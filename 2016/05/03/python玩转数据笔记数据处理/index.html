<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      python玩转数据笔记:数据处理 &middot; 跬步
    
  </title>

  
  <link rel="stylesheet" href="https://zhu327.github.io/css/poole.css">
  <link rel="stylesheet" href="https://zhu327.github.io/css/syntax.css">
  <link rel="stylesheet" href="https://zhu327.github.io/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://zhu327.github.io/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://zhu327.github.io/assets/favicon.ico">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://zhu327.github.io/feed.xml">
</head>


  <body class="theme-base-0d">

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>My notes and thoughts.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="https://zhu327.github.io/">Home</a>
    <a class="sidebar-nav-item " href="https://zhu327.github.io/post">Posts</a>
    <a class="sidebar-nav-item " href="https://zhu327.github.io/tags">Tags</a>

    
    
      
        <a class="sidebar-nav-item " href="https://zhu327.github.io/about/">About</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://github.com/zhu327" target="_blank">GitHub</a>
  </nav>

  <div class="sidebar-item">
    <p>&copy; 2020. All rights reserved.</p>
  </div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="https://zhu327.github.io/" title="Home">跬步</a>
            <small>On Coding</small>
          </h3>
        </div>
      </div>

      <div class="container content">


<div class="post">
  <h1 class="post-title">python玩转数据笔记:数据处理</h1>
  <span class="post-date">May 3 2016</span>
  <h3 id="时间索引">时间索引</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20160503&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">index</span>
<span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2016-05-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-05-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-05-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-05-06&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2016-05-07&#39;</span><span class="p">],</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span></code></pre></div>
<p></p>

<h3 id="数据显示">数据显示</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span>
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">03</span>  <span class="mf">0.320522</span> <span class="o">-</span><span class="mf">0.854196</span> <span class="o">-</span><span class="mf">0.477794</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">04</span> <span class="o">-</span><span class="mf">0.736698</span>  <span class="mf">0.220931</span>  <span class="mf">0.878340</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">05</span>  <span class="mf">1.002439</span> <span class="o">-</span><span class="mf">0.422472</span> <span class="o">-</span><span class="mf">1.027093</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">06</span>  <span class="mf">1.792256</span>  <span class="mf">0.322563</span>  <span class="mf">0.285416</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span> <span class="o">-</span><span class="mf">2.291344</span>  <span class="mf">0.633183</span>  <span class="mf">1.120919</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">index</span> <span class="c1"># 获取索引</span>
<span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2016-05-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-05-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-05-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-05-06&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2016-05-07&#39;</span><span class="p">],</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">columns</span> <span class="c1"># 列名</span>
<span class="n">Index</span><span class="p">([</span><span class="sa">u</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">values</span> <span class="c1"># 返回数组，从这里可以看出来DataFrame与Series都是以ndarray为基础的</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.32052247</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.85419619</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.47779368</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.73669815</span><span class="p">,</span>  <span class="mf">0.22093113</span><span class="p">,</span>  <span class="mf">0.87834037</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.00243859</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.42247204</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.02709299</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.79225566</span><span class="p">,</span>  <span class="mf">0.32256317</span><span class="p">,</span>  <span class="mf">0.28541609</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">2.2913443</span> <span class="p">,</span>  <span class="mf">0.63318336</span><span class="p">,</span>  <span class="mf">1.12091912</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">describe</span> <span class="c1"># 描述</span>
<span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">DataFrame</span><span class="o">.</span><span class="n">describe</span> <span class="n">of</span>                    <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">03</span>  <span class="mf">0.320522</span> <span class="o">-</span><span class="mf">0.854196</span> <span class="o">-</span><span class="mf">0.477794</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">04</span> <span class="o">-</span><span class="mf">0.736698</span>  <span class="mf">0.220931</span>  <span class="mf">0.878340</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">05</span>  <span class="mf">1.002439</span> <span class="o">-</span><span class="mf">0.422472</span> <span class="o">-</span><span class="mf">1.027093</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">06</span>  <span class="mf">1.792256</span>  <span class="mf">0.322563</span>  <span class="mf">0.285416</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span> <span class="o">-</span><span class="mf">2.291344</span>  <span class="mf">0.633183</span>  <span class="mf">1.120919</span><span class="o">&gt;</span></code></pre></div>
<h3 id="数据筛选">数据筛选</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 切片，前一行</span>
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">03</span>  <span class="mf">0.320522</span> <span class="o">-</span><span class="mf">0.854196</span> <span class="o">-</span><span class="mf">0.477794</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 最后一行</span>
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span> <span class="o">-</span><span class="mf">2.291344</span>  <span class="mf">0.633183</span>  <span class="mf">1.120919</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="p">[</span><span class="s1">&#39;2016-05-03&#39;</span><span class="p">:</span><span class="s1">&#39;2016-05-05&#39;</span><span class="p">]</span> <span class="c1"># 通过索引切片</span>
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">03</span>  <span class="mf">0.320522</span> <span class="o">-</span><span class="mf">0.854196</span> <span class="o">-</span><span class="mf">0.477794</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">04</span> <span class="o">-</span><span class="mf">0.736698</span>  <span class="mf">0.220931</span>  <span class="mf">0.878340</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">05</span>  <span class="mf">1.002439</span> <span class="o">-</span><span class="mf">0.422472</span> <span class="o">-</span><span class="mf">1.027093</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016-05-03&#39;</span><span class="p">:</span><span class="s1">&#39;2016-05-05&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]]</span> <span class="c1"># 区域选择，定义索引，字段名</span>
                   <span class="n">A</span>         <span class="n">B</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">03</span>  <span class="mf">0.320522</span> <span class="o">-</span><span class="mf">0.854196</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">04</span> <span class="o">-</span><span class="mf">0.736698</span>  <span class="mf">0.220931</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">05</span>  <span class="mf">1.002439</span> <span class="o">-</span><span class="mf">0.422472</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span>
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.814773</span>  <span class="mf">0.828948</span>  <span class="mf">1.279713</span>
<span class="mi">1</span>  <span class="mf">1.010236</span> <span class="o">-</span><span class="mf">1.063719</span> <span class="o">-</span><span class="mf">1.010884</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.206223</span> <span class="o">-</span><span class="mf">1.756636</span> <span class="o">-</span><span class="mf">0.777366</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">0.253049</span>  <span class="mf">0.955689</span> <span class="o">-</span><span class="mf">1.735237</span>
<span class="mi">4</span> <span class="o">-</span><span class="mf">1.269495</span> <span class="o">-</span><span class="mf">0.321743</span>  <span class="mf">0.929069</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 定位到单元格</span>
<span class="o">-</span><span class="mf">0.81477290050615703</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,[</span><span class="mi">1</span><span class="p">,]]</span> <span class="c1"># 通过数字切片loc</span>
                   <span class="n">B</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">04</span> <span class="o">-</span><span class="mf">1.002059</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">05</span> <span class="o">-</span><span class="mf">0.298642</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">06</span> <span class="o">-</span><span class="mf">1.042664</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># 数字索引定位到单元格</span>
<span class="o">-</span><span class="mf">1.0020589880335706</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="p">[</span><span class="n">dates</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="s1">&#39;2016-05-05&#39;</span><span class="p">]</span> <span class="c1"># 条件筛选</span>
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">06</span> <span class="o">-</span><span class="mf">0.334060</span> <span class="o">-</span><span class="mf">1.042664</span>  <span class="mf">0.999093</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span> <span class="o">-</span><span class="mf">2.051357</span>  <span class="mf">0.713025</span> <span class="o">-</span><span class="mf">0.792198</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="p">[(</span><span class="n">dates</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="s1">&#39;2016-05-05&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">A</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="c1"># 组合筛选</span>
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">06</span> <span class="o">-</span><span class="mf">0.334060</span> <span class="o">-</span><span class="mf">1.042664</span>  <span class="mf">0.999093</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span> <span class="o">-</span><span class="mf">2.051357</span>  <span class="mf">0.713025</span> <span class="o">-</span><span class="mf">0.792198</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="p">[</span><span class="n">dates</span><span class="o">.</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">B</span> <span class="c1"># 返回Series</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">06</span>   <span class="o">-</span><span class="mf">0.139405</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span>   <span class="o">-</span><span class="mf">1.437701</span>
<span class="n">Freq</span><span class="p">:</span> <span class="n">D</span><span class="p">,</span> <span class="n">Name</span><span class="p">:</span> <span class="n">B</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="p">[</span><span class="n">dates</span><span class="o">.</span><span class="n">A</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># 计算平均值</span>
<span class="o">-</span><span class="mf">0.78855298332911494</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span> <span class="c1"># 行数</span>
<span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">A</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">status</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">A</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">status</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">)]</span><span class="o">.</span><span class="n">size</span> <span class="c1"># 算变更类型未1的数量</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1"># 排序</span>
<span class="n">__main__</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span> <span class="ne">FutureWarning</span><span class="p">:</span> <span class="n">sort</span><span class="p">(</span><span class="n">columns</span><span class="o">=....</span><span class="p">)</span> <span class="ow">is</span> <span class="n">deprecated</span><span class="p">,</span> <span class="n">use</span> <span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=.....</span><span class="p">)</span>
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">03</span> <span class="o">-</span><span class="mf">0.695635</span>  <span class="mf">0.077077</span>  <span class="mf">0.694779</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">05</span> <span class="o">-</span><span class="mf">0.641996</span>  <span class="mf">1.420200</span>  <span class="mf">0.086330</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">04</span> <span class="o">-</span><span class="mf">0.594039</span> <span class="o">-</span><span class="mf">0.842575</span> <span class="o">-</span><span class="mf">0.046909</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span>  <span class="mf">0.667998</span> <span class="o">-</span><span class="mf">1.437701</span> <span class="o">-</span><span class="mf">0.196523</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">06</span>  <span class="mf">1.176916</span> <span class="o">-</span><span class="mf">0.139405</span> <span class="o">-</span><span class="mf">0.592849</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="c1"># 分组，分组的字段作为索引</span>
           <span class="n">B</span>  <span class="n">C</span>
<span class="n">A</span>              
<span class="o">-</span><span class="mf">0.695635</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="o">-</span><span class="mf">0.641996</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="o">-</span><span class="mf">0.594039</span>  <span class="mi">1</span>  <span class="mi">1</span>
 <span class="mf">0.667998</span>  <span class="mi">1</span>  <span class="mi">1</span>
 <span class="mf">1.176916</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span> <span class="c1"># 分组计算和</span>
                  <span class="n">B</span>         <span class="n">C</span>
<span class="n">A</span>                            
<span class="o">-</span><span class="mf">0.695635</span>  <span class="mf">0.077077</span>  <span class="mf">0.694779</span>
<span class="o">-</span><span class="mf">0.641996</span>  <span class="mf">1.420200</span>  <span class="mf">0.086330</span>
<span class="o">-</span><span class="mf">0.594039</span> <span class="o">-</span><span class="mf">0.842575</span> <span class="o">-</span><span class="mf">0.046909</span>
 <span class="mf">0.667998</span> <span class="o">-</span><span class="mf">1.437701</span> <span class="o">-</span><span class="mf">0.196523</span>
 <span class="mf">1.176916</span> <span class="o">-</span><span class="mf">0.139405</span> <span class="o">-</span><span class="mf">0.592849</span></code></pre></div>
<p><img src="http://7oti6o.com1.z0.glb.clouddn.com//blog/dataframe.png" alt="sum" /></p>

<h3 id="数据合并">数据合并</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">bdates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bdates</span>
          <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.043208</span>  <span class="mf">0.332842</span> <span class="o">-</span><span class="mf">0.390034</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.318745</span>  <span class="mf">0.013284</span>  <span class="mf">0.147836</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span>
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">03</span> <span class="o">-</span><span class="mf">0.695635</span>  <span class="mf">0.077077</span>  <span class="mf">0.694779</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">04</span> <span class="o">-</span><span class="mf">0.594039</span> <span class="o">-</span><span class="mf">0.842575</span> <span class="o">-</span><span class="mf">0.046909</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">05</span> <span class="o">-</span><span class="mf">0.641996</span>  <span class="mf">1.420200</span>  <span class="mf">0.086330</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">06</span>  <span class="mf">1.176916</span> <span class="o">-</span><span class="mf">0.139405</span> <span class="o">-</span><span class="mf">0.592849</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span>  <span class="mf">0.667998</span> <span class="o">-</span><span class="mf">1.437701</span> <span class="o">-</span><span class="mf">0.196523</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bdates</span><span class="p">)</span> <span class="c1"># 追加</span>
                            <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">03</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="o">-</span><span class="mf">0.695635</span>  <span class="mf">0.077077</span>  <span class="mf">0.694779</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">04</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="o">-</span><span class="mf">0.594039</span> <span class="o">-</span><span class="mf">0.842575</span> <span class="o">-</span><span class="mf">0.046909</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">05</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="o">-</span><span class="mf">0.641996</span>  <span class="mf">1.420200</span>  <span class="mf">0.086330</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">06</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">1.176916</span> <span class="o">-</span><span class="mf">0.139405</span> <span class="o">-</span><span class="mf">0.592849</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span> <span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>  <span class="mf">0.667998</span> <span class="o">-</span><span class="mf">1.437701</span> <span class="o">-</span><span class="mf">0.196523</span>
<span class="mi">0</span>                   <span class="o">-</span><span class="mf">0.043208</span>  <span class="mf">0.332842</span> <span class="o">-</span><span class="mf">0.390034</span>
<span class="mi">1</span>                   <span class="o">-</span><span class="mf">0.318745</span>  <span class="mf">0.013284</span>  <span class="mf">0.147836</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pieces</span> <span class="o">=</span> <span class="p">[</span><span class="n">dates</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dates</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span> <span class="c1"># 合并片段</span>
                   <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">03</span> <span class="o">-</span><span class="mf">0.695635</span>  <span class="mf">0.077077</span>  <span class="mf">0.694779</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">04</span> <span class="o">-</span><span class="mf">0.594039</span> <span class="o">-</span><span class="mf">0.842575</span> <span class="o">-</span><span class="mf">0.046909</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mo">07</span>  <span class="mf">0.667998</span> <span class="o">-</span><span class="mf">1.437701</span> <span class="o">-</span><span class="mf">0.196523</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># 忽略不想同的字段，用NaN填充</span>
          <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.695635</span>  <span class="mf">0.077077</span>  <span class="mf">0.694779</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.594039</span> <span class="o">-</span><span class="mf">0.842575</span> <span class="o">-</span><span class="mf">0.046909</span>
<span class="mi">2</span>  <span class="mf">0.667998</span> <span class="o">-</span><span class="mf">1.437701</span> <span class="o">-</span><span class="mf">0.196523</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">bdates</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1"># join合并，类比sql语句</span>
<span class="n">Empty</span> <span class="n">DataFrame</span>
<span class="n">Columns</span><span class="p">:</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B_x</span><span class="p">,</span> <span class="n">C_x</span><span class="p">,</span> <span class="n">B_y</span><span class="p">,</span> <span class="n">C_y</span><span class="p">]</span>
<span class="n">Index</span><span class="p">:</span> <span class="p">[]</span></code></pre></div>


</div>



<span id="/2016/05/03/python%E7%8E%A9%E8%BD%AC%E6%95%B0%E6%8D%AE%E7%AC%94%E8%AE%B0%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" class="leancloud_visitors" data-flag-title="python玩转数据笔记:数据处理">
  <span class="post-meta-item-text">文章阅读量 </span>
  <span class="leancloud-visitors-count">1000000</span>
  <p></p>
</span>
<div id="vcomments"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script type="text/javascript">
  new Valine({
      el: '#vcomments' ,
      appId: 'ets5MnLq4PcezyQ5V12Rn2yc-gzGzoHsz',
      appKey: '0PRGA047aMY95OeydaayLDEK',
      verify:  false , 
      avatar:'mm', 
      placeholder: '说点什么吧...',
      visitor:  true 
  });
</script>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>

