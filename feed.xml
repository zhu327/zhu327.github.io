<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
      <title>è·¬æ­¥ On Coding </title>
      <generator uri="https://gohugo.io">Hugo</generator>
    <link>https://zhu327.github.io/</link>
    <language>zh-cn</language>
    
    
    <updated>Wed, 02 Apr 2025 10:55:52 &#43;0800</updated>
    
    <item>
      <title>æˆ‘ç†è§£çš„AI Agentä¸MCP</title>
      <link>https://zhu327.github.io/2025/04/02/%E6%88%91%E7%90%86%E8%A7%A3%E7%9A%84ai-agent%E4%B8%8Emcp/</link>
      <pubDate>Wed, 02 Apr 2025 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/04/02/%E6%88%91%E7%90%86%E8%A7%A3%E7%9A%84ai-agent%E4%B8%8Emcp/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;æœ€è¿‘AIåœˆå­é‡ŒManusè¿™ä¸ªé¡¹ç›®å¯ä»¥è¯´æ˜¯ç›¸å½“ç«äº†ï¼Œè¿å¸¦ç€MCPï¼ˆModel Context Protocolï¼‰è¿™ä¸ªæ¦‚å¿µä¹Ÿå¼€å§‹é¢‘ç¹å‡ºç°åœ¨å„ç§æŠ€æœ¯è®¨è®ºåŒºã€‚ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œè‡ªç„¶ä¹Ÿå¯¹è¿™äº›æ–°ä¸œè¥¿å……æ»¡äº†å¥½å¥‡ï¼Œäºæ˜¯èŠ±æ—¶é—´æ£é¼“äº†ä¸€ä¸‹AI Agentå’ŒMCPç›¸å…³çš„çŸ¥è¯†ã€‚è¿™ç¯‡æ–‡ç« å°±æ˜¯æˆ‘å­¦ä¹ å’Œæ€è€ƒåï¼Œå¯¹è¿™ä¸¤ä¸ªæ¦‚å¿µçš„ä¸€äº›ä¸ªäººç†è§£å’Œæ¢³ç†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-ä»workflowåˆ°ai-agent-å¤§è„‘çš„è¿›åŒ–&#34;&gt;1. ä»Workflowåˆ°AI Agentï¼šå¤§è„‘çš„è¿›åŒ–&lt;/h3&gt;

&lt;p&gt;å›é¡¾æˆ‘ä»¬ä»¥å‰åšè‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œæ¯”å¦‚æä¸ªè‡ªåŠ¨æŠ¢ç¥¨ã€è‡ªåŠ¨ä¸‹å•ä¹‹ç±»çš„ï¼Œæ€è·¯åŸºæœ¬éƒ½æ˜¯å›´ç»•ç€ä¸€ä¸ªå›ºå®šçš„&lt;strong&gt;workflow&lt;/strong&gt;ã€‚æˆ‘ä»¬ä¼šé¢„å…ˆè®¾å®šå¥½ä¸€å¥—æµç¨‹é€»è¾‘ï¼šæ”¶åˆ°æŒ‡ä»¤ -&amp;gt; åˆ¤æ–­æ¡ä»¶ -&amp;gt; èµ°å¯¹åº”åˆ†æ”¯ -&amp;gt; è°ƒç”¨ç‰¹å®šå·¥å…·ï¼ˆAPIã€è„šæœ¬ç­‰ï¼‰ã€‚æ•´ä¸ªè¿‡ç¨‹å°±åƒä¸€ä¸ªæµç¨‹å›¾ï¼Œæ¯ä¸ªèŠ‚ç‚¹å’Œè·¯å¾„éƒ½æ˜¯æˆ‘ä»¬ç¨‹åºå‘˜é¢„å…ˆè®¾è®¡å¥½çš„ã€‚åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œ&lt;strong&gt;æˆ‘ä»¬ç¨‹åºå‘˜å°±æ˜¯è¿™ä¸ªworkflowçš„â€œå¤§è„‘â€&lt;/strong&gt;ï¼Œæˆ‘ä»¬æŠŠæ‰§è¡Œè®¡åˆ’é€šè¿‡ä»£ç é€»è¾‘ï¼Œâ€œç¡¬ç¼–ç â€åˆ°ç³»ç»Ÿé‡Œã€‚æ¯”å¦‚é¢„å®šæœºç¥¨è¿™ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬ä¼šå†™ä»£ç ä¸€æ­¥æ­¥è°ƒç”¨æŸ¥è¯¢æ¥å£ã€é€‰æ‹©èˆªç­æ¥å£ã€å¡«å†™ä¹˜æœºäººä¿¡æ¯æ¥å£ã€æ”¯ä»˜æ¥å£ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;2-llmç™»åœº-æœ‰äº†-å¤§è„‘-ä½†è¿˜ç¼º-æ‰‹è„š&#34;&gt;2. LLMç™»åœºï¼šæœ‰äº†â€œå¤§è„‘â€ï¼Œä½†è¿˜ç¼ºâ€œæ‰‹è„šâ€&lt;/h3&gt;

&lt;p&gt;éšç€å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æŠ€æœ¯çš„çªé£çŒ›è¿›ï¼Œç‰¹åˆ«æ˜¯åƒDeepSeek R1è¿™æ ·å¼ºå¤§çš„æ¨ç†æ¨¡å‹å‡ºç°ï¼Œå®ƒä»¬çš„æ¨ç†å’Œè§„åˆ’èƒ½åŠ›è¶Šæ¥è¶Šæ¥è¿‘äººç±»å¤§è„‘ã€‚è¿™å°±è®©æˆ‘ä»¬è‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°ï¼šèƒ½ä¸èƒ½è®©LLMæ¥å……å½“è¿™ä¸ªè‡ªåŠ¨åŒ–æµç¨‹çš„â€œå¤§è„‘â€ï¼Œä»£æ›¿æˆ‘ä»¬æ¥åˆ¶å®šæ‰§è¡Œè®¡åˆ’å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;æƒ³æ³•å¾ˆç¾å¥½ï¼Œä½†LLMæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ª&lt;strong&gt;æ–‡æœ¬è¡¥å…¨&lt;/strong&gt;çš„æ¨¡å‹ã€‚å®ƒèƒ½â€œæ€è€ƒâ€å¹¶å‘Šè¯‰ä½ è®¡åˆ’æ˜¯ä»€ä¹ˆï¼Œä½†å®ƒè‡ªå·±å¹¶ä¸èƒ½ç›´æ¥æ’¸èµ·è¢–å­å»è°ƒç”¨é‚£äº›å…·ä½“çš„å·¥å…·ï¼ˆAPIã€å‡½æ•°ç­‰ï¼‰æ¥å®Œæˆä»»åŠ¡ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒOpenAIåœ¨å…¶APIä¸­å¼•å…¥äº†&lt;code&gt;tools&lt;/code&gt;ï¼ˆæˆ–ç§°ä¸º Function Callingï¼‰çš„æ¦‚å¿µã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªæµç¨‹å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š
1.  æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼ˆå¯ä»¥ç§°ä¸ºAgentï¼‰è°ƒç”¨LLM APIæ—¶ï¼Œåœ¨è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¸­è¯¦ç»†æè¿°å¯ç”¨çš„å·¥å…·ï¼šæ¯ä¸ªå·¥å…·æ˜¯å¹²å˜›çš„ã€è¾“å…¥éœ€è¦ä»€ä¹ˆå‚æ•°ã€è¾“å‡ºæ˜¯ä»€ä¹ˆæ ¼å¼ã€‚
2.  AgentæŠŠç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼ˆPromptï¼‰å‘ç»™LLMã€‚
3.  LLMæ ¹æ®ç”¨æˆ·çš„éœ€æ±‚ï¼Œç»“åˆå®ƒæ‰€çŸ¥é“çš„å·¥å…·ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦ä»¥åŠéœ€è¦è°ƒç”¨å“ªä¸ªï¼ˆæˆ–å“ªäº›ï¼‰å·¥å…·ã€‚
4.  å¦‚æœéœ€è¦è°ƒç”¨å·¥å…·ï¼ŒLLMä¸ä¼šç›´æ¥æ‰§è¡Œï¼Œè€Œæ˜¯&lt;strong&gt;è¿”å›ä¸€ä¸ªåŒ…å«è°ƒç”¨æŒ‡ä»¤çš„å“åº”&lt;/strong&gt;ï¼Œé‡Œé¢è¯´æ˜äº†è¦è°ƒç”¨å“ªä¸ªå·¥å…·ä»¥åŠéœ€è¦ä¼ é€’çš„å‚æ•°ï¼ˆé€šå¸¸æ˜¯JSONæ ¼å¼ï¼‰ã€‚
5.  Agentæ”¶åˆ°è¿™ä¸ªå“åº”åï¼Œè§£æå‡ºè°ƒç”¨æŒ‡ä»¤ï¼Œ&lt;strong&gt;åœ¨Agentè‡ªå·±çš„ç¯å¢ƒé‡Œæ‰§è¡Œ&lt;/strong&gt;ç›¸åº”çš„å·¥å…·ï¼ˆæ¯”å¦‚è°ƒç”¨ä¸€ä¸ªæœ¬åœ°å‡½æ•°æˆ–ä¸€ä¸ªå¤–éƒ¨APIï¼‰ã€‚
6.  Agentæ‹¿åˆ°å·¥å…·çš„æ‰§è¡Œç»“æœåï¼ŒæŠŠè¿™ä¸ªç»“æœå†æ¬¡ä½œä¸ºä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¼ å›ç»™LLMã€‚
7.  LLMæ ¹æ®å·¥å…·çš„æ‰§è¡Œç»“æœï¼Œå†³å®šä¸‹ä¸€æ­¥æ˜¯ç»§ç»­è°ƒç”¨å…¶ä»–å·¥å…·ï¼Œè¿˜æ˜¯ç”Ÿæˆæœ€ç»ˆçš„å›å¤ç»™ç”¨æˆ·ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªåŸºäº&lt;code&gt;tools&lt;/code&gt;çš„äº¤äº’æ¨¡å¼ï¼Œè®©LLMæœ‰äº†æŒ‡æŒ¥â€œæ‰‹è„šâ€ï¼ˆå·¥å…·ï¼‰çš„èƒ½åŠ›ã€‚ä½†è¿™é‡Œä¹Ÿæš´éœ²äº†ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„&lt;strong&gt;å¼Šç«¯&lt;/strong&gt;ï¼šå®Œæˆä¸€ä¸ªä»»åŠ¡å¯èƒ½éœ€è¦&lt;strong&gt;å¤šæ¬¡ä¸LLMè¿›è¡Œäº¤äº’&lt;/strong&gt;ï¼ˆLLMå†³ç­– -&amp;gt; Agentæ‰§è¡Œ -&amp;gt; Agentåé¦ˆç»“æœ -&amp;gt; LLMå†å†³ç­–&amp;hellip;ï¼‰ï¼Œå¹¶ä¸”ä¸ºäº†è®©LLMç†è§£ä¸Šä¸‹æ–‡ï¼Œæ¯æ¬¡äº¤äº’éƒ½éœ€è¦ä¼ é€’è¶Šæ¥è¶Šé•¿çš„å†å²ä¿¡æ¯ï¼Œè¿™æ—¢&lt;strong&gt;å¢åŠ äº†å»¶è¿Ÿ&lt;/strong&gt;ï¼Œä¹Ÿ&lt;strong&gt;å¢åŠ äº†APIè°ƒç”¨æˆæœ¬å’ŒTokenæ¶ˆè€—&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-codeact-è®©llmç›´æ¥å†™ä»£ç æ‰§è¡Œ&#34;&gt;3. CodeActï¼šè®©LLMç›´æ¥å†™ä»£ç æ‰§è¡Œ&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼Œå½“å‰LLMæœ€å¼ºçš„èƒ½åŠ›ä¹‹ä¸€å°±æ˜¯&lt;strong&gt;ä»£ç ç”Ÿæˆ&lt;/strong&gt;ã€‚äºæ˜¯ï¼Œå°±æœ‰äººæƒ³å‡ºäº†å¦ä¸€ç§æ›´ç›´æ¥çš„æ€è·¯ï¼šæ—¢ç„¶LLMæ“…é•¿å†™ä»£ç ï¼Œè€Œæˆ‘ä»¬æä¾›çš„å·¥å…·æœ¬èº«å¾ˆå¤šå°±æ˜¯å‡½æ•°æˆ–è€…å¯ä»¥é€šè¿‡ä»£ç è°ƒç”¨çš„APIï¼Œé‚£ä½•ä¸è®©LLMç›´æ¥ç”Ÿæˆä¸€å°æ®µå¯æ‰§è¡Œçš„ä»£ç ï¼ˆæ¯”å¦‚Pythonï¼‰ï¼Œç„¶ååœ¨æˆ‘ä»¬çš„Agenté‡Œå†…ç½®ä¸€ä¸ªå®‰å…¨çš„&lt;strong&gt;ä»£ç æ‰§è¡Œæ²™ç®±&lt;/strong&gt;æ¥è¿è¡Œè¿™æ®µä»£ç å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;åœ¨è¿™æ®µç”Ÿæˆçš„ä»£ç é‡Œï¼ŒLLMå¯ä»¥ç›´æ¥åŒ…å«å¯¹æˆ‘ä»¬æä¾›çš„å·¥å…·ï¼ˆå‡½æ•°ï¼‰çš„è°ƒç”¨ï¼Œç”šè‡³å¯ä»¥ç¼–å†™ä¸€äº›ç®€å•çš„æµç¨‹æ§åˆ¶é€»è¾‘ï¼ˆif/elseã€å¾ªç¯ç­‰ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¤šä¸ªæ­¥éª¤å’Œå·¥å…·è°ƒç”¨å¯èƒ½é€šè¿‡ä¸€æ¬¡LLMç”Ÿæˆã€ä¸€æ¬¡ä»£ç æ‰§è¡Œå°±å®Œæˆäº†ï¼Œå¤§å¤§&lt;strong&gt;å‡å°‘äº†ä¸LLMçš„äº¤äº’æ¬¡æ•°&lt;/strong&gt;ã€‚è¿™ç§æ–¹æ³•å°±è¢«ç§°ä¸º&lt;strong&gt;CodeAct&lt;/strong&gt;ï¼ˆä»£ç ä½œä¸ºè¡ŒåŠ¨ï¼‰ã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-åˆ°åº•ä»€ä¹ˆæ˜¯ai-agent&#34;&gt;4. åˆ°åº•ä»€ä¹ˆæ˜¯AI Agentï¼Ÿ&lt;/h3&gt;

&lt;p&gt;èŠäº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬å†æ¥å°è¯•ç»™AI Agentä¸‹ä¸€ä¸ªå®šä¹‰ã€‚æˆ‘è®¤ä¸ºï¼Œ&lt;strong&gt;AI Agent = LLMï¼ˆå¤§è„‘ï¼‰ + Toolsï¼ˆæ‰‹è„šï¼‰ + Agent Runtimeï¼ˆæ‰§è¡Œå™¨ï¼‰ + å†³ç­–å¾ªç¯&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å…·ä½“æ¥è¯´ï¼ŒAI Agenté€šè¿‡è°ƒç”¨LLM APIï¼Œå¹¶ç»“åˆä¸€ç³»åˆ—å¯ç”¨çš„å·¥å…·ï¼ˆToolsï¼‰ï¼Œæ¥ç†è§£å¹¶æ‰§è¡Œç”¨æˆ·çš„è‡ªç„¶è¯­è¨€ä»»åŠ¡ã€‚å®ƒé€šå¸¸é‡‡ç”¨ä¸€ç§&lt;strong&gt;å†³ç­–-æ‰§è¡Œ-è§‚å¯Ÿ&lt;/strong&gt;çš„å¾ªç¯æ¨¡å¼ï¼ˆReActï¼‰ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†³ç­–ï¼ˆReasonï¼‰&lt;/strong&gt;ï¼šç”±LLMæ ¹æ®å½“å‰ä»»åŠ¡ç›®æ ‡å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå†³å®šä¸‹ä¸€æ­¥æ˜¯è°ƒç”¨å·¥å…·è¿˜æ˜¯ç›´æ¥å›å¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œï¼ˆActï¼‰&lt;/strong&gt;ï¼šç”±Agent Runtimeæ ¹æ®LLMçš„å†³ç­–ï¼Œæ‰§è¡Œç›¸åº”çš„å·¥å…·è°ƒç”¨æˆ–ä»£ç ç‰‡æ®µã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§‚å¯Ÿï¼ˆObserveï¼‰&lt;/strong&gt;ï¼šAgent Runtimeå°†æ‰§è¡Œç»“æœåé¦ˆç»™LLMï¼Œä½œä¸ºæ–°çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¾›LLMè¿›è¡Œä¸‹ä¸€è½®å†³ç­–ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™ä¸ªå¾ªç¯ä¸€ç›´æŒç»­ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆã€‚&lt;/p&gt;

&lt;p&gt;ä½†è¿™é‡Œæœ‰ä¸ªå…³é”®é—®é¢˜ï¼šLLMæœ¬èº«å…·æœ‰ä¸€å®šçš„&lt;strong&gt;ä¸ç¡®å®šæ€§&lt;/strong&gt;ã€‚å¯¹äºç›¸åŒçš„è¾“å…¥ï¼ˆPromptï¼‰ï¼Œå®ƒæ¯æ¬¡è¿”å›çš„ç»“æœå¯èƒ½éƒ½ä¸å®Œå…¨ä¸€æ ·ã€‚è¿™å°±ç»™AI Agentçš„æ‰§è¡Œå¸¦æ¥äº†æŒ‘æˆ˜ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¼šåç¦»é¢„æœŸæˆ–è€…å¡åœ¨æŸä¸ªç¯èŠ‚ã€‚å› æ­¤ï¼Œåœ¨å¼€å‘AI Agentæ—¶ï¼Œæ¥å…¥&lt;strong&gt;Tracingï¼ˆè¿½è¸ªï¼‰&lt;/strong&gt;ç³»ç»Ÿå˜å¾—éå¸¸é‡è¦ã€‚æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿå®æ—¶è·Ÿè¸ªAgentä¸LLMçš„æ¯ä¸€æ¬¡äº¤äº’ã€ä¸Šä¸‹æ–‡å†…å®¹ã€å·¥å…·è°ƒç”¨æƒ…å†µä»¥åŠæ‰§è¡Œç»“æœï¼Œè¿™æ ·æ‰èƒ½åœ¨å‡ºç°é—®é¢˜æ—¶å¿«é€Ÿå®šä½å’Œè°ƒè¯•ï¼Œè¿›è€Œä¼˜åŒ–æˆ‘ä»¬çš„Promptæˆ–è€…Agenté€»è¾‘ã€‚&lt;/p&gt;

&lt;h3 id=&#34;5-å¤šagentåä½œ-ä¸“ä¸šçš„äº‹äº¤ç»™ä¸“ä¸šçš„agent&#34;&gt;5. å¤šAgentåä½œï¼šä¸“ä¸šçš„äº‹äº¤ç»™ä¸“ä¸šçš„Agent&lt;/h3&gt;

&lt;p&gt;éšç€Manusçš„æµè¡Œï¼Œ&lt;strong&gt;å¤šAgentç¼–æ’ï¼ˆMulti-Agent Orchestrationï¼‰&lt;/strong&gt;çš„ç†å¿µä¹Ÿå¼€å§‹å—åˆ°å…³æ³¨ã€‚æ ¸å¿ƒæ€è·¯æ˜¯&lt;strong&gt;åŒ–æ•´ä¸ºé›¶ï¼Œåˆ†å·¥åä½œ&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä¸å†è¯•å›¾æ„å»ºä¸€ä¸ªâ€œä¸‡èƒ½â€çš„è¶…çº§Agentï¼Œè€Œæ˜¯å°†å¤æ‚çš„ä»»åŠ¡æ‹†è§£ï¼Œæ„å»ºå¤šä¸ª&lt;strong&gt;åŠŸèƒ½å•ä¸€ã€èŒè´£æ˜ç¡®&lt;/strong&gt;çš„&lt;strong&gt;ä¸“å®¶Agent&lt;/strong&gt;ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ&lt;code&gt;web_search&lt;/code&gt;å’Œ&lt;code&gt;web_fetch&lt;/code&gt;è¿™ä¸¤ä¸ªå·¥å…·ç»„åˆèµ·æ¥ï¼Œå°è£…æˆä¸€ä¸ªä¸“é—¨è´Ÿè´£ç½‘é¡µæŠ“å–çš„&lt;code&gt;web_scraper_agent&lt;/code&gt;ã€‚è¿™ç§å•ä¸€åŠŸèƒ½çš„Agentï¼Œå®ƒçš„å¤§è„‘ï¼ˆLLMï¼‰å¯èƒ½ä¸éœ€è¦æœ€é¡¶çº§çš„æ¨ç†èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥é€‰ç”¨ä¸€ä¸ª&lt;strong&gt;æ€§èƒ½è¶³å¤Ÿä¸”æˆæœ¬æ›´ä½&lt;/strong&gt;çš„æ¨¡å‹ï¼ˆæ¯”å¦‚ä¸€äº›ä¸­å°å‹æ¨¡å‹æˆ–è€…ç‰¹å®šé¢†åŸŸçš„å¾®è°ƒæ¨¡å‹ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;å½“æˆ‘ä»¬æœ‰äº†å¤šä¸ªè¿™æ ·çš„ä¸“å®¶Agentåï¼Œå†å¼•å…¥ä¸€ä¸ª&lt;strong&gt;Planner Agentï¼ˆè§„åˆ’å™¨Agentï¼‰&lt;/strong&gt;ã€‚è¿™ä¸ªPlanner Agenté€šå¸¸éœ€è¦ä¸€ä¸ª&lt;strong&gt;æ¨ç†èƒ½åŠ›è¾ƒå¼º&lt;/strong&gt;çš„LLMä½œä¸ºå¤§è„‘ï¼Œå®ƒçš„èŒè´£æ˜¯ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æ¥æ”¶ç”¨æˆ·çš„åŸå§‹ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;å°†ä»»åŠ¡æ‹†è§£æˆè‹¥å¹²å­æ­¥éª¤ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®æ¯ä¸ªå­æ­¥éª¤çš„éœ€æ±‚ï¼Œé€‰æ‹©å¹¶è°ƒç”¨åˆé€‚çš„ä¸“å®¶Agentã€‚&lt;/li&gt;
&lt;li&gt;æ”¶é›†ä¸“å®¶Agentçš„æ‰§è¡Œç»“æœã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®æ‰§è¡Œç»“æœï¼ŒåŠ¨æ€è°ƒæ•´åç»­çš„è®¡åˆ’ï¼ˆå¯èƒ½éœ€è¦é‡æ–°è§„åˆ’æˆ–è°ƒç”¨å…¶ä»–Agentï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¾ªç¯è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æœ€ç»ˆä»»åŠ¡å®Œæˆï¼Œç„¶åå°†ç»“æœæ±‡æ€»è¿”å›ç»™ç”¨æˆ·ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™ç§å¤šAgentæ¶æ„å¸¦æ¥çš„å¥½å¤„æ˜¾è€Œæ˜“è§ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æˆæœ¬æ•ˆç›Š&lt;/strong&gt;ï¼šåœ¨å¤§é‡æ‰§è¡Œå…·ä½“ä»»åŠ¡çš„ä¸“å®¶Agentä¸Šå¯ä»¥ä½¿ç”¨æ›´ä¾¿å®œçš„LLMã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»´æŠ¤æ€§&lt;/strong&gt;ï¼šæ¯ä¸ªAgentåŠŸèƒ½å•ä¸€ï¼Œæ›´å®¹æ˜“å¼€å‘ã€æµ‹è¯•å’Œç»´æŠ¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ€§&lt;/strong&gt;ï¼šå¯ä»¥æ–¹ä¾¿åœ°å¢åŠ æ–°çš„ä¸“å®¶Agentæ¥æ‰©å±•æ•´ä¸ªç³»ç»Ÿçš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯èƒ½æ›´ä¼˜åŒ–çš„ä¸Šä¸‹æ–‡ç®¡ç†&lt;/strong&gt;ï¼šPlanner Agentå¯èƒ½åªéœ€è¦å…³æ³¨å­ä»»åŠ¡çš„ç›®æ ‡å’Œä¸“å®¶Agentè¿”å›çš„å…³é”®ç»“æœï¼Œè€Œä¸éœ€è¦æ‰¿è½½æ‰€æœ‰åº•å±‚å·¥å…·è°ƒç”¨çš„è¯¦ç»†ä¸Šä¸‹æ–‡ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;6-promptå·¥ç¨‹-agentçš„çµé­‚&#34;&gt;6. Promptå·¥ç¨‹ï¼šAgentçš„çµé­‚&lt;/h3&gt;

&lt;p&gt;æ— è®ºæ˜¯ä½¿ç”¨ReActè¿˜æ˜¯CodeActï¼Œæ— è®ºæ˜¯å•Agentæ¶æ„è¿˜æ˜¯å¤šAgentç¼–æ’ï¼Œæœ‰ä¸€ä¸ªç¯èŠ‚å§‹ç»ˆæ˜¯ç»•ä¸å¼€çš„ï¼Œé‚£å°±æ˜¯&lt;strong&gt;Prompt Engineeringï¼ˆæç¤ºå·¥ç¨‹ï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€ä¸ªä¸LLMäº¤äº’çš„ç¯èŠ‚ï¼ˆæ— è®ºæ˜¯Planner Agentåˆ¶å®šè®¡åˆ’ï¼Œè¿˜æ˜¯ä¸“å®¶Agentæ‰§è¡Œä»»åŠ¡ï¼Œæˆ–æ˜¯Function Calling/CodeActçš„è§¦å‘ï¼‰&lt;strong&gt;ç²¾å¿ƒè®¾è®¡Prompt&lt;/strong&gt;ã€‚å¥½çš„Promptéœ€è¦èƒ½å¤Ÿå¼•å¯¼LLMæŒ‰ç…§æˆ‘ä»¬çš„é¢„æœŸæ¥æ€è€ƒå’Œè¾“å‡ºï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è®©Planner Agentç”Ÿæˆ&lt;strong&gt;ç»“æ„åŒ–ã€å¯åˆ†æ­¥æ‰§è¡Œ&lt;/strong&gt;çš„è®¡åˆ’ã€‚&lt;/li&gt;
&lt;li&gt;è®©LLMåœ¨éœ€è¦æ—¶&lt;strong&gt;å‡†ç¡®åœ°é€‰æ‹©å¹¶è°ƒç”¨&lt;/strong&gt;æˆ‘ä»¬æä¾›çš„å·¥å…·ã€‚&lt;/li&gt;
&lt;li&gt;è®©LLMè¿”å›&lt;strong&gt;æ ¼å¼è§„èŒƒã€æ˜“äºè§£æ&lt;/strong&gt;çš„æ–‡æœ¬ï¼ˆæ¯”å¦‚JSONï¼‰ï¼Œæ–¹ä¾¿Agent Runtimeå¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¯ä»¥è¯´ï¼ŒPromptå°±æ˜¯æˆ‘ä»¬ç»™AI Agentæ³¨å…¥çµé­‚çš„æ–¹å¼ã€‚&lt;/p&gt;

&lt;h3 id=&#34;7-mcp-agenté—´æ²Ÿé€šçš„æ ‡å‡†è¯­&#34;&gt;7. MCPï¼šAgenté—´æ²Ÿé€šçš„æ ‡å‡†è¯­&lt;/h3&gt;

&lt;p&gt;éšç€å¤šAgentæ¶æ„çš„å…´èµ·ï¼ŒAgentä¹‹é—´å¦‚ä½•å‘ç°å½¼æ­¤ã€å¦‚ä½•è°ƒç”¨å½¼æ­¤çš„èƒ½åŠ›å°±æˆäº†ä¸€ä¸ªé—®é¢˜ã€‚è¿™æ—¶ï¼Œ&lt;strong&gt;MCPï¼ˆModel Context Protocolï¼‰&lt;/strong&gt;è¿™ä¸ªæ¦‚å¿µåº”è¿è€Œç”Ÿã€‚&lt;/p&gt;

&lt;p&gt;ä½ å¯ä»¥æŠŠMCPç†è§£ä¸ºä¸€å¥—&lt;strong&gt;ä¸ºAgentï¼ˆæˆ–è€…è¯´LLMçš„å·¥å…·ï¼‰è®¾è®¡çš„æ ‡å‡†åŒ–æ¥å£è§„èŒƒ&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æ²¡æœ‰MCPä¹‹å‰ï¼Œæˆ‘ä»¬å®ç°çš„å·¥å…·å¯èƒ½äº”èŠ±å…«é—¨ï¼šä¸€æ®µæœ¬åœ°Pythonä»£ç ã€ä¸€ä¸ªå†…éƒ¨HTTP APIè°ƒç”¨ã€ä¸€ä¸ªç¬¬ä¸‰æ–¹äº‘æœåŠ¡æ¥å£ç­‰ç­‰ã€‚æ¯æ¬¡è¦ç»™Agentæ·»åŠ æ–°å·¥å…·ï¼Œéƒ½éœ€è¦æ‰‹åŠ¨ç¼–å†™å…³äºè¿™ä¸ªå·¥å…·çš„æè¿°ï¼ˆåŠŸèƒ½ã€å‚æ•°ã€æ ¼å¼ï¼‰ï¼Œç„¶åæ³¨å…¥åˆ°Agentçš„ä¸Šä¸‹æ–‡ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰äº†MCPä¹‹åï¼Œæƒ…å†µå°±å¯èƒ½å˜å¾—æ›´è§„èŒƒï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å·¥å…·æä¾›æ–¹å¯ä»¥å°†å…¶èƒ½åŠ›å°è£…æˆä¸€ä¸ªéµå¾ªMCPåè®®çš„&lt;strong&gt;MCP Server&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Agentå¯ä»¥é€šè¿‡æ ‡å‡†çš„MCPæ–¹æ³•ï¼ˆæ¯”å¦‚&lt;code&gt;list_tools&lt;/code&gt;ï¼‰æ¥&lt;strong&gt;åŠ¨æ€å‘ç°&lt;/strong&gt;æŸä¸ªMCP Serveræä¾›äº†å“ªäº›å·¥å…·åŠå…¶æè¿°ã€‚&lt;/li&gt;
&lt;li&gt;Agentå¯ä»¥é€šè¿‡æ ‡å‡†çš„MCP &lt;strong&gt;RPC Call&lt;/strong&gt;æ¥æ‰§è¡Œè¿™äº›å·¥å…·ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;MCPä¸ä»…ä»…è§„èŒƒäº†å·¥å…·çš„è°ƒç”¨ï¼Œå®ƒé€šå¸¸ä¹Ÿè¯•å›¾è§„èŒƒ&lt;strong&gt;Promptæ¨¡æ¿ã€èµ„æºç®¡ç†&lt;/strong&gt;ç­‰Agentå¼€å‘ä¸­å¸¸è§çš„å…ƒç´ ã€‚å¦‚æœMCPèƒ½å¤Ÿè¢«å¹¿æ³›é‡‡ç”¨ï¼Œç†è®ºä¸Šå¯ä»¥ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é™ä½Agentçš„å¼€å‘é—¨æ§›&lt;/strong&gt;ï¼šå¼€å‘è€…å¯ä»¥ç›´æ¥å¤ç”¨ç¤¾åŒºæä¾›çš„ã€éµå¾ªMCPæ ‡å‡†çš„å·¥å…·æœåŠ¡ï¼Œè€Œä¸éœ€è¦è‡ªå·±é‡å¤å®ç°å’Œæè¿°å·¥å…·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æé«˜Agentçš„äº’æ“ä½œæ€§&lt;/strong&gt;ï¼šä¸åŒå¼€å‘è€…ã€ä¸åŒå›¢é˜Ÿå¼€å‘çš„Agentæˆ–è®¸èƒ½æ›´å®¹æ˜“åœ°è¿›è¡Œåä½œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å½“ç„¶ï¼ŒMCPç›®å‰ä¼¼ä¹è¿˜åœ¨å‘å±•åˆæœŸï¼Œä½†å®ƒæŒ‡æ˜äº†ä¸€ä¸ªè®©Agentç”Ÿæ€æ›´åŠ è§„èŒƒåŒ–ã€æ ‡å‡†åŒ–çš„æ–¹å‘ã€‚&lt;/p&gt;

&lt;h3 id=&#34;8-æ€»ç»“-é—¨æ§›ä¸é«˜-ç²¾é€šä¸æ˜“&#34;&gt;8. æ€»ç»“ï¼šé—¨æ§›ä¸é«˜ï¼Œç²¾é€šä¸æ˜“&lt;/h3&gt;

&lt;p&gt;ä»¥ä¸Šå°±æ˜¯æˆ‘è¿™æ®µæ—¶é—´å­¦ä¹ ä¸‹æ¥ï¼Œå¯¹AI Agentå’ŒMCPçš„ä¸€äº›ç²—æµ…ç†è§£ã€‚åœ¨é˜…è¯»äº†å‡ ä¸ªå¼€æºçš„Manuså®ç°ï¼ˆæˆ–è€…ç±»ä¼¼çš„å¤šAgentæ¡†æ¶ï¼‰ä¹‹åï¼Œæˆ‘çš„ä¸€ä¸ªç›´è§‚æ„Ÿå—æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;å¯¹äºæŒæ¡Pythonçš„ç¨‹åºå‘˜æ¥è¯´ï¼Œä¸Šæ‰‹å¼€å‘ä¸€ä¸ªåŸºç¡€çš„AI Agentï¼Œæˆ–è€…ç¼–å†™ä¸€ä¸ªç®€å•çš„Tool/MCP Serverï¼Œ&lt;strong&gt;æŠ€æœ¯é—¨æ§›ä¼¼ä¹å¹¶ä¸ç®—ç‰¹åˆ«é«˜&lt;/strong&gt;ã€‚å¾ˆå¤šæ¡†æ¶ï¼ˆå¦‚LangChainã€LlamaIndexç­‰ï¼‰å·²ç»å¸®æˆ‘ä»¬å¤„ç†äº†ä¸LLMäº¤äº’ã€ç®¡ç†ä¸Šä¸‹æ–‡ã€æ‰§è¡Œå·¥å…·ç­‰ç¹ççš„åº•å±‚å·¥ä½œã€‚&lt;/p&gt;

&lt;p&gt;ç„¶è€Œï¼Œ&lt;strong&gt;çœŸæ­£çš„æŒ‘æˆ˜åœ¨äº&lt;/strong&gt;ï¼šå¦‚ä½•åœ¨ä¸€ä¸ª&lt;strong&gt;ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯&lt;/strong&gt;ä¸‹ï¼Œè®¾è®¡å’Œå®ç°ä¸€ä¸ª&lt;strong&gt;ç¨³å®šã€å¯é ã€é«˜æ•ˆ&lt;/strong&gt;çš„AI Agentã€‚è¿™éœ€è¦ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ·±åˆ»ç†è§£ä¸šåŠ¡éœ€æ±‚&lt;/strong&gt;ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºé€‚åˆAgentæ‰§è¡Œçš„ä»»åŠ¡æµç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç²¾å¿ƒçš„Promptè®¾è®¡ä¸è°ƒä¼˜&lt;/strong&gt;ï¼Œä¸æ–­å°è¯•ï¼Œå¼•å¯¼LLMç»™å‡ºæœŸæœ›çš„è¾“å‡ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰æ•ˆçš„Tracingå’ŒDebugging&lt;/strong&gt;ï¼Œå¿«é€Ÿå®šä½Agentæ‰§è¡Œè¿‡ç¨‹ä¸­çš„é—®é¢˜å¹¶è¿›è¡Œä¿®å¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆç†çš„æ¶æ„é€‰æ‹©&lt;/strong&gt;ï¼ˆå•Agent vs å¤šAgentï¼ŒReAct vs CodeActï¼‰å’Œ&lt;strong&gt;æˆæœ¬æ§åˆ¶&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å°±åƒå½“å¹´æˆ‘ä»¬ä»å†™ç®€å•è„šæœ¬åˆ°æ„å»ºå¤æ‚ç³»ç»Ÿä¸€æ ·ï¼ŒAI Agentçš„ä¸–ç•Œä¹Ÿæ˜¯æ˜“å­¦éš¾ç²¾ã€‚å·¥å…·å’Œæ¡†æ¶é™ä½äº†å…¥é—¨é—¨æ§›ï¼Œä½†è¦åšå‡ºçœŸæ­£å¥½ç”¨çš„Agentï¼Œè¿˜éœ€è¦å¤§é‡çš„å®è·µã€æ€è€ƒå’Œæ‰“ç£¨ã€‚&lt;/p&gt;

&lt;h3 id=&#34;9-å‚è€ƒ&#34;&gt;9. å‚è€ƒ&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://arthurchiao.art/blog/ai-agent-white-paper-zh/&#34;&gt;Google AI Agentï¼ˆæ™ºèƒ½ä½“ï¼‰æŠ€æœ¯ç™½çš®ä¹¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://arthurchiao.art/blog/build-effective-ai-agent-zh/&#34;&gt;Anthropic AI Workflow &amp;amp; AI Agentï¼šæ¶æ„ã€æ¨¡å¼ä¸å·¥ç¨‹å»ºè®®&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://huggingface.co/learn/agents-course/zh-CN/unit0/introduction&#34;&gt;Hugging Face AI Agents è¯¾ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/liaokongVFX/MCP-Chinese-Getting-Started-Guide&#34;&gt;Model Context Protocol(MCP) ç¼–ç¨‹æé€Ÿå…¥é—¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/liaokongVFX/LangChain-Chinese-Getting-Started-Guide&#34;&gt;LangChain ä¸­æ–‡å…¥é—¨æ•™ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mannaandpoem/OpenManus&#34;&gt;OpenManus&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/Darwin-lfl/langmanus&#34;&gt;LangManus&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>äº‘åŸç”Ÿå¼€å‘å…¥é—¨</title>
      <link>https://zhu327.github.io/2025/03/28/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/</link>
      <pubDate>Fri, 28 Mar 2025 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/03/28/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/</guid>
      <description>&lt;p&gt;ä½œä¸ºä¸€ååœ¨äº‘åŸç”Ÿé¢†åŸŸæ‘¸çˆ¬æ»šæ‰“äº†ä¸€æ®µæ—¶é—´çš„å¼€å‘è€…ï¼Œæˆ‘æ—¶å¸¸ä¼šé‡åˆ°ä¸€äº›åˆšæ¥è§¦è¿™ä¸ªé¢†åŸŸçš„æœ‹å‹ï¼Œä»–ä»¬é¢å¯¹ Kubernetes (K8s)ã€å®¹å™¨è¿™äº›æ¦‚å¿µæ—¶ï¼Œå¸¸å¸¸æ„Ÿåˆ°æœ‰äº›è¿·èŒ«ï¼Œä¸çŸ¥é“ä»ä½•å­¦èµ·ã€‚è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘æƒ³ç»“åˆè‡ªå·±çš„ä¸€äº›å­¦ä¹ ä½“ä¼šï¼Œä¸ºæƒ³è¦å…¥é—¨äº‘åŸç”Ÿå¼€å‘çš„åŒå­¦æä¾›ä¸€ä¸ªç›¸å¯¹æ¸…æ™°çš„æŒ‡å¼•ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘è‡ªå·±å¹¶éç§‘ç­å‡ºèº«ï¼Œä»æœ€åˆæ¥è§¦è½¯ä»¶æµ‹è¯•å†™ Lua è„šæœ¬ï¼Œåˆ°åæ¥å­¦ä¹  Python åšåç«¯ï¼Œå†åˆ°è¿›å…¥è…¾è®¯æ¥è§¦ Golang å’Œ K8s ç›¸å…³å¼€å‘ï¼Œä¸€è·¯èµ°æ¥ä¹Ÿè¸©äº†ä¸å°‘å‘ã€‚äº‘åŸç”ŸæŠ€æœ¯æ ˆç¡®å®åºå¤§ï¼Œä½†æ ¸å¿ƒçš„ç†å¿µæ˜¯åˆ©ç”¨å®¹å™¨ã€å¾®æœåŠ¡ã€å£°æ˜å¼ API ç­‰æ–¹å¼ï¼Œå»æ„å»ºæ›´å¯é ã€æ›´å…·å¼¹æ€§çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚è€Œ K8s ä½œä¸ºè¿™ä¸ªç”Ÿæ€çš„æ ¸å¿ƒç¼–æ’å¼•æ“ï¼Œå¯ä»¥è¯´æ˜¯æˆ‘ä»¬å¿…é¡»æŒæ¡çš„å…³é”®æŠ€èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¼šä»åŸºç¡€æ¦‚å¿µèŠèµ·ï¼Œåˆ†äº«å‡ æœ¬æˆ‘å­¦ä¹ è¿‡ç¨‹ä¸­è§‰å¾—éå¸¸æœ‰å¸®åŠ©çš„ä¹¦ç±ï¼Œä¸€ä¸ªä¸é”™çš„ç¤¾åŒºæ–‡ç« é›†åˆï¼Œä»¥åŠä¸¤ä¸ªå¯ä»¥åŠ¨æ‰‹å®è·µçš„ä»£ç é¡¹ç›®ã€‚æœ€åï¼Œè¿˜ä¼šç»“åˆå®é™…å·¥ä½œç»éªŒï¼ŒèŠèŠ K8s è¿ç»´å®è·µä¸­ä¸€äº›é‡è¦çš„äº‹æƒ…ã€‚å¸Œæœ›è¿™äº›èƒ½å¸®åŠ©å¤§å®¶åœ¨å­¦ä¹ äº‘åŸç”Ÿçš„è·¯ä¸Šå°‘èµ°ä¸€äº›å¼¯è·¯ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;ä¸€-äº‘åŸç”Ÿä¸-kubernetes-ä»åŸºç¡€æ¦‚å¿µå¼€å§‹&#34;&gt;ä¸€ã€äº‘åŸç”Ÿä¸ Kubernetesï¼šä»åŸºç¡€æ¦‚å¿µå¼€å§‹&lt;/h2&gt;

&lt;h3 id=&#34;äº‘åŸç”Ÿåˆ°åº•æ˜¯ä»€ä¹ˆ&#34;&gt;äº‘åŸç”Ÿåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;

&lt;p&gt;æˆ‘ç†è§£çš„äº‘åŸç”Ÿï¼ˆCloud Nativeï¼‰ï¼Œå®ƒä¸æ˜¯æŒ‡æŸä¸€ä¸ªå…·ä½“çš„æŠ€æœ¯ï¼Œæ›´åƒæ˜¯ä¸€ç§é¢å‘äº‘ç¯å¢ƒçš„åº”ç”¨è®¾è®¡ã€å¼€å‘å’Œéƒ¨ç½²çš„æœ€ä½³å®è·µé›†åˆã€‚å®ƒé¼“åŠ±æˆ‘ä»¬ä½¿ç”¨åƒå®¹å™¨ã€å¾®æœåŠ¡ã€ä¸å¯å˜åŸºç¡€è®¾æ–½ã€å£°æ˜å¼ API è¿™äº›æŠ€æœ¯å’Œæ–¹æ³•ï¼Œç›®æ ‡æ˜¯è®©æˆ‘ä»¬çš„åº”ç”¨èƒ½æ›´å¥½åœ°åˆ©ç”¨äº‘è®¡ç®—çš„å¼¹æ€§ã€åˆ†å¸ƒå¼ã€è‡ªåŠ¨åŒ–ç­‰ä¼˜åŠ¿ã€‚æ ¹æ® CNCFï¼ˆäº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šï¼‰çš„å®šä¹‰ï¼Œè¿™äº›æ˜¯å…³é”®è¦ç´ ã€‚ç®€å•è¯´ï¼Œå°±æ˜¯è®©åº”ç”¨ä¸ºäº‘è€Œç”Ÿï¼Œèƒ½åœ¨äº‘ä¸Šè¿è¡Œå¾—æ›´å¥½ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä¸ºä»€ä¹ˆ-kubernetes-è¿™ä¹ˆé‡è¦&#34;&gt;ä¸ºä»€ä¹ˆ Kubernetes è¿™ä¹ˆé‡è¦ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;å®¹å™¨æŠ€æœ¯ï¼ˆæ¯”å¦‚ Dockerï¼‰è§£å†³äº†ç¯å¢ƒä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä½†å½“ä½ æœ‰æˆç™¾ä¸Šåƒä¸ªå®¹å™¨éœ€è¦ç®¡ç†æ—¶ï¼Œæ‰‹åŠ¨æ“ä½œå°±å˜å¾—ä¸ç°å®äº†ã€‚Kubernetes å°±æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚å®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨ç¼–æ’å¹³å°ï¼Œæœ€åˆç”± Google å¼€å‘ï¼Œç°åœ¨ç”± CNCF ç»´æŠ¤ã€‚å®ƒå¯ä»¥è‡ªåŠ¨åŒ–åœ°å®Œæˆåº”ç”¨çš„éƒ¨ç½²ã€æ‰©ç¼©å®¹ã€æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€æ•…éšœæ¢å¤ç­‰ä¸€ç³»åˆ—å¤æ‚å·¥ä½œã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒæŒæ¡ K8s æ˜¯è¿›å…¥ç°ä»£åç«¯å¼€å‘ã€ç‰¹åˆ«æ˜¯å¹³å°å·¥ç¨‹é¢†åŸŸçš„ä¸€å¼ é‡è¦é—¨ç¥¨ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æˆ‘çš„å­¦ä¹ è·¯å¾„å»ºè®®&#34;&gt;æˆ‘çš„å­¦ä¹ è·¯å¾„å»ºè®®ï¼š&lt;/h3&gt;

&lt;p&gt;å›é¡¾æˆ‘è‡ªå·±çš„å­¦ä¹ è¿‡ç¨‹ï¼Œæˆ‘å»ºè®®å¯ä»¥æŒ‰ä»¥ä¸‹æ­¥éª¤æ¥ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…ˆææ‡‚å®¹å™¨&lt;/strong&gt;ï¼šç†è§£ Docker çš„åŸºæœ¬æ¦‚å¿µï¼Œæ¯”å¦‚é•œåƒï¼ˆImageï¼‰ã€å®¹å™¨ï¼ˆContainerï¼‰ã€Dockerfileï¼Œèƒ½è‡ªå·±åŠ¨æ‰‹æ„å»ºã€è¿è¡Œä¸€ä¸ªç®€å•çš„å®¹å™¨åŒ–åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†æ·±å…¥ K8s æ ¸å¿ƒ&lt;/strong&gt;ï¼šå­¦ä¹  K8s çš„æ ¸å¿ƒç»„ä»¶ï¼ˆæ¯”å¦‚ Podã€Serviceã€Deploymentã€StatefulSetã€Namespace ç­‰ï¼‰éƒ½æ˜¯åšä»€ä¹ˆçš„ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯å¦‚ä½•åä½œçš„ã€‚äº†è§£æ§åˆ¶å¹³é¢ï¼ˆMasterï¼‰å’Œæ•°æ®å¹³é¢ï¼ˆNodeï¼‰çš„åŸºæœ¬å·¥ä½œåŸç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ‰‹å®è·µæ˜¯å…³é”®&lt;/strong&gt;ï¼šç†è®ºå­¦ä¹ åï¼Œä¸€å®šè¦åŠ¨æ‰‹å®è·µã€‚å°è¯•ç¼–å†™ YAML æ–‡ä»¶éƒ¨ç½²åº”ç”¨ï¼Œä½¿ç”¨ &lt;code&gt;kubectl&lt;/code&gt; ä¸é›†ç¾¤äº¤äº’ã€‚ç„¶åå¯ä»¥å»æ¢ç´¢å­˜å‚¨ï¼ˆVolumes, PV, PVCï¼‰ã€ç½‘ç»œï¼ˆIngress, CNIï¼‰ã€é…ç½®ï¼ˆConfigMap, Secretï¼‰ç­‰æ›´æ·±å…¥çš„ä¸»é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç†è§£è¿ç»´è§†è§’&lt;/strong&gt;ï¼šå¼€å‘çš„åº”ç”¨æœ€ç»ˆè¦è·‘åœ¨ç”Ÿäº§ç¯å¢ƒã€‚äº†è§£ K8s é›†ç¾¤çš„ç›‘æ§ã€æ—¥å¿—ã€å‘Šè­¦ã€æ’é”™ç­‰è¿ç»´å®è·µï¼Œå¯¹äºå†™å‡ºæ›´å¥å£®ã€æ›´æ˜“äºç»´æŠ¤çš„åº”ç”¨éå¸¸æœ‰å¸®åŠ©ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ¥ä¸‹æ¥ï¼Œåˆ†äº«ä¸€äº›æˆ‘åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ç”¨è¿‡ä¸”è§‰å¾—ä¸é”™çš„èµ„æºã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;äºŒ-æ¨èä¹¦ç±-ç†è®ºä¸å®è·µç»“åˆ&#34;&gt;äºŒã€æ¨èä¹¦ç±ï¼šç†è®ºä¸å®è·µç»“åˆ&lt;/h2&gt;

&lt;p&gt;å¸‚é¢ä¸Šå…³äº K8s çš„ä¹¦ä¸å°‘ï¼Œä½†ä¸‹é¢è¿™ä¸¤æœ¬æ˜¯æˆ‘ä¸ªäººè§‰å¾—éå¸¸ç»å…¸ï¼Œå€¼å¾—èŠ±æ—¶é—´å»è¯»çš„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-kubernetes-in-action&#34;&gt;1. ã€ŠKubernetes in Actionã€‹&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è±†ç“£è¯„åˆ†å‚è€ƒ&lt;/strong&gt;ï¼š8.8 åˆ†&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æˆ‘çš„æ¨èç†ç”±&lt;/strong&gt;ï¼š
è¿™æœ¬ä¹¦éå¸¸ä¾§é‡å®è·µã€‚ä½œè€… Marko LukÅ¡a é€šè¿‡å¤§é‡å¯æ“ä½œçš„ä¾‹å­ï¼Œä¸€æ­¥æ­¥å¸¦ä½ ä¸Šæ‰‹ K8sã€‚ä»æœ€åŸºç¡€çš„ Podã€Service åˆ° Deployment å®ç°æ»šåŠ¨æ›´æ–°ï¼Œéƒ½è®²å¾—å¾ˆæ¸…æ¥šã€‚å¯¹äºåˆšå…¥é—¨ K8sï¼Œå¸Œæœ›å¿«é€Ÿçœ‹åˆ°æ•ˆæœã€å»ºç«‹ä¿¡å¿ƒçš„åŒå­¦æ¥è¯´ï¼Œè¿™æœ¬ä¹¦æ˜¯æå¥½çš„é€‰æ‹©ã€‚æˆ‘å½“åˆå°±æ˜¯è·Ÿç€è¿™æœ¬ä¹¦æ•²ä»£ç ï¼Œå¯¹ K8s çš„åŸºæœ¬æ“ä½œæœ‰äº†ç›´è§‚çš„è®¤è¯†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ä»¥é‡ç‚¹å…³æ³¨çš„ç« èŠ‚&lt;/strong&gt;ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 2 ç« &lt;/strong&gt;ï¼šç”¨ä¸€ä¸ª Node.js ä¾‹å­å¸¦ä½ è·‘é€šç¬¬ä¸€ä¸ª K8s åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 5 ç« &lt;/strong&gt;ï¼šè®²è§£ Serviceï¼Œç†è§£åº”ç”¨å¦‚ä½•è¢«è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 9 ç« &lt;/strong&gt;ï¼šè®²è§£ Deploymentï¼ŒæŒæ¡åº”ç”¨å‘å¸ƒçš„æ ¸å¿ƒæ–¹å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚åˆè°&lt;/strong&gt;ï¼šK8s æ–°æ‰‹ï¼Œç‰¹åˆ«æ˜¯å–œæ¬¢é€šè¿‡åŠ¨æ‰‹å®è·µæ¥å­¦ä¹ çš„å¼€å‘è€…ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;2-æ·±å…¥å‰–æ-kubernetes&#34;&gt;2. ã€Šæ·±å…¥å‰–æ Kubernetesã€‹&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è±†ç“£è¯„åˆ†å‚è€ƒ&lt;/strong&gt;ï¼š9.3 åˆ†&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æˆ‘çš„æ¨èç†ç”±&lt;/strong&gt;ï¼š
å¼ ç£Šå¤§ä½¬å†™çš„è¿™æœ¬ä¹¦ï¼Œæ›´ä¾§é‡äº K8s çš„è®¾è®¡ç†å¿µå’Œåº•å±‚å®ç°åŸç†ã€‚å¦‚æœä½ ä¸æ»¡è¶³äºä»…ä»…ä¼šç”¨ K8sï¼Œè¿˜æƒ³çŸ¥é“å®ƒå†…éƒ¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼ˆæ¯”å¦‚è°ƒåº¦å™¨å¦‚ä½•å†³ç­–ï¼Ÿç½‘ç»œ CNI å¦‚ä½•å®ç°ï¼Ÿï¼‰ï¼Œé‚£è¿™æœ¬ä¹¦ç»å¯¹å€¼å¾—ä¸€è¯»ã€‚å¯¹æˆ‘è‡ªå·±è€Œè¨€ï¼Œé˜…è¯»è¿™æœ¬ä¹¦åŠ æ·±äº†æˆ‘å¯¹ K8s æ¶æ„çš„ç†è§£ï¼Œå¯¹äºåæ¥åšä¸€äº› K8s ç›¸å…³çš„å¼€å‘å·¥ä½œéå¸¸æœ‰å¸®åŠ©ã€‚å®ƒä¸ä»…ä»…æ˜¯è®²æŠ€æœ¯ï¼Œè¿˜èå…¥äº†ä½œè€…åœ¨ä¸€çº¿çš„å®è·µæ€è€ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ä»¥é‡ç‚¹å…³æ³¨çš„ç« èŠ‚&lt;/strong&gt;ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 3 ç« &lt;/strong&gt;ï¼šK8s æ•´ä½“æ¶æ„å’Œè®¾è®¡å“²å­¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 5 ç« &lt;/strong&gt;ï¼šæ§åˆ¶å™¨ï¼ˆControllerï¼‰å’Œç¼–æ’åŸç†ï¼Œè¿™æ˜¯ K8s è‡ªåŠ¨åŒ–çš„æ ¸å¿ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 7 ç« &lt;/strong&gt;ï¼šç½‘ç»œåŸç†ï¼ŒCNIã€Service ç­‰æœºåˆ¶è®²å¾—å¾ˆé€å½»ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚åˆè°&lt;/strong&gt;ï¼šå¯¹ K8s æœ‰ä¸€å®šåŸºç¡€ï¼Œæƒ³æ·±å…¥ç†è§£å…¶å·¥ä½œåŸç†å’Œè®¾è®¡æ€æƒ³çš„å¼€å‘è€…ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;æ€ä¹ˆé€‰ï¼Ÿ&lt;/strong&gt; æˆ‘çš„å»ºè®®æ˜¯ï¼Œå¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œå¯ä»¥å…ˆçœ‹ã€ŠKubernetes in Actionã€‹åŠ¨æ‰‹å®è·µï¼Œå»ºç«‹åŸºæœ¬æ¦‚å¿µï¼›ç„¶åå†è¯»ã€Šæ·±å…¥å‰–æ Kubernetesã€‹åŠ æ·±ç†è§£ã€‚å¦‚æœä½ å·²ç»æœ‰åŸºç¡€ï¼Œå¯ä»¥ç›´æ¥çœ‹ã€Šæ·±å…¥å‰–æ Kubernetesã€‹ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;ä¸‰-ç¤¾åŒºæ–‡ç« åˆé›†-k8s-club&#34;&gt;ä¸‰ã€ç¤¾åŒºæ–‡ç« åˆé›†ï¼šK8s Club&lt;/h2&gt;

&lt;p&gt;é™¤äº†ä¹¦ç±ï¼Œç¤¾åŒºé‡Œä¹Ÿæœ‰å¾ˆå¤šé«˜è´¨é‡çš„æ–‡ç« ã€‚æˆ‘ä¸ªäººæ¯”è¾ƒå…³æ³¨ &lt;a href=&#34;https://github.com/k8s-club/k8s-club&#34;&gt;K8s Club&lt;/a&gt; è¿™ä¸ª GitHub ä»“åº“ã€‚&lt;/p&gt;

&lt;p&gt;å®ƒæ±‡é›†äº†ä¸å°‘å›½å†…äº‘åŸç”Ÿå¼€å‘è€…æ’°å†™çš„æŠ€æœ¯æ–‡ç« ï¼Œå†…å®¹è¦†ç›–ä»åŸºç¡€åˆ°è¿›é˜¶ï¼Œä¹Ÿæœ‰æºç åˆ†æå’Œå®è·µç»éªŒåˆ†äº«ï¼Œè´¨é‡æ™®éä¸é”™ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å€¼å¾—å…³æ³¨çš„å†…å®¹&#34;&gt;å€¼å¾—å…³æ³¨çš„å†…å®¹ï¼š&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¦‚å¿µæ¢³ç†ä¸å…¥é—¨&lt;/strong&gt;ï¼šæ¯”å¦‚ç”¨é—®ç­”å½¢å¼æ€»ç»“ K8s æ ¸å¿ƒæ¦‚å¿µçš„æ–‡ç« ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŸ¥è¯†å›¾è°±&lt;/strong&gt;ï¼šå¸®åŠ©ä½ äº†è§£ K8s çš„æ•´ä½“çŸ¥è¯†ä½“ç³»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç»„ä»¶åŸç†åˆ†æ&lt;/strong&gt;ï¼šæ¯”å¦‚ Informer æœºåˆ¶ã€è°ƒåº¦å™¨åŸç†ç­‰ï¼Œå¯¹æ·±å…¥ç†è§£ K8s æˆ–åšäºŒæ¬¡å¼€å‘å¾ˆæœ‰å¸®åŠ©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®è·µæ“ä½œæŒ‡å—&lt;/strong&gt;ï¼šæ¯”å¦‚æ‰‹åŠ¨æ­å»ºé›†ç¾¤ã€Pod ç”Ÿå‘½å‘¨æœŸç®¡ç†ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;å¦‚ä½•åˆ©ç”¨ï¼Ÿ&lt;/strong&gt; é‡åˆ°å…·ä½“é—®é¢˜æ—¶å¯ä»¥å»æœç´¢ç›¸å…³çš„æ–‡ç« ï¼›ä¹Ÿå¯ä»¥ç³»ç»Ÿæ€§åœ°é˜…è¯»æŸä¸ªç³»åˆ—ï¼›æœ€é‡è¦çš„æ˜¯ï¼Œçœ‹å®Œä¹‹åå°½é‡åŠ¨æ‰‹åœ¨è‡ªå·±çš„ç¯å¢ƒï¼ˆæ¯”å¦‚ Minikubeï¼‰ä¸­éªŒè¯ä¸€ä¸‹ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;å››-ä»£ç ç¤ºä¾‹é¡¹ç›®-åŠ¨æ‰‹å®è·µå‡ºçœŸçŸ¥&#34;&gt;å››ã€ä»£ç ç¤ºä¾‹é¡¹ç›®ï¼šåŠ¨æ‰‹å®è·µå‡ºçœŸçŸ¥&lt;/h2&gt;

&lt;p&gt;ç†è®ºå­¦ä¹ æœ€ç»ˆè¿˜æ˜¯è¦è½åˆ°å®è·µä¸Šã€‚å°±åƒæˆ‘å­¦ä¹  Rust ä¼šè‡ªå·±åŠ¨æ‰‹å†™é¡¹ç›®ä¸€æ ·ï¼Œå­¦ä¹  K8s ä¹Ÿéœ€è¦é€šè¿‡ä»£ç æ¥åŠ æ·±ç†è§£ã€‚ä¸‹é¢æ˜¯æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ª GitHub ä¸Šçš„é¡¹ç›®é›†åˆï¼Œæä¾›äº†ä¸é”™çš„ç»ƒæ‰‹æœºä¼šï¼š&lt;/p&gt;

&lt;h3 id=&#34;1-kubernetes-learning-playground&#34;&gt;1. Kubernetes Learning Playground&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœ°å€&lt;/strong&gt;ï¼š&lt;a href=&#34;https://github.com/Kubernetes-Learning-Playground&#34;&gt;https://github.com/Kubernetes-Learning-Playground&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€ä»‹&lt;/strong&gt;ï¼šè¿™ä¸ªç»„ç»‡ä¸‹æœ‰ä¸å°‘å…³äº K8s æ‰©å±•å¼€å‘çš„é¡¹ç›®ç¤ºä¾‹ï¼Œæ¯”å¦‚å¦‚ä½•ä¸ K8s API äº¤äº’ï¼ˆclient-goï¼‰ã€ç®€å•çš„ CSI/CNI æ’ä»¶å®ç°ã€è‡ªå®šä¹‰è°ƒåº¦å™¨ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ä»¥çœ‹çœ‹çš„é¡¹ç›®&lt;/strong&gt;ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;multi-cluster-informer&lt;/code&gt;ï¼šå­¦ä¹ å¦‚ä½•ç›‘æ§å¤šä¸ª K8s é›†ç¾¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;csi-interface-study&lt;/code&gt;ï¼šä¸€ä¸ªç®€å•çš„ CSI å­˜å‚¨æ’ä»¶ç¤ºä¾‹ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚åˆ&lt;/strong&gt;ï¼šå¯¹ K8s å†…éƒ¨æœºåˆ¶ã€API ç¼–ç¨‹ã€æ’ä»¶å¼€å‘æ„Ÿå…´è¶£çš„åŒå­¦ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;2-operator-learning-playground&#34;&gt;2. Operator Learning Playground&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœ°å€&lt;/strong&gt;ï¼š&lt;a href=&#34;https://github.com/Operator-Learning-Playground&#34;&gt;https://github.com/Operator-Learning-Playground&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€ä»‹&lt;/strong&gt;ï¼šä¸“æ³¨äº K8s Operator å¼€å‘æ¨¡å¼çš„ç»ƒä¹ é¡¹ç›®ã€‚Operator æ˜¯ç”¨æ¥ç®¡ç†æœ‰çŠ¶æ€åº”ç”¨æˆ–è‡ªåŠ¨åŒ–å¤æ‚è¿ç»´ä»»åŠ¡çš„é‡è¦æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ä»¥çœ‹çœ‹çš„é¡¹ç›®&lt;/strong&gt;ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;proxy-operator&lt;/code&gt;ï¼šä¸€ä¸ªç®€å•çš„ Operator ä¾‹å­ï¼Œæ„Ÿå—ä¸‹åŸºæœ¬ç»“æ„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;podReStarter-operator&lt;/code&gt;ï¼šå®ç°ç‰¹å®šæ¡ä»¶ä¸‹è‡ªåŠ¨é‡å¯ Pod çš„æ§åˆ¶å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚åˆ&lt;/strong&gt;ï¼šæƒ³å­¦ä¹ å¦‚ä½•ä½¿ç”¨ CRD (è‡ªå®šä¹‰èµ„æº) å’Œ Controller æ¥æ‰©å±• K8s åŠŸèƒ½çš„åŒå­¦ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;ï¼š
*   åœ¨æœ¬åœ°ç”¨ Minikube æˆ– Kind æ­ä¸ª K8s ç¯å¢ƒï¼Œæ–¹ä¾¿å®éªŒã€‚
*   ä»ç®€å•çš„é¡¹ç›®å¼€å§‹ï¼Œå…ˆè·‘èµ·æ¥ï¼Œå†å°è¯•ç†è§£ä»£ç ï¼Œç„¶åå¯ä»¥è¯•ç€ä¿®æ”¹æˆ–æ‰©å±•å®ƒã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;äº”-å­¦ä¹ è·¯çº¿ä¸ä¸ªäººå¿ƒå¾—&#34;&gt;äº”ã€å­¦ä¹ è·¯çº¿ä¸ä¸ªäººå¿ƒå¾—&lt;/h2&gt;

&lt;p&gt;ç»“åˆä¸Šé¢çš„èµ„æºï¼Œæˆ‘æ¢³ç†äº†ä¸€ä¸ªå­¦ä¹  K8s çš„å¤§è‡´è·¯çº¿ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€å…¥é—¨&lt;/strong&gt;ï¼šé€šè¿‡ã€ŠKubernetes in Actionã€‹å’ŒåŠ¨æ‰‹å®éªŒï¼ŒæŒæ¡ Docker å’Œ K8s çš„åŸºæœ¬æ¦‚å¿µä¸æ“ä½œã€‚èƒ½éƒ¨ç½²ç®€å•åº”ç”¨ï¼Œä¼šç”¨ &lt;code&gt;kubectl&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ·±å…¥åŸç†&lt;/strong&gt;ï¼šé˜…è¯»ã€Šæ·±å…¥å‰–æ Kubernetesã€‹ï¼Œç†è§£ K8s çš„æ ¸å¿ƒæ¶æ„å’Œå·¥ä½œæœºåˆ¶ã€‚ç»“åˆ K8s Club çš„æ–‡ç« ï¼Œé’ˆå¯¹æ€§å­¦ä¹ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®è·µè¿›é˜¶&lt;/strong&gt;ï¼šç ”ç©¶ä¸Šé¢æåˆ°çš„ä»£ç ç¤ºä¾‹é¡¹ç›®ï¼Œå°è¯•ç†è§£å¹¶åŠ¨æ‰‹ä¿®æ”¹ã€‚å¼€å§‹å…³æ³¨ K8s ç”Ÿæ€ä¸­çš„å…¶ä»–å·¥å…·ï¼Œå¦‚ Helmã€Prometheus ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒç»­å­¦ä¹ &lt;/strong&gt;ï¼šäº‘åŸç”ŸæŠ€æœ¯å‘å±•å¾ˆå¿«ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€å¾ˆé‡è¦ã€‚å¤šçœ‹å®˜æ–¹æ–‡æ¡£ï¼Œå…³æ³¨ç¤¾åŒºåŠ¨æ€ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;æˆ‘è‡ªå·±çš„ä¸€äº›ä½“ä¼šï¼š&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ‰‹éå¸¸é‡è¦&lt;/strong&gt;ï¼šçœ‹å†å¤šæ–‡æ¡£ä¸å¦‚è‡ªå·±åŠ¨æ‰‹æ•²ä¸€éã€‚é‡åˆ°é—®é¢˜ã€è§£å†³é—®é¢˜çš„è¿‡ç¨‹æ˜¯æœ€å¥½çš„å­¦ä¹ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éç§‘ç­ä¸ç”¨æ€•&lt;/strong&gt;ï¼šåƒæˆ‘ä¸€æ ·éç§‘ç­å‡ºèº«çš„åŒå­¦ï¼Œå¯èƒ½åŸºç¡€ä¼šè–„å¼±ä¸€äº›ï¼Œé‚£å°±å¤šèŠ±ç‚¹æ—¶é—´å»è¡¥åŸºç¡€ï¼ˆæ¯”å¦‚ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹è¿™æ ·çš„ä¹¦ï¼‰ã€‚å…³é”®æ˜¯æŒç»­å­¦ä¹ å’Œå®è·µã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ©ç”¨å¥½ GitHub&lt;/strong&gt;ï¼šæ— è®ºæ˜¯å­¦ä¹ åˆ«äººçš„é¡¹ç›®ï¼Œè¿˜æ˜¯åƒæˆ‘ä¸€æ ·æŠŠè‡ªå·±å†™çš„ä¸œè¥¿æ”¾ä¸Šå»ï¼ŒGitHub éƒ½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¹³å°ã€‚å®ƒä¸ä»…èƒ½è®°å½•ä½ çš„æˆé•¿ï¼Œæœ‰æ—¶è¿˜èƒ½å¸¦æ¥æ„æƒ³ä¸åˆ°çš„æœºä¼šã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;å…­-k8s-è¿ç»´å®è·µ-å¼€å‘è€…ä¹Ÿéœ€å…³æ³¨&#34;&gt;å…­ã€K8s è¿ç»´å®è·µï¼šå¼€å‘è€…ä¹Ÿéœ€å…³æ³¨&lt;/h2&gt;

&lt;p&gt;å¼€å‘å®Œåº”ç”¨éƒ¨ç½²åˆ° K8s åªæ˜¯ç¬¬ä¸€æ­¥ï¼Œå¦‚ä½•ä¿éšœå®ƒåœ¨ç”Ÿäº§ç¯å¢ƒç¨³å®šè¿è¡Œï¼Œæ˜¯åŒæ ·é‡è¦çš„äº‹æƒ…ã€‚è™½ç„¶å¯èƒ½æœ‰ä¸“é—¨çš„è¿ç»´å›¢é˜Ÿï¼Œä½†ä½œä¸ºå¼€å‘è€…ï¼Œäº†è§£ä¸€äº›åŸºæœ¬çš„è¿ç»´å®è·µï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´ç¬¦åˆç”Ÿäº§è¦æ±‚çš„åº”ç”¨ï¼Œä¹Ÿèƒ½åœ¨æ’æŸ¥é—®é¢˜æ—¶æ›´æœ‰æ€è·¯ã€‚&lt;/p&gt;

&lt;p&gt;è¿™éƒ¨åˆ†æˆ‘å‚è€ƒäº†è…¾è®¯äº‘ K8s è¿ç»´å¼€å‘å·¥ç¨‹å¸ˆæ•´ç†çš„ã€Š&lt;a href=&#34;https://imroc.cc/kubernetes/best-practices&#34;&gt;Kubernetes å®è·µæŒ‡å—&lt;/a&gt;ã€‹ï¼ˆè¿™ä»½æŒ‡å—å†™å¾—æŒºå®ç”¨çš„ï¼‰ï¼Œç»“åˆè‡ªå·±çš„ä¸€äº›ç»éªŒï¼Œæç‚¼å‡ ç‚¹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç†Ÿç»ƒä½¿ç”¨ &lt;code&gt;kubectl&lt;/code&gt;&lt;/strong&gt;ï¼šè¿™æ˜¯ä¸ K8s äº¤äº’çš„åŸºç¡€ã€‚&lt;code&gt;get&lt;/code&gt;, &lt;code&gt;describe&lt;/code&gt;, &lt;code&gt;logs&lt;/code&gt;, &lt;code&gt;exec&lt;/code&gt; ç­‰å‘½ä»¤è¦å¸¸ç”¨å¸¸ç»ƒã€‚å­¦ä¼šçœ‹ &lt;code&gt;describe&lt;/code&gt; é‡Œçš„ Events ä¿¡æ¯ï¼Œå¯¹æ’é”™å¾ˆæœ‰å¸®åŠ©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•œåƒç®¡ç†&lt;/strong&gt;ï¼šæ³¨æ„ä½¿ç”¨å°çš„åŸºç¡€é•œåƒã€å¤šé˜¶æ®µæ„å»ºæ¥ä¼˜åŒ–é•œåƒä½“ç§¯ã€‚ç”Ÿäº§ç¯å¢ƒç”¨ç§æœ‰é•œåƒä»“åº“ï¼Œé…ç½®å¥½æ‹‰å–å¯†é’¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å‘Šè­¦æ˜¯æ ‡é…&lt;/strong&gt;ï¼šPrometheus + Grafana æ˜¯ç¤¾åŒºä¸»æµæ–¹æ¡ˆï¼Œéœ€è¦äº†è§£å¦‚ä½•æš´éœ²åº”ç”¨çš„ metricsï¼Œå¦‚ä½•é…ç½®åŸºæœ¬çš„å‘Šè­¦è§„åˆ™ã€‚æ—¥å¿—æ”¶é›†ï¼ˆå¦‚ EFK/ELKï¼‰ä¹Ÿè¦è€ƒè™‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºç®¡ç†ï¼ˆRequests &amp;amp; Limitsï¼‰&lt;/strong&gt;ï¼šä¸€å®šè¦ç»™ Pod è®¾ç½®åˆç†çš„ CPU å’Œå†…å­˜ &lt;code&gt;requests&lt;/code&gt;ï¼ˆç”¨äºè°ƒåº¦ï¼‰å’Œ &lt;code&gt;limits&lt;/code&gt;ï¼ˆç”¨äºé™åˆ¶ï¼‰ï¼Œé¿å…èµ„æºæŠ¢å å¯¼è‡´åº”ç”¨ä¸ç¨³å®šæˆ–å½±å“å…¶ä»–åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¥åº·æ£€æŸ¥ï¼ˆProbesï¼‰&lt;/strong&gt;ï¼šé…ç½®å¥½ Liveness Probeï¼ˆå­˜æ´»æ¢é’ˆï¼Œåˆ¤æ–­å®¹å™¨æ˜¯å¦éœ€è¦é‡å¯ï¼‰å’Œ Readiness Probeï¼ˆå°±ç»ªæ¢é’ˆï¼Œåˆ¤æ–­å®¹å™¨æ˜¯å¦å‡†å¤‡å¥½æ¥æ”¶æµé‡ï¼‰ï¼Œè®© K8s èƒ½å‡†ç¡®ç®¡ç†åº”ç”¨çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç†è§£ Namespace å’Œ RBAC&lt;/strong&gt;ï¼šNamespace ç”¨äºèµ„æºéš”ç¦»ï¼ŒRBAC ç”¨äºæƒé™æ§åˆ¶ï¼Œéƒ½æ˜¯ä¿éšœé›†ç¾¤å®‰å…¨å’Œç®¡ç†æœ‰åºæ€§çš„é‡è¦æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;è¿ç»´å­¦ä¹ å»ºè®®&lt;/strong&gt;ï¼šåŒæ ·éœ€è¦åŠ¨æ‰‹ï¼Œå¯ä»¥åœ¨æœ¬åœ°ç¯å¢ƒæ¨¡æ‹Ÿä¸€äº›åœºæ™¯ï¼Œæ¯”å¦‚æ‰‹åŠ¨åˆ é™¤ Pod çœ‹ K8s å¦‚ä½•æ¢å¤ï¼Œè°ƒæ•´èµ„æºé™åˆ¶çœ‹æ•ˆæœç­‰ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;ä¸ƒ-ç»“è¯­&#34;&gt;ä¸ƒã€ç»“è¯­&lt;/h2&gt;

&lt;p&gt;å›å¤´çœ‹ï¼Œäº‘åŸç”Ÿå¼€å‘è¿™æ¡è·¯ç¡®å®å†…å®¹ä¸å°‘ï¼Œä½†èµ°ä¸‹æ¥æ”¶è·ä¹Ÿå¾ˆå¤§ã€‚ä» K8s çš„åŸºç¡€æ“ä½œåˆ°æ·±å…¥ç†è§£å…¶åŸç†ï¼Œå†åˆ°å…³æ³¨è¿ç»´å®è·µï¼Œæ˜¯ä¸€ä¸ªé€æ­¥æ·±å…¥çš„è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;å¸Œæœ›æˆ‘åˆ†äº«çš„è¿™äº›å­¦ä¹ èµ„æºå’Œè·¯å¾„å»ºè®®ï¼Œèƒ½å¯¹æ­£åœ¨å…¥é—¨æˆ–æ‰“ç®—å…¥é—¨äº‘åŸç”Ÿå¼€å‘çš„ä½ æœ‰æ‰€å¸®åŠ©ã€‚æˆ‘è‡ªå·±ä¹Ÿæ˜¯åœ¨ä¸æ–­å­¦ä¹ ä¸­ï¼Œäº‘åŸç”ŸæŠ€æœ¯æ—¥æ–°æœˆå¼‚ï¼Œä¿æŒå¥½å¥‡å¿ƒå’ŒåŠ¨æ‰‹å®è·µçš„çƒ­æƒ…éå¸¸é‡è¦ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä½ åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­æœ‰ä»»ä½•é—®é¢˜æˆ–å¿ƒå¾—ï¼Œä¹Ÿæ¬¢è¿ä¸€èµ·äº¤æµã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ä»ã€Šè½¯ä»¶è®¾è®¡çš„å“²å­¦ã€‹è°ˆä»£ç çš„å¤æ‚æ€§ä¸åº”å¯¹</title>
      <link>https://zhu327.github.io/2025/01/10/%E4%BB%8E%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%93%B2%E5%AD%A6%E8%B0%88%E4%BB%A3%E7%A0%81%E7%9A%84%E5%A4%8D%E6%9D%82%E6%80%A7%E4%B8%8E%E5%BA%94%E5%AF%B9/</link>
      <pubDate>Fri, 10 Jan 2025 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/01/10/%E4%BB%8E%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%93%B2%E5%AD%A6%E8%B0%88%E4%BB%A3%E7%A0%81%E7%9A%84%E5%A4%8D%E6%9D%82%E6%80%A7%E4%B8%8E%E5%BA%94%E5%AF%B9/</guid>
      <description>&lt;p&gt;å‡ ä¸ªæœˆå‰è¯»å®Œäº†ã€Šè½¯ä»¶è®¾è®¡çš„å“²å­¦ã€‹è¿™æœ¬ä¹¦ï¼Œåœ¨ç»“åˆè‡ªå·±å¤šå¹´çš„å·¥ä½œä½“ä¼šï¼Œå¯¹äºä»£ç çš„å¯è¯»æ€§ï¼Œå¯ç»´æŠ¤æ€§æœ‰äº†ç³»ç»Ÿæ€§çš„ä½“ä¼šï¼Œç„¶ååŸºäºæˆ‘è®°å½•çš„è¯»ä¹¦ç¬”è®°ç„¶åç»è¿‡AIçš„æ¶¦è‰²ï¼Œå½¢æˆäº†è¿™ç¯‡ç¬”è®°ã€‚å¸Œæœ›å¯¹ä½ ä¹Ÿæœ‰æ‰€å¸®åŠ©ã€‚&lt;/p&gt;

&lt;p&gt;è¯»å®Œã€Šè½¯ä»¶è®¾è®¡çš„å“²å­¦ã€‹ï¼Œæ„Ÿè§‰åƒç»å†äº†ä¸€æ¬¡ä»£ç çš„â€œæ·±åº¦ä½“æ£€â€ã€‚è¿™æœ¬ä¹¦æ²¡æœ‰è®²è§£å…·ä½“çš„ç¼–ç æŠ€å·§ï¼Œè€Œæ˜¯ä»æ›´é«˜çš„ç»´åº¦å¸®åŠ©æˆ‘ä»¬é‡æ–°å®¡è§†ä»£ç å¤æ‚æ€§çš„é—®é¢˜ï¼Œå¹¶æå‡ºäº†è®¸å¤šå®ç”¨çš„å»ºè®®ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³ç»“åˆè‡ªå·±çš„ç†è§£ï¼Œåˆ†äº«è¿™æœ¬ä¹¦å¸¦æ¥çš„å¯å‘ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯ä»£ç çš„å¤æ‚æ€§&#34;&gt;ä»€ä¹ˆæ˜¯ä»£ç çš„å¤æ‚æ€§ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ç®€å•æ¥è¯´ï¼Œå¤æ‚æ€§å°±æ˜¯é‚£äº›è®©ç³»ç»Ÿéš¾ä»¥ç†è§£å’Œä¿®æ”¹çš„å› ç´ ã€‚å®ƒä¸ä»…ä»…æŒ‡ä»£ç çš„è¡Œæ•°æˆ–é€»è¾‘æ·±åº¦ï¼Œè¿˜åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éš¾ä»¥ç†è§£&lt;/strong&gt;ï¼šå³ä¾¿æ˜¯è‡ªå·±å†™çš„ä»£ç ï¼Œè¿‡ä¸€æ®µæ—¶é—´å¯èƒ½ä¹Ÿçœ‹ä¸æ‡‚ï¼Œæ›´åˆ«æå…¶ä»–äººã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿®æ”¹æˆæœ¬é«˜&lt;/strong&gt;ï¼šä¸€ä¸ªå°æ”¹åŠ¨éœ€è¦æ”¹åŠ¨å¤šä¸ªåœ°æ–¹ï¼Œç”šè‡³å¼•å‘æ–°çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡ç³Šçš„æ”¹åŠ¨èŒƒå›´&lt;/strong&gt;ï¼šä¸çŸ¥é“è¯¥ä¿®æ”¹å“ªäº›æ¨¡å—æ‰èƒ½å®ç°ç›®æ ‡ï¼Œæˆ–è€…ä¸ç¡®å®šä¿®æ”¹åæ˜¯å¦ä¼šå¼•å‘å…¶ä»–é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš¾ä»¥ä¿®å¤çš„é”™è¯¯&lt;/strong&gt;ï¼šä¿®å¤ä¸€ä¸ª bug å¯èƒ½éœ€è¦å¤§é‡æ—¶é—´ï¼Œè¿˜å¯èƒ½å¼•å…¥æ–°çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;å¤æ‚æ€§çš„è¡¨ç°å½¢å¼&#34;&gt;å¤æ‚æ€§çš„è¡¨ç°å½¢å¼&lt;/h3&gt;

&lt;p&gt;å¤æ‚æ€§å¹¶éæŠ½è±¡æ¦‚å¿µï¼Œå®ƒå¸¸ä»¥ä»¥ä¸‹å½¢å¼ä½“ç°ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å˜æ›´æ”¾å¤§&lt;/strong&gt;ï¼šä¸€ä¸ªç®€å•éœ€æ±‚æ”¹åŠ¨éœ€è¦ä¿®æ”¹å¤šä¸ªæ¨¡å—ç”šè‡³ä»£ç åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¤çŸ¥è´Ÿè·&lt;/strong&gt;ï¼šå®Œæˆä¸€ä¸ªä»»åŠ¡éœ€è¦äº†è§£å¤§é‡èƒŒæ™¯çŸ¥è¯†æˆ–å¤æ‚ç»†èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœªçŸ¥çš„æœªçŸ¥&lt;/strong&gt;ï¼šä¿®æ”¹ä»£ç æ—¶ï¼Œä¸ç¡®å®šæ˜¯å¦ä¼šå¼•å…¥æ–°çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;å¤æ‚æ€§çš„æ¥æº&#34;&gt;å¤æ‚æ€§çš„æ¥æº&lt;/h3&gt;

&lt;p&gt;å¤æ‚æ€§é€šå¸¸æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡å—ä¹‹é—´çš„ä¾èµ–&lt;/strong&gt;ï¼šä¸€ä¸ªæ¨¡å—çš„æ”¹åŠ¨å¯èƒ½éœ€è¦åŒæ­¥ä¿®æ”¹ä¾èµ–å®ƒçš„å…¶ä»–æ¨¡å—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™¦æ¶©éš¾æ‡‚çš„ä»£ç &lt;/strong&gt;ï¼šä¸æ¸…æ™°çš„å˜é‡åã€å‡½æ•°åä»¥åŠç¼ºä¹æ³¨é‡Šçš„é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡æ¡£ä¸è¶³&lt;/strong&gt;ï¼šç¼ºä¹è§£é‡Šä»£ç æ„å›¾å’Œçº¦æŸçš„æ–‡æ¡£ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;é¢å¯¹å¤æ‚æ€§çš„ä¸¤å¤§ç­–ç•¥&#34;&gt;é¢å¯¹å¤æ‚æ€§çš„ä¸¤å¤§ç­–ç•¥&lt;/h3&gt;

&lt;p&gt;ä¹¦ä¸­æåˆ°äº†è§£å†³ä»£ç å¤æ‚æ€§çš„ä¸¤ç§æ ¸å¿ƒç­–ç•¥ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®©ä»£ç æ›´ç®€å•ã€æ›´ç›´è§‚&lt;/strong&gt;

&lt;ul&gt;
&lt;li&gt;é€šè¿‡æ¸…æ™°çš„å‘½åã€ç®€æ´çš„é€»è¾‘ã€è§„èŒƒçš„å®ç°ï¼Œè®©ä»£ç æ˜“äºç†è§£ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°è£…å¤æ‚æ€§&lt;/strong&gt;

&lt;ul&gt;
&lt;li&gt;å°†å¤æ‚é€»è¾‘å°è£…èµ·æ¥ï¼Œé€šè¿‡ç®€æ´çš„æ¥å£æš´éœ²ç»™å¤–éƒ¨ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒå†…éƒ¨ç»†èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;å¦‚ä½•åº”å¯¹å¤æ‚æ€§&#34;&gt;å¦‚ä½•åº”å¯¹å¤æ‚æ€§ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ä»¥ä¸‹æ˜¯ä¹¦ä¸­æåˆ°çš„ä¸€äº›æœ‰æ•ˆæ–¹æ³•ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ¨¡å—åŒ–è®¾è®¡&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å°†ç³»ç»Ÿåˆ†è§£ä¸ºç‹¬ç«‹æ¨¡å—ï¼Œå‡å°‘æ¨¡å—é—´çš„ä¾èµ–ã€‚æ¯ä¸ªæ¨¡å—åº”åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®ä»»åŠ¡ï¼Œæä¾›æ¸…æ™°æ¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æŠ½è±¡&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å¿½ç•¥ä¸é‡è¦çš„ç»†èŠ‚ï¼Œåªæš´éœ²å¿…è¦çš„ä¿¡æ¯ã€‚å¥½çš„æŠ½è±¡èƒ½é™ä½è®¤çŸ¥è´Ÿè·å¹¶æé«˜ä»£ç å¤ç”¨æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;ä¿¡æ¯éšè—&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;éšè—æ¨¡å—çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œåªæš´éœ²æ¥å£ã€‚è¿™æ ·èƒ½å‡å°‘æ¨¡å—ä¹‹é—´çš„è€¦åˆï¼Œé™ä½ä¿®æ”¹é£é™©ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è®¾è®¡é€šç”¨æ¥å£&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;é€šç”¨æ¥å£èƒ½éšè—ç»†èŠ‚å¹¶æé«˜ä»£ç å¤ç”¨æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;ä¸“æ³¨äºä»»åŠ¡çš„çŸ¥è¯†&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è®¾è®¡æ¨¡å—æ—¶ï¼Œåº”å…³æ³¨ä»»åŠ¡æ‰€éœ€çš„çŸ¥è¯†ï¼Œè€Œéä»»åŠ¡å‘ç”Ÿçš„é¡ºåºã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ³¨é‡Šä»£ç &lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æ³¨é‡Šåº”è§£é‡Šä»£ç çš„â€œä¸ºä»€ä¹ˆâ€ï¼Œè€Œéâ€œæ˜¯ä»€ä¹ˆâ€ã€‚ä¾‹å¦‚ï¼Œæè¿°å˜é‡å•ä½ã€è¾¹ç•Œæ¡ä»¶ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ¸…æ™°å‘½å&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å‡†ç¡®ä¸”ä¸€è‡´çš„å‘½åï¼Œé¿å…æ­§ä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;å…ˆå†™æ³¨é‡Šï¼Œå†å†™ä»£ç &lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å…ˆç”¨æ³¨é‡Šæ˜ç¡®è¡¨è¾¾ä»£ç æ„å›¾ï¼Œç„¶åå†å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è®¾è®¡ä¸¤æ¬¡&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;åˆæ­¥å®Œæˆä»£ç åï¼Œé‡æ–°å®¡è§†è®¾è®¡ï¼Œæ€è€ƒæ˜¯å¦æœ‰æ›´å¥½çš„æ¥å£å’Œå®ç°æ–¹å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;ç»Ÿä¸€è§„èŒƒ&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;åˆ¶å®šå›¢é˜Ÿä»£ç è§„èŒƒï¼Œä¿æŒä¸€è‡´æ€§ï¼Œæé«˜å¯è¯»æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ˜¾å¼ä»£ç ä¼˜äºéšå¼ä»£ç &lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ä»£ç åº”å°½å¯èƒ½æ¸…æ™°æ˜“æ‡‚ï¼Œé¿å…æ™¦æ¶©æŠ€å·§ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;å±é™©ä¿¡å·-ä»€ä¹ˆæ—¶å€™è¯¥è­¦æƒ•å¤æ‚æ€§&#34;&gt;å±é™©ä¿¡å·ï¼šä»€ä¹ˆæ—¶å€™è¯¥è­¦æƒ•å¤æ‚æ€§ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ä»¥ä¸‹æ˜¯ä¹¦ä¸­æåˆ°çš„ä¸€äº›â€œå±é™©ä¿¡å·â€ï¼Œé‡åˆ°è¿™äº›æƒ…å†µæ—¶ï¼Œéœ€è¦è€ƒè™‘é‡æ„ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æµ…æ¨¡å—&lt;/strong&gt;ï¼šæ¥å£ä¸å®ç°çš„å¤æ‚æ€§ç›¸å·®æ— å‡ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿¡æ¯æ³„æ¼&lt;/strong&gt;ï¼šè®¾è®¡å†³ç­–å¯¼è‡´å¤šä¸ªæ¨¡å—ä¹‹é—´è€¦åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´åˆ†è§£&lt;/strong&gt;ï¼šä»£ç ç»“æ„ä¾èµ–æ“ä½œæ‰§è¡Œé¡ºåºï¼Œè€ŒéåŸºäºä¿¡æ¯éšè—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿‡åº¦æš´éœ²&lt;/strong&gt;ï¼šAPI æš´éœ²äº†ä¸å¸¸ç”¨çš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡å¤ä»£ç &lt;/strong&gt;ï¼šç›¸åŒä»£ç åå¤å‡ºç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è”åˆæ–¹æ³•&lt;/strong&gt;ï¼šä¸¤ä¸ªæ–¹æ³•é—´ä¾èµ–æ€§å¼ºï¼Œéš¾ä»¥å•ç‹¬ç†è§£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨é‡Šé‡å¤ä»£ç &lt;/strong&gt;ï¼šæ³¨é‡Šä»…é‡å¤ä»£ç å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å«ç³Šä¸æ¸…çš„åç§°&lt;/strong&gt;ï¼šå˜é‡æˆ–æ–¹æ³•åç§°ä¼ é€’ä¸äº†æœ‰ç”¨ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš¾ä»¥æè¿°&lt;/strong&gt;ï¼šéœ€è¦å†—é•¿æ–‡æ¡£è§£é‡Šå˜é‡æˆ–æ–¹æ³•æ„å›¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éæ˜¾è€Œæ˜“è§çš„ä»£ç &lt;/strong&gt;ï¼šä»£ç è¡Œä¸ºæˆ–æ„å›¾ä¸ç›´è§‚ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;è½¯ä»¶è®¾è®¡çš„æ ¸å¿ƒåŸåˆ™&#34;&gt;è½¯ä»¶è®¾è®¡çš„æ ¸å¿ƒåŸåˆ™&lt;/h3&gt;

&lt;p&gt;ä¹¦ä¸­æ€»ç»“äº†ä»¥ä¸‹å…³é”®åŸåˆ™ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤æ‚æ€§æ˜¯é€æ­¥å¢åŠ çš„&lt;/strong&gt;ï¼šä»å°äº‹åšèµ·ï¼ŒæŒç»­æ”¹è¿›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç è·‘èµ·æ¥å¹¶ä¸å¤Ÿ&lt;/strong&gt;ï¼šè¿˜éœ€å…³æ³¨å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒç»­æŠ•å…¥æ”¹å–„ç³»ç»Ÿè®¾è®¡&lt;/strong&gt;ï¼šä¸è¦å¿½è§†ä»£ç çš„é•¿æœŸç»´æŠ¤æˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡å—åº”è¯¥è¶³å¤Ÿæ·±&lt;/strong&gt;ï¼šæ¥å£è¦æ¯”å®ç°ç®€å•å¾—å¤šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€åŒ–æ¥å£&lt;/strong&gt;ï¼šæ¥å£è®¾è®¡åº”å°½å¯èƒ½ç®€åŒ–æœ€å¸¸è§ç”¨æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€šç”¨ä¸ä¸“ç”¨åˆ†ç¦»&lt;/strong&gt;ï¼šé€šç”¨ä»£ç ä¸ä¸“ç”¨ä»£ç åº”æ˜ç¡®åŒºåˆ†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±‚æ¬¡åˆ†æ˜&lt;/strong&gt;ï¼šä¸åŒå±‚æ¬¡åº”æœ‰ä¸åŒæŠ½è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™ä½å¤æ‚æ€§&lt;/strong&gt;ï¼šå§‹ç»ˆå…³æ³¨å‡å°‘è®¤çŸ¥è´Ÿè·å’Œæ¨¡å—è€¦åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ˆè®¾è®¡ï¼Œå†å®ç°&lt;/strong&gt;ï¼šé¿å…ä»“ä¿ƒå†³ç­–ï¼Œå¤šæ¬¡è®¾è®¡è¿­ä»£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨é‡Šä¸æ˜æ˜¾å†…å®¹&lt;/strong&gt;ï¼šå¥½çš„æ³¨é‡Šå¯æ˜¾è‘—é™ä½è®¤çŸ¥è´Ÿè·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç æ˜¯å†™ç»™äººçœ‹çš„&lt;/strong&gt;ï¼šæ¸…æ™°æ€§ä¼˜å…ˆäºå®ç°æŠ€å·§ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;ç»“è¯­&#34;&gt;ç»“è¯­&lt;/h3&gt;

&lt;p&gt;ã€Šè½¯ä»¶è®¾è®¡çš„å“²å­¦ã€‹è®©æˆ‘æ„è¯†åˆ°ï¼Œè½¯ä»¶å¼€å‘ä¸ä»…æ˜¯å®ç°åŠŸèƒ½ï¼Œæ›´æ˜¯ä¸€é—¨éœ€è¦æ·±æ€ç†Ÿè™‘çš„è‰ºæœ¯ã€‚å®ƒæé†’æˆ‘ä»¬ï¼Œä»£ç çš„æ ¸å¿ƒç›®æ ‡æ˜¯&lt;strong&gt;æ˜“äºç†è§£å’Œç»´æŠ¤&lt;/strong&gt;ã€‚æ¯•ç«Ÿï¼Œ&lt;strong&gt;ä»£ç æ˜¯å†™ç»™äººçœ‹çš„ï¼Œå…¶æ¬¡æ‰æ˜¯ç»™æœºå™¨çœ‹çš„&lt;/strong&gt;ã€‚å¸Œæœ›è¿™äº›å¿ƒå¾—å¯¹ä½ æœ‰æ‰€å¯å‘ï¼Œè®©æˆ‘ä»¬ä¸€èµ·å†™å‡ºæ›´æ¸…æ™°ã€æ›´ä¼˜é›…çš„ä»£ç ï¼&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>å¦‚ä½•å¿«é€Ÿä¸Šæ‰‹é¡¹ç›®</title>
      <link>https://zhu327.github.io/2025/01/08/%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E9%A1%B9%E7%9B%AE/</link>
      <pubDate>Wed, 08 Jan 2025 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/01/08/%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E9%A1%B9%E7%9B%AE/</guid>
      <description>&lt;p&gt;èŒä¸šç”Ÿæ¶¯ä¸­æ¥æ‰‹è¿‡å¾ˆå¤šé¡¹ç›®äº†ï¼Œå„ç§é¡¹ç›®éƒ½æ¥è§¦è¿‡ï¼Œä¸€ä¸ªå¯¹æ–°äººå‹å¥½çš„é¡¹ç›®ä¸€èˆ¬å…·å¤‡å¦‚ä¸‹ç‰¹å¾ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å®Œå¤‡çš„å®‰è£…/åŠŸèƒ½æ–‡æ¡£&lt;/li&gt;
&lt;li&gt;å®Œå¤‡çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œæ¶æ„è®¾è®¡æ–‡æ¡£&lt;/li&gt;
&lt;li&gt;åˆç†çš„åˆ†å±‚ï¼Œæ¸…æ™°çš„ä»£ç ç›®å½•ç»“æ„&lt;/li&gt;
&lt;li&gt;å¯è¯»ï¼Œå¯ç»´æŠ¤æ€§é«˜çš„ä»£ç &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä½†æ˜¯å¾€å¾€æˆ‘ä»¬ä¼šå¿½ç•¥ä¸€ä¸ªä¸€ä¸ªç®€å•çš„æŒ‡å¼•æ€§çš„æ–‡æ¡£ï¼š&lt;strong&gt;Quick Start&lt;/strong&gt;ï¼Œè¿™ä¸ªæ–‡æ¡£ä¸éœ€è¦å¾ˆè¯¦ç»†ï¼Œåªéœ€è¦è¯´æ˜ï¼Œå¦‚ä½•å¿«é€Ÿä¸Šæ‰‹çš„è¿‡ç¨‹ï¼Œå…·ä½“çš„æ­¥éª¤é“¾æ¥åˆ°å¯¹åº”çš„æ–‡æ¡£å³å¯ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨Quick Startä¸Šå†™æ˜ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æœ€ç®€å®‰è£…çš„æ­¥éª¤&lt;/li&gt;
&lt;li&gt;ä¸»æµç¨‹åŠŸèƒ½çš„ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;å¼€å‘ç¯å¢ƒçš„æ­å»º&lt;/li&gt;
&lt;li&gt;å¼€å‘æ³¨æ„äº‹é¡¹

&lt;ol&gt;
&lt;li&gt;åŒ…å«ç»„ä»¶çš„æ¶æ„å›¾&lt;/li&gt;
&lt;li&gt;åŒ…å«ä»£ç çš„åˆ†å±‚ç›®å½•è¯´æ˜&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™ä¸ªæ–‡æ¡£éœ€è¦ç”±é¡¹ç›®çš„è´Ÿè´£äººç¼–å†™ï¼Œåœ¨åç»­ç”±é¡¹ç›®çš„æ–°äººå®è·µçš„è¿‡ç¨‹ä¸­é€æ­¥å®Œå–„ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶è¿™éƒ½æ˜¯æ¯”è¾ƒç†æƒ³çš„æƒ…å†µï¼Œå®é™…æƒ…å†µä¸­ï¼Œæˆ‘ä»¬å¯èƒ½é‡åˆ°çš„é¡¹ç›®å¯èƒ½æ ¹æœ¬å°±æ²¡æœ‰æ–‡æ¡£ï¼Œç„¶ååªæœ‰ä¸€ä¸ªä»£ç ä»“åº“çš„æƒ…å†µï¼Œé‚£æ€ä¹ˆæ‰èƒ½å¿«é€Ÿä¸Šæ‰‹å‘¢ï¼Ÿå…¶å®è¿˜æ˜¯æŒ‰ç…§Quick Startçš„æ€è·¯ï¼Œåªä¸è¿‡éœ€è¦è‡ªå·±æ¥æ‘¸ç´¢æ¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-å®‰è£…&#34;&gt;1. å®‰è£…&lt;/h3&gt;

&lt;p&gt;æˆ‘ç›¸ä¿¡ä¸ç®¡ä»€ä¹ˆé¡¹ç›®ï¼Œæˆ–å¤šæˆ–å°‘éƒ½æœ‰ä¸€äº›å¦‚ä½•å®‰è£…çš„æ–‡æ¡£ï¼Œå¦‚æœè¿ä¸€ç‚¹è¿™æ ·çš„æ–‡æ¡£éƒ½æ²¡æœ‰ï¼Œé‚£å°±éœ€è¦é—®å…¶å®ƒåŒäº‹äº†ï¼Œå¦‚æœè¿é—®éƒ½é—®ä¸å‡ºæ¥ï¼Œé‚£æ­å–œä½ èµ¶å¿«è·‘è·¯å§ï¼ŒğŸ˜‚&lt;/p&gt;

&lt;p&gt;å› ä¸ºæˆ‘ä»¬æ˜¯åˆæ¬¡æ¥è§¦é¡¹ç›®ï¼Œä¸å¿…ææ‡‚å®‰è£…çš„æ¯ä¸ªæ­¥éª¤ï¼Œæ¯ä¸ªé…ç½®çš„å«ä¹‰ï¼Œç›®æ ‡ä»…ä»…æ˜¯æŠŠé¡¹ç›®è·‘èµ·æ¥ï¼Œèƒ½ç”¨èµ·æ¥ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç›®æ ‡å°±æ˜¯å®‰è£…æœ€ç®€åŒ–çš„æ–¹å¼æŠŠé¡¹ç›®è·‘èµ·æ¥ã€‚å½“å‰çš„åç«¯é¡¹ç›®ä¸€èˆ¬é‡‡ç”¨å®¹å™¨äº¤ä»˜çš„å½¢å¼ï¼Œä¸€èˆ¬å°±äº¤ä»˜é•œåƒä¸helm chartï¼Œè¿™ç§æ–¹å¼çš„å®‰è£…ç†è®ºæ¥è¯´æ˜¯éå¸¸ç®€å•çš„ï¼Œä¸€æ¡helm install çš„å‘½ä»¤å°±å¯ä»¥æå®šã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨äº¤ä»˜çš„çš„æ—¶ä¸€å®šè¦åœ¨é»˜è®¤çš„é…ç½®ä¸­å†™å¥½æœ€ç®€åŒ–çš„é…ç½®ï¼Œè¿™æ ·æ–°äººå°±å¯ä»¥ç›´æ¥ç”¨é»˜è®¤çš„é…ç½®æ¥å®‰è£…ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-åŠŸèƒ½ä½“éªŒ&#34;&gt;2. åŠŸèƒ½ä½“éªŒ&lt;/h3&gt;

&lt;p&gt;å®‰è£…å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»äº§å“çš„è§’åº¦å¼€å§‹ä½“éªŒé¡¹ç›®çš„ç›¸å…³åŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘ä»¬è¦èšç„¦åˆ°é¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½ä¸Šï¼Œè·‘å®Œæ•´ä¸ªä¸»è¦æµç¨‹ï¼Œä¸è¦åœ¨æ„ç»†èŠ‚ï¼Œä¹Ÿä¸è¦æ€¥äºæŠŠä½“éªŒçš„åŠŸèƒ½ä¸ä»£ç å®ç°ç»“åˆèµ·æ¥ï¼Œæˆ‘ä»¬åªè¦æ¢³ç†åŠŸèƒ½æµç¨‹ï¼Œæ•°æ®çš„æµè½¬ï¼Œæ•°æ®çš„å»ºæ¨¡ã€‚ç„¶åæœ‰ç»éªŒçš„ç¨‹åºå‘˜å¾€å¾€ä¼šåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ€è€ƒï¼Œè¿™ä¸ªåŠŸèƒ½å¦‚æœæ˜¯æˆ‘æ¥åšï¼Œæˆ‘ä¼šæ€ä¹ˆåšã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸€å®šè¦æœ‰è‡ªå·±çš„è¾“å‡ºï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;åŠŸèƒ½æ¸…å•&lt;/li&gt;
&lt;li&gt;åŠŸèƒ½æµç¨‹å›¾&lt;/li&gt;
&lt;li&gt;æ•°æ®æ¨¡å‹&lt;/li&gt;
&lt;li&gt;æ•°æ®æµè½¬å›¾&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¦‚æœæœ‰æ€è€ƒå¦‚ä½•å®ç°ï¼Œè¿˜å¯ä»¥è®°å½•è¿™äº›ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æŠ€æœ¯é€‰å‹&lt;/li&gt;
&lt;li&gt;æŠ€æœ¯æ–¹æ¡ˆ&lt;/li&gt;
&lt;li&gt;æ¶æ„è®¾è®¡&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨ä½“éªŒè¿‡ç¨‹ä¸­å¦‚æœå‘ç°äº†é—®é¢˜ï¼Œä¹Ÿéœ€è¦è®°å½•ä¸‹æ¥ï¼Œè¿˜æœ‰è‡ªå·±å¯¹é¡¹ç›®çš„ç–‘é—®ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡ï¼Œè¿™ä¸ªåŠŸèƒ½è§£å†³çš„ä»€ä¹ˆå®é™…é—®é¢˜ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯é¿å…é™·å…¥ç»†èŠ‚ï¼Œæœ‰äº›ä¸œè¥¿æ²¡ææ‡‚å°±æ²¡ææ‡‚ï¼Œæ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ªæ–°äººï¼Œæä¸æ‡‚ä¹Ÿæ­£å¸¸ï¼ŒæŠŠæ²¡ææ‡‚çš„é—®é¢˜è®°å½•ä¸‹æ¥ï¼Œåç»­å†é€æ­¥ç†Ÿæ‚‰ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-ç»„ä»¶æ‹†è§£ä¸ç”¨é€”åˆ†æ&#34;&gt;3. ç»„ä»¶æ‹†è§£ä¸ç”¨é€”åˆ†æ&lt;/h3&gt;

&lt;p&gt;åœ¨åŠŸèƒ½ä½“éªŒå®Œæˆåï¼Œæˆ‘ä»¬å°±æœ‰äº†è‡ªå·±çš„å¯¹ä¸é¡¹ç›®çš„æ€è€ƒï¼Œä¹Ÿæœ‰äº†ä¸€äº›ç–‘é—®ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥ä»é¡¹ç›®çš„ä¾èµ–çš„å„ä¸ªç»„ä»¶æ¥é€æ­¥ææ¸…æ¥šè¿™äº›é—®é¢˜ã€‚æ¯”å¦‚é¡¹ç›®ä¸­ç”¨äº†ä»€ä¹ˆæ•°æ®åº“ï¼Œç”¨äº†ä»€ä¹ˆç¼“å­˜ç­‰ç­‰ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å¯¹ç…§æˆ‘ä»¬è‡ªå·±çš„åˆ†ææ¥çœ‹çœ‹é¡¹ç›®æ˜¯ä¸æ˜¯çœŸçš„å°±æ˜¯æƒ³æˆ‘ä»¬æƒ³æƒ³çš„æ¥å®ç°çš„ï¼Œæ•°æ®åº“çš„è¡¨è®¾è®¡æ˜¯ä¸æ˜¯ä¹Ÿè·Ÿæˆ‘ä»¬çš„æ•°æ®å»ºæ¨¡ä¸€è‡´ã€‚ç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜å¾€å¾€å¾ˆå¿«å°±èƒ½çŒœå‡ºé¡¹ç›®çš„ä¸»è¦ç»„ä»¶ä¾èµ–ï¼Œå¿«é€Ÿç”»å‡ºä¸€ä¸ªç®€å•çš„æ¶æ„å›¾ã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-é¡¹ç›®ä»£ç åˆ†æ&#34;&gt;4. é¡¹ç›®ä»£ç åˆ†æ&lt;/h3&gt;

&lt;p&gt;ææ˜ç™½å„ä¸ªç»„ä»¶çš„ç”¨é€”åï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å•åˆ€ç›´å…¥ï¼Œä»ä¸»è¦åŠŸèƒ½æµç¨‹å‡ºå‘ï¼Œæ‰¾åˆ°å¯¹åº”ä»£ç çš„å…¥å£ï¼Œç„¶åæŒ‰ç…§æˆ‘ä»¬æ•´ç†çš„åŠŸèƒ½æµç¨‹ï¼Œæ¢³ç†å‡ºä»£ç æµè½¬çš„è¿‡ç¨‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬å°±å¯ä»¥å¤§ä½“åˆ†æå‡ºé¡¹ç›®ä»£ç ä¸­ç›®å½•çš„åˆ†å±‚ï¼Œå„ä¸ªæ¨¡å—çš„åŠŸèƒ½äº†ã€‚æˆ‘ä»¬è¿˜å¯ä»¥å€ŸåŠ©å·¥å…·æ¥ç»˜åˆ¶ä»£ç çš„ä¾èµ–å›¾ï¼Œè¿™æ ·å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„ç†è§£ä»£ç ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨é˜…è¯»çš„è¿‡ç¨‹ä¸­ä»£ç æœ¬èº«å¯èƒ½ä¹Ÿä¼šæœ‰æˆ‘ä»¬çœ‹ä¸æƒ¯çš„åœ°æ–¹ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦æŠŠä»£ç åˆ‡å‡ºä¸€ä¸ªåˆ†æ”¯æ¥ï¼Œä¸“é—¨ç”¨æ¥è®°å½•è‡ªå·±é˜…è¯»æ—¶å†™çš„æ³¨é‡Šä»¥åŠä¸€äº›è§‰å¾—è¦é‡æ„çš„ç‚¹ï¼Œä½†æ˜¯åƒä¸‡ä¸è¦ç›´æ¥å¼€å§‹åŠ¨æ‰‹ï¼Œä¸€å®šåªæ˜¯è®°å½•ï¼Œæ‰“ä¸Šæ ‡è®°ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;// TODO: è¿™é‡Œæœ‰å¾…é‡æ„
// ? ä¸ºä»€ä¹ˆè¿™é‡Œç”¨çš„æ˜¯è¿™ç§æ–¹å¼
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç­‰ç­‰ï¼Œä¹Ÿæ˜¯æŠŠè‡ªå·±çš„ç–‘é—®è®°å½•ä¸‹æ¥ï¼Œåç»­æœ‰éœ€è¦å¯ä»¥å¸¦ç€ç–‘é—®å»é—®åŒäº‹ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä»£ç é˜…è¯»çš„è¿‡ç¨‹ä¸­ï¼Œåˆ‡è®°ä¸è¦é™·å…¥ç»†èŠ‚ï¼Œä¸è¦é™·å…¥ç»†èŠ‚ï¼Œä¸è¦é™·å…¥ç»†èŠ‚ã€‚æˆ‘ä»¬åªéœ€è¦ææ¸…æ¥šä»£ç æµè½¬çš„è¿‡ç¨‹å³å¯ï¼Œè‡³äºä»£ç çš„å®ç°ç»†èŠ‚ï¼Œæˆ‘ä»¬åç»­åœ¨è§£BUGçš„è¿‡ç¨‹ä¸­å†å»é€æ­¥ç†Ÿæ‚‰ã€‚&lt;/p&gt;

&lt;h3 id=&#34;5-ä»å°é—®é¢˜å…¥æ‰‹-é€æ­¥ä¸Šæ‰‹&#34;&gt;5. ä»å°é—®é¢˜å…¥æ‰‹ï¼Œé€æ­¥ä¸Šæ‰‹&lt;/h3&gt;

&lt;p&gt;å…¥æ‰‹é¡¹ç›®çš„åˆæœŸä¸è¦å¥½é«˜éª›è¿œï¼Œæˆ‘ä»¬ä»è§£å°çš„BUGå¼€å§‹ç†Ÿæ‚‰æ€ä¹ˆæ­£ç¡®çš„æäº¤ç¬¬ä¸€ä¸ªPRï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥å­¦ä¹ é¡¹ç›®çš„è§„èŒƒï¼Œæ­£ç¡®çš„å†™å•å…ƒæµ‹è¯•ï¼Œç„¶åè§£BUGçš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸è¦çœ‹å“ªé‡Œçš„ä»£ç å°±åªæ˜¯å“ªé‡Œçš„ä»£ç ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨æ¨¡å—çš„è¾¹ç•Œï¼Œäº†è§£æ•´ä¸ªæ¨¡å—éƒ½æœ‰ä¸€äº›ä»€ä¹ˆåŠŸèƒ½ã€‚å¾ˆå¤šçš„BUGå¾€å¾€ä¸æ˜¯ä¸»è¦åŠŸèƒ½æµç¨‹ä¸­çš„é—®é¢˜ï¼Œåœ¨å¤„ç†è¿™äº›å°çš„BUGçš„æ—¶å€™æ­£æ˜¯æˆ‘ä»¬å»äº†è§£å…¶å®ƒéä¸»è¦æµç¨‹åŠŸèƒ½çš„å¥½æœºä¼šã€‚&lt;/p&gt;

&lt;h3 id=&#34;6-æ–°åŠŸèƒ½ä¸é‡æ„&#34;&gt;6. æ–°åŠŸèƒ½ä¸é‡æ„&lt;/h3&gt;

&lt;p&gt;å½“æˆ‘ä»¬å¯¹é¡¹ç›®æœ‰ä¸€å®šçš„äº†è§£åï¼Œå°±å¯ä»¥åšä¸€äº›æ–°åŠŸèƒ½äº†ï¼Œç„¶ååœ¨è§„åˆ’æ–°åŠŸèƒ½æ—¶ï¼Œå¾€å¾€æˆ‘ä»¬éœ€è¦å¯¹æ¶‰åŠåˆ°å·²æœ‰çš„ä»£ç åšä¸€äº›é‡æ„ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ¡ä»£ç é‡æ„çš„ä¸€ä¸ªåº¦ï¼Œä¸€å®šæ˜¯æœ‰é™å¤„ç†å¯¹æˆ‘ä»¬å†™æ–°åŠŸèƒ½æœ‰é˜»ç¢çš„ä»£ç ï¼Œç„¶åéœ€è¦è€ƒè™‘åŠŸèƒ½çš„åç»­è¿­ä»£ä¸æœªæ¥çš„æ¼”è¿›æ¥é‡æ„ã€‚æ¸è¿›å¼çš„é‡æ„ï¼Œä¸è¦ä¸Šæ¥å°±æå¤§çš„ï¼Œæˆ‘ç›¸ä¿¡å¾ˆå¤šç¨‹åºå‘˜éƒ½å¸Œæœ›èƒ½æŠŠä»£ç å†™çš„è·Ÿç¬¦åˆè‡ªå·±çš„å®¡ç¾ï¼Œä½†æ˜¯åˆæœŸè¿˜æ˜¯è¦ä»¥åŠŸèƒ½ä¸ºä¸»ï¼Œå†å®ç°åŠŸèƒ½çš„åŒæ—¶å°æ­¥æ¸è¿›å¼çš„é‡æ„ã€‚é‡æ„æœ‰å¾ˆå¤šæŠ€å·§ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬æ”¹ä¸åŠ¨çš„ä»£ç åšéš”ç¦»ï¼Œå…ˆä¿è¯èƒ½è·‘èµ·æ¥ï¼Œç„¶åå†å®Œå–„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;åˆå…¥ä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°å¾ˆå¤šå¾ˆå¤šé—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯æŠŠè¿™äº›ç–‘é—®éƒ½è®°å½•ä¸‹æ¥ï¼Œç„¶åå¸¦ç€ç–‘é—®æ…¢æ…¢å»ç†Ÿæ‚‰ï¼Œç†Ÿæ‚‰ä¸€ä¸ªé¡¹ç›®ä¹Ÿéœ€è¦ä¸€ä¸ªè¿‡ç¨‹ï¼Œä¸è¦ç€æ€¥ï¼Œ1ä¸ªæ˜ŸæœŸä¸è¡Œï¼Œå°±1ä¸ªæœˆï¼Œé‡åˆ°å›°éš¾å°±åŠæ—¶å¯»æ±‚å¸®åŠ©ã€‚å‰äººç§æ ‘ï¼Œåäººä¹˜å‡‰ã€‚å¦‚æœå‰äººæ²¡èƒ½å¸®ä½ ç§å¥½æ ‘ï¼Œé‚£æˆ‘ä»¬å°±æŠŠæˆ‘ä»¬ç†Ÿæ‚‰é¡¹ç›®çš„è¿‡ç¨‹æ•´ç†æˆæ–‡æ¡£ï¼Œç•™ç»™åäººï¼Œè¿™æ ·åäººå°±å¯ä»¥å°‘èµ°å¾ˆå¤šå¼¯è·¯ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>æˆ‘çš„2024</title>
      <link>https://zhu327.github.io/2024/12/31/%E6%88%91%E7%9A%842024/</link>
      <pubDate>Tue, 31 Dec 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/12/31/%E6%88%91%E7%9A%842024/</guid>
      <description>&lt;p&gt;ä»Šå¤©æ˜¯2024å¹´çš„æœ€åä¸€å¤©ï¼Œæˆ‘æœ‰è¿™ä¸€ä¸‹åˆçš„ç©ºé—²æ—¶é—´ï¼Œæ‰€ä»¥å°±è®©æˆ‘æ¥çµ®çµ®å¨å¨çš„å†™å†™æˆ‘è¿™ç¥å¥‡çš„2024å¹´å§ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘æ˜¯é¾™å¹´å‡ºç”Ÿçš„ï¼Œæ‰€ä»¥2024å¹´æ˜¯æˆ‘çš„æœ¬å‘½å¹´ï¼Œå¹´åˆçš„æ—¶å€™ï¼Œè€å©†è¿˜æœ‰å§å§å°±ç»™æˆ‘å‡†å¤‡äº†çº¢å†…è£¤ï¼Œçº¢è¢œå­ã€‚ç”±äºçº¢è¢œå­å¤ªè¿‡æ˜¾çœ¼äº†ï¼Œæ‰€ä»¥è¿™ä¸€å¹´æˆ‘çš„å†…è£¤éƒ½æ˜¯çº¢è‰²çš„ï¼Œå“ˆå“ˆã€‚æœ¬å‘½å¹´ï¼ŒçŠ¯å¤ªå²ï¼Œè¿™ä¸€å¹´å·¥ä½œä¸Šï¼Œå¿ƒæ€ä¸Šï¼Œéƒ½æœ‰ä¸€äº›å˜åŒ–ï¼Œå°±è®©æˆ‘åœ¨æœ¬å‘½å¹´çš„æœ€åä¸€å¤©çå†™å†™å§ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æˆ‘è‡ªå·±&#34;&gt;æˆ‘è‡ªå·±&lt;/h3&gt;

&lt;p&gt;æˆ‘æ˜¯80å¹´ä»£æœ«ç”Ÿäººï¼Œå‡ºç”Ÿåœ¨ä¸€ä¸ªå°é•‡ï¼Œæ˜¯æ ‡å‡†çš„å°é•‡åšé¢˜å®¶ã€‚ä»é«˜ä¸­å¼€å§‹åŸºæœ¬å°±ä¸æ€ä¹ˆå›å®¶äº†ï¼Œç„¶åä¸Šå¤§å­¦ï¼Œè·‘å»äº†äº‘å—ï¼ŒåŒéä¸€æœ¬ï¼Œå­¦çš„æ˜¯çƒ­èƒ½ä¸åŠ¨åŠ›å·¥ç¨‹ã€‚æˆ‘çš„åŒå­¦å¤§éƒ½æ‰¾åˆ°äº†æ°´ç”µå‚ï¼Œç«ç”µå‚çš„å·¥ä½œã€‚å·¥ä½œå¥½çš„å»äº†ä¸‰å³¡ï¼Œä¸€èˆ¬å°±å»äº†äº‘å—ä¸€äº›æ¯”è¾ƒååƒ»çš„ç”µå‚ã€‚è€Œæˆ‘å‘¢æ¯•ä¸šå°±å¤±ä¸šäº†ï¼Œåæ¥æ‰¾åˆ°ä¸€ä¸ªæµ·å—çš„å°ç”µå‚ã€‚å·¥ä½œ2å¹´åï¼Œæˆ‘å°±æ¥åˆ°äº†æ·±åœ³ï¼Œåœ¨èººäº†å¥½å‡ ä¸ªæœˆåï¼Œç»ä¸€ä¸ªäº²æˆšçš„ä»‹ç»åˆ°ä¸€ä¸ªåä¸ºçš„è½¯ä»¶å¤–åŒ…å…¬å¸å­¦ä¹ åšè½¯ä»¶æµ‹è¯•ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;è½¯ä»¶æµ‹è¯•æœ¬èº«æ˜¯æ²¡ä»€ä¹ˆé—¨æ§›çš„ï¼Œç„¶åæˆ‘è‡ªè®¤ä¸ºè¿˜æœ‰ç‚¹å°èªæ˜ï¼Œä¹Ÿç”±äºäº²æˆšçš„å®‰æ’ï¼Œæˆ‘æ‰€åœ¨çš„é¡¹ç›®å¹¶ä¸æ˜¯çº¯ç²¹çš„æ‰‹å·¥æµ‹è¯•ã€‚è€Œæ˜¯åå‘è‡ªåŠ¨åŒ–çš„TCP/IPåè®®æ ˆçš„æµ‹è¯•ï¼Œè¿™ä¸ªæµ‹è¯•éœ€è¦æˆ‘å†™ä¸€äº›Luaè„šæœ¬æ¥æ¨¡æ‹Ÿå‘é€ä¸€äº›æ•°æ®åŒ…æ¥åšæµ‹è¯•ã€‚è™½ç„¶è¿™ä¸æ˜¯ä¸€ä¸ªå¼€å‘çš„å·¥ä½œï¼Œä½†æ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘è¿˜æ˜¯å­¦åˆ°ä¸å°‘ä¸œè¥¿ï¼ŒåŸºæœ¬çš„åè®®æ ˆï¼Œsocketï¼Œè¿˜æœ‰ä¸€äº›åŸºç¡€çš„ç¼–ç¨‹è¯­è¨€æ–¹é¢çš„çŸ¥è¯†ã€‚&lt;/p&gt;

&lt;p&gt;åæ¥åˆæ¢äº†åˆ«çš„é¡¹ç›®ï¼ŒåšGUIè·Ÿç½‘é¡µçš„åŠŸèƒ½æµ‹è¯•ï¼Œæˆ‘æ¥æ‰‹è¿™ä¸ªé¡¹ç›®çš„æµ‹è¯•çš„æ—¶å€™ï¼Œé‡Œé¢è¿˜ç»´æŠ¤äº†ä¸€å †Javaå†™çš„åŸºäºä¸€ä¸ªIBMçš„æµ‹è¯•æ¡†æ¶çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ã€‚è¿™å¯éš¾å€’æˆ‘äº†ï¼Œä»¥è‡³äºå¤§åŠå¹´çš„æ—¶é—´æˆ‘éƒ½æ²¡è·‘è¿‡è¿™ä¸ªè‡ªåŠ¨åŒ–çš„æµ‹è¯•ï¼Œä¸€ç›´éƒ½æ˜¯æ‰‹åŠ¨æµ‹è¯•ã€‚æƒ³æƒ³ä¸æ˜¯åŠæ³•ï¼Œè¿˜æ˜¯ææè‡ªåŠ¨åŒ–çš„æµ‹è¯•å§ï¼ŒJavaæ˜¯ä¸€æ—¶åŠä¼šå­¦ä¸ä¼šçš„ï¼Œä¸å¦‚è‡ªå·±å­¦ä¸€å­¦Pythonè‡ªåŠ¨åŒ–å§ï¼Œå°±è¿™æ ·æˆ‘æ¥è§¦åˆ°Pythonç¼–ç¨‹ã€‚æˆ‘ä¾ç„¶è®°å¾—åœ¨æŸä¸€å¤©æˆ‘ç”¨Pythonå†™äº†ä¸€ä¸ªè‡ªåŠ¨åŒ¹é…å…³é”®å­—çš„å·¥å…·ç”¨æ¥åšå®‰å…¨æ£€æŸ¥åï¼Œè·å¾—äº†åä¸ºçš„æŒç»­é›†æˆå¥–ã€‚&lt;/p&gt;

&lt;p&gt;å°±è¿™æ ·æˆ‘åœ¨è¿™ä¸ªè½¯ä»¶å¤–åŒ…å…¬å¸åšæµ‹è¯•åšäº†4å¹´ï¼Œç„¶åæˆ‘å†³å®šè¿˜æ˜¯æ‰¾ä¸€ä»½Pythonå¼€å‘çš„å·¥ä½œå§ï¼Œäºæ˜¯åœ¨å­¦ä¹ äº†Djangoå¼€å‘åï¼Œæˆ‘å°±è£¸è¾äº†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨2015å¹´çš„é‚£ä¸ªæ¿€è¡çš„ä¸‡ä¼—åˆ›ä¸šï¼Œä¸‡ä¼—åˆ›æ–°çš„2015å¹´ï¼Œåªè¦ä½ ä¼šå†™ç‚¹ä»£ç ï¼Œå°±èƒ½æ‰¾åˆ°å·¥ä½œã€‚äºæ˜¯æˆ‘å…¥èŒäº†ä¸€å®¶å¾ˆå°çš„å…¬å¸åšPythonåç«¯å¼€å‘ï¼Œç„¶ååŠå¹´ä¹‹åï¼Œæˆ‘å°±è¢«ä¼˜åŒ–äº†ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ç¡®å®æ€€ç–‘è¿‡è‡ªå·±ï¼Œæˆ‘æ˜¯ä¸æ˜¯çœŸçš„é€‚åˆåšå¼€å‘å‘¢ï¼Œæˆ‘èƒ½æ‹¿å‡ºæ‰‹çš„é¡¹ç›®åªæœ‰æˆ‘åœ¨githubä¸Šå†™çš„ä¸€ä¸ªDjangoçš„è®ºå›ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶åå°±åˆå¼€å§‹æ‰¾å·¥ä½œäº†ï¼Œä¸æ˜¯å¾ˆé¡ºåˆ©ï¼Œç›´åˆ°2015å¹´ä¸‹åŠå¹´çš„æŸä¸€å¤©ï¼Œæˆ‘æ”¶åˆ°äº†ä¸€å°é‚®ä»¶ï¼Œå—¯ï¼Œä¸€å®¶æˆ‘æ²¡æœ‰æŠ•é€’çš„å…¬å¸é‚€è¯·æˆ‘å»é¢è¯•ã€‚åæ¥æ‰ä»è¿™å®¶å…¬å¸çš„CTOå£ä¸­å¾—çŸ¥ï¼Œä»–æ˜¯åœ¨çœ‹åˆ°æˆ‘çš„githubæ‰é‚€è¯·æˆ‘å»é¢è¯•çš„ï¼Œç„¶åæˆ‘å°±å…¥èŒäº†è¿™å®¶å…¬å¸ï¼Œç»§ç»­åšPythonçš„åç«¯å¼€å‘ã€‚åœ¨è¿™å®¶å…¬å¸æˆ‘åˆæ‰¾åˆ°äº†è‡ªä¿¡ã€‚ç„¶ååœ¨è¿™é‡Œæˆ‘å‘ç°æˆ‘åšæµ‹è¯•çš„ç»å†è¿˜æ˜¯æœ‰ç”¨çš„ï¼Œæ¯•ç«Ÿæˆ‘çš„è‡ªæµ‹åšçš„æ¯”è¾ƒç»†è‡´ï¼Œä»¥è‡³äºæˆ‘çš„æ•ˆç‡ä»¥åŠè´¨é‡éƒ½è¿œè¶…å…¶ä»–åŒäº‹ã€‚ç„¶åç”±äºæ•ˆç‡çš„æå‡ï¼Œå¾ˆå¿«æˆ‘å°±å¼€å§‹è´Ÿè´£æ›´åŸºç¡€çš„æ¡†æ¶å¼€å‘ï¼Œå¼•å…¥äº†DRFæ¡†æ¶ï¼Œè¿˜å°è¯•åšäº†RPCæ¡†æ¶ï¼Œç„¶ååˆå¼•å…¥äº†APIç½‘å…³ï¼Œè®¤è¯†äº†Openrestyï¼Œä½ çœ‹ï¼ŒOpenrestyåˆå›åˆ°äº†æˆ‘æœ€åˆåšæµ‹è¯•çš„è€æœ¬è¡ŒLuaä¸Šé¢ã€‚&lt;/p&gt;

&lt;p&gt;ç”±äºåœ¨githubä¸Šé¢å°åˆ°äº†ç”œå¤´ï¼Œåç»­æˆ‘åˆåœ¨githubä¸Šå†™äº†ä¸€äº›Openrestyçš„å°é¡¹ç›®ï¼Œä¹Ÿæœ‰Python RPCç›¸å…³çš„é¡¹ç›®ï¼Œç„¶åä¹Ÿå†™äº†ä¸€äº›æˆ‘è§‰å¾—è¿˜è¡Œçš„åšå®¢æ–‡ç« ã€‚æˆ‘æ„Ÿè§‰æˆ‘çš„èƒ½åŠ›è¿˜æ˜¯åˆæ¯”è¾ƒå¤§çš„æå‡çš„ï¼Œæˆ‘æƒ³æˆ‘æ˜¯ä¸æ˜¯å†å‡ºå»æ‰¾æ‰¾æœºä¼šå‘¢ï¼Ÿæ‰€ä»¥æˆ‘åˆå¼€å§‹é¢è¯•äº†ï¼Œä¸å‡ºæ„å¤–çš„è¿˜æ˜¯è¢«æ‰“å‡»åˆ°äº†ï¼Œæ— éæ˜¯å› ä¸ºéç§‘ç­å‡ºç”Ÿï¼Œç„¶ååŸºç¡€å¾ˆå·®ã€‚æœ‰ä¸€ä¸ªæ¯”è¾ƒniceçš„é¢è¯•å®˜æ¨èæˆ‘å»è¯»ä¸€è¯»æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿï¼Œç„¶åæˆ‘å°±ä¹°äº†è¿™æœ¬ä¹¦ã€‚å¹´è½»çš„æ—¶å€™è¿˜æ˜¯æ¯”è¾ƒè¦å¼ºçš„ï¼Œä¸å–œæ¬¢è®¤è¾“ï¼Œæ‰€ä»¥èŠ±äº†å¥½å‡ ä¸ªæœˆæ­»å•ƒè¿™æœ¬ä¹¦ï¼Œç„¶åå†å›é¡¾è‡ªå·±çš„åœ¨å·¥ä½œä¸­ç‚¹ç‚¹æ»´æ»´ï¼Œç¡®å®å¯¹ç¼–ç¨‹è¿™ä¸ªå·¥ä½œæœ‰äº†æ›´å¤šçš„ç†è§£ã€‚å†ç„¶åæˆ‘å°±ä¹°äº†æ›´å¤šçš„ä¹¦ï¼Œåœ¨doubanä¸Šæ‰¾è¯„åˆ†é«˜çš„ä¹¦ï¼Œè¡¥é½äº†å¾ˆå¤šåŸºç¡€çŸ¥è¯†ã€‚&lt;/p&gt;

&lt;p&gt;æ—¶é—´æ¥åˆ°äº†2018å¹´ï¼Œå¾ˆå¹¸è¿çš„æ˜¯æˆ‘é€šè¿‡äº†è…¾è®¯çš„é¢è¯•ï¼Œè¿™é‡Œé¢æœ‰æˆ‘è¯»ä¹¦çš„èƒ½åŠ›æå‡ï¼Œä¹Ÿæœ‰ä¸åœåœ¨githubä¸Šå†™é¡¹ç›®çš„åŠªåŠ›ï¼Œè¿˜æœ‰æˆ‘é‚£å‡ å¹´ç§¯ç´¯ä¸‹æ¥çš„å·¥ä½œç»éªŒã€‚&lt;/p&gt;

&lt;h3 id=&#34;è…¾è®¯&#34;&gt;è…¾è®¯&lt;/h3&gt;

&lt;p&gt;åˆå…¥è…¾è®¯ï¼Œæˆ‘æ˜¯åœ¨ä¸€ä¸ªè¿ç»´ç»„é‡Œçš„å”¯ä¸€çš„å¼€å‘ï¼Œæˆ‘æ¥çš„éœ€æ±‚éƒ½æ˜¯æˆ‘çš„è¿ç»´åŒäº‹é€šè¿‡å¼€å‘å·¥å…·æ¥æ”¹å–„ä»–ä»¬çš„è¿ç»´å·¥ä½œã€‚è¿™æœŸé—´æœ‰ä¸€ä¸ªç›´æ’­æ¨æµç›¸å…³çš„éœ€æ±‚å¯¹æˆ‘æ¥è¯´ç®—æ˜¯ä¸€ä¸ªå¥‘æœºï¼Œä¿ƒæˆäº†æˆ‘ä»Pythonç¨‹åºè½¬å‘Golangç¨‹åºå‘˜ã€‚åœ¨è¿™ä¸ªç»„é‡Œåšäº†ä¸€å¹´åï¼Œæˆ‘è§‰å¾—æˆ‘åšçš„çš„äº‹æƒ…éƒ½ä¸å…·å¤‡æŒä¹…æ€§ï¼Œæ²¡æœ‰ä¸€ä¸ªæ¸…æ™°çš„æœªæ¥ï¼Œæ‰€ä»¥æˆ‘å†³å®šæ¢ä¸€ä¸ªç»„ï¼Œäºæ˜¯æˆ‘æ¥åˆ°äº†è“é²¸çš„å¼€å‘ç»„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨è…¾è®¯ä½œä¸ºä¸€ä¸ªéç§‘ç­å‡ºèº«çš„æ–°äººï¼Œæˆ‘å¹¶æ²¡æœ‰è§‰å¾—è‡ªå·±èƒ½åšå¾ˆä¹…ï¼Œæˆ‘è„‘å­é‡Œä¸€ç›´æœ‰ä¸€ä¸ªå¿µæƒ³å°±æ˜¯åšä¸ªå‡ å¹´ï¼Œæœ‰äº†å¤§å‚å…‰ç¯ï¼Œç„¶åå†å‡ºå»ä½œä¸ºä¸€ä¸ªæ¶æ„å¸ˆæ‰¾ä¸€ä»½æ–°çš„å·¥ä½œã€‚ä½†æ˜¯æˆ‘åœ¨è“é²¸ç¡®å®è®¤è¯†äº†ä¸€ç¾¤niceçš„åŒäº‹ï¼Œç„¶åè¿™ä¸€åšå°±æ˜¯5å¹´ã€‚è¿™æœŸé—´æˆ‘ä¸€ç›´ä¸“æ³¨åœ¨ä¸€ä¸ªé¡¹ç›®ä¸Šï¼Œå¯ä»¥è¯´æˆä¸ºäº†é¢†åŸŸå†…çš„ä¸“å®¶ã€‚æŒç»­çš„ä¸€ç›´åšä¸€ä»¶äº‹æƒ…æœ‰å¥½å¤„ï¼Œä¹Ÿæœ‰åå¤„ï¼Œå¥½å¤„æ˜¯ä½ å¯ä»¥åœ¨è¿™ä¸ªé¢†åŸŸå†…åšåˆ°æè‡´ï¼Œåå¤„æ˜¯ä½ å¾ˆéš¾è·³å‡ºè¿™ä¸ªé¢†åŸŸã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å¤§å‚ï¼Œæ¯åŠå¹´ä¸€æ¬¡çš„è€ƒæ ¸ï¼Œå‚¬ä¿ƒç€æˆ‘æˆé•¿ï¼Œæ²Ÿé€šèƒ½åŠ›ï¼Œé¡¹ç›®ç®¡ç†èƒ½åŠ›ï¼Œæ¶æ„èƒ½åŠ›ï¼Œè§„åˆ’èƒ½åŠ›ç­‰ç­‰ï¼Œæˆ‘éƒ½æœ‰å®å®åœ¨åœ¨çš„æˆé•¿ã€‚ç„¶è€Œåœ¨æœ¬å‘½å¹´çš„è¿™ä¸€å¹´ï¼Œæˆ‘è¿˜æ˜¯è§‰å¾—æˆ‘å¯ä»¥ç¦»å¼€äº†ï¼Œæ¯•ç«Ÿäº’è”ç½‘35å²çš„å±æœºï¼Œå¹´çºªè¶Šå¤§æ„Ÿå—è¶Šæ·±ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ–°å·¥ä½œ&#34;&gt;æ–°å·¥ä½œ&lt;/h3&gt;

&lt;p&gt;è™½ç„¶é¡¶ç€å¤§å‚å…‰ç¯ï¼Œä½†æ˜¯åœ¨2024å¹´36å²çš„å¹´çºªï¼Œæ‰¾å·¥ä½œè¿˜æ˜¯å¾ˆå›°éš¾ï¼Œé¢è¯•äº†å¾ˆå¤šï¼Œåªè¦æ¶‰åŠå†™ç®—æ³•ä»€ä¹ˆçš„åŸºæœ¬éƒ½æŒ‚äº†ï¼Œç„¶åæˆ‘å°±é™è–ªå…¥èŒäº†ç°åœ¨çš„å…¬å¸ã€‚æˆ‘æœ‰äº†æ›´å¤šçš„æ—¶é—´ï¼Œç„¶åå†™äº†æ›´å¤šçš„æ–‡ç« ï¼Œä¹Ÿå­¦ä¹ äº†Rustç¼–ç¨‹ï¼Œæ–°çš„Rustçš„é¡¹ç›®ä¹Ÿéƒ½æ”¾åˆ°äº†githubä¸Šã€‚æˆ‘ä¸çŸ¥é“è‡ªå·±çš„èŒä¸šç”Ÿæ¶¯è¿˜èƒ½èµ°å¤šè¿œï¼Œä½†æ˜¯æˆ‘è§‰å¾—æˆ‘ä¾ç„¶çƒ­çˆ±ç¼–ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;éšç€AIç¼–ç¨‹åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œæˆ‘è§‰å¾—å¯¹äºå¤´éƒ¨çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œä»–ä»¬çš„ä¼˜åŠ¿ä¼šè¶Šæ¥è¶Šå¤§ï¼Œå› ä¸ºAIä¼šæå¤§çš„æå‡ä»–ä»¬çš„æ•ˆç‡ï¼Œè¿™å¯¹ä¸­ä¸‹éƒ¨çš„ç¨‹åºå‘˜å¯èƒ½æ˜¯ä¸€ä¸ªç¾éš¾ã€‚å¯èƒ½ä¼šå› ä¸ºè¿™ä¸ªæ•´ä¸ªå¸‚åœºçš„è¡Œæƒ…ä¼šè¶Šæ¥è¶Šå·®ï¼Œæ‰€ä»¥æˆ‘ä¸ªäººè§‰å¾—æŒç»­å­¦ä¹ ï¼Œç»ˆèº«å­¦ä¹ åœ¨è¿™ä¸ªæ—¶ä»£æ˜¯å¿…é¡»çš„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ç”Ÿæ´»&#34;&gt;ç”Ÿæ´»&lt;/h3&gt;

&lt;p&gt;3æœˆçš„æ—¶å€™è·Ÿè€å©†æ¥äº†ä¸€æ¬¡å¹¿è¥¿è‡ªé©¾æ¸¸ï¼Œä»æ·±åœ³å‡ºå‘ï¼Œå¼€ç€æˆ‘çš„ç”µè½¦ç¬¬ä¸€æ¬¡é•¿é€”è‡ªé©¾ï¼Œæ„Ÿè°¢è€å©†çš„è¾›è‹¦åšäº†æ”»ç•¥ï¼Œåœ¨å¹¿è¥¿è¾¹å¢ƒçœ‹äº†å¤§ç€‘å¸ƒï¼Œä¹Ÿç¬¬ä¸€æ¬¡ä½“éªŒäº†æº¶æ´é€Ÿé™ï¼Œè¿˜çœ‹åˆ°äº†ç¾ä¸½æ¢¦å¹»çš„ä¸‰é—¨æµ·ã€‚ä¹Ÿå»äº†ä¸€äº›å°ä¼—çš„æ™¯ç‚¹ã€‚åœ¨å¹¿è¥¿çš„å±±é—´å°è·¯æ‚¬å´–è¾¹å°å¿ƒçš„å¼€ç€è½¦ï¼Œåœ¨æº¶æ´é‡Œé¢å¬ç€æ°´æµçš„å£°éŸ³ï¼Œçœ‹ç€å¤´é¡¶çš„ç¯å…‰ï¼Œé‚£ç§æ„Ÿè§‰çœŸçš„å¾ˆæ£’ã€‚&lt;/p&gt;

&lt;p&gt;7æœˆçš„æ—¶å€™ï¼Œæ­£å¼ä»è…¾è®¯ç¦»èŒäº†ï¼Œç„¶åä¹Ÿæ²¡æ‰¾åˆ°å·¥ä½œï¼Œå°±åœ¨å®¶é‡Œèººå¹³é™é™çš„æ€è€ƒäº†ï¼Œå…³äºå·¥ä½œä¸ç„¦è™‘æ˜¯å‡çš„ï¼Œä½†æ˜¯ç”Ÿæ´»ä¹Ÿæ˜¯è¦ç»§ç»­çš„ã€‚æ–°çš„å·¥ä½œå¼€å§‹åï¼Œæˆ‘æœ‰äº†æ›´å¤šçš„æ—¶é—´é™ªå°å­©ï¼Œçœ‹ç€å°å­©çš„æˆé•¿ï¼Œç¡®å®åˆæ„Ÿè§‰ç”Ÿæ´»ä¸ä¸€æ ·äº†ï¼Œå°å­©çš„éœ€æ±‚æ²¡é‚£ä¹ˆå¤šï¼Œæ›´å¤šæ˜¯æˆ‘éƒ½æ˜¯ä½œä¸ºä¸€ä¸ªæ§å“çš„è§’è‰²ï¼Œçœ‹ç€å¥¹ç©è€ï¼Œé…åˆå¥¹çš„å„ç§éœ€æ±‚ã€‚&lt;/p&gt;

&lt;p&gt;å…³äºæœªæ¥ï¼Œä¸–ç•Œå˜åŒ–å¾ˆå¿«ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æœªæ¥ä¼šæ€ä¹ˆæ ·ï¼Œåœ¨æ·±åœ³è¿˜æ²¡æœ‰ä¹°æˆ¿ï¼Œæ²¡å•¥å‹åŠ›ï¼Œåœ¨å¹¿è¥¿æ¸¸çš„è¿‡ç¨‹ä¸­æœ‰ä¸ªå°å°çš„ç§å­ç§åœ¨äº†å¿ƒé‡Œï¼Œä»€ä¹ˆæ—¶å€™èƒ½åœ¨å¹¿è¥¿æ‰¾ä¸ªå±±å¥½æ°´å¥½çš„åœ°æ–¹è¿‡ä¸Šæ…¢ç”Ÿæ´»å‘¢ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ç»“å°¾&#34;&gt;ç»“å°¾&lt;/h3&gt;

&lt;p&gt;å›å¤´çœ‹2024å¹´ï¼Œè¿™ä¸€å¹´è¿‡å¾—æŒºç‰¹åˆ«çš„ï¼Œæœ‰å˜åŒ–ä¹Ÿæœ‰æˆé•¿ã€‚æ— è®ºæ˜¯å·¥ä½œä¸Šçš„è½¬æŠ˜ï¼Œè¿˜æ˜¯ç”Ÿæ´»ä¸­çš„ç‚¹æ»´ï¼Œæˆ‘éƒ½åœ¨æ…¢æ…¢é€‚åº”ã€æ…¢æ…¢è°ƒæ•´ã€‚è™½ç„¶æœªæ¥ä¼šæ€æ ·è¿˜ä¸å¥½è¯´ï¼Œä½†æˆ‘æƒ³ç»§ç»­ä¿æŒå­¦ä¹ çš„ä¹ æƒ¯ï¼Œä¿æŒå¯¹ç”Ÿæ´»çš„çƒ­æƒ…ï¼Œä¹Ÿå°½é‡å¤šé™ªé™ªå®¶äººã€‚ç”Ÿæ´»æ€»æ˜¯è¿™æ ·ï¼Œå……æ»¡æœªçŸ¥ï¼Œä½†ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œæ¯ä¸€å¤©éƒ½å€¼å¾—è®¤çœŸè¿‡å¥½ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ä»Pingoraåˆ°APIç½‘å…³ï¼šæ€»ç»“</title>
      <link>https://zhu327.github.io/2024/12/19/%E4%BB%8Epingora%E5%88%B0api%E7%BD%91%E5%85%B3%E6%80%BB%E7%BB%93/</link>
      <pubDate>Thu, 19 Dec 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/12/19/%E4%BB%8Epingora%E5%88%B0api%E7%BD%91%E5%85%B3%E6%80%BB%E7%BB%93/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/zhu327/pingisx&#34;&gt;https://github.com/zhu327/pingisx&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ç»è¿‡ä¸€ä¸ªå¤šæœˆçš„å¼€å‘ï¼Œç»ˆäºå®Œæˆäº†ä½¿ç”¨Rustå®ç°ä¸€ä¸ªAPIç½‘å…³çš„ç›®æ ‡ï¼Œé€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘åŸºæœ¬ä¸ŠæŠŠPingoraçš„æ ¸å¿ƒåŠŸèƒ½éƒ½æ‘¸é€äº†ï¼Œç„¶åä¹Ÿå†æ¬¡åŠ æ·±äº†å¯¹APISIXçš„ç†è§£ã€‚æ€»çš„æ¥è¯´PingSIXåŸºäºPingoraå®ç°äº†APISIXçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ˜¯APISIXåŠŸèƒ½çš„ä¸€ä¸ªå­é›†ã€‚&lt;/p&gt;

&lt;p&gt;å¼€å‘è¿™ä¸ªé¡¹ç›®æœ¬èº«ä¹Ÿæ˜¯ä¸ºäº†å­¦ä¹ Rustçš„ä½¿ç”¨ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ç¡®å®ä¹Ÿé‡åˆ°äº†å¾ˆå¤šçš„é—®é¢˜ï¼Œåœ¨ChatGPTçš„å¸®åŠ©ä¸‹ï¼Œè¿™äº›é—®é¢˜å¾—åˆ°äº†è§£å†³ï¼Œä¹Ÿè®©æˆ‘å¯¹Rustæœ‰äº†æ›´æ·±åˆ»çš„ç†è§£ã€‚ä¸‹é¢æˆ‘é€šè¿‡4ä¸ªæ–¹é¢æ¥æ€»ç»“ä¸€ä¸‹åœ¨è¿™ä¸ªé¡¹ç›®ä¸­æˆ‘çš„æ”¶è·ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-ç”Ÿå‘½å‘¨æœŸ&#34;&gt;1. ç”Ÿå‘½å‘¨æœŸ&lt;/h3&gt;

&lt;p&gt;åœ¨Rustä¸­ï¼Œä»»ä½•å˜é‡ï¼Œå¯¹è±¡éƒ½æœ‰å®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸ä½œç”¨åŸŸï¼Œåˆšå¼€å§‹çœ‹Rustçš„ä¹¦æ—¶ï¼Œä¼šæƒ³æ˜¯ä¸æ˜¯åªæœ‰&lt;strong&gt;æŒ‡é’ˆ&lt;/strong&gt;éœ€è¦æ ‡æ³¨ï¼Œå®ƒæ‰æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œå…¶å®ä¸æ˜¯çš„ï¼Œä»»ä½•å˜é‡éƒ½æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ä½œç”¨åŸŸé—­åˆæ—¶ï¼Œç”Ÿå‘½å‘¨æœŸä¹Ÿå°±ç»“æŸäº†ï¼Œè€Œå†…å­˜ä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚è¿™å°±æ˜¯Rusté€šè¿‡ç”Ÿå‘½å‘¨æœŸæ¥ç®¡ç†å†…å­˜çš„æœºåˆ¶ã€‚&lt;/p&gt;

&lt;p&gt;å˜é‡çš„ä½œç”¨åŸŸå¯ä»¥ä»å‰ä¸€ä¸ªè½¬ç§»åˆ°åä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;move&lt;/code&gt;, è½¬ç§»åå‰ä¸€ä¸ªä½œç”¨åŸŸå°±ä¸å†æŒæœ‰è¿™ä¸ªå˜é‡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æ‰€æœ‰æƒï¼Œè¿™ä¸ªå˜é‡æ˜¯å±äºè¿™ä¸ªä½œç”¨åŸŸï¼Œåœ¨ä½œç”¨åŸŸå†…å°±å¯ä»¥ä½¿ç”¨ï¼Œè€Œåœ¨&lt;code&gt;move&lt;/code&gt;å‡ºä½œç”¨åŸŸåå°±æ— æ³•ä½¿ç”¨äº†ã€‚æ¯”å¦‚ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨ï¼Œå¯¹è±¡åœ¨ä¼ å…¥åï¼Œå¯¹è±¡çš„ä½œç”¨åŸŸå°±è½¬ç§»åˆ°æ–°çš„å‡½æ•°ä½œç”¨åŸŸä¸­ã€‚é‚£æˆ‘ä»¬å¦‚æœå¸Œæœ›åœ¨åŸæ¥çš„ä½œç”¨åŸŸä¸­ç»§ç»­ä½¿ç”¨è¿™ä¸ªå˜é‡ï¼Œå°±æ¶‰åŠåˆ°&lt;code&gt;Copy&lt;/code&gt; traitä¸&lt;code&gt;Clone&lt;/code&gt; traitäº†ï¼Œå¦‚æœå¯¹è±¡å®ç°äº†&lt;code&gt;Copy&lt;/code&gt; traitï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°±å¯ä»¥åœ¨åŸæ¥çš„ä½œç”¨åŸŸä¸­ç»§ç»­ä½¿ç”¨ã€‚å¦‚æœå¯¹è±¡å®ç°äº†&lt;code&gt;Clone&lt;/code&gt; traitï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å¯ä»¥åœ¨æ–°çš„ä½œç”¨åŸŸä¸­é€šè¿‡cloneæ–¹æ³•æ¥è·å–ã€‚æ— è®ºæ˜¯&lt;code&gt;Copy&lt;/code&gt; traitè¿˜æ˜¯&lt;code&gt;Clone&lt;/code&gt; traitï¼Œç›¸å½“äºæŠŠå¯¹è±¡å¤åˆ¶äº†ä¸€ä»½ï¼Œåœ¨æ–°çš„ä½œç”¨åŸŸä¸­å¯ä»¥ä½¿ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸å¸Œæœ›æ¯æ¬¡å‡½æ•°è°ƒç”¨éƒ½æŠŠå¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œå¹¶ä¸”åœ¨å‡½æ•°ä¸­ä¹Ÿä¸éœ€è¦æŒæœ‰å¯¹è±¡çš„æ‰€æœ‰æƒï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥é€šè¿‡&lt;code&gt;&amp;amp;&lt;/code&gt;æ¥&lt;strong&gt;å€Ÿç”¨&lt;/strong&gt;å¯¹è±¡ï¼Œé€šè¿‡&lt;code&gt;&amp;amp;mut&lt;/code&gt;æ¥&lt;strong&gt;å¯å˜å€Ÿç”¨&lt;/strong&gt;å¯¹è±¡ã€‚åˆçœ‹Rustçš„ä¹¦ï¼Œæˆ‘ä¼šè§‰å¾—è¿™ä¸å°±æ˜¯æŒ‡é’ˆå—ï¼Œå“ªä¸ªè¯­è¨€æ²¡æœ‰è¿™ä¸ªæ¦‚å¿µå‘€ï¼Œä½†æ˜¯çœŸæ­£ç†è§£äº†ç”Ÿå‘½å‘¨æœŸä¸æ‰€æœ‰æƒåï¼Œå°±ä¼šå‘ç°è¿™ç¡®å®å°±æ˜¯&lt;strong&gt;å€Ÿç”¨&lt;/strong&gt;ï¼Œæˆ‘ä¸ç»™ä½ æ‰€æœ‰æƒï¼Œä½ å¿…é¡»åœ¨æˆ‘çš„ä½œç”¨åŸŸå†…ä½¿ç”¨ï¼Œè¿™å°±æ˜¯å€Ÿç”¨ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶åå†æ¥ç†è§£ä¸‹ä¸€ä¸ªå¯¹è±¡ä¸èƒ½åŒæ—¶å­˜åœ¨&lt;strong&gt;å¯å˜å€Ÿç”¨&lt;/strong&gt;ä¸&lt;strong&gt;ä¸å¯å˜å€Ÿç”¨&lt;/strong&gt;ï¼Œä¹Ÿå°±æ¯”è¾ƒå¥½ç†è§£äº†ï¼Œå¦‚æœå¯å˜å€Ÿç”¨è¢«ä¿®æ”¹äº†ï¼Œé‚£åŒæ—¶å­˜åœ¨çš„ä¸å¯ä»¥å˜å€Ÿç”¨åˆ°åº•æ˜¯å˜äº†è¿˜æ˜¯æ²¡å˜å‘¢ï¼Œå¦‚æœéƒ½å­˜åœ¨å°±æ˜¯çŸ›ç›¾çš„ã€‚&lt;/p&gt;

&lt;p&gt;è¯´å®Œäº†å€Ÿç”¨ï¼Œå†æ¥çœ‹çœ‹æ™ºèƒ½æŒ‡é’ˆï¼Œæˆ‘å¸Œæœ›åœ¨å¤šä¸ªä½œç”¨åŸŸä¸­ä½¿ç”¨å¯¹è±¡ï¼Œå¹¶ä¸”éƒ½æœ‰æ‰€æœ‰æƒï¼Œé‚£å°±å¯ä»¥ä½¿ç”¨&lt;code&gt;Rc&amp;lt;T&amp;gt;&lt;/code&gt;ï¼Œå®ƒå®ç°äº†å¼•ç”¨è®¡æ•°ï¼Œå½“å¯¹è±¡è¢«Rcæ‰€æŒæœ‰æ—¶ï¼Œå¼•ç”¨è®¡æ•°åŠ 1ï¼Œå½“ç¦»å¼€ä½œç”¨åŸŸåï¼Œå¼•ç”¨è®¡æ•°å‡1ï¼Œå½“å¼•ç”¨è®¡æ•°ä¸º0æ—¶å†…å­˜è¢«é‡Šæ”¾ã€‚&lt;code&gt;Rc&amp;lt;T&amp;gt;&lt;/code&gt;æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾€å¾€ä½¿ç”¨&lt;code&gt;Arc&amp;lt;T&amp;gt;&lt;/code&gt;ï¼Œå®ƒå®ç°äº†åŸå­çš„å¼•ç”¨è®¡æ•°ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚è¿™2ä¸ªæ™ºèƒ½æŒ‡é’ˆæ˜¯é€šè¿‡ &lt;code&gt;Drop&lt;/code&gt; traitæ¥å®ç°å¼•ç”¨è®¡æ•°çš„å˜æ›´ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;Rc&amp;lt;T&amp;gt;&lt;/code&gt;ä¸&lt;code&gt;Arc&amp;lt;T&amp;gt;&lt;/code&gt;å¦‚æœç›´æ¥åŒ…è£¹å¯¹è±¡ï¼Œé‚£å¯¹è±¡å°±æ˜¯ä¸å¯å˜çš„ï¼Œä¸ºäº†å®ç°å¯å˜å€Ÿç”¨ï¼Œéœ€è¦ä½¿ç”¨&lt;code&gt;RefCell&amp;lt;T&amp;gt;&lt;/code&gt;åŒ…è£¹å¯¹è±¡ï¼Œé€šè¿‡&lt;code&gt;borrow_mut()&lt;/code&gt;æ¥è·å–å¯å˜å€Ÿç”¨ã€‚ç„¶è€Œ&lt;code&gt;RefCell&amp;lt;T&amp;gt;&lt;/code&gt;ä¹Ÿä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨&lt;code&gt;Mutex&amp;lt;T&amp;gt;&lt;/code&gt;æˆ–è€…&lt;code&gt;RWLock&amp;lt;T&amp;gt;&lt;/code&gt;æ¥åŒ…è£¹å¯¹è±¡ï¼Œé€šè¿‡&lt;code&gt;lock()&lt;/code&gt;è·å–å¯å˜å€Ÿç”¨ã€‚&lt;/p&gt;

&lt;p&gt;è¯´å®Œäº†ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€æœ‰æƒï¼Œå€Ÿç”¨ï¼Œæ™ºèƒ½æŒ‡é’ˆï¼Œä¸¾å‡ ä¸ªæˆ‘åœ¨PingSIXä¸­çš„å®é™…ä»£ç ï¼Œæ¥å¸®åŠ©ç†è§£ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;sd&#34;&gt;/// Proxy load balancer.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;///
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Manages the load balancing of requests to upstream servers.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;ProxyUpstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;SelectionLB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Runtime&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Sender&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ProxyUpstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;new_with_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstream&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proxy_upstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Self&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proxy_upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proxy_upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Starts the health check service, runs only once.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;start_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;take_background_service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Create a channel for watching the health check status
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch_tx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch_rx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;channel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch_tx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Determine the number of threads for the service
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Create a runtime based on the work_stealing flag
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;create_runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Spawn the service on the runtime
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;spawn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;move&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start_service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch_rx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Service exited.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Set the runtime lifecycle with ProxyUpstream
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;create_runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service_name&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Runtime&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Runtime&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new_steal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Runtime&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new_no_steal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;stop_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;take&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;ProxyUpstream&lt;/code&gt;æ˜¯åå‘ä»£ç†çš„ä¸Šæ¸¸å¯¹è±¡ï¼Œåœ¨newè¿™ä¸ªå¯¹è±¡çš„åŒæ—¶ä¼šåˆ›å»ºä¸€ä¸ªåå°ä»»åŠ¡æ¥æ‰§è¡Œå¥åº·æ£€æŸ¥ï¼Œå¯ä»¥çœ‹åˆ°å¥åº·æ£€æŸ¥åœ¨è¿™é‡Œæ˜¯é€šè¿‡&lt;code&gt;tokio&lt;/code&gt;çš„&lt;code&gt;Runtime&lt;/code&gt;æ¥æ‰§è¡Œçš„ã€‚åœ¨Golangä¸­æˆ‘å¯èƒ½ä¼šé€šè¿‡&lt;code&gt;go&lt;/code&gt;å…³é”®å­—æ¥åˆ›å»ºä¸€ä¸ªgoroutineæ¥æ‰§è¡Œåå°ä»»åŠ¡å°±ä¸ç®¡äº†ï¼Œç„¶è€Œåœ¨Rustè¿™é‡Œæˆ‘å¿…é¡»åœ¨&lt;code&gt;spawn&lt;/code&gt;åå°ä»»åŠ¡åè®©&lt;code&gt;ProxyUpstream&lt;/code&gt;æŒæœ‰&lt;code&gt;Runtime&lt;/code&gt;çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦åˆ™åå°ä»»åŠ¡ä¼šå› ä¸ºä½œç”¨åŸŸç»“æŸè€Œæå‰é€€å‡ºã€‚åœ¨&lt;code&gt;ProxyUpstream&lt;/code&gt;æŒæœ‰&lt;code&gt;Runtime&lt;/code&gt;åï¼Œåªæœ‰å½“&lt;code&gt;ProxyUpstream&lt;/code&gt;å¯¹è±¡è¢«dropåï¼Œåå°ä»»åŠ¡æ‰ä¼šç»“æŸã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Drop&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ProxyUpstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Stops the health check service if it exists.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;drop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stop_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// ç¡®ä¿å…¶ä»–èµ„æºå¦‚ runtime è¢«é‡Šæ”¾
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;take&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// è·å– runtime çš„ handle
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// ä½¿ç”¨ handler æ‰§è¡Œå…³é—­é€»è¾‘
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;spawn_blocking&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;move&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shutdown_timeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Duration&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;from_secs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Runtime shutdown successfully.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å†æ¥çœ‹çœ‹&lt;code&gt;Drop&lt;/code&gt; traitçš„å®ç°ï¼Œåœ¨&lt;code&gt;ProxyUpstream&lt;/code&gt;å¯¹è±¡è¢«é‡Šæ”¾çš„åŒæ—¶æˆ‘ä»¬å¸Œæœ›åœæ­¢å¥åº·æ£€æŸ¥ï¼Œè¿™ä¸ªæ—¶å€™è¿˜éœ€è¦ä¸»åŠ¨å…³é—­&lt;code&gt;Runtime&lt;/code&gt;ï¼Œå¦åˆ™è¿è¡Œä¸­çš„&lt;code&gt;Runtime&lt;/code&gt;ä¼šå› ä¸ºä½œç”¨åŸŸç»“æŸè€Œpanicã€‚&lt;/p&gt;

&lt;p&gt;å†æ¥çœ‹ä¸€ä¸ªå¯å˜å€Ÿç”¨ä¸ä¸å¯å˜å€Ÿç”¨å†²çªçš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[async_trait]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServeHttp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AdminHttpApp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServerSession&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_keepalive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;validate_api_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;api_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Response&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;FORBIDDEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//   let (path, method) = {
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//       let req_header = http_session.req_header();
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//       (req_header.uri.path().to_string(), req_header.method.clone())
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//   };
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;router&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;BTreeMap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;collect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;etcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Response&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;BAD_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Response&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;METHOD_NOT_ALLOWED&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Response&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;NOT_FOUND&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;b&amp;#34;Not Found&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_vec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;http_session&lt;/code&gt;æ˜¯ä¸€ä¸ªå¯å˜å€Ÿç”¨ï¼Œç„¶ååœ¨è·å–&lt;code&gt;path&lt;/code&gt;ä¸&lt;code&gt;method&lt;/code&gt;æ—¶ï¼Œ&lt;code&gt;http_session&lt;/code&gt;ä¼šå˜æˆä¸å¯å˜å€Ÿç”¨æ¥è°ƒç”¨&lt;code&gt;req_header()&lt;/code&gt;ï¼Œç„¶è€Œåœ¨è·å–&lt;code&gt;path&lt;/code&gt;ä¸&lt;code&gt;method&lt;/code&gt;åï¼Œ&lt;code&gt;http_session&lt;/code&gt;åˆéœ€è¦è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥è¿™é‡ŒåŒæ—¶å­˜åœ¨äº†å¯å˜å€Ÿç”¨ä¸ä¸å¯å˜å€Ÿç”¨ï¼ŒRustç¼–è¯‘å™¨ä¼šæç¤ºé”™è¯¯ã€‚é‚£æ€ä¹ˆä¿®æ”¹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[async_trait]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServeHttp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AdminHttpApp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServerSession&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬ç»™&lt;code&gt;req_header&lt;/code&gt;åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼Œè¿™æ ·&lt;code&gt;http_session&lt;/code&gt;å°±å˜æˆä¸å¯å˜å€Ÿç”¨ï¼Œåœ¨ä½œç”¨åŸŸç»“æŸæ—¶ï¼Œ&lt;code&gt;req_header&lt;/code&gt;ä¹Ÿè·Ÿç€é‡Šæ”¾äº†ã€‚è¿™ç”¨å°±ä¸ä¼šåŒæ—¶å­˜åœ¨å¯å˜å€Ÿç”¨ä¸ä¸å¯å˜å€Ÿç”¨å†²çªäº†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-å‡½æ•°å¼ç¼–ç¨‹&#34;&gt;2. å‡½æ•°å¼ç¼–ç¨‹&lt;/h3&gt;

&lt;p&gt;ä»¥å¾€åœ¨å†™Pythonæˆ–Golangçš„è¿‡ç¨‹ä¸­åŸºæœ¬ä¸Šæ²¡æ€ä¹ˆç”¨åˆ°å‡½æ•°å¼ç¼–ç¨‹ï¼ŒPythonä¸­è™½ç„¶æœ‰mapã€filterç­‰å‡½æ•°ï¼Œä½†æ˜¯ä¹Ÿåªæ˜¯åœ¨ç®€å•çš„åœºæ™¯ä¸‹ä½¿ç”¨ã€‚è€ŒRustä¸­å‡½æ•°å¼ç¼–ç¨‹æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå®ƒè®©ä»£ç æ›´ç®€æ´ã€æ›´ä¼˜é›…ã€‚åœ¨å†™PingSIXçš„è¿‡ç¨‹ä¸­ï¼Œåˆšå¼€å§‹æˆ‘ä¹Ÿæ²¡æ€ä¹ˆç”¨åˆ°å‡½æ•°å¼ç¼–ç¨‹ï¼Œä¸€ç›´å°±å¼è€è€å®å®çš„if elseï¼Œmatchç­‰ç­‰ã€‚è¿™æ ·ä»£ç å…¶å®ä¹Ÿæ²¡é—®é¢˜ï¼Œä½†æ˜¯ä¼šè®©ä»£ç çœ‹èµ·æ¥å¾ˆé•¿ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠæˆ‘çš„ä»£ç å¸–åˆ°ChatGPTé—®é—®å®ƒå¦‚ä½•èƒ½è®©ä»£ç æ›´åŠ ç®€æ´ï¼Œå°±æœ‰äº†ä¸‹é¢çš„è¿™äº›ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;validate_upstream_host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ValidationError&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pass_host&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamPassHost&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;REWRITE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstream_host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;map_or_else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ValidationError&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;upstream_host_required_for_rewrite&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(()),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç®€å•æ˜¯å¦ä¸º&lt;code&gt;Option&lt;/code&gt;çš„åˆ¤æ–­ï¼Œå¦‚æœä¸º&lt;code&gt;None&lt;/code&gt;åˆ™è¿”å›é”™è¯¯ï¼Œå¦åˆ™è¿”å›&lt;code&gt;Ok(())&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[async_trait]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServiceDiscovery&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DnsDiscovery&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Discovers backends by resolving DNS names to IP addresses.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;discover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BTreeSet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Backend&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HashMap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Resolving DNS for domain: {}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backends&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;BTreeSet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Backend&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resolver&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_ip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;or_err_with&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;InternalError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;DNS discovery failed for domain: {}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SocketAddr&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Creating backend
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Backend&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new_with_weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Determine if TLS is needed
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamScheme&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamScheme&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;GRPCS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Create HttpPeer
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HttpPeer&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamScheme&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;GRPC&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamScheme&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;GRPCS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alpn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ALPN&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;H2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Insert HttpPeer into the backend
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;assert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;insert&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HttpPeer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_none&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;collect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Return backends and an empty HashMap for now
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backends&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HashMap&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸²DNSè§£æä¸è½¬æ¢çš„ä»£ç ï¼Œè¯´å®è¯æˆ‘çš„è„‘å­é‡Œè¿˜æ²¡å½¢æˆè¿™ç§å‡½æ•°å¼ç¼–ç¨‹çš„å®šå¼æ€ç»´ï¼Œè™½ç„¶æˆ‘çœ‹çš„æ‡‚ï¼Œä½†æ˜¯çœŸæ­£å†™çš„æ—¶å€™æˆ‘è¿˜æ˜¯ä¸ä¼šç›´æ¥æƒ³åˆ°è¿™ä¹ˆå†™ï¼Œå¹¸å¥½æœ‰ChatGPTå¸®æˆ‘è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚æˆ‘æƒ³å†™çš„è¶Šå¤šä¹Ÿå°±è¶Šç†Ÿæ‚‰äº†å§ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-å¤šæ€&#34;&gt;3. å¤šæ€&lt;/h3&gt;

&lt;p&gt;åœ¨Rusté‡Œé¢å†™å¤šæ€æœ‰2ä¸­é€‰æ‹©ï¼Œä¸€ç§ä½¿ç”¨traitï¼Œä¸€ç§æ˜¯ç”¨enumï¼Œæˆ‘ä»¬åˆ†åˆ«æ¥çœ‹ä¸‹ã€‚&lt;/p&gt;

&lt;h4 id=&#34;enum&#34;&gt;enum&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;enum&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;SelectionLB&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Fnv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FVNHash&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ketama&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;KetamaHashing&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TryFrom&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;SelectionType&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;SelectionType&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;SelectionType&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Fnv&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Fnv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FVNHash&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;SelectionType&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Ketama&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Ketama&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;KetamaHashing&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªåŒ…è£…äº†å¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•çš„æšä¸¾ï¼Œåœ¨&lt;code&gt;try_from()&lt;/code&gt;æ–¹æ³•ä¸­æ ¹æ®ä¸åŒçš„ç±»å‹åˆ›å»ºå¯¹åº”çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚åœ¨ä½¿ç”¨æ—¶ï¼Œæˆ‘éœ€è¦æ ¹æ®ä¸åŒenumçš„variantè¿›è¡Œmatchï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ProxyUpstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Selects a backend server for a given session.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;select_backend&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Backend&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;request_selector_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hash_on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;proxy lb key: {}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstreams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstreams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Fnv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstreams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Ketama&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstreams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_mut&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HttpPeer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_timeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥éšè—ä¸åŒè´Ÿè½½å‡è¡¡ç®—æ³•çš„ç»†èŠ‚ï¼Œå¯¹å¤–æä¾›ç»Ÿä¸€çš„è°ƒç”¨å…¥å£æ¥å®ç°å¤šæ€ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨Pingoraä¸­å¤„ç†http1ä¸http2çš„å·®å¼‚æ—¶ä¹Ÿä½¿ç”¨enumæ¥å®ç°å¤šæ€ã€‚&lt;/p&gt;

&lt;h4 id=&#34;trait&#34;&gt;trait&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;sd&#34;&gt;/// Hybrid service discovery.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;///
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Combines static and DNS-based service discovery.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[derive(Default)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;HybridDiscovery&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;discoveries&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServiceDiscovery&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸ºäº†åŒ…è£…DNSçš„æœåŠ¡å‘ç°ä¸é™æ€æœåŠ¡å‘ç°ï¼Œæˆ‘å®šä¹‰äº†&lt;code&gt;HybridDiscovery&lt;/code&gt;åŒæ—¶å¤„ç†è¿™ä¸¤ç§æœåŠ¡å‘ç°ï¼Œå®ƒæŒæœ‰ä¸€ä¸ª&lt;code&gt;Vec&amp;lt;Box&amp;lt;dyn ServiceDiscovery + Send + Sync&amp;gt;&amp;gt;&lt;/code&gt;çš„æˆå‘˜å˜é‡ã€‚è¿™é‡Œé€šè¿‡BoxåŒ…è£¹çš„trait objectæ¥å®ç°å¤šæ€ã€‚å½“ç„¶ä¸ºäº†æ”¯æŒasync traitï¼Œè¿˜è¦åŠ ä¸Š&lt;code&gt;Send + Sync&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-å±€éƒ¨å¯å˜æ€§&#34;&gt;4. å±€éƒ¨å¯å˜æ€§&lt;/h3&gt;

&lt;p&gt;åœ¨æˆ‘ä½¿ç”¨etcdæ¥å®ç°PingSixçš„èµ„æºå®æ—¶åŠ è½½æ—¶ï¼Œé‡åˆ°äº†è¿™æ ·çš„é—®é¢˜ï¼Œå¯¹etcd clientçš„ä½¿ç”¨å¿…é¡»æ˜¯mutçš„ï¼Œä½†æ˜¯æŒæœ‰etcd clientçš„å¯¹è±¡åˆæ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±å¿…é¡»åŒ…è£…å‡ºå±€éƒ¨å¯å˜çš„etcd clientï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;EtcdClientWrapper&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Etcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Arc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Mutex&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Client&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EtcdClientWrapper&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cfg&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Etcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;cfg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Arc&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Mutex&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;ensure_connected&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Arc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Mutex&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Client&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_none&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Creating new etcd client...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;create_client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ensure_connected&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ok_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Etcd client is not initialized&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;with_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kvs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kv&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_vec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ensure_connected&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ok_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Etcd client is not initialized&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;with_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ensure_connected&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ok_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Etcd client is not initialized&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;with_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;with_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;{}/{}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å°±å¦‚æˆ‘åœ¨ç¬¬ä¸€èŠ‚çš„ç”Ÿå‘½å‘¨æœŸä¸­æ‰€è¯´çš„ï¼Œä¸ºäº†å±€éƒ¨å¯å˜ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨Arc&lt;Mutex&gt;åŒ…è£¹ï¼Œè¿™æ ·åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥é€šè¿‡lock()æ¥è·å–å¯å˜å¼•ç”¨ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;åœ¨å†™PingSIXä¹‹å‰ï¼Œæˆ‘å†™è¿‡ä¸€äº›Rustçš„å°é¡¹ç›®ï¼Œæ¯”å¦‚ä¸€äº›httpæ¥å£çš„è°ƒç”¨ï¼Œæ¯”å¦‚ä¸€äº›TCPåè®®çš„è§£æã€‚ä½†æ˜¯éƒ½æ²¡æœ‰ç³»ç»Ÿæ€§çš„æ¥ä½¿ç”¨Rustï¼Œæ‰€ä»¥ä¸€ç›´æœ‰è®¡åˆ’ç”¨Rustæ¥å†™ä¸€ä¸ªAPIç½‘å…³ï¼Œç„¶åè¿™ä¸€ä¸ªå¤šæœˆä¸‹æ¥ï¼Œæˆ‘å¯¹Rustå¯ä»¥è¯´æœ‰äº†ä¸€å®šçš„ç†è§£å§ï¼Œè™½ç„¶åƒ&lt;code&gt;Send + Sync&lt;/code&gt;è¿™ç§ä¸œè¥¿è¿˜æ˜¯ä¸å¤ªç†è§£ï¼Œä½†æ˜¯è‡³å°‘çŸ¥é“æ€ä¹ˆç”¨äº†ã€‚åœ¨æ¯”å¦‚åƒ&lt;code&gt;FnOnce&lt;/code&gt;ï¼Œè¿˜æœ‰&lt;code&gt;Pin&lt;/code&gt;è¿™äº›ä¹Ÿéƒ½è¿˜ä¸å¤ªäº†è§£ï¼Œä½†æ˜¯å¯ä»¥è¯´ç°åœ¨ç”¨Rustå†™ç‚¹é¡¹ç›®è¿˜æ˜¯å¯ä»¥çš„ã€‚&lt;/p&gt;

&lt;p&gt;PingSIXè™½ç„¶åªå®ç°äº†APISIXçš„ä¸€ä¸ªå­é›†ï¼Œæœ‰å¾ˆå¤šåŠŸèƒ½çš„ç¼ºå¤±ï¼Œæ¯”å¦‚è¢«åŠ¨çš„å¥åº·æ£€æŸ¥ï¼ŒåŠ¨æ€çš„TLSæ”¯æŒï¼Œè¿˜æœ‰å¾ˆå¤šæ’ä»¶ç­‰ï¼Œä½†æ˜¯å¤§çš„æ¡†æ¶å…¶å®å·²ç»æ­å¥½äº†ï¼Œå‰©ä¸‹çš„å…¶å®éƒ½æ˜¯ä½“åŠ›æ´»äº†ã€‚æ‰€ä»¥æš‚æ—¶å…ˆå‘Šä¸€æ®µè½å§ã€‚&lt;/p&gt;

&lt;p&gt;é€šè¿‡è¿™ä¸ªé¡¹ç›®æˆ‘å¯¹Pingoraçš„å„ä¸ªcrateéƒ½æœ‰äº†æ·±åº¦ä½¿ç”¨ï¼Œå½“ç„¶è¿˜æœ‰ä¸€äº›åŠŸèƒ½ä¹Ÿæ˜¯æ²¡æœ‰è¦†ç›–åˆ°ï¼Œæ¯”å¦‚ä¸‹é¢çš„è¿™äº›ï¼š&lt;/p&gt;

&lt;p&gt;dynamic sslï¼š&lt;a href=&#34;https://github.com/cloudflare/pingora/blob/main/pingora/examples/server.rs#L77&#34;&gt;https://github.com/cloudflare/pingora/blob/main/pingora/examples/server.rs#L77&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;cacheï¼š&lt;a href=&#34;https://github.com/cloudflare/pingora/blob/main/pingora-proxy/tests/utils/server_utils.rs#L393&#34;&gt;https://github.com/cloudflare/pingora/blob/main/pingora-proxy/tests/utils/server_utils.rs#L393&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è¿™äº›éƒ½è¿˜æ²¡æœ‰æ–‡æ¡£ï¼Œæ‰€ä»¥æš‚æ—¶å…ˆä¸æäº†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å¼€å‘è¿™ä¸ªé¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘é¢‘ç¹ä½¿ç”¨ChatGPTï¼Œæ·±åˆ»çš„æ„Ÿå—åˆ°ChatGPTå¯¹äºç¨‹åºå‘˜çš„æ•ˆç‡çš„æå‡ï¼Œé¡¹ç›®ä¸­çš„æ‰€æœ‰ä»£ç éƒ½ç»è¿‡äº†ChatGPTçš„Reviewï¼ŒAIä¸ä¼šæ·˜æ±°ç¨‹åºå‘˜ï¼Œåªä¼šæ·˜æ±°ä¸ä¼šä½¿ç”¨AIçš„ç¨‹åºå‘˜ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ä»Pingoraåˆ°APIç½‘å…³ï¼šRustå®æˆ˜</title>
      <link>https://zhu327.github.io/2024/11/15/%E4%BB%8Epingora%E5%88%B0api%E7%BD%91%E5%85%B3rust%E5%AE%9E%E6%88%98/</link>
      <pubDate>Fri, 15 Nov 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/11/15/%E4%BB%8Epingora%E5%88%B0api%E7%BD%91%E5%85%B3rust%E5%AE%9E%E6%88%98/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;åœ¨å­¦ä¹ Rustçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¸»è¦è¿›è¡Œäº†ä¸€äº›å°å·¥å…·çš„ç»ƒä¹ ï¼Œå¯¹Rustçš„å†…å­˜å®‰å…¨æ€§å’Œæ€§èƒ½ä¼˜åŠ¿æœ‰äº†åˆæ­¥çš„ä½“ä¼šï¼Œä½†å§‹ç»ˆæ²¡æœ‰å®ç°è¿‡ä¸€ä¸ªå®Œæ•´çš„å¤§å‹é¡¹ç›®ã€‚æœ€è¿‘éšç€Ruståœ¨é«˜æ€§èƒ½è®¡ç®—é¢†åŸŸçš„åº”ç”¨ä¸æ–­æ‹“å±•ï¼Œå°¤å…¶æ˜¯Pingoraç­‰é¡¹ç›®çš„å‘å¸ƒï¼Œè®©æˆ‘çœ‹åˆ°äº†Ruståœ¨ç½‘ç»œé€šä¿¡é¢†åŸŸä¸­çš„æ½œåŠ›ï¼Œä¹Ÿæ¿€å‘äº†æˆ‘ç”¨Rustæ¥å®ç°ä¸€ä¸ªAPIç½‘å…³çš„å…´è¶£ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨åŠ å…¥è…¾è®¯ä¹‹å‰ï¼Œæˆ‘æ›¾ä½¿ç”¨OpenRestyå’ŒKongè¿›è¡ŒAPIç½‘å…³çš„å¼€å‘å·¥ä½œï¼Œåæ¥åœ¨è…¾è®¯è¿›ä¸€æ­¥æ·±å…¥å‚ä¸äº†APISixçš„äº‘åŸç”Ÿç½‘å…³é¡¹ç›®ï¼Œé€æ­¥ç§¯ç´¯äº†å…³äºAPIç½‘å…³è®¾è®¡ã€å®ç°ä»¥åŠæ€§èƒ½è°ƒä¼˜æ–¹é¢çš„ç»éªŒã€‚APIç½‘å…³æ˜¯ä¸€ä¸ªå…¼å…·æ¶æ„å¤æ‚åº¦ä¸æ€§èƒ½è¦æ±‚çš„ç³»ç»Ÿï¼Œæ¶‰åŠè¯·æ±‚è·¯ç”±ã€æµé‡æ§åˆ¶ã€èº«ä»½éªŒè¯ç­‰å¤šä¸ªå…³é”®æ¨¡å—ï¼Œæ°å¥½å¯ä»¥å……åˆ†å‘æŒ¥Rustçš„ä¼˜åŠ¿ã€‚å› æ­¤ï¼Œæˆ‘å†³å®šä»¥Rustä¸ºåŸºç¡€å¼€å‘ä¸€ä¸ªAPIç½‘å…³ï¼Œè¿™ä¸ä»…æ˜¯ä¸ºäº†æå‡è‡ªå·±çš„RustæŠ€æœ¯ï¼Œæ›´å¸Œæœ›é€šè¿‡æ­¤é¡¹ç›®è¿›ä¸€æ­¥å·©å›ºå’Œæå‡åœ¨APIç½‘å…³æ–¹é¢çš„çŸ¥è¯†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å…·ä½“å®ç°ä¸­ï¼Œæˆ‘è®¡åˆ’åŸºäºPingoraçš„è®¾è®¡æ€è·¯ï¼Œæ‰“é€ ä¸€ä¸ªAPISixç½‘å…³çš„å­é›†åŠŸèƒ½ã€‚æˆ‘å·²åœ¨GitHubä¸Šå‘å¸ƒäº†è¯¥é¡¹ç›®çš„åˆå§‹ç‰ˆæœ¬ &lt;a href=&#34;https://github.com/zhu327/pingsix&#34;&gt;https://github.com/zhu327/pingsix&lt;/a&gt;ï¼Œç›®å‰å®ç°äº†åŸºç¡€çš„standaloneæ¨¡å¼ï¼ŒåŒ…æ‹¬åŸºæœ¬çš„è·¯ç”±ä¸åå‘ä»£ç†åŠŸèƒ½ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°†æ‰©å±•æ’ä»¶å®šä¹‰ï¼Œé€æ­¥å®ç°ä¸€äº›å…¸å‹çš„åŠŸèƒ½æ’ä»¶ï¼Œæœ€ç»ˆç›®æ ‡æ˜¯æ”¯æŒåŸºäºetcdçš„åŠ¨æ€é…ç½®åŠ è½½ï¼Œä»¥ä¾¿é€‚åº”å¤šåœºæ™¯çš„APIç½‘å…³éœ€æ±‚ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;å®ç°-é…ç½®&#34;&gt;å®ç°ï¼šé…ç½®&lt;/h3&gt;

&lt;p&gt;åœ¨è®¾è®¡ pingsix çš„é…ç½®æ–‡ä»¶æ—¶ï¼Œæˆ‘å‚è€ƒäº† APISix å’Œ Pingora çš„é…ç½®æ–‡ä»¶ç»“æ„ï¼Œç»“åˆè‡ªèº«é¡¹ç›®ç›®æ ‡å’ŒåŠŸèƒ½ï¼Œç®€åŒ–äº†éƒ¨åˆ†å¤æ‚å†…å®¹ï¼ŒåŒæ—¶ä¿æŒäº†æ ¸å¿ƒåŠŸèƒ½çš„çµæ´»æ€§ã€‚é…ç½®æ–‡ä»¶åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªå…³é”®éƒ¨åˆ†ï¼š&lt;strong&gt;åŸºç¡€é…ç½®&lt;/strong&gt;ã€&lt;strong&gt;Listener é…ç½®&lt;/strong&gt; å’Œ &lt;strong&gt;èµ„æºé…ç½®&lt;/strong&gt;ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†è¯´æ˜ä¸å®Œæ•´ YAML ç¤ºä¾‹ã€‚&lt;/p&gt;

&lt;h4 id=&#34;1-åŸºç¡€é…ç½®&#34;&gt;1. åŸºç¡€é…ç½®&lt;/h4&gt;

&lt;p&gt;åŸºç¡€é…ç½®éƒ¨åˆ†ç›´æ¥æ²¿ç”¨äº† Pingora çš„è®¾è®¡ï¼Œç”¨äºå®šä¹‰ç½‘å…³çš„å…¨å±€è¡Œä¸ºå’Œè¿è¡Œå‚æ•°ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´é…ç½®ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;c&#34;&gt;# pingora config example from https://github.com/cloudflare/pingora/blob/main/docs/user_guide/conf.md&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;pingora&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;version&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# é…ç½®æ–‡ä»¶ç‰ˆæœ¬&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;threads&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å·¥ä½œçº¿ç¨‹æ•°é‡&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;pid_file&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/run/pingora.pid&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä¿å­˜è¿›ç¨‹IDçš„æ–‡ä»¶è·¯å¾„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;upgrade_sock&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/tmp/pingora_upgrade.sock&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# çƒ­å‡çº§ç”¨çš„Unix socketæ–‡ä»¶&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;user&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;nobody&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿è¡Œç½‘å…³çš„ç”¨æˆ·&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;group&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;webusers&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿è¡Œç½‘å…³çš„ç”¨æˆ·ç»„&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;è®¾è®¡æ€è·¯&lt;/strong&gt;ï¼šè¿™ä¸€éƒ¨åˆ†é…ç½®æ˜¯ç½‘å…³è¿è¡Œæ—¶çš„åŸºç¡€ï¼Œä¿æŒç®€æ´çš„åŒæ—¶ï¼Œä¸ Pingora é…ç½®å®Œå…¨å…¼å®¹ï¼Œé™ä½äº†é…ç½®çš„å­¦ä¹ æˆæœ¬ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;2-listener-é…ç½®&#34;&gt;2. Listener é…ç½®&lt;/h4&gt;

&lt;p&gt;Listener æ˜¯ API ç½‘å…³çš„å…¥å£ï¼Œç”¨äºå®šä¹‰ç½‘å…³ç›‘å¬çš„åœ°å€ã€ç«¯å£ä»¥åŠåè®®ç±»å‹ï¼ˆHTTP/HTTPSï¼‰ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´é…ç½®ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;listeners&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;-&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;address&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.0&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# HTTPç›‘å¬åœ°å€å’Œç«¯å£&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# - address: &amp;#34;[::1]:443&amp;#34;  # ç¤ºä¾‹ï¼šIPv6åœ°å€ç›‘å¬&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   tls:                  # é…ç½®HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#     cert_path: /etc/ssl/server.crt # SSLè¯ä¹¦è·¯å¾„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#     key_path: /etc/ssl/server.key  # SSLç§é’¥è·¯å¾„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   offer_h2: true         # æ˜¯å¦æ”¯æŒHTTP/2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;è®¾è®¡æ€è·¯&lt;/strong&gt;ï¼š
- å½“å‰æ”¯æŒ HTTP å’Œ HTTPS åè®®ï¼Œé€šè¿‡é…ç½® &lt;code&gt;tls&lt;/code&gt; å‚æ•°æ¥å¼€å¯ HTTPSã€‚ æœªæ¥å¯èƒ½åŠ å…¥ç±»ä¼¼ APISix çš„ &lt;code&gt;Stream Proxy&lt;/code&gt; åŠŸèƒ½ï¼Œç”¨äºæ”¯æŒ TCP/UDP æµé‡ä»£ç†ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;3-èµ„æºé…ç½®&#34;&gt;3. èµ„æºé…ç½®&lt;/h4&gt;

&lt;p&gt;èµ„æºé…ç½®æ˜¯ç½‘å…³çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œä¸»è¦å®šä¹‰è·¯ç”±è§„åˆ™ï¼ˆRouterï¼‰å’Œåç«¯æœåŠ¡ï¼ˆUpstreamï¼‰çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚ç›®å‰ pingsix æ”¯æŒçš„åŠŸèƒ½å­é›†ä»¥å®ç°åå‘ä»£ç†ä¸ºä¸»ï¼Œä»¥ä¸‹æ˜¯å®Œæ•´ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;c&#34;&gt;# å‚è€ƒAPISixçš„Standaloneæ¨¡å¼é…ç½®ç¤ºä¾‹ï¼šhttps://apisix.apache.org/zh/docs/apisix/3.1/stand-alone/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å®Œæ•´çš„Routerï¼ŒUpstreamé…ç½®å‚è€ƒAPISixçš„APIæ–‡æ¡£ï¼šhttps://apisix.apache.org/zh/docs/apisix/admin-api/#route&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;routers&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;-&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                     &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è·¯ç”±å”¯ä¸€æ ‡è¯†&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;uri&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è·¯ç”±åŒ¹é…çš„URI&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;host&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;www.baidu.com&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# åŒ¹é…çš„ä¸»æœº&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¯é€‰é¡¹ï¼š&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# uris: [&amp;#34;/&amp;#34;,&amp;#34;/test&amp;#34;]     # æ”¯æŒå¤šä¸ªURIåŒ¹é…&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# hosts: [&amp;#34;www.baidu.com&amp;#34;,&amp;#34;www.taobao.com&amp;#34;] # æ”¯æŒå¤šä¸ªHoståŒ¹é…&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# methods: [&amp;#34;GET&amp;#34;, &amp;#34;POST&amp;#34;] # é™åˆ¶è¯·æ±‚æ–¹æ³•&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# timeout:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   connect: 2           # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   send: 3              # å‘é€è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   read: 5              # è¯»å–è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# priority: 10           # è·¯ç”±ä¼˜å…ˆçº§ï¼ˆæ•°å­—è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;upstream&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å®šä¹‰åç«¯æœåŠ¡&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;nodes&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;www.baidu.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# åç«¯æœåŠ¡åœ°å€åŠæƒé‡&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;type&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;roundrobin&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è´Ÿè½½å‡è¡¡ç±»å‹ï¼ˆæ”¯æŒroundrobinã€randomç­‰ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;checks&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æ£€æŸ¥é…ç½®&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;active&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä¸»åŠ¨å¥åº·æ£€æŸ¥&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;type&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;https&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ£€æŸ¥ç±»å‹ï¼ˆhttp/httpsï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;timeout&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æ£€æŸ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;host&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;www.baidu.com&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ£€æŸ¥ç›®æ ‡ä¸»æœº&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;http_path&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æ£€æŸ¥è·¯å¾„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;https_verify_certificate&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ˜¯å¦éªŒè¯HTTPSè¯ä¹¦&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;req_headers&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;User-Agent: curl/7.29.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¯·æ±‚å¤´&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;healthy&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æœåŠ¡çš„æ ‡å‡†&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;interval&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æ£€æŸ¥é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;http_statuses&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;201&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# åˆ¤æ–­å¥åº·çš„HTTPçŠ¶æ€ç &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;successes&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿ç»­æˆåŠŸæ¬¡æ•°&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;unhealthy&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä¸å¥åº·æœåŠ¡çš„æ ‡å‡†&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;http_failures&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿ç»­å¤±è´¥çš„HTTPè¯·æ±‚æ¬¡æ•°&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;tcp_failures&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿ç»­å¤±è´¥çš„TCPè¯·æ±‚æ¬¡æ•°&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;pass_host&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;rewrite&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ˜¯å¦é€ä¼ ä¸»æœºä¿¡æ¯&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;upstream_host&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;www.baidu.com&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä¼ é€’ç»™åç«¯çš„Host&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;scheme&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;https&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä½¿ç”¨çš„åè®®ï¼ˆhttp/httpsï¼‰&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;ï¼š
- &lt;strong&gt;Router&lt;/strong&gt; å®šä¹‰äº†è¯·æ±‚çš„è·¯ç”±è§„åˆ™ï¼Œç›®å‰æ”¯æŒ &lt;code&gt;uri&lt;/code&gt; å’Œ &lt;code&gt;host&lt;/code&gt; çš„åŒ¹é…ï¼Œè¿˜å¯ä»¥æ‰©å±•æ”¯æŒ &lt;code&gt;methods&lt;/code&gt;ã€&lt;code&gt;priority&lt;/code&gt; ç­‰å‚æ•°ã€‚
- &lt;strong&gt;Upstream&lt;/strong&gt; é…ç½®æ”¯æŒè´Ÿè½½å‡è¡¡å’Œå¥åº·æ£€æŸ¥ï¼Œæ”¯æŒé…ç½®å„ç§å¤æ‚å‡è¡¡ç®—æ³•ï¼Œè¿˜æ”¯æŒä¸»åŠ¨å¥åº·æ£€æŸ¥ã€‚&lt;/p&gt;

&lt;p&gt;å¯ä»¥åœ¨ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/config.yaml&#34;&gt;GitHub&lt;/a&gt; æŸ¥çœ‹å®Œæ•´çš„é…ç½®æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;4-é…ç½®åŠ è½½&#34;&gt;4. é…ç½®åŠ è½½&lt;/h4&gt;

&lt;p&gt;åœ¨ pingsix ä¸­ï¼Œé…ç½®åŠ è½½çš„å®ç°æ–¹å¼ä¸ Pingora å®Œå…¨å…¼å®¹ï¼Œä¸»è¦é€šè¿‡å¤ç”¨ Pingora çš„å‘½ä»¤è¡Œè§£æå’Œé…ç½®åŠ è½½ä»£ç æ¥å®Œæˆã€‚è¿™äº›ä»£ç å¤§éƒ¨åˆ†æ˜¯ç›´æ¥å€Ÿé‰´äº† Pingora çš„å®ç°ï¼Œå¹¶æ ¹æ® pingsix çš„éœ€æ±‚åšäº†ä¸€äº›ç®€å•çš„è°ƒæ•´å’Œä¼˜åŒ–ã€‚&lt;/p&gt;

&lt;h5 id=&#34;ä¸»è¦æ”¹è¿›&#34;&gt;ä¸»è¦æ”¹è¿›ï¼š&lt;/h5&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;serde&lt;/code&gt; è¿›è¡Œé…ç½®è§£æ&lt;/strong&gt;ï¼šé…ç½®æ–‡ä»¶ä»ç„¶é‡‡ç”¨ YAML æ ¼å¼ï¼Œä½¿ç”¨ &lt;code&gt;serde_yaml&lt;/code&gt; åº“è¿›è¡Œè§£æã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®æ ¡éªŒ&lt;/strong&gt;ï¼šä¸ºäº†ç¡®ä¿é…ç½®çš„æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬å¼•å…¥äº† &lt;code&gt;validator&lt;/code&gt; crateï¼Œå¯¹é…ç½®é¡¹è¿›è¡Œç®€å•çš„æ ¡éªŒï¼Œç¡®ä¿å®ƒä»¬ç¬¦åˆé¢„æœŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤å€¼å’Œæ‹·è´&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;serde&lt;/code&gt; çš„ &lt;code&gt;default&lt;/code&gt; ç‰¹æ€§ç®€åŒ–äº†é»˜è®¤å€¼çš„å¤„ç†ï¼Œä½¿ç”¨ &lt;code&gt;Clone&lt;/code&gt; derive ç‰¹æ€§å®ç°äº†é…ç½®çš„æ‹·è´ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;é…ç½®åŠ è½½å®ç°&#34;&gt;é…ç½®åŠ è½½å®ç°&lt;/h5&gt;

&lt;p&gt;é…ç½®çš„åŠ è½½æµç¨‹å’Œ Pingora åŸºæœ¬ä¸€è‡´ï¼Œä»£ç ç»“æ„ä¹Ÿä¸ Pingora ç›¸ä¼¼ã€‚æˆ‘ä»¬é¦–å…ˆè¯»å– YAML é…ç½®æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ &lt;code&gt;serde_yaml&lt;/code&gt; è¿›è¡Œè§£æï¼Œæœ€åä½¿ç”¨ &lt;code&gt;validator&lt;/code&gt; æ ¡éªŒé…ç½®é¡¹çš„åˆæ³•æ€§ã€‚&lt;/p&gt;

&lt;p&gt;å…·ä½“çš„å®ç°å¯ä»¥å‚è€ƒ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/config/mod.rs&#34;&gt;pingsix çš„é…ç½®åŠ è½½ä»£ç &lt;/a&gt;ï¼Œè¯¥æ–‡ä»¶å±•ç¤ºäº†é…ç½®è§£æã€æ ¡éªŒå’Œé»˜è®¤å€¼å¤„ç†çš„å®ç°æ–¹å¼ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å®ç°-ä¸Šæ¸¸&#34;&gt;å®ç°ï¼šä¸Šæ¸¸&lt;/h3&gt;

&lt;p&gt;ä» APISix çš„ä¸Šæ¸¸é…ç½®åŠŸèƒ½å¯ä»¥çœ‹å‡ºï¼Œç½‘å…³çš„ä¸Šæ¸¸æ¨¡å—éœ€è¦å…·å¤‡ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;DNS è§£æ&lt;/strong&gt;ï¼šæ”¯æŒä¸Šæ¸¸æœåŠ¡çš„åŸŸåè§£æã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡ç®—æ³•&lt;/strong&gt;ï¼šæ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•å’Œè‡ªå®šä¹‰ hash keyã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¥åº·æ£€æŸ¥&lt;/strong&gt;ï¼šå®ç°ä¸»åŠ¨å¥åº·æ£€æŸ¥ï¼Œç¡®ä¿ä¸Šæ¸¸æœåŠ¡çš„å¯ç”¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶ä¸é‡è¯•é…ç½®&lt;/strong&gt;ï¼šä¸ºè¿æ¥ã€å‘é€å’Œè¯»å–è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¹¶åœ¨è¯·æ±‚å¤±è´¥æ—¶è¿›è¡Œé‡è¯•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åè®®æ”¯æŒ&lt;/strong&gt;ï¼šæ”¯æŒ HTTP å’Œ HTTPS ä¸Šæ¸¸åè®®ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;ä¸Šæ¸¸æ¨¡å—å®ç°ç»“æ„&#34;&gt;ä¸Šæ¸¸æ¨¡å—å®ç°ç»“æ„&lt;/h4&gt;

&lt;p&gt;æ ¹æ® Pingora çš„æŠ½è±¡è®¾è®¡ï¼Œæˆ‘ä»¬å°†ä¸Šæ¸¸å¤„ç†æ‹†åˆ†ä¸ºä¸¤ä¸ªä¸»è¦æ¨¡å—ï¼Œåˆ†åˆ«è´Ÿè´£æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;æœåŠ¡å‘ç°æ¨¡å—&lt;/strong&gt;&lt;br /&gt;
æœåŠ¡å‘ç°æ¨¡å—ä½äº &lt;code&gt;discovery.rs&lt;/code&gt;ï¼Œæ”¯æŒé™æ€ IP é…ç½®ã€åŸŸå DNS è§£æï¼Œå¹¶å…è®¸ HTTP/HTTPS æ··åˆé…ç½®ã€‚è¯¦æƒ…è§ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/proxy/discovery.rs&#34;&gt;discovery.rs æºç &lt;/a&gt;ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡æ¨¡å—&lt;/strong&gt;&lt;br /&gt;
è´Ÿè½½å‡è¡¡æ¨¡å—ä½äº &lt;code&gt;lb.rs&lt;/code&gt;ï¼Œæ”¯æŒ roundrobinã€randomã€fnvhash å’Œ ketama ç­‰ç®—æ³•ï¼Œå¹¶æŒ‰ç…§ APISix å®ç°äº†éƒ¨åˆ†åŸºäº &lt;code&gt;vars&lt;/code&gt;ã€&lt;code&gt;header&lt;/code&gt; å’Œ &lt;code&gt;cookie&lt;/code&gt; çš„ hash è®¡ç®—ã€‚è´Ÿè½½å‡è¡¡æ¨¡å—å¯æ‰©å±•ä¸åŒçš„ hash key ç±»å‹ã€‚æ›´å¤šå®ç°ç»†èŠ‚è§ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/proxy/lb.rs&#34;&gt;lb.rs æºç &lt;/a&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;å®ç°å¿ƒå¾—&#34;&gt;å®ç°å¿ƒå¾—&lt;/h4&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;å¤šæ€è®¾è®¡&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;enum&lt;/code&gt; å®ç°è´Ÿè½½å‡è¡¡ç®—æ³•çš„å¤šæ€æ€§ï¼Œå°†ä¸åŒç®—æ³•çš„å·®å¼‚å°è£…åœ¨æ¨¡å—å†…ï¼Œä¾¿äºè°ƒç”¨å’Œæ‰©å±•ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;é…ç½®è½¬æ¢ç®€åŒ–&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;From&lt;/code&gt; trait å°†é…ç½®ç»“æ„è½¬æ¢ä¸ºä¸šåŠ¡å¯¹è±¡ï¼Œç®€åŒ–ä»£ç ï¼Œæé«˜å¯è¯»æ€§ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;å¥åº·æ£€æŸ¥é›†æˆ&lt;/strong&gt;ï¼šPingora çš„å¥åº·æ£€æŸ¥é€»è¾‘ä¸ä¸Šæ¸¸ç»‘å®šåœ¨ä¸€èµ·ï¼Œè€Œå¥åº·æ£€æŸ¥åå°æœåŠ¡éœ€è¦åœ¨ server å¯åŠ¨æ—¶æ³¨å…¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨ä¸Šå±‚ç»“æ„ä¸­å°†ä¸Šæ¸¸å’Œå¥åº·æ£€æŸ¥é€»è¾‘ç»‘å®šï¼Œé€šè¿‡ &lt;code&gt;Option&lt;/code&gt; çµæ´»æ§åˆ¶å…¶ç”Ÿå‘½å‘¨æœŸã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä»¥ä¸Šå®ç°æ–¹æ³•ç¡®ä¿äº†ä»£ç ç»“æ„çš„ç®€æ´æ€§å’Œæ¨¡å—çš„å¯å¤ç”¨æ€§ï¼Œå»ºè®®é˜…è¯»ç›¸å…³æºç è¿›ä¸€æ­¥äº†è§£å®ç°ç»†èŠ‚ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å®ç°-è·¯ç”±&#34;&gt;å®ç°ï¼šè·¯ç”±&lt;/h3&gt;

&lt;p&gt;è·¯ç”±æ¨¡å—å‚è€ƒäº† &lt;a href=&#34;https://github.com/apache/apisix/tree/master/apisix/http/router&#34;&gt;APISix çš„ radixtree_host_uri è·¯ç”±æ–¹å¼&lt;/a&gt;ï¼Œé€šè¿‡ &lt;code&gt;host&lt;/code&gt; å’Œ &lt;code&gt;uri&lt;/code&gt; çš„ç»„åˆå®ç°é«˜æ•ˆçš„è·¯ç”±åŒ¹é…ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ pingsix ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Rust çš„ &lt;code&gt;matchit&lt;/code&gt; crateï¼Œè¿™æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ Radix Tree è·¯ç”±åº“ï¼Œç”¨æ¥å®ç°ä¸ APISix ç›¸åŒçš„åŠŸèƒ½ã€‚&lt;code&gt;matchit&lt;/code&gt; æä¾›äº†çµæ´»çš„è·¯ç”±åŒ¹é…èƒ½åŠ›ï¼Œæ”¯æŒç²¾ç¡®åŒ¹é…å’Œé€šé…ç¬¦è§„åˆ™ã€‚&lt;/p&gt;

&lt;p&gt;æ­¤å¤–ï¼Œè·¯ç”±é€»è¾‘è¿˜ç»“åˆäº†è´Ÿè½½å‡è¡¡ï¼ˆlbï¼‰æ¨¡å—çš„æ–¹æ³•ï¼Œå®ç°è¯·æ±‚çš„ç²¾å‡†è·¯ç”±ï¼Œå¹¶æ”¯æŒé€šè¿‡è·¯ç”±çš„ &lt;code&gt;timeout&lt;/code&gt; é…ç½®è¦†ç›–é»˜è®¤çš„ä¸Šæ¸¸è¶…æ—¶è®¾ç½®ã€‚&lt;/p&gt;

&lt;p&gt;å®Œæ•´å®ç°å¯ä»¥å‚è€ƒ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/proxy/router.rs&#34;&gt;router.rs æºç &lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å®ç°-pingora-service-ä¸-server&#34;&gt;å®ç°ï¼šPingora Service ä¸ Server&lt;/h3&gt;

&lt;h4 id=&#34;service-å®ç°&#34;&gt;Service å®ç°&lt;/h4&gt;

&lt;p&gt;Pingora çš„ &lt;code&gt;Service&lt;/code&gt; æ¦‚å¿µç”¨äºå®šä¹‰ HTTP è¯·æ±‚å¤„ç†çš„å„ä¸ªé˜¶æ®µï¼Œå…¶å¤„ç†æµç¨‹ä¸ Nginx çš„å¤„ç†é˜¶æ®µç±»ä¼¼ï¼ˆå‚è€ƒ &lt;a href=&#34;https://github.com/cloudflare/pingora/blob/main/docs/user_guide/phase.md&#34;&gt;Pingora çš„é˜¶æ®µè®¾è®¡&lt;/a&gt;ï¼‰ã€‚åœ¨ pingsix ä¸­ï¼Œé€šè¿‡å®ç° &lt;code&gt;ProxyService&lt;/code&gt; traitï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªå®Œæ•´çš„åå‘ä»£ç†æœåŠ¡ï¼Œå¹¶åœ¨ä»¥ä¸‹é˜¶æ®µæ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;request&lt;/strong&gt;: è¯·æ±‚æ¥æ”¶åå¯è¿›è¡Œä¿®æ”¹æˆ–æ ¡éªŒã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;upstream_request&lt;/strong&gt;: è½¬å‘åˆ°ä¸Šæ¸¸å‰å¤„ç†è¯·æ±‚ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;upstream_response&lt;/strong&gt;: æ¥æ”¶ä¸Šæ¸¸å“åº”åè¿›è¡Œå¤„ç†ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;response&lt;/strong&gt;: è¿”å›å®¢æˆ·ç«¯å‰å¯¹å“åº”è¿›è¡Œæœ€ç»ˆä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™ç§è®¾è®¡è®©æˆ‘ä»¬å¯ä»¥é€šè¿‡æ’ä»¶çµæ´»æ‰©å±•åŠŸèƒ½ï¼Œä¾‹å¦‚æ·»åŠ è®¤è¯ã€æµé‡æ§åˆ¶ç­‰ã€‚æ ¸å¿ƒä»£ç å®ç°å¯å‚è€ƒ &lt;a href=&#34;https://github.com/cloudflare/pingora/blob/main/src/mod.rs&#34;&gt;pingsix proxy æ¨¡å—&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h4 id=&#34;server-å®ç°&#34;&gt;Server å®ç°&lt;/h4&gt;

&lt;p&gt;Server å±‚è´Ÿè´£åè°ƒé…ç½®ã€è·¯ç”±å’ŒæœåŠ¡å¯åŠ¨ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;åŠ è½½é…ç½®ä¸è·¯ç”±&lt;/strong&gt;&lt;br /&gt;
ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½è·¯ç”±è§„åˆ™å’Œç›‘å¬åœ°å€ï¼Œå¹¶åˆå§‹åŒ–æ‰€éœ€çš„æœåŠ¡æ¨¡å—ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;å¯åŠ¨ç›‘å¬å™¨&lt;/strong&gt;&lt;br /&gt;
æ”¯æŒå¤šåè®®ç›‘å¬ï¼ˆå¦‚ HTTP/HTTPSï¼‰ï¼Œå¹¶åŠ¨æ€ç»‘å®šé…ç½®çš„ç›‘å¬ç«¯å£ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;Service æ‰©å±•&lt;/strong&gt;&lt;br /&gt;
åœ¨ Server ä¸­å¯ä»¥æ³¨å†Œå¤šç§ &lt;code&gt;Service&lt;/code&gt; å®ç°ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ProxyService&lt;/code&gt;: ç”¨äºå¤„ç†åå‘ä»£ç†é€»è¾‘ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BackgroundService&lt;/code&gt;: å¦‚å¥åº·æ£€æŸ¥åå°ä»»åŠ¡ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰æ‰©å±• Serviceï¼Œä¾‹å¦‚è‡ªåŠ¨ç”³è¯·è¯ä¹¦ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é€šè¿‡è¿™ç§è®¾è®¡ï¼ŒServer å¯ä»¥çµæ´»åœ°ç®¡ç†å¤šä¸ªæœåŠ¡å®ä¾‹ï¼Œæ‰©å±•åŠŸèƒ½å˜å¾—ç®€å•ä¸”ç›´è§‚ã€‚å®Œæ•´çš„å®ç°ä»£ç å¯å‚è€ƒ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/main.rs&#34;&gt;pingsix çš„ main.rs&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;è§„åˆ’&#34;&gt;è§„åˆ’&lt;/h3&gt;

&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åŸºäºå½“å‰çš„åå‘ä»£ç†åŠŸèƒ½è¿›ä¸€æ­¥å®Œå–„ API ç½‘å…³çš„æ ¸å¿ƒæ‰©å±•èƒ½åŠ›ï¼Œè§„åˆ’åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ’ä»¶æ”¯æŒ&lt;/strong&gt;&lt;br /&gt;
å¼•å…¥æ’ä»¶æœºåˆ¶ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½å’Œæ‰§è¡Œï¼Œé€æ­¥å®ç° API ç½‘å…³çš„å…³é”®æ’ä»¶ï¼ˆå¦‚è®¤è¯ã€é™æµã€æ—¥å¿—ç­‰ï¼‰ï¼Œæå‡åŠŸèƒ½çš„çµæ´»æ€§ä¸å¯æ‰©å±•æ€§ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;åŠ¨æ€é…ç½®ç®¡ç†&lt;/strong&gt;&lt;br /&gt;
é›†æˆ etcdï¼Œå®ç°é…ç½®çš„åŠ¨æ€åŠ è½½å’Œæ›´æ–°ï¼Œä»¥ä¾¿åœ¨æ— éœ€é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹åŠ¨æ€è°ƒæ•´è·¯ç”±ã€ä¸Šæ¸¸é…ç½®ç­‰ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;ä¸Šæ¸¸ä¸æœåŠ¡çš„ç‹¬ç«‹é…ç½®&lt;/strong&gt;&lt;br /&gt;
æä¾›ä¸Šæ¸¸ï¼ˆupstreamï¼‰å’ŒæœåŠ¡ï¼ˆserviceï¼‰çš„å•ç‹¬é…ç½®æŠ½è±¡ï¼Œä½¿å¾—å¤æ‚ä¸šåŠ¡éœ€æ±‚ä¸‹çš„é…ç½®æ›´æ¸…æ™°ã€æ¨¡å—åŒ–ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;p&gt;ç»è¿‡ä»¥ä¸Šè®¾è®¡ï¼Œæˆ‘ä»¬å·²ç»æ„å»ºäº†ä¸€ä¸ªå®Œæ•´çš„åŸºç¡€åå‘ä»£ç†åŠŸèƒ½ï¼Œä½†è¦å®ç° API ç½‘å…³çš„æ ¸å¿ƒä»·å€¼ï¼Œæ¥ä¸‹æ¥çš„é‡ç‚¹å°†èšç„¦åœ¨æ’ä»¶ç³»ç»Ÿçš„è®¾è®¡ä¸å®ç°ï¼Œä»¥ä¾¿æ”¯æŒæ›´ä¸°å¯Œçš„åŠŸèƒ½æ‰©å±•ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/apache/apisix&#34;&gt;APISix&lt;/a&gt; - å¼€æºã€é«˜æ€§èƒ½çš„ API ç½‘å…³ï¼Œæä¾›ä¸°å¯Œçš„æ’ä»¶æ”¯æŒå’Œçµæ´»çš„é…ç½®ç®¡ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cloudflare/pingora&#34;&gt;Pingora&lt;/a&gt; - Cloudflare å¼€å‘çš„é«˜æ€§èƒ½åå‘ä»£ç†ï¼Œé‡‡ç”¨ Rust å®ç°ï¼Œè®¾è®¡çµæ„Ÿæ¥æºäº Nginxã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…¶ä»–ç›¸å…³é¡¹ç›®ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/vicanso/pingap&#34;&gt;pingap&lt;/a&gt; - ä¸€ä¸ªä½¿ç”¨ Rust å®ç°çš„è½»é‡çº§ API ç½‘å…³ï¼Œé€‚åˆå‚è€ƒå…¶æ¶æ„å’Œæ’ä»¶è®¾è®¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/memorysafety/river&#34;&gt;river&lt;/a&gt; - Rust å®ç°çš„åˆ†å¸ƒå¼æµé‡ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒåŠ¨æ€è·¯ç”±å’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caibirdme/penguin&#34;&gt;penguin&lt;/a&gt; - Rust ç¼–å†™çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºå­¦ä¹ å’Œå‚è€ƒå…¶è·¯ç”±ä¸è´Ÿè½½å‡è¡¡å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>k8säº‘åŸç”Ÿç¨‹åºå®ç°CRDçš„æœç´¢æŸ¥è¯¢åˆ†é¡µ</title>
      <link>https://zhu327.github.io/2024/10/22/k8s%E4%BA%91%E5%8E%9F%E7%94%9F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0crd%E7%9A%84%E6%90%9C%E7%B4%A2%E6%9F%A5%E8%AF%A2%E5%88%86%E9%A1%B5/</link>
      <pubDate>Tue, 22 Oct 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/10/22/k8s%E4%BA%91%E5%8E%9F%E7%94%9F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0crd%E7%9A%84%E6%90%9C%E7%B4%A2%E6%9F%A5%E8%AF%A2%E5%88%86%E9%A1%B5/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;æ¥æ–°å…¬å¸è¿˜æ˜¯åœ¨åšäº‘åŸç”Ÿå¹³å°çš„å¼€å‘ï¼ŒåŸºæœ¬çš„ä¸šåŠ¡é€»è¾‘å°±æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„CRDèµ„æºï¼Œèµ°Operatorçš„æ¨¡å¼æ¥å®ç°å¹³å°çš„å„ç§ä¸šåŠ¡éƒ¨ç½²ã€‚ä½†æ˜¯CRDåœ¨apiserverä¸­æ˜¯ä»¥key-valueçš„å½¢å¼å­˜å‚¨åœ¨etcdä¸­ï¼Œè™½ç„¶labelså¯ä»¥å®ç°ç®€å•çš„æŸ¥è¯¢ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æ»¡è¶³å¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ã€‚åœ¨æˆ‘æ¥ä¹‹å‰CRDèµ„æºçš„åˆ—è¡¨æŸ¥è¯¢éƒ½æ˜¯ç›´æ¥å…¨é‡è¿”å›ç”±å‰ç«¯è‡ªè¡Œç­›é€‰ï¼Œéšç€ä¸šåŠ¡é‡çš„å¢åŠ ï¼ŒæŸ¥è¯¢çš„æ•ˆç‡è¶Šæ¥è¶Šä½ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ¥è¿™ä¸ªé¡¹ç›®çš„å‰ä»»å¼€å‘è€…å†³ç­–ä½¿ç”¨MySQLæ¥åŒå†™CRDèµ„æºï¼Œæ¥å®ç°è¾…åŠ©æŸ¥è¯¢ï¼Œä»£ç ä¹Ÿå†™äº†å¾ˆå¤šäº†ï¼ŒåŒå†™å¸¦æ¥äº†ä¸€äº›ä»£ç ç»“æ„ä¸Šçš„è€¦åˆï¼Œä½†æ˜¯å…¶å®ä¹Ÿä¸æ˜¯ä¸ªé—®é¢˜ã€‚æ›´æ¶å¿ƒçš„é—®é¢˜æ˜¯æœ‰ä¸€ä¸ªå®¢æˆ·ç”±äºä¿¡åˆ›æ–¹é¢çš„æ”¿æ²»é—®é¢˜ï¼Œè¦æ±‚æˆ‘ä»¬ä¸èƒ½å¼•å…¥MySQLï¼è™½ç„¶å®¢æˆ·æœ‰å»ºè®®ç”¨ä»–ä»¬è‡ªå·±çš„æ•°æ®åº“ï¼Œä½†æ˜¯ä»æˆ‘ä»¬çš„è§’åº¦æ¥è¯´ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›è‡ªå·±çš„æœåŠ¡ä¾èµ–å¤–éƒ¨å®¢æˆ·ç»„ä»¶ï¼Œæ‰€ä»¥å°±å¿…é¡»è€ƒè™‘ä¸‹å…¶å®ƒçš„æ–¹æ¡ˆäº†ï¼Œæ¯”å¦‚ä¸ç”¨æ•°æ®åº“æœåŠ¡ã€‚&lt;/p&gt;

&lt;p&gt;åŸºäºä»¥å¾€åœ¨SQLiteä¸Šçš„å­¦ä¹ ç»éªŒï¼Œä»¥å½“å‰CRDèµ„æºçš„ä½“é‡å®Œå…¨å¯ä»¥ä½¿ç”¨SQLiteæ¥å®ç°CRDèµ„æºçš„è¾…åŠ©æŸ¥è¯¢ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯è¦å¼•å…¥æŒä¹…å­˜å‚¨å‘¢ï¼Ÿå…¶å®è¿˜æ˜¯ä¸ç”¨ï¼Œå› ä¸ºCRDæœ¬èº«å·²ç»å­˜å‚¨åœ¨etcdä¸­äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç¨‹åºå¯åŠ¨æ—¶é€šè¿‡k8sçš„List-Watchçš„æ–¹å¼å°†CRDèµ„æºåŒæ­¥åˆ°SQLiteä¸­ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°CRDèµ„æºçš„è¾…åŠ©æŸ¥è¯¢äº†ã€‚å…·ä½“åˆ°å®ç°ä¸Šå®Œå…¨å¯ä»¥ä½¿ç”¨k8s clientä¸­çš„informeræ¥å®ç°CRDèµ„æºçš„åŒæ­¥ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨åˆ°informerçš„ç¼“å­˜æœºåˆ¶å‡å°‘apiserverçš„æŸ¥è¯¢å‹åŠ›ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;å®ç°&#34;&gt;å®ç°&lt;/h3&gt;

&lt;h4 id=&#34;synchronizerçš„æ¥å£å®šä¹‰&#34;&gt;synchronizerçš„æ¥å£å®šä¹‰&lt;/h4&gt;

&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å®šä¸€ä¸ªsynchronizeræ¥å£ï¼Œé’ˆå¯¹æ¯ç§éœ€è¦åŒæ­¥çš„CRDèµ„æºï¼Œéœ€è¦å®ç°synchronizeræ¥å£ã€‚è¿™ä¸ªæ¥å£ä¼šå¤„ç†informerçš„addã€updateã€deleteäº‹ä»¶ï¼Œå°†CRDèµ„æºåŒæ­¥åˆ°SQLiteä¸­ã€‚æ¯ä¸€ä¸ªèµ„æºå¯ä»¥åˆ›å»ºä¸€å¼ åœ¨SQLiteä¸­åˆ›å»ºçš„è¡¨ï¼Œå°†CRDèµ„æºåŒæ­¥åˆ°è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/runtime/schema&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;synchronizer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GroupVersionResource&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;oldObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newObj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;// ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®ç°æ¥å£çš„ä¾‹å­
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;manager&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dao&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;TemplateManager&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// SQLiteæ•°æ®åº“æ“ä½œ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GroupVersionResource&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GroupVersionResource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Group&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;    &lt;span class=&#34;s&#34;&gt;&amp;#34;apps.titanide.cn&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;s&#34;&gt;&amp;#34;v1alpha1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Resource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;templates&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;// åˆ†åˆ«å¤„ç†informerçš„addã€updateã€deleteäº‹ä»¶ï¼ŒæŠŠæ•°æ®åŒæ­¥åˆ°SQLiteçš„è¡¨ä¸­
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;oldObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newObj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;åŒæ­¥é€»è¾‘å®ç°&#34;&gt;åŒæ­¥é€»è¾‘å®ç°&lt;/h4&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬ä½¿ç”¨k8sçš„dynamicclientçš„informeræ¥å®ç°CRDèµ„æºçš„åŒæ­¥ï¼Œå› ä¸ºè¿™æ®µä»£ç åœ¨é¡¹ç›®ä¸­çš„å±‚çº§æ¯”è¾ƒä½ï¼Œæ²¡èƒ½ç›´æ¥åˆ›å»ºå¸¦schemeçš„clientï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨dynamicclientã€‚å¦‚æœä½ çš„é¡¹ç›®ä»£ç å±‚çº§æ¯”è¾ƒé«˜ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¸¦schemeçš„clientã€‚initSynchronizerå‡½æ•°å¿…é¡»åœ¨æœåŠ¡å¯åŠ¨æ—¶è°ƒç”¨ï¼Œç­‰å¾…åŒæ­¥å®Œæˆåå†å¯åŠ¨æœåŠ¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;os&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;os/signal&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;syscall&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;

	&lt;span class=&#34;s&#34;&gt;&amp;#34;github.com/pkg/errors&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/apis/meta/v1/unstructured&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/runtime&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/runtime/schema&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/client-go/dynamic&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/client-go/dynamic/dynamicinformer&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/client-go/rest&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/client-go/tools/cache&amp;#34;&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;appsv1alpha1&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;project/api/apis/apps/v1alpha1&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;project/pkg/database&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;project/pkg/database/dao&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;initSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;GetKubeDynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

  &lt;span class=&#34;nx&#34;&gt;sigCh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Signal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;signal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Notify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sigCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SIGINT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SIGTERM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// å¯åŠ¨ä¸€ä¸ªgoroutineï¼Œç­‰å¾…æ¥æ”¶ä¿¡å·
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sigCh&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;

	&lt;span class=&#34;c1&#34;&gt;// å¯åŠ¨åŒæ­¥é€»è¾‘
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;database&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GetDB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

  &lt;span class=&#34;c1&#34;&gt;// åˆå§‹åŒ–å…·ä½“çš„åŒæ­¥å¯¹è±¡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;templateSynchronizer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newTemplateSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dao&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewTemplateManager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;projectSynchronizer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newProjectSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dao&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewProjectManager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;pluginSynchronizer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newPluginSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dao&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewPluginManager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;synchronize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;synchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;projectSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pluginSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;synchronize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dynamicClient&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syncs&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;synchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// åˆ›å»º Informer å·¥å‚, 10åˆ†é’Ÿå…¨é‡åŒæ­¥ä¸€æ¬¡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;factory&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dynamicinformer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewDynamicSharedInformerFactory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Minute&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;hasSyncedFuncs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;InformerSynced&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;syncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syncs&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;c1&#34;&gt;// åˆ›å»º informer
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

		&lt;span class=&#34;nx&#34;&gt;informer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;factory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ForResource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Informer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

		&lt;span class=&#34;c1&#34;&gt;// è®¾ç½®äº‹ä»¶å¤„ç†ç¨‹åº
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;informer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;AddEventHandler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ResourceEventHandlerFuncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;AddFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;UpdateFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;DeleteFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;

		&lt;span class=&#34;c1&#34;&gt;// å¯åŠ¨ informer
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;informer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

		&lt;span class=&#34;nx&#34;&gt;hasSyncedFuncs&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hasSyncedFuncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;informer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;HasSynced&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;c1&#34;&gt;// ç­‰å¾…ç¼“å­˜åŒæ­¥
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WaitForCacheSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hasSyncedFuncs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;New&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;failed to wait for cache sync&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;// GetKubeDynamicClient å‡½æ•°ç”¨äºè·å– Kubernetes å®¢æˆ·ç«¯é›†ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘ *kubernetes.Clientset çš„æŒ‡é’ˆå’Œ error å¯¹è±¡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;GetKubeDynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;cfg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;rest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;InClusterConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Wrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;failed to get cluster config&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;dynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewForConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cfg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Wrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;failed to create dynamicClient&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;å…¶å®ƒ&#34;&gt;å…¶å®ƒ&lt;/h3&gt;

&lt;p&gt;é€šè¿‡ä»¥ä¸Šæœºåˆ¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°CRDèµ„æºçš„è¾…åŠ©æŸ¥è¯¢äº†ã€‚è¿™ç§åŒæ­¥æœºåˆ¶ä¹Ÿæ‘†è„±äº†éœ€è¦åŒå†™çš„å¤æ‚é€»è¾‘ï¼Œåœ¨ç¨‹åºå¯åŠ¨æ—¶ListåŒæ­¥ï¼Œå¯åŠ¨åWatchåŠ¨æ€æ›´æ–°ï¼Œåœ¨æŸ¥è¯¢æ—¶ç›´æ¥ä»SQLiteä¸­æŸ¥è¯¢ï¼Œå†™å…¥æ—¶ç›´æ¥å†™CRDã€‚ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œè¿™ç§æœºåˆ¶å®ç°äº†è¯»å†™åˆ†ç¦»ï¼Œä¹Ÿè§£å†³äº†åŒå†™å¸¦æ¥çš„è€¦åˆé—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å°è£…dbçš„daoå±‚æ—¶ï¼ŒåŸºäºä»¥å¾€é¡¹ç›®çš„ç»éªŒè¿˜æ˜¯å»ºè®®ç›´æ¥ä½¿ç”¨sqlx+squirrelæ¥å®ç°SQLçš„ç”Ÿæˆå’Œæ‰§è¡Œï¼Œè¿™æ ·åœ¨ä»£ç ç»“æ„ä¸Šä¼šæ›´åŠ æ¸…æ™°ã€‚æ²¡æœ‰å¼•å…¥ORMçš„åŸå› æ˜¯ä»¥å‰è¸©è¿‡å‘ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä½¿ç”¨SQLiteæ—¶å»ºè®®å¼€å¯ä¸€äº›é…ç½®ï¼Œæ¥ä¼˜åŒ–æ€§èƒ½ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA journal_mode = WAL;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA synchronous=NORMAL;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA mmap_size = 134217728;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA journal_size_limit = 27103364;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA cache_size=2000;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;åœ¨å®é™…é¡¹ç›®ä¸­æˆ‘ä»¬ä¼šç¢°åˆ°å„ç§é—®é¢˜ï¼Œè§£å†³é—®é¢˜çš„æ€è·¯å’Œæ–¹æ³•å¤šç§å¤šæ ·ã€‚éœ€è¦æ ¹æ®é¡¹ç›®çš„å®é™…æƒ…å†µä¸é¡¹ç›®æœªæ¥çš„å‘å±•æ–¹å‘æ¥å†³ç­–ä½¿ç”¨ä»€ä¹ˆæ–¹æ³•æ¥è§£å†³é—®é¢˜ã€‚ä»¥æˆ‘å½“å‰çš„é¡¹ç›®ä¸ºä¾‹ï¼Œå®¢æˆ·çš„æ”¿æ²»åŸå› å¯¼è‡´ä¸èƒ½å¼•å…¥MySQLï¼Œåªèƒ½è€ƒè™‘å…¶å®ƒçš„æ–¹å¼æ¥è§£å†³é—®é¢˜ã€‚åœ¨å¼•å…¥SQLiteçš„åŒæ—¶è¿˜è§£å†³äº†éœ€è¦åŒå†™å¸¦æ¥çš„è€¦åˆé—®é¢˜ï¼Œè¿™é‡Œçš„ä»£ç ä¸å¤šï¼Œä½†æ˜¯æä¾›ä¸€ç§è§£å†³CRDèµ„æºé€šç”¨æŸ¥è¯¢çš„æ€è·¯ï¼Œæœ‰éœ€è¦å¯ä»¥å‚è€ƒã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ä»¥Vaultwardenä¸ºä¾‹ä½¿ç”¨SQLite Litestreamå®ç°æ— æ•°æ®åº“æœåŠ¡</title>
      <link>https://zhu327.github.io/2024/09/03/%E4%BB%A5vaultwarden%E4%B8%BA%E4%BE%8B%E4%BD%BF%E7%94%A8sqlite-litestream%E5%AE%9E%E7%8E%B0%E6%97%A0%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1/</link>
      <pubDate>Tue, 03 Sep 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/09/03/%E4%BB%A5vaultwarden%E4%B8%BA%E4%BE%8B%E4%BD%BF%E7%94%A8sqlite-litestream%E5%AE%9E%E7%8E%B0%E6%97%A0%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;Vaultwardenæ˜¯ä¸€ä¸ªéå®˜æ–¹å®ç°çš„Bitwarden Serverï¼Œç”¨äºå¯†ç ç®¡ç†ï¼Œæ”¯æŒWebç«¯ã€æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯ã€‚å®ƒæ”¯æŒå¤šç§æ•°æ®æ¥å­˜å‚¨æ•°æ®ï¼ŒåŒ…æ‹¬SQLiteã€PostgreSQLå’ŒMySQLç­‰ã€‚å½“æˆ‘ä»¬æƒ³æŠŠå®ƒéƒ¨ç½²åœ¨ä¸€ä¸ªå®¹å™¨æœåŠ¡å¹³å°æ—¶ï¼Œå¦‚æœå®¹å™¨æœåŠ¡æœ¬èº«æ²¡æœ‰æä¾›æŒä¹…æŒ‚è½½çš„å·ï¼Œé‚£æˆ‘ä»¬å°±åªèƒ½ä½¿ç”¨PostgreSQLæˆ–è€…MySQLå¤–éƒ¨æ•°æ®æ¥å­˜å‚¨æ•°æ®ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸æƒ³é¢å¤–å†ä¹°èµ„æºæ¥è¿è¡Œä¸€ä¸ªæ•°æ®åº“ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨SQLiteæ¥å­˜å‚¨æ•°æ®ï¼Œå¹¶ä¸”ä½¿ç”¨Litestreamæ¥å®ç°å®¹ç¾å¤‡ä»½ã€‚è¿™æ ·è™½ç„¶å®¹å™¨æœåŠ¡æ²¡æœ‰æŒä¹…å­˜å‚¨ï¼Œä½†æ˜¯æ•°æ®è¿˜æ˜¯å®‰å…¨çš„ã€‚ä¸‹é¢ä»¥Vaultwardenä¸ºä¾‹ï¼Œä½¿ç”¨SQLiteå’ŒLitestreamæ¥å®ç°æ— æ•°æ®åº“æœåŠ¡ã€‚å…¶å®ƒå¯ä»¥ä½¿ç”¨SQLiteçš„ç¨‹åºä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å®ç°æ— æ•°æ®åº“æœåŠ¡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-litestream-yml&#34;&gt;1. litestream.yml&lt;/h3&gt;

&lt;p&gt;Litesreamæ˜¯ä¸€ä¸ªå¼€æºçš„SQLiteæ•°æ®åº“å¤‡ä»½å·¥å…·ï¼Œå®ƒä½¿ç”¨Goè¯­è¨€å¼€å‘ã€‚å®ƒå¯ä»¥ç›‘æ§ä¸€ä¸ªSQLiteæ•°æ®åº“æ–‡ä»¶çš„å˜åŒ–ï¼Œå¹¶ä¸”å°†å˜åŒ–è®°å½•åˆ°S3ã€MinIOç­‰å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸Šã€‚å®ƒå·§å¦™çš„ä½¿ç”¨äº†SQLiteçš„WALï¼ˆWrite-Ahead Loggingï¼‰æœºåˆ¶ï¼Œæ¥è®°å½•æ•°æ®åº“çš„å˜åŒ–ï¼Œå¹¶æµå¼åœ°å°†è¿™äº›å˜åŒ–è®°å½•åˆ°å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸Šï¼Œè¾¾åˆ°å®æ—¶å¤‡ä»½çš„ç›®çš„ã€‚åœ¨æœåŠ¡å¯å‰ï¼ŒLitestreamå¯ä»¥ä»å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸Šæ¢å¤æ•°æ®åˆ°SQLiteæ•°æ®åº“æ–‡ä»¶ä¸­ã€‚å®ƒçš„å®ç°åŸç†å¯ä»¥å‚è€ƒ&lt;a href=&#34;https://litestream.io/how-it-works/&#34;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä½¿ç”¨Litestreamæ—¶ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ªS3å…¼å®¹çš„å¯¹è±¡å­˜å‚¨ï¼Œè¿™é‡Œä»¥Cloudflare R2ä¸ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ª&lt;code&gt;litestream.yml&lt;/code&gt;çš„é…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;dbs&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;-&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;path&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/data/db.sqlite3&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;replicas&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;-&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;type&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;s3&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;endpoint&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;${REPLICA_URL}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;bucket&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;sqlite&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;/data/db.sqlite3&lt;/code&gt; æ˜¯Vaultwardençš„SQLiteæ•°æ®åº“æ–‡ä»¶è·¯å¾„ï¼Œ&lt;code&gt;REPLICA_URL&lt;/code&gt;æ˜¯å¯¹è±¡å­˜å‚¨æœåŠ¡çš„åœ°å€ï¼Œæ¯”å¦‚ &lt;code&gt;https://&amp;lt;cloudflare-account-id&amp;gt;.r2.cloudflarestorage.com&lt;/code&gt;ï¼Œæˆ‘ä»¬éœ€è¦åœ¨Cloudflare R2ä¸Šåˆ›å»ºä¸€ä¸ª&lt;code&gt;sqlite&lt;/code&gt;çš„å­˜å‚¨æ¡¶ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-entrypoint-sh&#34;&gt;2. entrypoint.sh&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬è¿˜éœ€è¦å‡†å¤‡ä¸€ä¸ª&lt;code&gt;entrypoint.sh&lt;/code&gt;çš„è„šæœ¬æ–‡ä»¶ï¼Œç”¨äºå¯åŠ¨Liestreamå’ŒVaultwardenæœåŠ¡ã€‚å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; -e

&lt;span class=&#34;c1&#34;&gt;# Set the directory of the database in a variable
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;DB_PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/data/db.sqlite3

&lt;span class=&#34;c1&#34;&gt;# Restore the database if it does not already exist.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; -f &lt;span class=&#34;nv&#34;&gt;$DB_PATH&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Database already exists, skipping restore&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;No database found, restoring from replica if exists&amp;#34;&lt;/span&gt;
	litestream restore -if-replica-exists -config /etc/litestream.yml &lt;span class=&#34;nv&#34;&gt;$DB_PATH&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Litestream replicate database and start vaultwarden
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;exec litestream&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; litestream replicate -exec &lt;span class=&#34;s2&#34;&gt;&amp;#34;/start.sh&amp;#34;&lt;/span&gt; -config /etc/litestream.yml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨å¯åŠ¨VaultwardenæœåŠ¡å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ£€æŸ¥SQLiteæ•°æ®åº“æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä»å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸Šæ¢å¤æ•°æ®ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-dockerfile&#34;&gt;3. Dockerfile&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-dockerfile&#34; data-lang=&#34;dockerfile&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; litestream/litestream:latest AS litestream&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; vaultwarden/server:latest&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;COPY --from&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;litestream /usr/local/bin/litestream /usr/local/bin/litestream&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;COPY --chmod&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;755&lt;/span&gt; entrypoint.sh /usr/bin/entrypoint.sh&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;COPY litestream.yml /etc/litestream.yml&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CMD&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; [&amp;#34;/usr/bin/entrypoint.sh&amp;#34;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·ä¼šæ‰“ä¸€ä¸ªæ–°çš„é•œåƒæŠŠLitestreamå’ŒVaultwardenæœåŠ¡ä¸€èµ·æ‰“åŒ…ï¼Œå¹¶ä¸”ä½¿ç”¨&lt;code&gt;entrypoint.sh&lt;/code&gt;å¯åŠ¨æœåŠ¡ã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-å¯åŠ¨æœåŠ¡&#34;&gt;4. å¯åŠ¨æœåŠ¡&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬è¿˜è¦å‡†å¤‡ä¸€ä¸ª.envæ–‡ä»¶ï¼Œç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;LITESTREAM_ACCESS_KEY_ID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;cloudflare-r2-access-key-id&amp;gt;
&lt;span class=&#34;nv&#34;&gt;LITESTREAM_SECRET_ACCESS_KEY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;cloudflare-r2-access-key&amp;gt;
&lt;span class=&#34;nv&#34;&gt;PUSH_ENABLED&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;PUSH_INSTALLATION_ID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;push-installation-id&amp;gt;
&lt;span class=&#34;nv&#34;&gt;PUSH_INSTALLATION_KEY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;push-installation-key&amp;gt;
&lt;span class=&#34;nv&#34;&gt;PUSH_RELAY_BASE_URI&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;https://push.bitwarden.com
&lt;span class=&#34;nv&#34;&gt;REPLICA_URL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;https://&amp;lt;cloudflare-account-id&amp;gt;.r2.cloudflarestorage.com
&lt;span class=&#34;nv&#34;&gt;SIGNUPS_ALLOWED&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;true&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;vaulewardençš„PUSHé…ç½®éœ€è¦åˆ°&lt;a href=&#34;https://bitwarden.com/host/&#34;&gt;è¿™é‡Œ&lt;/a&gt;ç”³è¯·ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Dockeræ¥å¯åŠ¨æœåŠ¡äº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;docker run -d &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --name bitwarden &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  -p &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;:80 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --restart unless-stopped &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --env-file .env &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  vaultwarden/server:latest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ²¡æœ‰æŒä¹…å­˜å‚¨çš„å®¹å™¨æœåŠ¡ä¸Šæ— æ•°æ®åº“çš„è¿è¡ŒVaultwardenæœåŠ¡äº†ï¼Œæ¯”å¦‚GCP Code Runï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ä¾‹æ•°é‡scaleåˆ°0ï¼Œåªæœ‰æµé‡è¿›æ¥æ—¶æ‰å¯åŠ¨æœåŠ¡ï¼ŒçœŸæ­£åšåˆ°åªæœ‰ä½¿ç”¨æ—¶æ‰ä»˜è´¹ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨Litestreamå®ç°äº†Vaultwardençš„æ— æ•°æ®åº“æœåŠ¡ï¼Œå¹¶ä¸”ä½¿ç”¨Cloudflare R2ä½œä¸ºå¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚è¿™æ ·å³ä½¿å®¹å™¨æœåŠ¡æ²¡æœ‰æŒä¹…å­˜å‚¨å·ï¼Œæ•°æ®ä¹Ÿæ˜¯å®‰å…¨çš„ã€‚ç±»ä¼¼çš„æ€è·¯è¿˜å¯ä»¥æ¨å¹¿åˆ°å…¶å®ƒä½¿ç”¨SQLiteçš„ç¨‹åºä¸Šã€‚æ¯”å¦‚æˆ‘ä»¬è‡ªå·±å¼€å‘äº†ä¸€ä¸ªDjangoçš„ç¨‹åºï¼Œä¸ä¾èµ–å¤–éƒ¨çš„æ•°æ®åº“æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Litestreamæ¥å®ç°å®¹ç¾å¤‡ä»½ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>è‡ªåŠ¨åŒ–è‡ªå·±çš„ç”Ÿæ´»ï¼šåˆ›é€ è‡ªå·±çš„å°å·¥å…·</title>
      <link>https://zhu327.github.io/2024/08/30/%E8%87%AA%E5%8A%A8%E5%8C%96%E8%87%AA%E5%B7%B1%E7%9A%84%E7%94%9F%E6%B4%BB%E5%88%9B%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%B0%8F%E5%B7%A5%E5%85%B7/</link>
      <pubDate>Fri, 30 Aug 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/08/30/%E8%87%AA%E5%8A%A8%E5%8C%96%E8%87%AA%E5%B7%B1%E7%9A%84%E7%94%9F%E6%B4%BB%E5%88%9B%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%B0%8F%E5%B7%A5%E5%85%B7/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;ä½œä¸ºä¸€ä½ç¨‹åºå‘˜ï¼Œæˆ‘å†™çš„å¤§éƒ¨åˆ†å½“ç„¶éƒ½æ˜¯ç”¨æ¥èµšé’±ç”Ÿæ´»çš„ä»£ç ï¼Œèµšé’±çš„ä»£ç éƒ½æ˜¯éå¸¸è§„èŒƒçš„ï¼Œä¸€èˆ¬éƒ½æ˜¯å¤æ‚ä¸šåŠ¡é€»è¾‘åœ¨ç¨‹åºä¸Šæ˜ å°„ï¼Œå¾ˆå¤šæ—¶å€™éƒ½åªæœ‰åœ¨è§£å†³äº†å¤æ‚çš„ä¸šåŠ¡é—®é¢˜ï¼Œæ‰èƒ½è·å¾—æ‰“æ€ªå‡çº§çš„æˆå°±æ„Ÿã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯æˆ‘ä¹Ÿä¼šåœ¨ä¸šä½™æ—¶é—´å­¦ä¹ ä¸€äº›å·¥ä½œæ— å…³çš„æŠ€æœ¯ï¼Œæ¯”å¦‚æœ€è¿‘åŠå¹´æˆ‘å­¦ä¹ äº†Rustï¼Œæ¯å½“æˆ‘å­¦ä¹ ä¸€é—¨æ–°çš„æŠ€æœ¯ï¼Œæˆ‘æ€»æ˜¯å¸Œæœ›æŠŠä¹‹å‰å®ç°çš„ä¸€äº›ç¨‹åºæ”¹ç”¨æ–°æŠ€æœ¯æ¥å®ç°ï¼Œè¿™æ ·å°±å¯ä»¥æ›´å¿«çš„ä¸Šæ‰‹ã€‚å¹³å¸¸ç”Ÿæ´»ä¸­ä¹Ÿæ²¡ä»€ä¹ˆç”¨åˆ°Rustçš„åœºæ™¯ï¼Œé‚£å°±åªèƒ½å…ˆæŠŠä¹‹å‰ç”¨Bashï¼ŒPythonå†™çš„å°å·¥å…·ç”¨Rusté‡å†™ä¸€éã€‚ç„¶åæœ€è¿‘æˆ‘ä¹Ÿè‡ªå·±å‘æ˜äº†ä¸€äº›ç”Ÿæ´»ä¸Šçš„åœºæ™¯ï¼Œè¿™äº›åœºæ™¯å¾ˆå¤šæ—¶å€™éƒ½æ˜¯é‡å¤çš„ï¼Œæ‰‹åŠ¨çš„ï¼Œå¦‚æœèƒ½æ”¹æˆè‡ªåŠ¨åŒ–èƒ½å¤ŸèŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚æƒ³èµ·äº†ä¸çŸ¥é“å“ªé‡Œçœ‹è¿‡çš„ä¸€ä¸ªè¯´æ³•ï¼šæ‡’æƒ°æ˜¯ç¨‹åºå‘˜çš„ç¬¬ä¸€ç”Ÿäº§åŠ›ï¼Œå› ä¸ºæ‡’ï¼Œæˆ‘ä»¬ä¼šæŠŠå„ç§é‡å¤æ‰‹åŠ¨çš„å·¥ä½œè‡ªåŠ¨åŒ–ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢çš„å†…å®¹å°±æ˜¯æˆ‘åœ¨ä»Šå¹´è‡ªåŠ¨åŒ–ç”Ÿæ´»çš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡è‡ªå·±åˆ›é€ çš„è¿™äº›å°å·¥å…·ï¼Œæˆ‘è§£å†³äº†è‡ªå·±ç”Ÿæ´»ä¸­çš„ä¸€äº›å°ç—›ç‚¹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-è‡ªåŠ¨è¿½ç•ª&#34;&gt;1. è‡ªåŠ¨è¿½ç•ª&lt;/h3&gt;

&lt;p&gt;æ—©å‰æˆ‘åœ¨å®¶é‡Œçš„å¼€å‘æ¿ä¸Šæ­å»ºäº†Jellyfin, Sonarrç”¨æ¥è¿½ç¾å‰§ï¼Œæ•ˆæœè¿˜æ˜¯ä¸é”™çš„ï¼Œè‡ªåŠ¨ä¸‹è½½è‡ªåŠ¨æ•´ç†æ–‡ä»¶ï¼Œè‡ªåŠ¨å‰Šåˆ®æµ·æŠ¥ã€‚Sonarrä¾èµ–çš„IndexeræœåŠ¡æ˜¯ä¸€ä¸ªæ­å»ºåœ¨fly.ioå¹³å°ä¸Šçš„ProwlarræœåŠ¡ï¼ŒæŠŠProwlarræ­å»ºåœ¨å¤–ç½‘ï¼Œå¯ä»¥é¿å…å›½å†…ç½‘ç»œè®¿é—®çš„é™åˆ¶ã€‚&lt;/p&gt;

&lt;p&gt;è¿™å¥—æ–¹æ¡ˆå¯¹äºç¾å‰§æ¥è¯´å·²ç»éå¸¸å®Œç¾äº†ï¼Œä½†æ˜¯æˆ‘é™¤äº†çœ‹ç¾å‰§ï¼Œè¿˜å–œæ¬¢çœ‹æ—¥æœ¬åŠ¨æ¼«ï¼Œç”±äºSonarrå¯¹äºç•ªç»„çš„ä¸­æ–‡æ”¯æŒä¸å¥½ï¼Œæˆ‘åœ¨ç½‘ç»œä¸Šä¹Ÿæ‰¾äº†ä¸€äº›æ–¹æ¡ˆï¼Œéƒ½ä¸æ˜¯ç‰¹åˆ«æ»¡æ„ï¼Œæ‰€ä»¥æˆ‘éƒ½æ˜¯æ‰‹åŠ¨åœ¨èœœæŸ‘è®¡åˆ’ä¸Šæ‰¾ç£åŠ›é“¾ï¼Œç„¶åæ‰‹åŠ¨ä¸‹è½½ã€‚&lt;/p&gt;

&lt;p&gt;å› ä¸ºæˆ‘å¾ˆæ‡’ï¼Œæ‰€ä»¥æˆ‘å°±å­¦ä¹ äº†ä¸€ä¸‹Prowlarrçš„APIï¼Œå†™äº†ä¸€ä¸ªå°å·¥å…·ï¼Œæ¯å°æ—¶è‡ªåŠ¨ä»Prowlarrä¸Šæœç´¢èœœæŸ‘è®¡åˆ’çš„ç´¢å¼•ï¼Œé€šè¿‡æˆ‘åœ¨é…ç½®ä¸­å¡«å†™çš„å…³é”®å­—ï¼Œæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç•ªç»„ï¼Œç„¶åè§¦å‘è‡ªåŠ¨ä¸‹è½½ï¼Œå¦‚æœè§¦å‘äº†ä¸‹è½½è¿˜å¯ä»¥é…ç½®é€šè¿‡ntfy.shå‘é€é€šçŸ¥åˆ°æ‰‹æœºï¼Œè¿™æ ·å°±ä¸ä¼šæ¼æ‰æˆ‘è®¢é˜…çš„ç•ªç»„ã€‚&lt;/p&gt;

&lt;p&gt;ä»£ç åœ°å€ï¼š&lt;a href=&#34;https://github.com/zhu327/ani-sub&#34;&gt;https://github.com/zhu327/ani-sub&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä»£ç å¾ˆé€»è¾‘å¾ˆç®€å•ï¼Œåªæ˜¯ä¸€äº›APIçš„è°ƒç”¨ï¼Œå¦‚æœæ„Ÿå…´è¶£å¯ä»¥è‡ªå·±çœ‹çœ‹ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºäº†æ–¹ä¾¿æ²¡æœ‰è‡ªå·±æœåŠ¡å™¨çš„æœ‹å‹ï¼Œæˆ‘è¿˜å¼€å‘ä¸€ä¸ªå¯ä»¥éƒ¨ç½²åœ¨Cloudflare Workersçš„ç‰ˆæœ¬ï¼š&lt;a href=&#34;https://github.com/zhu327/ani-sub/tree/workers&#34;&gt;https://github.com/zhu327/ani-sub/tree/workers&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªç‰ˆæœ¬ç”±äºæ²¡æœ‰é…ç½®æ–‡ä»¶ï¼Œéœ€è¦ä¾èµ–Cloudflare D1æ•°æ®åº“ï¼Œå¯ä»¥åœ¨Cloudflareç½‘ç«™ä¸Šç¼–è¾‘D1æ•°æ®åº“çš„æ•°æ®æ¥æ·»åŠ ä¿®æ”¹è‡ªå·±è®¢é˜…çš„ç•ªç»„å…³é”®å­—ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-è‡ªåŠ¨ç”Ÿæˆrss-aiæ‘˜è¦&#34;&gt;2. è‡ªåŠ¨ç”ŸæˆRSS AIæ‘˜è¦&lt;/h3&gt;

&lt;p&gt;æˆ‘åœ¨fly.ioå¹³å°ä¸Šæ­å»ºäº†è‡ªå·±çš„RSSè®¢é˜…æœåŠ¡Minifluxï¼Œå¹¶ä¸”è¿˜åœ¨Vercelå¹³å°ä¸Šæ­å»ºäº†è‡ªå·±çš„RSSHubæœåŠ¡ã€‚éšç€è®¢é˜…çš„RSSæºè¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä¸€èˆ¬åœ¨æµè§ˆå™¨ä¸Šä½¿ç”¨ChatGPTæ€»ç»“åŠ©æ‰‹æ¥ç”Ÿæˆæ–‡ç« æ‘˜è¦æ¥å¿«é€Ÿé˜…è¯»ã€‚ä½†æ˜¯è¿™æ ·æ¯æ¬¡æ‰“å¼€æ–‡ç« ï¼Œéƒ½éœ€è¦æˆ‘è‡ªå·±æ‰‹åŠ¨ç‚¹å‡»ä¸€ä¸‹æ¥ç”Ÿæˆæ‘˜è¦ï¼Œéå¸¸éº»çƒ¦ï¼Œæ‰€ä»¥åœ¨ç½‘ç»œä¸Šæ‰¾äº†Minifuxä¸OpenAIç›¸å…³çš„è¯é¢˜ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æ–¹æ¡ˆã€‚ç›´åˆ°æˆ‘åœ¨v2exçœ‹åˆ°ä¸€ä¸ªç½‘å‹åˆ†äº«çš„ä»–ç”¨Pythonå®ç°çš„ä¸€ä¸ªæ—è·¯æœåŠ¡ï¼Œé€šè¿‡Minifluxçš„APIéå†æ–‡ç« ï¼Œç„¶åé€šè¿‡OpenAIçš„APIç”Ÿæˆæ‘˜è¦ï¼Œå†ä¿å­˜åˆ°Minifluxä¸­ã€‚é‚£æˆ‘ä¹Ÿå¯ä»¥ç”¨Rustå®ç°ä¸€ä¸ªç±»ä¼¼çš„æœåŠ¡ï¼Œå¹¶ä¸”å¯ä»¥éƒ¨ç½²åœ¨Cloudflare Workersä¸Šã€‚è¿˜å¯ä»¥åˆ©ç”¨åˆ° Cloudflare Workers AIçš„å…è´¹æ¨¡å‹æ¥ç”Ÿæˆæ‘˜è¦ã€‚&lt;/p&gt;

&lt;p&gt;ä»£ç åœ°å€ï¼š&lt;a href=&#34;https://github.com/zhu327/miniflux-ai&#34;&gt;https://github.com/zhu327/miniflux-ai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç°åœ¨å¯¹äºæ¯”è¾ƒé•¿çš„æ–°é—»ï¼Œæˆ‘ä¸€èˆ¬éƒ½åªçœ‹AIæ‘˜è¦äº†ï¼Œåªæœ‰æœ‰å…´è¶£çš„æ–‡ç« æ‰ä¼šé˜…è¯»å…¨æ–‡ï¼Œå¹¶ä¸”åœ¨æ‰‹æœºä¸Šä¹Ÿå¯ä»¥æ–¹ä¾¿çš„é˜…è¯»åˆ°AIæ‘˜è¦ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-è‡ªåŠ¨ç¿»è¯‘hacknews-rss&#34;&gt;3. è‡ªåŠ¨ç¿»è¯‘HackNews RSS&lt;/h3&gt;

&lt;p&gt;ä½œä¸ºä¸€ä½ç¨‹åºå‘˜ï¼Œæˆ‘å»ºè®®æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥å…³æ³¨HackNewsï¼Œäº†è§£ä¸‹æ¯å¤©çš„ä¸šç•Œæ–°é—»ã€‚ç½‘ç»œä¸Šå·²ç»æœ‰äº†HackNews RSSæº&lt;a href=&#34;https://hnrss.github.io&#34;&gt;https://hnrss.github.io&lt;/a&gt;ï¼Œä½†æ˜¯æ¯å¤©çš„ä¿¡æ¯å¤ªå¤šï¼Œæˆ‘ä¸€èˆ¬åªçœ‹æ ‡é¢˜ï¼Œè‹±æ–‡çš„æ ‡é¢˜ä¼šå½±å“æˆ‘çš„é˜…è¯»ï¼Œæ‰€ä»¥æˆ‘éœ€è¦ä¸€ä¸ªè‡ªåŠ¨ç¿»è¯‘çš„HackNews RSSæºã€‚æ­£å¥½å‰å‡ ä¸ªæœˆCloudflare Workerså¼€å§‹æ”¯æŒPythonï¼Œæ‰€ä»¥æˆ‘å°±ç”¨Pythonå®ç°äº†ä¸€ä¸ªåˆ©ç”¨å¾®è½¯azureç¿»è¯‘APIè‡ªåŠ¨ç¿»è¯‘çš„HackNews RSSæºã€‚å¾®è½¯azureç¿»è¯‘APIæ˜¯æœ‰å…è´¹é¢åº¦ï¼Œæ¯å¤©å¯ä»¥ç¿»è¯‘10ä¸‡å­—ç¬¦ï¼Œå¯¹äºHackNewsæ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚&lt;/p&gt;

&lt;p&gt;ä»£ç åœ°å€ï¼š&lt;a href=&#34;https://github.com/zhu327/workers-hnrss&#34;&gt;https://github.com/zhu327/workers-hnrss&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;4-è‡ªåŠ¨æ£€æµ‹aws-cloudfront-æ–°åŠ å¡-ddns&#34;&gt;4. è‡ªåŠ¨æ£€æµ‹AWS Cloudfront æ–°åŠ å¡ DDNS&lt;/h3&gt;

&lt;p&gt;ç”±äºä¸€äº›ç‰¹æ®Šçš„éœ€æ±‚ï¼Œæˆ‘éœ€è¦ä¿è¯ä¸€ä¸ªåŸŸåä¸€ç›´æŒ‡å‘AWS Cloudfrontçš„æ–°åŠ å¡çš„IPä¸Šï¼Œä½†æ˜¯Cloudfrontçš„IPåœ°å€æ˜¯åŠ¨æ€çš„ï¼Œä¸€æ®µæ—¶é—´å¯èƒ½å¤±æ•ˆï¼Œéœ€è¦æ‰¾æ–°çš„IPåœ°å€ã€‚æ‰€ä»¥æˆ‘å°±å†™äº†ä¸€ä¸ªå°å·¥å…·ï¼Œæ¯å°æ—¶æ£€æµ‹ä¸€æ¬¡Cloudfrontçš„IPåœ°å€æ˜¯å¦æœ‰æ•ˆï¼Œå¦‚æœä¸å¯è¾¾ï¼Œåˆ™è‡ªåŠ¨æ‰¾åˆ°æ–°çš„IPåœ°å€ï¼Œå¹¶ä¸”æ›´æ–°DNSè®°å½•ã€‚&lt;/p&gt;

&lt;p&gt;æ•´ä¸ªé€»è¾‘æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æŸ¥è¯¢DNSPodçš„DNSè®°å½•ï¼Œè·å–è€çš„IPåœ°å€&lt;/li&gt;
&lt;li&gt;http è®¿é—®è¿™ä¸ª IPåœ°å€ï¼Œå¦‚æœä¸å¯è¾¾&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;a href=&#34;https://sg-sin.doh.sb/dns-query&#34;&gt;https://sg-sin.doh.sb/dns-query&lt;/a&gt;è¿™ä¸ªDOHæŸ¥è¯¢ä¸€ä¸ªæ–°çš„æ–°åŠ å¡çš„IPåœ°å€&lt;/li&gt;
&lt;li&gt;é€šè¿‡DNSPodçš„APIæ›´æ–°DNSè®°å½•&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åˆšå¼€å§‹è¿™ä¸ªå°å·¥å…·æ˜¯ç”¨Bashå†™çš„å¹¶é€šè¿‡crontabè¿è¡Œåœ¨æˆ‘çš„æœåŠ¡å™¨ä¸Šï¼Œåæ¥ä¸ºäº†ç»ƒä¹ Rustï¼Œæˆ‘å°±ç”¨Rusté‡å†™äº†è¿™ä¸ªå·¥å…·ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨Cloudflare Workersä¸Šã€‚&lt;/p&gt;

&lt;h3 id=&#34;5-gemini-openai-proxy&#34;&gt;5. Gemini OpenAI Proxy&lt;/h3&gt;

&lt;p&gt;å»å¹´æˆ‘ç”¨Golangå†™äº†ä¸ªä¸€ä¸ªGeminiçš„OpenAIä»£ç†æœåŠ¡&lt;a href=&#34;https://github.com/zhu327/gemini-openai-proxy&#34;&gt;https://github.com/zhu327/gemini-openai-proxy&lt;/a&gt;ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨fly.ioå¹³å°ä¸Šã€‚ä½†æ˜¯å…¶å®ç”¨çš„ä¹ŸæŒºå°‘çš„ï¼Œè¿˜å äº†fly.ioçš„å®ä¾‹èµ„æºã€‚æ‰€ä»¥æˆ‘å°±æƒ³æ‰¾ä¸€ä¸ªservelessçš„ç‰ˆæœ¬æ¥æ›¿ä»£è¿™ä¸ªå·¥å…·ï¼Œç„¶åå°±æ‰¾äº†è¿™ä¸ªæ”¯æŒCloudflare Workersçš„Geminiä»£ç†ï¼š&lt;a href=&#34;https://github.com/PublicAffairs/openai-gemini&#34;&gt;https://github.com/PublicAffairs/openai-gemini&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯å‘¢Cloudflare Workersåœ¨å›½å†…æ˜¯è¢«å±è”½äº†çš„ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠè¿™ä¸ªå°å·¥å…·éƒ¨ç½²åˆ°deno deployä¸Šï¼Œå›½å†…å¯ä»¥æ— ç—›è®¿é—®ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;é™¤äº†å·¥ä½œï¼Œæˆ‘ä»¬åœ¨ç”Ÿæ´»ä¸­ä¹Ÿä¼šæœ‰ä¸€äº›é‡å¤æ€§çš„å·¥ä½œï¼Œå¦‚æœèƒ½è‡ªåŠ¨åŒ–ï¼Œé‚£ä¹ˆå°±å¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚ä½œä¸ºç¨‹åºå‘˜æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç°æœ‰çš„å…è´¹èµ„æºï¼Œæ¥åˆ›é€ è‡ªå·±çš„å°å·¥å…·ï¼Œè®©æˆ‘ä»¬çš„ç”Ÿæ´»æ›´ç¾å¥½ã€‚&lt;/p&gt;

&lt;p&gt;Cloudflare Workers, deno deployï¼Œfly.ioéƒ½æœ‰ä¸€äº›å…è´¹çš„èµ„æºå¯ä»¥åˆ©ç”¨ï¼Œå¯ä»¥è®©æˆ‘ä»¬é›¶æˆæœ¬å®ç°ä¸€äº›å°å·¥å…·ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ChromeOS Flexä½¿ç”¨ä½“éªŒ</title>
      <link>https://zhu327.github.io/2024/08/02/chromeos-flex%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/</link>
      <pubDate>Fri, 02 Aug 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/08/02/chromeos-flex%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;ç”±äºMacBookå¸¦åˆ°æ–°å…¬å¸ä½œä¸ºåŠå…¬æœ¬ä½¿ç”¨ï¼Œåˆå› ä¸ºä¸å–œæ¬¢å¸¦ç”µè„‘ä¸Šä¸‹ç­ï¼Œæ‰€ä»¥åœ¨å®¶é‡Œå°±åªå¥½å¯ç”¨6å¹´å‰åœ¨å‰å…¬å¸é¢†ç”¨çš„ç¬¬ä¸€å°ç¬”è®°æœ¬ThinkPad X1 Carbon (6th Gen)ï¼Œè¿™æ˜¯ä¸€å° i5 8250u/8G Ram/256G SSD/2K14â€˜ é…ç½®çš„ç¬”è®°æœ¬ï¼Œé»˜è®¤ä½¿ç”¨Windows 10æ“ä½œç³»ç»Ÿã€‚è¿™å°ç”µè„‘å·²ç»å¾ˆè€äº†ï¼Œè‚‰çœ¼å¯è§çš„åœ¨æµè§ˆç½‘é¡µæ—¶ä¼šå¡ï¼Œæ‰€ä»¥æƒ³çœ‹çœ‹æœ‰ä»€ä¹ˆå¯ä»¥æ‹¯æ•‘ä¸€ä¸‹è€ç”µè„‘çš„æ–¹æ³•ï¼Œè¦ä¹ˆç›´æ¥ä¸ŠLinuxï¼Œç„¶åå„ç§æŠ˜è…¾é…ç½®ï¼Œå„ç§å¯èƒ½é¢å¯¹çš„é—®é¢˜ï¼Œé«˜åˆ†å±ä¹‹ç±»çš„ã€‚ç„¶åå¦å¤–ä¸€ä¸ªé€‰æ‹©å°±æ˜¯Chrome OS Flexï¼ŒGoogleå®˜æ–¹æ”¯æŒï¼Œä¸å…¶è¯´è¿™æ˜¯ä¸ªæ“ä½œç³»ç»Ÿï¼Œè¿˜ä¸å¦‚è¯´é™¤äº†æµè§ˆå™¨ï¼Œè¿™ä¸ªç³»ç»Ÿå°±å•¥ä¹Ÿæ²¡æœ‰äº†ï¼Œå½“ç„¶è¿˜å¯ä»¥è·‘ä¸€ä¸ªlxcå®¹å™¨çš„Debianã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://support.google.com/chromeosflex/answer/11513094?hl=zh-Hans&#34;&gt;Googleè®¤è¯è®¾å¤‡åˆ—è¡¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™å°ThinkPad X1 Carbon (6th Gen)å¯ä»¥å®˜æ–¹æ”¯æŒåˆ°2028å¹´ï¼Œéå¸¸ä¸é”™ï¼Œæ‰€ä»¥å°±å¯ä»¥å¼€å§‹æŠ˜è…¾äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;å®‰è£…&#34;&gt;å®‰è£…&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://support.google.com/chromeosflex/answer/11541904?hl=zh-Hans&amp;amp;ref_topic=11551271&amp;amp;sjid=9842639522054919015-AP&#34;&gt;ChromeOS Flexå®‰è£…æŒ‡å—&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;é¦–å…ˆè¦ä¿è¯æœ‰ä¸€ä¸ªèƒ½å¯é çš„è®¿é—®Googleçš„ç½‘ç»œç¯å¢ƒï¼Œå»ºè®®ä»ä»¥ä¸Šå®‰è£…æŒ‡å—çš„ä¸‹åŠéƒ¨åˆ†å¼€å§‹ï¼Œç›´æ¥ä¸‹è½½&lt;a href=&#34;https://dl.google.com/chromeos-flex/images/latest.bin.zip&#34;&gt;æœ€æ–°çš„ ChromeOS Flex å®‰è£…ç¨‹åºæ˜ åƒ&lt;/a&gt;ï¼Œç„¶åä½¿ç”¨&lt;a href=&#34;https://rufus.ie/zh/&#34;&gt;Refus å·¥å…·&lt;/a&gt;åˆ·å†™é•œåƒåˆ°Uç›˜ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;é€šè¿‡Uç›˜å¯åŠ¨ç”µè„‘ï¼Œå¾ˆå¿«å°±å¯ä»¥å®‰è£…å¥½ChromeOS Flexäº†ï¼Œç„¶åä½ ä¼šå‘ç°ä½ å¾—åˆ°äº†ä¸€ä¸ªåªæœ‰Chromeæµè§ˆå™¨çš„ç”µè„‘ï¼Œæ˜¯çš„åªæœ‰æµè§ˆå™¨ï¼Œåˆ«çš„å•¥ä¹Ÿæ²¡æœ‰äº†ï¼Œå¯ä»¥è¯´æ˜¯å®‰è£…Chromeæµè§ˆå™¨é€äº†ä¸€ä¸ªç©ºå£³æ“ä½œç³»ç»Ÿã€‚å½“ç„¶è½»é‡åŒ–çš„æ“ä½œç³»ç»Ÿå¸¦æ¥çš„å¥½å¤„å°±æ˜¯Chromeæµè§ˆç½‘é¡µçš„ä½“éªŒæ˜¯çœŸçš„ä¸æ»‘ï¼Œå®Œå…¨ä¸åƒä¸€å°6å¹´å‰çš„ç”µè„‘ã€‚é™¤äº†Chromeæµè§ˆå™¨ï¼Œè¿™ä¸ªæ“ä½œç³»ç»Ÿè¿˜å¯ä»¥é€šè¿‡lxcå®¹å™¨çš„æ–¹å¼å¯åŠ¨ä¸€ä¸ªDebianè™šæ‹Ÿå®¹å™¨ï¼Œè¿›è€Œå¯ä»¥åœ¨è¿™ä¸ªDebianç¯å¢ƒä¸‹å®‰è£…å„ç§Linux Appã€‚&lt;/p&gt;

&lt;h3 id=&#34;debian&#34;&gt;Debian&lt;/h3&gt;

&lt;p&gt;åœ¨ChromeOS Flexä¸‹çš„è®¾ç½®ä¸­å¯ç”¨Debianåå°±å¯ä»¥å¼€å§‹åœ¨Debianç¯å¢ƒä¸‹æŠ˜è…¾äº†ï¼Œæˆ‘çš„ç›®æ ‡å…¶å®å¾ˆç®€å•ï¼Œå®‰è£…vscodeå†™ä»£ç ï¼Œå®‰è£…è§†é¢‘æ’­æ”¾å™¨å¶å°”çœ‹çœ‹ç”µå½±ï¼Œå¦‚ä½•èƒ½å®‰è£…LinuxåŸç”Ÿçš„å¾®ä¿¡å°±æ›´å¥½äº†ï¼Œç„¶åå°±è¿›å…¥äº†æŠ˜è…¾æ¨¡å¼ã€‚&lt;/p&gt;

&lt;p&gt;å‚è€ƒæ–‡ç« ï¼š&lt;a href=&#34;https://blog.skihome.xyz/archives/5/&#34;&gt;æ‰“é€ ä¸€å°é€‚åˆç”Ÿäº§çš„Chromebook&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&#34;æ›´æ¢å›½å†…é•œåƒæº&#34;&gt;æ›´æ¢å›½å†…é•œåƒæº&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo vim /etc/apt/sources.list&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æŠŠ&lt;code&gt;http://deb.debian.org/&lt;/code&gt;æ›¿æ¢æˆ&lt;code&gt;https://mirrors.cloud.tencent.com/&lt;/code&gt;ï¼Œç„¶åæ›´æ–°&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo apt update &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt upgrade&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;linuxæœ¬åœ°åŒ–ä¹‹ä¸­æ–‡ç¯å¢ƒ&#34;&gt;Linuxæœ¬åœ°åŒ–ä¹‹ä¸­æ–‡ç¯å¢ƒ&lt;/h4&gt;

&lt;p&gt;ç»™Linuxå®‰æ’ä¸€ä¸ªä¸­æ–‡ç¯å¢ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´åŠ ä¼˜é›…åœ°ä½¿ç”¨Linuxç¨‹åºã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼Œç‚¹å¼€ç»ˆç«¯ç¨‹åºï¼Œæ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤è¿›è¡Œä¸­æ–‡å­—ä½“çš„å®‰è£…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo apt install fonts-noto-cjk fonts-wqy-microhei fonts-wqy-zenhei&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ¥ä¸‹æ¥éœ€è¦é…ç½®é»˜è®¤localeï¼Œè¾“å…¥å¦‚ä¸‹æŒ‡ä»¤å¹¶é€‰æ‹©zh_CN.UTF-8ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo dpkg-reconfigure locales&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨ç»ˆç«¯ä¸Šå…³é—­Linuxï¼Œç„¶åé‡æ–°æ‰“å¼€ï¼Œå³å¯çœ‹åˆ°ç¨‹åºé»˜è®¤ä½¿ç”¨ä¸­æ–‡æ˜¾ç¤ºã€‚&lt;/p&gt;

&lt;h4 id=&#34;gtkä¸‹çš„ä¸­æ–‡æ˜¾ç¤º&#34;&gt;GTKä¸‹çš„ä¸­æ–‡æ˜¾ç¤º&lt;/h4&gt;

&lt;p&gt;åœ¨æˆ‘ä»¬ä½¿ç”¨ä¸€äº›gtkçš„ç¨‹åºæ—¶ï¼Œå¯èƒ½ä¼šæ„Ÿè§‰ä¸­æ–‡å­—ä½“éå¸¸å¥‡æ€ªï¼Œçœ‹èµ·æ¥éå¸¸ä¸èˆ’æœã€‚æ­¤æ—¶æˆ‘ä»¬éœ€è¦è°ƒæ•´gtké»˜è®¤å­—ä½“ï¼Œä½¿ç¨‹åºæ˜¾ç¤ºæ›´åŠ ä¼˜é›…ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦gnome-tweaksè¿™ä¸ªç¨‹åºï¼Œå¯ä»¥æ§åˆ¶gtkçš„æ˜¾ç¤ºæ•ˆæœã€‚&lt;/p&gt;

&lt;p&gt;å®‰è£…gnome-tweaksï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo apt install gnome-tweaks&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å®‰è£…åï¼Œè¾“å…¥gnome-tweakså¯åŠ¨è¯¥ç¨‹åºã€‚åœ¨&amp;rdquo;å­—ä½“&amp;rdquo;é€‰é¡¹ä¸­ï¼Œè®¾ç½®&amp;rdquo;ç•Œé¢æ–‡æœ¬&amp;rdquo;ä¸&amp;rdquo;æ–‡æ¡£æ–‡æœ¬&amp;rdquo;åˆ†åˆ«ä¸º&amp;rdquo;Noto Sans CJK SC Regular&amp;rdquo; å’Œ &amp;ldquo;Noto Sans Regular&amp;rdquo;ã€‚å…¶ä»–é€‰é¡¹æ— éœ€ä¿®æ”¹(ä¿®æ”¹åå¯èƒ½ä¼šå¯¼è‡´è«åå…¶å¦™çš„åæœ)ã€‚&lt;/p&gt;

&lt;p&gt;è‡ªæ­¤ï¼Œå¤§å¤šæ•°GTKç¨‹åºçš„ä¸­æ–‡æ˜¾ç¤ºéƒ½ä¸ä¼šéå¸¸å¥‡æ€ªã€‚è®¾ç½®å®Œæ¯•åï¼Œä¹Ÿå¯ä»¥å°†å…¶å¸è½½ï¼Œä»¥ä¾¿ç•™å‡ºæ›´å¤šç©ºé—´ã€‚&lt;/p&gt;

&lt;h4 id=&#34;ä¸­æ–‡è¾“å…¥æ³•&#34;&gt;ä¸­æ–‡è¾“å…¥æ³•&lt;/h4&gt;

&lt;p&gt;ChromeOSè‡ªå¸¦çš„Linuxç¯å¢ƒæ˜¯Debian 11ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯Waylandåè®®ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨fcitx5æ¥ä½œä¸ºè¾“å…¥æ³•å¼•æ“ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤å®‰è£…fcitx5ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo apt install fcitx5 fcitx5-chinese-addons fcitx5-frontend-gtk4 fcitx5-frontend-gtk3 fcitx5-frontend-gtk2 fcitx5-frontend-qt5&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç„¶åç¼–è¾‘/etc/profileï¼Œå°†ä¸‹è¿°å†…å®¹å†™å…¥é…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;export XMODIFIERS=@im=fcitx  
export GTK_IM_MODULE=fcitx  
export QT_IM_MODULE=fcitx
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo vim /etc/environment&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;XIM=fcitx
XIM_PROGRAM=fcitx
GTK_IM_MODULE=fcitx
QT_IM_MODULE=fcitx
XMODIFIERS=@im=fcitx
SDL_IM_MODULE=fcitx
GLFW_IM_MODULE=fcitx
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo vim /etc/environment.d/wechat.conf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;GTK_IM_MODULE=fcitx
QT_IM_MODULE=fcitx
XMODIFIERS=@im=fcitx
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¥ä¸‹æ¥è¾“å…¥ fcitx5-configtoolï¼Œè¿›å…¥fcitx5çš„é…ç½®é¡µé¢ã€‚&lt;/p&gt;

&lt;p&gt;å°† æ‹¼éŸ³ ç§»åˆ°å·²å·¦ä¾§ï¼Œæ¿€æ´»æ‹¼éŸ³è¾“å…¥ã€‚ç‚¹å‡»ä¸­é—´çš„æ‰³æ‰‹å›¾æ ‡ï¼Œè¿›å…¥æ‹¼éŸ³çš„è®¾ç½®ã€‚å¼€å¯äº‘æ‹¼éŸ³ï¼Œå¹¶é€‰æ‹©Baiduã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo vim ~/.bashrc&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;# fcitx5
if [ -z $(pgrep -fo &amp;quot;fcitx5&amp;quot;) ]; then
    fcitx5 --disable=wayland -d --verbose &#39;*&#39;=0 &amp;amp;
fi
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·åœ¨æ¯æ¬¡æ‰“å¼€ç»ˆç«¯éƒ½ä¼šå¯åŠ¨fcitx5ã€‚è¾“å…¥çš®è‚¤æ¨èç”¨&lt;a href=&#34;https://github.com/catppuccin/fcitx5&#34;&gt;catppuccin-mocha&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ç½‘ä¸Šçš„èµ„æ–™ä¸­ä¼šæ¨èæŠŠå¯åŠ¨å‘½ä»¤æ”¾åˆ°&lt;code&gt;.sommelierrc&lt;/code&gt;ï¼Œä½†æ˜¯æˆ‘åœ¨ä½¿ç”¨ä¸­å‘ç°æ”¾åˆ°è¿™ä¸ªæ–‡ä»¶ä¸‹ï¼Œä¼šå¯¼è‡´ä½¿ç”¨è¾“å…¥æ³•æ—¶ä¼šäº§ç”Ÿä¸€äº›å¥‡æ€ªçš„è·³åŠ¨ï¼Œæ‰€ä»¥æœ€ç»ˆé€‰æ‹©æ”¾åˆ°&lt;code&gt;~/.bashrc&lt;/code&gt;æ¥å¯åŠ¨ã€‚&lt;/p&gt;

&lt;h4 id=&#34;è§†é¢‘æ’­æ”¾å™¨-mpv&#34;&gt;è§†é¢‘æ’­æ”¾å™¨ mpv&lt;/h4&gt;

&lt;p&gt;åœ¨MacOSæ˜¯æˆ‘å·²ç»ä¹ æƒ¯ä½¿ç”¨IINAæ’­æ”¾å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºmpvçš„å¥—å£³æ’­æ”¾å™¨ï¼Œåœ¨Windowsä¸Šæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨PotPlayerï¼Œç„¶è€Œåœ¨Debianä¸Šæˆ‘æ²¡æœ‰æ‰¾åˆ°ç‰¹åˆ«åˆé€‚çš„æ’­æ”¾å™¨ï¼Œè¯•è¿‡äº†å‡ ä¸ªä»¥åè¿˜æ˜¯é€‰æ‹©ç›´æ¥ä½¿ç”¨mpvï¼Œç”±äºåœ¨Debianå®¹å™¨ä¸­ï¼Œæ²¡æœ‰å¾ˆå¥½çš„GPUæ”¯æŒï¼ŒæŸ¥æ‰¾äº†å¾ˆå¤šèµ„æ–™ï¼Œæœ€åå‘ç°äº†è¿™ä¸ª&lt;a href=&#34;https://wiki.archlinuxcn.org/wiki/Chrome_OS_devices/Crostini#%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE&#34;&gt;https://wiki.archlinuxcn.org/wiki/Chrome_OS_devices/Crostini#%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE&lt;/a&gt;ï¼Œç„¶ååœ¨å‚è€ƒäº†ä¸€äº›mpvçš„é…ç½®æœ€åæœ‰äº†ä¸€ä¸‹é…ç½®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;mkdir -p ~/.config/mpv
vim ~/.config/mpv/mpv.conf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;#è®¾ç½®ç½®é¡¶æ’­æ”¾
ontop=yes

# è®¾å®šç¨‹åºå¯åŠ¨åçš„é»˜è®¤éŸ³é‡
volume=100

# ä½¿å­—å¹•è¾“å‡ºåœ¨é»‘è¾¹ä¸Š
sub-ass-force-margins=yes

# å¼€å¯è‰²å½©ç®¡ç†
blend-subtitles=video

# ç¡¬ä»¶æ¸²æŸ“
vo=gpu
ao=alsa

# è®°å¿†ä¸Šæ¬¡æ’­æ”¾çš„ä½ç½®
save-position-on-quit

# éŸ³è½¨é…ç½®
audio-file-auto=fuzzy
sub-auto=fuzzy
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;vim ~/.config/mpv/input.conf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;# å…¨å±åˆ‡æ¢(å›è½¦é”®åŠå°é”®ç›˜ç¡®è®¤é”®)
Enter    cycle fullscreen
KP_ENTER  cycle fullscreen

# åŒå‡»å·¦é”® æ’­æ”¾/æš‚åœ
MBTN_LEFT_DBL  cycle pause

# æ»šè½®ä¸Šä¸‹æ»‘åŠ¨è°ƒèŠ‚éŸ³é‡
WHEEL_UP      add volume 5
WHEEL_DOWN    add volume -5

# ç©ºæ ¼é”® æ’­æ”¾/æš‚åœ
SPACE cycle pause

# é™éŸ³
m cycle mute

# æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯
TAB script-binding stats/display-stats
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨ç³»ç»Ÿçš„æ–‡ä»¶ç®¡ç†å™¨ä¸‹å¯ä»¥ç›´æ¥ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„å½±éŸ³æ’­æ”¾å™¨æ’­æ”¾è§†é¢‘ï¼Œè¿™æ—¶å€™ä¼šä½¿ç”¨ç³»ç»Ÿçš„ç¡¬ä»¶è§£ç ï¼Œéå¸¸çœç”µï¼Œä½†æ˜¯åœ¨æœ‰äº›ä¸æ”¯æŒçš„æ ¼å¼ï¼Œä»¥åŠéœ€è¦åŠ è½½å¤–æŒ‚å­—å¹•çš„æƒ…å†µä¸‹å¯ä»¥é€‰æ‹©ä½¿ç”¨mpvæ’­æ”¾ï¼Œç»è¿‡ä»¥ä¸Šè®¾ç½®ï¼Œ4Kç”µå½±ä¹Ÿèƒ½æ­£å¸¸æ’­æ”¾ã€‚&lt;/p&gt;

&lt;h4 id=&#34;å¾®ä¿¡&#34;&gt;å¾®ä¿¡&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo apt install libatomic1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä»&lt;a href=&#34;https://github.com/lovechoudoufu/wechat_for_linux/releases&#34;&gt;https://github.com/lovechoudoufu/wechat_for_linux/releases&lt;/a&gt;ä¸‹è½½æœ€æ–°çš„å¾®ä¿¡debåŒ…&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sudo dpkg -i wechat-beta_1.0.0.238_amd64_login.deb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å› ä¸ºä¹‹å‰å·²ç»é…ç½®äº†è¾“å…¥æ³•ï¼Œå®‰è£…å®Œå°±å¯ä»¥å®Œç¾ä½¿ç”¨äº†ã€‚&lt;/p&gt;

&lt;h4 id=&#34;vscode&#34;&gt;VSCode&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://code.visualstudio.com/blogs/2020/12/03/chromebook-get-started&#34;&gt;https://code.visualstudio.com/blogs/2020/12/03/chromebook-get-started&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æŒ‰ä»¥ä¸ŠæŒ‡å¼•å®‰è£…å³å¯ï¼Œè¾“å…¥æ³•æ”¯æŒæ­£å¸¸ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å…¶å®ƒ&#34;&gt;å…¶å®ƒ&lt;/h3&gt;

&lt;p&gt;ChromeOS Flexå†…ç½®çš„è¾“å…¥æ³•å…¶å®ä¹Ÿæ˜¯å¯ä»¥åœ¨Linux Appä¸Šä½¿ç”¨çš„ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« &lt;a href=&#34;https://zonble.medium.com/%E5%9C%A8-crostini-%E4%BD%BF%E7%94%A8-chrome-os-%E7%9A%84%E8%BC%B8%E5%85%A5%E6%B3%95-fb1d226de273&#34;&gt;åœ¨ Crostini ç•¶ä¸­ä½¿ç”¨ Chrome OS çš„è¼¸å…¥æ³•&lt;/a&gt;ï¼Œä½†æ˜¯æˆ‘é…ç½®äº†ä¹‹åå‘ç°åªèƒ½åœ¨VSCodeä¸Šä½¿ç”¨ï¼Œæ”¯æŒä¸äº†å¾®ä¿¡ï¼Œæ‰€ä»¥è¿˜æ˜¯é€‰æ‹©ä½¿ç”¨fctix5ã€‚&lt;/p&gt;

&lt;p&gt;å¦å¤–è¿˜æœ‰ä¸€äº›&lt;code&gt;chrome://flags&lt;/code&gt;å¯ä»¥é€‰æ‹©é…ç½®ï¼š&lt;/p&gt;

&lt;p&gt;å¼€å¯è¶…çº¿ç¨‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#scheduler-configuration
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¼€å¯å¤šçº¿ç¨‹ä¸‹è½½ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#enable-parallel-downloading
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¼€å¯Debiançš„GPUæ”¯æŒ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#crostini-gpu-support
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;å›é¡¾ä¸€ä¸‹æˆ‘åœ¨å®¶é‡Œä½¿ç”¨ç”µè„‘çš„æƒ…å†µï¼Œå…¶å®90%ä»¥ä¸Šçš„æ—¶é—´éƒ½æ˜¯åœ¨ä½¿ç”¨ç½‘é¡µæµè§ˆå™¨ï¼Œå…¶å®ƒå¶å°”çœ‹çœ‹ç”µå½±å•¥çš„ï¼Œåœ¨å®¶é‡Œä¹Ÿä¸å­˜åœ¨éœ€è¦ç”Ÿäº§åŠ›çš„é—®é¢˜ï¼Œç°åœ¨è¿™å°è€ç”µè„‘è¶³ä»¥æä¾›Chromeæµè§ˆå™¨ä¸‹ä¸æ»‘çš„ä½“éªŒã€‚å¶å°”è¦å†™å†™ä»£ç ï¼Œçœ‹çœ‹ç”µå½±ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Linux Appæ¥å®ç°ã€‚ChromeOS Flexæä¾›å¯¹è€ç”µè„‘æ”¯æŒçš„ä¸€ä¸ªç›¸æ¯”å…¶å®ƒLinuxå‘è¡Œç‰ˆä¸æ˜¯é‚£ä¹ˆæŠ˜è…¾çš„é€‰é¡¹ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ä»é¹…å‚å¤§ä½¬èº«ä¸Šå­¦æŠ€æœ¯</title>
      <link>https://zhu327.github.io/2024/05/10/%E4%BB%8E%E9%B9%85%E5%8E%82%E5%A4%A7%E4%BD%AC%E8%BA%AB%E4%B8%8A%E5%AD%A6%E6%8A%80%E6%9C%AF/</link>
      <pubDate>Fri, 10 May 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/05/10/%E4%BB%8E%E9%B9%85%E5%8E%82%E5%A4%A7%E4%BD%AC%E8%BA%AB%E4%B8%8A%E5%AD%A6%E6%8A%80%E6%9C%AF/</guid>
      <description>&lt;p&gt;2018ä¸‹åŠå¹´æˆ‘åŠ å…¥é¹…å‚ï¼Œ2019å¹´è°ƒå²—åˆ°ç°åœ¨çš„ç»„ï¼Œä¸€ç›´è·Ÿç€é¹…å‚11çº§å¤§ä½¬åšäº‹ï¼Œä¸ºäº†æå‡è‡ªå·±èƒ½åŠ›ï¼Œæˆ‘å¼€å§‹å­¦ä¹ å¤§ä½¬çš„åšäº‹æ–¹å¼ï¼Œæˆ‘å‘ç°å¤§ä½¬çš„èƒ½åŠ›å¾€å¾€ä½“ç°åœ¨ä»–çš„æ€ç»´çš„å±‚æ¬¡ä¸Šï¼Œç®€å•çš„è¯´å°±æ˜¯è§£å†³æŸä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘å½“æ—¶å¯èƒ½åªçœ‹åˆ°ç¬¬2å±‚ï¼Œä½†æ˜¯å¤§ä½¬å·²ç»æƒ³åˆ°ç¬¬4å±‚ä¸Šå»äº†ï¼Œè¿™æœŸé—´æˆ‘ä¹Ÿæ‰¾å¤§ä½¬èŠè¿‡å¤©ï¼Œä¹Ÿæœ‰ä¸€äº›æ”¶è·ï¼Œåœ¨è¿™é‡Œé€šè¿‡ä¸€äº›å…·ä½“çš„äº‹ä¾‹æ¥åˆ†æä¸€ä¸‹å¤§ä½¬çš„æŠ€æœ¯èƒ½åŠ›ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;é‡å¤çç¢çš„å·¥ä½œ&#34;&gt;é‡å¤çç¢çš„å·¥ä½œ&lt;/h3&gt;

&lt;p&gt;æˆ‘æ‰€åœ¨çš„é¡¹ç›®æ˜¯ä¸€ä¸ªå…¬å…±çš„å¹³å°é¡¹ç›®ï¼Œå¯¹å¤–æä¾›apiå¯¹æ¥æœåŠ¡ï¼Œä¸å¯é¿å…çš„å°±ä¸€ç›´æœ‰äº›OnCallçš„å·¥ä½œï¼Œåœ¨é¡¹ç›®åˆæœŸï¼Œä¹Ÿæ˜¯å„ç§appå¯¹æ¥çš„é«˜å³°æœŸï¼Œæˆ‘æ¯å¤©çš„å·¥ä½œæ—¶é—´åŸºæœ¬ä¸Šéƒ½è¢«å„ç§å’¨è¯¢ï¼Œå„ç§é—®é¢˜æ‰€å ç”¨ï¼Œæ–‡æ¡£ä¹Ÿå†™äº†ï¼Œå„ç§FAQä¹Ÿè¯´æ˜äº†ã€‚ä½†æ˜¯ç”±äºå¹³å°æœ¬èº«æ¨¡å‹çš„å¤æ‚æ€§ï¼Œé—®é¢˜æ€»æ˜¯åœ¨é‡å¤ã€‚è€ƒæ ¸å‘¨æœŸä¸€ç›˜ç‚¹ï¼Œå‘ç°å®é™…äº§å‡ºç›¸æ¯”ä»¥å¾€æœ‰æ‰€é™ä½ï¼Œå¤ç›˜æˆ‘å¤„ç†è¿™äº›OnCallå·¥ä½œçš„æ–¹å¼ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å†™æ–‡æ¡£ï¼ŒæŒç»­æ›´æ–°æ–‡æ¡£&lt;/li&gt;
&lt;li&gt;å†™FAQï¼ŒæŒç»­æ•´ç†å¹¶æ›´æ–°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é‚£ä¹ˆé—®é¢˜å‡ºç°åœ¨å“ªé‡Œå‘¢ï¼Œä»å¤§ä½¬å¼€å§‹å‚ä¸é¡¹ç›®å¼€å§‹ï¼Œè¿™äº›OnCallçš„äº‹é¡¹æˆäº†é¡¹ç›®é‡ç‚¹éœ€è¦è§£å†³çš„é—®é¢˜ï¼Œå¤§ä½¬é¦–å…ˆè¦æ±‚æˆ‘å­¦ä¹ ä¸šç•Œä¼˜ç§€çš„å¼€æºé¡¹ç›®æ–‡æ¡£å†™ä½œæ–¹å¼ï¼Œæ•´ç†å¹³å°é¡¹ç›®æ–‡æ¡£çš„æœ€ä½³å®è·µã€‚æˆ‘åœ¨é˜…è¯»äº†ç›¸å…³æ–‡æ¡£ï¼Œä»¥åŠæ–‡æ¡£å†™ä½œç»éªŒåï¼Œæ‰¾åˆ°äº†å¹³å°é¡¹ç›®å†™æ–‡æ¡£çš„æœ€ä½³å®è·µï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;QuickStartï¼šè¿™éƒ¨åˆ†å†…å®¹å†™ä¸€ä¸ªç®€çŸ­çš„demoæ¥ä¸ºè¯»è€…æä¾›ä¸€ä¸ªå¿«é€Ÿå¯åŠ¨çš„å¯¼è§ˆ&lt;/li&gt;
&lt;li&gt;HowToï¼šä»¥ç”¨æˆ·çš„è§’åº¦ä»–å¯èƒ½ç¢°åˆ°çš„ä¸€äº›é—®é¢˜çš„åœºæ™¯æ¥è¯´æ˜å¦‚ä½•è¿›è¡Œ&lt;/li&gt;
&lt;li&gt;Explanationï¼šä¸€äº›çº¦å®šçš„åè¯æ¦‚å¿µï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšçš„è¯´æ˜&lt;/li&gt;
&lt;li&gt;Referenceï¼šæœ€åæ˜¯ä¸€äº›å…³è”çš„æ–‡æ¡£ï¼Œapiçš„docsï¼Œæ€§èƒ½æµ‹è¯•æŠ¥å‘Šï¼ŒFAQç­‰ç­‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨åŸºäºä»¥ä¸Šæ–‡æ¡£ç»“æ„é‡æ–°æ•´ç†çš„æ–‡æ¡£åï¼Œç”¨æˆ·åé¦ˆæ¥å…¥æµç¨‹æ¸…æ™°äº†å¾ˆå¤šï¼Œä¸åŒéœ€æ±‚çš„ç”¨æˆ·éƒ½èƒ½åœ¨QuickStartçš„åŸºç¡€ä¸Šç»“åˆHowToæ¥å®ç°è‡ªå·±çš„éœ€æ±‚ã€‚&lt;/p&gt;

&lt;p&gt;é’ˆå¯¹ç”¨æˆ·çš„å„ç§ç–‘éš¾é—®é¢˜ï¼Œå¤§ä½¬è¦æ±‚æˆ‘é™¤äº†æ•´ç†FAQä»¥å¤–è¿˜è¦åˆ†æFAQä¸­çš„ä¸€äº›é—®é¢˜æ˜¯å¦èƒ½é€šè¿‡è‡ªåŠ¨åŒ–æ¥è§£å†³ï¼Œæ˜¯å¦èƒ½è®©ç”¨æˆ·è‡ªè¡Œé€šè¿‡å·¥å…·è§£å†³ï¼Œåœ¨åˆ†æäº†ä¸€äº›å…±æ€§çš„é—®é¢˜åï¼Œæˆ‘æ‰¾äº†2ä¸ªå¯ä»¥å®ç°å·¥å…·çš„ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;é’ˆå¯¹æ¥å£é€»è¾‘éš¾ä»¥è°ƒè¯•çš„ç‚¹ï¼Œåœ¨ç”¨æˆ·è°ƒç”¨æ¥å£çš„å…¥å£ç‚¹å¢åŠ debugå¼€å…³ï¼Œåœ¨apiçš„æ‰§è¡Œé€»è¾‘ä¸­å¦‚æœå¼€å¯debugï¼Œå°±ä¸€è·¯æ”¶é›†ç›¸å…³ä¿¡æ¯ï¼Œç›´æ¥æŠŠè°ƒè¯•ä¿¡æ¯è¿”å›ç»™ç”¨æˆ·ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥è‡ªè¡Œè°ƒè¯•&lt;/li&gt;
&lt;li&gt;é’ˆå¯¹åˆä¸€äº›éœ€è¦æ‰‹åŠ¨ä¿®æ”¹æ•°æ®çš„æ“ä½œï¼Œæ•´ç†ç›¸å…³æ“ä½œï¼Œå†™ä¸ªä¸€ä¸ªç®€å•çš„åŠ©æ‰‹appï¼Œä½¿å¾—ç”¨æˆ·èƒ½è‡ªåŠ©å¤„ç†é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€šè¿‡ä»¥ä¸Šæªæ–½ï¼ŒåŸæœ¬çš„OnCallå·¥ä½œæ‰€å ç”¨çš„æ—¶é—´å‡å°‘äº†60%ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å°±å®Œç¾äº†å‘¢ï¼Œå¤§ä½¬è¯´ä¸æ˜¯ï¼Œå¤§ä½¬è¦æ±‚æˆ‘æƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆæ€»æ˜¯ä¼šæœ‰è¿™ä¹ˆå¤šçš„å’¨è¯¢é‡ï¼Œæ˜¯ä¸æ˜¯é¡¹ç›®æœ¬èº«çš„è®¾è®¡çš„æ¨¡å‹å°±æ˜¯æœ‰é—®é¢˜ï¼Œå°±ç®—æ²¡æœ‰é—®é¢˜ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹å¼èƒ½è®©ç”¨æˆ·å‡å°‘å’¨è¯¢ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶åæˆ‘å¼€å§‹é‡æ–°å¤ç›˜é¡¹ç›®çš„åŠŸèƒ½ã€‚å’¨è¯¢é‡å¤§çš„æ ¹å› åœ¨äºé¡¹ç›®æœ¬èº«éœ€æ±‚çš„å¤æ‚åº¦ï¼Œç”¨æˆ·å¯¹æ¥çš„æ—¶å€™æ˜¯æœ‰å¾ˆé«˜çš„ç†è§£æˆæœ¬çš„ï¼Œé€ æˆäº†å’¨è¯¢é‡å¾ˆå¤§ï¼Œä½†æ˜¯éœ€æ±‚çš„å¤æ‚åº¦æš‚æ—¶æ˜¯æ²¡æœ‰åŠæ³•é™ä½çš„ï¼Œåªèƒ½å’Œäº§å“åŒå­¦ä¸€èµ·æƒ³åŠæ³•ï¼Œæœ€åæˆ‘æ¨åŠ¨äº§å“ä¸€èµ·åšäº†ä¸€ä¸ªå¯è§†åŒ–æ¥å…¥çš„appï¼Œå¸®åŠ©ç”¨æˆ·ç»„åœ¨å¯è§†åŒ–æ¥å…¥æµç¨‹ä¸­ç†è§£æ¥å…¥æµç¨‹ï¼Œç”Ÿæˆæ•°æ®ã€‚è™½ç„¶è¿™ä¸ªappä¸èƒ½è¦†ç›–100%çš„åœºæ™¯ï¼Œä½†æ˜¯å¯¹äº70%ä»¥ä¸Šçš„ç®€å•éœ€æ±‚è¶³ä»¥è¦†ç›–ã€‚&lt;/p&gt;

&lt;p&gt;åˆ°è¿™é‡ŒOnCallçš„å·¥ä½œç»ˆäºä¸å†å ç”¨æˆ‘å¤ªå¤šçš„æ—¶é—´äº†ï¼Œè®©æˆ‘ä»¬æ¥æ€»ç»“ä¸‹æˆ‘å½“æ—¶çš„æ€ç»´å±‚æ¬¡:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€å±‚ï¼šç”¨æˆ·é—®ä»€ä¹ˆè§£å†³ä»€ä¹ˆ&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒå±‚ï¼šæ€»ç»“æ–‡æ¡£ï¼ŒFAQé¿å…é‡å¤å›ç­”&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¤§ä½¬çš„æ€ç»´å±‚æ¬¡ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸‰å±‚ï¼šæŠ½è±¡å·¥å…·æ¥è§£å†³é—®é¢˜&lt;/li&gt;
&lt;li&gt;ç¬¬å››å±‚ï¼šè¯†åˆ«ä¸šåŠ¡æœ¬èº«çš„é—®é¢˜ï¼Œæ¨åŠ¨ä¸šåŠ¡æ”¹è¿›&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;èƒ½æƒ³åˆ°ç¬¬å‡ å±‚å®é™…å°±ä½“ç°äº†æŠ€æœ¯èƒ½åŠ›å“ªé‡Œï¼ŒæŠ€æœ¯èƒ½åŠ›æ˜¯ä¸€ç§ä»¥è§£å†³æŸç§é—®é¢˜ä¸ºç›®æ ‡çš„æ€è·¯ã€æ–¹æ³•ä¸æ‰§è¡Œæ‰‹æ®µï¼Œå…¶æœ¬è´¨å°±æ˜¯è§£å†³é—®é¢˜çš„èƒ½åŠ›ã€‚åœ¨ç¼–ç¨‹é¢†åŸŸï¼Œå°±æ˜¯å¯¹é‡åˆ°çš„ä¸šåŠ¡é—®é¢˜è¿›è¡ŒæŠ½è±¡ã€æç‚¼ä»¥åŠé€»è¾‘çš„æ„å»ºï¼Œé€šè¿‡ç ”å‘å·¥å…·ä»¥æå‡è§£å†³é—®é¢˜çš„æ•ˆèƒ½ï¼Œå‡ä½äººå·¥ä½æ•ˆçš„é‡å¤å·¥ä½œã€‚&lt;/p&gt;

&lt;h3 id=&#34;æŠ½è±¡å¤æ‚çš„å·¥ä½œ&#34;&gt;æŠ½è±¡å¤æ‚çš„å·¥ä½œ&lt;/h3&gt;

&lt;p&gt;éšç€ä¸šåŠ¡çš„å‘å±•ï¼Œæˆ‘ä»¬çš„é¡¹ç›®å¯¹æ¥çš„appä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ªå…¬å…±å¹³å°ï¼Œéœ€æ±‚çš„æ¨è¿›å¾€å¾€ä»¥é€šç”¨éœ€æ±‚ä¸ºä¸»ï¼Œä½†æ˜¯å¯¹æ¥çš„appæœ‰å„ç§å„æ ·ï¼Œéœ€æ±‚å„ä¸ç›¸åŒï¼Œå¯¼è‡´ç”¨æˆ·è™½ç„¶å¯¹æ¥äº†ï¼Œä½†æ˜¯å¾ˆå¤šç‰¹æœ‰çš„éœ€æ±‚åˆè¦è‡ªå·±å®ç°ï¼Œä¸ºäº†æ»¡è¶³è¿™ç±»ç”¨æˆ·çš„è¯‰æ±‚ï¼Œæˆ‘å¼€å§‹ä¸“é¡¹è®¿è°ˆæŠ±æ€¨çš„ç”¨æˆ·ï¼Œäº†è§£ä»–ä»¬çš„éœ€æ±‚ï¼Œé’ˆå¯¹æ€§çš„è§£å†³ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯å¤§ä½¬æç¤ºæˆ‘ï¼Œæœ‰ä¸€äº›ç”¨æˆ·è™½ç„¶æ²¡æœ‰æŠ±æ€¨ï¼Œä¸ä»£è¡¨æ²¡æœ‰éœ€æ±‚ï¼Œåº”è¯¥åšä¸€ä¸ªé—®å·å¹¿æ³›æ”¶é›†æ„è§ï¼Œå®‰æ’ä¸“äººå¤„ç†ã€‚&lt;/p&gt;

&lt;p&gt;è¿›ä¸€æ­¥è¦ä»æ”¶é›†çš„æ„è§ä¸­æç‚¼éœ€æ±‚ï¼Œæç‚¼ä»·å€¼ï¼Œä»æ¶æ„ä¸äº§å“çš„è§’åº¦å¯»æ‰¾åŸå› ï¼Œæ‹†è§£ä»»åŠ¡ï¼Œåˆ¶å®šå®æ–½è®¡åˆ’ã€‚&lt;/p&gt;

&lt;p&gt;åˆ°è¿™é‡Œæ˜¯ä¸æ˜¯å®Œäº†å‘¢ï¼Œå¤§ä½¬è¯´å…¶å®æ›´åº”è¯¥ä»ç»„ç»‡æ¶æ„ï¼Œä»å¹´åº¦ç›®æ ‡ä¸Šä»æ”¶ç›Šæœ€å¤§åŒ–çš„è§’åº¦ï¼Œä»åŸ¹å…»å›¢é˜Ÿçš„è§’åº¦å…¨å±€æ€è€ƒè¿™äº›æ”¶é›†çš„æ„è§ï¼Œç»¼åˆè€ƒé‡ã€‚å½“ç„¶è¿™é‡Œå°±æ¯”è¾ƒé«˜å±‚æ¬¡äº†ï¼Œéœ€è¦æ›´å¤šçš„æ€è€ƒã€‚&lt;/p&gt;

&lt;p&gt;æ€»ç»“ä¸‹è¿™é‡Œå·¥ä½œçš„æ€è€ƒå±‚æ¬¡ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€å±‚ï¼šæœ‰ä»€ä¹ˆé—®é¢˜è§£å†³ä»€ä¹ˆé—®é¢˜&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒå±‚ï¼šå¹¿æ³›æ”¶é›†ï¼Œä¸“äººè·Ÿè¿›è§£å†³é—®é¢˜&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰å±‚ï¼šæŠ½è±¡ä¸šåŠ¡éœ€æ±‚ï¼Œæ”¹è¿›äº§å“ä¸æ¶æ„&lt;/li&gt;
&lt;li&gt;ç¬¬å››å±‚ï¼šä»ä¸šåŠ¡å‘å±•ï¼Œä¸ªäººå‘å±•ï¼Œç»„ç»‡å‘å±•çš„è§’åº¦æ€è€ƒä¸šåŠ¡æ¼”è¿›çš„æ–¹å‘&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘ä»¬éœ€è¦ä»ä¸šåŠ¡å‘å±•ä¸è‡ªæˆ‘å‘å±•ä¸ç»„ç»‡å‘å±•çš„è§’åº¦æ¥æ€è€ƒå¦‚ä½•å¤„ç†å„ç§å¤æ‚æŠ½è±¡çš„å·¥ä½œï¼Œé¿å…åªçŸ¥é“æ¥éœ€æ±‚ï¼Œæˆä¸ºä¸€ä¸ªé¡¹ç›®ç»ç†ï¼ŒåªçŸ¥é“é€šè¿‡ä»»åŠ¡æ¥è·Ÿè¸ªè¿›åº¦ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å…³é”®å†³ç­–&#34;&gt;å…³é”®å†³ç­–&lt;/h3&gt;

&lt;p&gt;åœ¨ä¸å¤§ä½¬çš„åˆä½œè¿‡ç¨‹ä¸­æˆ‘ä¸€ç›´æœ‰ä¸€ä¸ªç–‘é—®ï¼Œå°±æ˜¯é¡¹ç›®æ¨è¿›çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€äº›å…³é”®çš„å†³ç­–æ˜¯æ€ä¹ˆç¡®å®šçš„ï¼Œæ¯”å¦‚åœ¨æŸä¸ªæ—¶é—´ç‚¹å¤§ä½¬è¦æ±‚æˆ‘ä»¬å¿…é¡»é‡æ–°æ•´ç†ä»£ç å±‚æ¬¡ï¼ŒæŠ½è±¡æ–°çš„ä»£ç ç¼–ç è§„èŒƒï¼Œä½†æ˜¯è¿™ä¸ªäº‹æƒ…å…¶å®çŸ­æœŸæ¥çœ‹å¹¶ä¸ä¼šçœ‹åˆ°æœ‰æ”¶ç›Šï¼Œå¯èƒ½ä»è€æ¿çš„è§’åº¦æ¥çœ‹è¿™éƒ½ä¸ç®—äº§å‡ºã€‚åœ¨ä¸€æ¬¡èŠå¤©ä¸­ï¼Œæˆ‘æå‡ºäº†æˆ‘çš„ç–‘é—®ï¼Œå¤§ä½¬ä»3ä¸ªè§’åº¦å¸®æˆ‘è§£äº†æƒ‘ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æœ‰æ‰€åšæŒï¼šæœ‰ä¸€äº›åŸåˆ™è‡ªå·±å¿…é¡»åšæŒï¼Œæ¯”å¦‚å¯¹ä»£ç çš„æ¶æ„ï¼Œä»£ç çš„æ•´æ´&lt;/li&gt;
&lt;li&gt;é•¿æœŸä¸»ä¹‰ï¼šé¡¹ç›®å¯èƒ½ä¼šé•¿æ—¶é—´çš„åœ¨è‡ªå·±æ‰‹é‡Œç»´æŠ¤ï¼Œæ‰€ä»¥éœ€è¦çœ‹è¿œä¸€ç‚¹ï¼Œå¦åˆ™å‘çš„è¿˜æ˜¯è‡ªå·±&lt;/li&gt;
&lt;li&gt;å‘ä¸Šæ±‡æŠ¥ï¼šè¦è®©leaderçŸ¥é“ä½ åœ¨åšä»€ä¹ˆä»¥åŠè¿™ä¹ˆåšçš„å¿…è¦æ€§ï¼Œè·å–leaderçš„æ”¯æŒ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨ä¸å¤§ä½¬åˆä½œçš„è¿™å‡ å¹´ä¸­ï¼Œé€šè¿‡è§‚å¯Ÿå¤§ä½¬çš„å·¥ä½œæ–¹å¼ï¼Œæˆ‘å­¦åˆ°äº†å¾ˆå¤šã€‚ç¼–ç¨‹èƒ½åŠ›æ˜¯ç¨‹åºå‘˜çš„æ ¸å¿ƒåŸºç¡€èƒ½åŠ›ï¼Œä½†æ˜¯åªæ˜¯èƒ½åŠ›çš„ä¸€éƒ¨ä»½ï¼Œæˆ‘ä»¬è¿˜è¦æé«˜æˆ‘ä»¬çš„æ€ç»´å±‚æ¬¡ï¼Œæé«˜æ•ˆç‡ï¼Œå¢åŠ äº§å‡ºã€‚è½¯æŠ€èƒ½ä¹Ÿå¾ˆé‡è¦ï¼Œè¡¨è¾¾èƒ½åŠ›ï¼Œæ²Ÿé€šèƒ½åŠ›ï¼Œé¡¹ç›®ç®¡ç†èƒ½åŠ›éƒ½æ˜¯ç¨‹åºå‘˜éœ€è¦å…³æ³¨çš„æŠ€èƒ½ç‚¹ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ç©è½¬ HackNewsï¼šå¦‚ä½•æ­£ç¡®è®¢é˜…ç§‘æŠ€æ–°é—»</title>
      <link>https://zhu327.github.io/2024/04/10/%E7%8E%A9%E8%BD%AC-hacknews%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E8%AE%A2%E9%98%85%E7%A7%91%E6%8A%80%E6%96%B0%E9%97%BB/</link>
      <pubDate>Wed, 10 Apr 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/04/10/%E7%8E%A9%E8%BD%AC-hacknews%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E8%AE%A2%E9%98%85%E7%A7%91%E6%8A%80%E6%96%B0%E9%97%BB/</guid>
      <description>&lt;p&gt;è¿‘æ—¥ï¼Œæˆ‘åœ¨æ¢ç´¢ HackNews çš„è¿‡ç¨‹ä¸­ï¼Œæ”¶è·äº†å¤§é‡çš„æ–°çŸ¥è¯†ã€‚ç„¶è€Œï¼Œæˆ‘å‘ç°è‡ªåŠ¨è®¢é˜…çš„ HackNews RSS æºå¹¶æ²¡æœ‰å¯¹çƒ­é—¨è¯é¢˜è¿›è¡Œç­›é€‰ï¼Œå¯¼è‡´æˆ‘çš„ RSS é˜…è¯»å™¨é‡Œå……æ–¥ç€æˆ‘ä¸æ„Ÿå…´è¶£çš„è¯é¢˜ã€‚äºæ˜¯ï¼Œæˆ‘å¼€å§‹å¯»æ‰¾é€‚åˆè‡ªå·±çš„ HackNews RSS è®¢é˜…æºã€‚åœ¨ä¼—å¤šé€‰æ‹©ä¸­ï¼Œæˆ‘å‘ç°äº† &lt;a href=&#34;https://hnrss.org/newest?points=100&#34;&gt;https://hnrss.org/newest?points=100&lt;/a&gt;ï¼Œè¿™ä¸ªæºåªæ¨é€çƒ­é—¨è¯é¢˜ï¼Œéå¸¸é€‚åˆæˆ‘ã€‚ç„¶è€Œï¼Œç”±äºå…¨è‹±æ–‡é˜…è¯»æœ‰äº›ç¹çï¼Œæˆ‘åˆæ‰¾åˆ°äº† &lt;a href=&#34;https://rsstranslator.com/&#34;&gt;https://rsstranslator.com/&lt;/a&gt; è¿™ä¸ªæä¾›ç¿»è¯‘æœåŠ¡çš„ç½‘ç«™ï¼Œèƒ½å°† HackNews ç¿»è¯‘æˆä¸­æ–‡æ ‡é¢˜ï¼Œéå¸¸ä¾¿æ·ã€‚ä½†ä¸å¹¸çš„æ˜¯ï¼Œç”±äºè®¿é—®é‡è¿‡å¤§ï¼Œè¯¥ç½‘ç«™å·²å…³é—­æœåŠ¡å¹¶å¼€æºä»£ç ã€‚åœ¨å°è¯•äº†å„ç§å·¥å…·åæœªæœï¼Œæˆ‘å†³å®šè‡ªå·±åŠ¨æ‰‹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç„¶è€Œï¼Œæˆ‘åˆä¸å¸Œæœ›ç»´æŠ¤ç‹¬ç«‹çš„æœåŠ¡ï¼Œè€Œåˆšå¥½ &lt;a href=&#34;https://blog.cloudflare.com/python-workers&#34;&gt;Cloudflare Workers å¼€å§‹æ”¯æŒ Python&lt;/a&gt;ï¼Œäºæ˜¯æˆ‘å†³å®šä½¿ç”¨ Cloudflare Workers æ¥å®ç°è¿™ä¸ªæœåŠ¡ã€‚åœ¨è¯„ä¼°äº†å„ç§ç¿»è¯‘ API åï¼Œæˆ‘é€‰æ‹©äº† Microsoft Azure ç¿»è¯‘ APIï¼Œå®ç°äº†å…è´¹ç¿»è¯‘çš„åŠŸèƒ½ã€‚æœ€ç»ˆï¼Œæˆ‘å®Œæˆäº†è¿™ä¸ªé¡¹ç›® &lt;a href=&#34;https://github.com/zhu327/workers-hnrss&#34;&gt;workers-hnrss&lt;/a&gt;ï¼Œå¹¶ä¸”å®Œå…¨é›¶æˆæœ¬éƒ¨ç½²ã€‚ä½†åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç° Cloudflare Workers è¿˜ä¸æ”¯æŒ &lt;code&gt;requirements.txt&lt;/code&gt;ï¼Œä¸è¿‡æ®ä»–ä»¬çš„æ–‡æ¡£ç§°ï¼Œå†è¿‡å‡ å‘¨å°±ä¼šæ”¯æŒï¼Œæ‰€ä»¥æˆ‘å†³å®šå†ç­‰ç­‰ï¼Œç„¶åå°±å¯ä»¥åœ¨æˆ‘çš„ RSS é˜…è¯»å™¨ä¸Šè¯»åˆ°ä¸­æ–‡æ ‡é¢˜çš„ HackNews äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;åœ¨å¯»æ‰¾ HackNews RSS çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘è¿˜å‘ç°äº† &lt;a href=&#34;https://hackernewsrecap.buzzsprout.com/&#34;&gt;https://hackernewsrecap.buzzsprout.com/&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªç”± AI ç”Ÿæˆçš„æ¯æ—¥ HackNews è¯­éŸ³æ‘˜è¦æ’­å®¢ã€‚ç„¶è€Œï¼ŒåŒæ ·æ˜¯å…¨è‹±æ–‡çš„ï¼Œæˆ‘æ›¾è€ƒè™‘é€šè¿‡ TTS å°†å…¶è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œç„¶åä½¿ç”¨ Gemini API ç¿»è¯‘æˆä¸­æ–‡ï¼Œå¹¶å®šæ—¶æ¨é€æˆ HackNews ä¸­æ–‡æ‘˜è¦æ’­å®¢ã€‚ä½†åœ¨è¯„ä¼°äº†å„ç§ TTS API åï¼Œå‘ç°é•¿è¯­éŸ³è½¬æ–‡æœ¬çš„æˆæœ¬æœ‰ç‚¹å¤§ï¼Œå¹¶ä¸”å·¥ç¨‹éš¾åº¦ä¹Ÿä¸å°ï¼Œæ‰€ä»¥æˆ‘æ”¾å¼ƒäº†è¿™ä¸ªæƒ³æ³•ã€‚ç„¶è€Œï¼Œæœ€è¿‘æˆ‘å‘ç°æœ‰äººå·²ç»å®ç°äº†æˆ‘æƒ³åšçš„äº‹ï¼Œå¹¶ä¸”ä¸­æ–‡æ•ˆæœç›¸å½“æµç•…ã€‚å¹¶ä¸”æœ‰ä¼´éšè¯­éŸ³å’Œå›¾æ–‡å†…å®¹ï¼Œéå¸¸ä¸é”™ã€‚è€Œä¸” RSSHub ä¹Ÿæ”¯æŒå°†å…¶è½¬æ¢ä¸º RSSï¼Œæ‰€ä»¥æˆ‘ä¹Ÿåœ¨ RSS é˜…è¯»å™¨ä¸Šè®¢é˜…äº†è¿™ä¸ªå†…å®¹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://www.xiaoyuzhoufm.com/podcast/6456fdfc0a8e51c73e68d0cd&#34;&gt;https://www.xiaoyuzhoufm.com/podcast/6456fdfc0a8e51c73e68d0cd&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡ä»¥ä¸Šè¿™äº›è®¢é˜…ï¼Œæˆ‘èƒ½åŠæ—¶äº†è§£åˆ°å›½å¤–å„ç§çƒ­é—¨ç§‘æŠ€è¯é¢˜ï¼Œè€Œä¸”æ˜¯åœ¨ä¸­æ–‡ç¯å¢ƒä¸­ã€‚æœ‰æ—¶å€™ï¼Œåœ¨ç½‘ç»œä¸Šæ‰¾ä¸åˆ°è§£å†³æ–¹æ¡ˆæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥åŠ¨åŠ¨è‡ªå·±çš„è„‘ç­‹ï¼Œå†™äº›ä»£ç æ¥è§£å†³é—®é¢˜ã€‚ç°åœ¨çš„äº’è”ç½‘æœ‰å„ç§å…è´¹èµ„æºï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å……åˆ†åˆ©ç”¨ï¼Œé€šè¿‡è¿™äº›èµ„æºæ”¹å–„æˆ‘ä»¬çš„ç”Ÿæ´»ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>2023å¹´é˜…è¯»åˆ†äº«ï¼šæ·±åº¦æŒ–æ˜ç¼–ç¨‹ä¹‹é“</title>
      <link>https://zhu327.github.io/2024/01/10/2023%E5%B9%B4%E9%98%85%E8%AF%BB%E5%88%86%E4%BA%AB%E6%B7%B1%E5%BA%A6%E6%8C%96%E6%8E%98%E7%BC%96%E7%A8%8B%E4%B9%8B%E9%81%93/</link>
      <pubDate>Wed, 10 Jan 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/01/10/2023%E5%B9%B4%E9%98%85%E8%AF%BB%E5%88%86%E4%BA%AB%E6%B7%B1%E5%BA%A6%E6%8C%96%E6%8E%98%E7%BC%96%E7%A8%8B%E4%B9%8B%E9%81%93/</guid>
      <description>&lt;p&gt;ä½œä¸ºä¸€ä¸ªçƒ­è¡·äºæŠ€æœ¯çš„ç¨‹åºå‘˜åšä¸»ï¼Œæˆ‘åœ¨2023å¹´è¿æ¥äº†å…¨æ–°çš„é˜…è¯»ä½“éªŒï¼Œå°†RSSä½œä¸ºæˆ‘çš„ä¸»è¦ä¿¡æ¯æºï¼Œå¹¶é€šè¿‡è®¢é˜…Hacker Newsçƒ­é—¨ä¸»é¢˜ï¼ŒæŒç»­æ·±å…¥è‹±æ–‡æŠ€æœ¯æ–‡ç« çš„é˜…è¯»ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°äº†ä¸€äº›çœŸæ­£ç²¾å½©çš„æ–‡ç« ï¼Œè¿™äº›ä¸ä»…ä»…æ˜¯çŸ¥è¯†çš„ç§¯ç´¯ï¼Œæ›´æ˜¯å¯¹ç¼–ç¨‹ä¹‹è·¯çš„æ·±åˆ»æ€è€ƒã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†å…¶ä¸­ä¸€äº›æˆ‘è®¤ä¸ºå€¼å¾—åˆ†äº«çš„æ–‡ç« æ•´ç†å‡ºæ¥ï¼Œæ¨èç»™å„ä½çœ‹å®˜ï¼Œå¸Œæœ›ä½ ä»¬åœ¨å­¦ä¹ ä¸­æ‰¾åˆ°çµæ„Ÿï¼Œä¸æ–­è¿›æ­¥ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;åŸºç¡€ç¯‡&#34;&gt;&lt;strong&gt;åŸºç¡€ç¯‡&lt;/strong&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://tontinton.com/posts/database-fundementals/&#34;&gt;Database Fundamentals&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä½œè€…æ·±å…¥æµ…å‡ºåœ°ä»‹ç»äº†æ•°æ®åº“åŸºç¡€çŸ¥è¯†ï¼Œå¯¹äºæ„å»ºç¨³å¥çš„æ•°æ®å­˜å‚¨ç³»ç»Ÿè‡³å…³é‡è¦ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://iq.thc.org/how-does-linux-start-a-process&#34;&gt;How does Linux start a process&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æ·±å…¥ç†è§£Linuxå¯åŠ¨è¿‡ç¨‹ï¼Œä»æ“ä½œç³»ç»Ÿçš„è§’åº¦æ¢ç©¶è¿›ç¨‹çš„åˆ›å»ºæœºåˆ¶ï¼Œå¯¹äºç†è§£åº•å±‚åŸç†æœ‰ç€é‡è¦çš„å¯å‘ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://labs.iximiuz.com/tutorials/container-networking-from-scratch&#34;&gt;How Container Networking Works - Building a Linux Bridge Network From Scratch&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è¿™ç¯‡æ•™ç¨‹è¯¦ç»†è®²è§£äº†å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªLinuxæ¡¥æ¥ç½‘ç»œï¼Œæ·±å…¥äº†è§£å®¹å™¨ç½‘ç»œèƒŒåçš„åŸç†ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.kawabangga.com/posts/5330&#34;&gt;æœ‰å…³ TLS/SSL è¯ä¹¦çš„ä¸€åˆ‡&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å¯¹äºç½‘ç»œå®‰å…¨è‡³å…³é‡è¦çš„TLS/SSLè¯ä¹¦ï¼Œæœ¬æ–‡æ¶µç›–äº†ä¸ä¹‹ç›¸å…³çš„æ–¹æ–¹é¢é¢ï¼Œæ˜¯ä¸€ä»½æƒå¨çš„å‚è€ƒèµ„æ–™ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://ibraheem.ca/posts/too-many-web-servers/&#34;&gt;Learning Async Rust With Entirely Too Many Web Servers&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Rustè¯­è¨€å¼‚æ­¥ç¼–ç¨‹çš„å­¦ä¹ ä¹‹æ—…ï¼Œé€šè¿‡æ„å»ºå¤šä¸ªWebæœåŠ¡å™¨çš„è¿‡ç¨‹ï¼Œå¸®åŠ©è¯»è€…æ›´å¥½åœ°ç†è§£å¼‚æ­¥ç¼–ç¨‹çš„ç²¾é«“ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;æŠ€å·§ç¯‡&#34;&gt;&lt;strong&gt;æŠ€å·§ç¯‡&lt;/strong&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://johnnymetz.com/posts/slow-django-database-queries/&#34;&gt;Supercharge Your Django App: 7 Sneaky Tricks to Crush Slow Database Queries&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Djangoåº”ç”¨æ€§èƒ½ä¼˜åŒ–çš„ä¸ƒä¸ªæŠ€å·§ï¼Œè§£å†³æ…¢æŸ¥è¯¢é—®é¢˜ï¼Œæå‡åº”ç”¨çš„å“åº”é€Ÿåº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://blog.europython.eu/kraken-technologies-how-we-organize-our-very-large-pythonmonolith/&#34;&gt;Kraken Technologies: How we organize our very large Python monolith&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Kraken Technologiesåˆ†äº«äº†ä»–ä»¬æ˜¯å¦‚ä½•ç»„ç»‡åºå¤§çš„Pythonå•ä½“åº”ç”¨çš„ï¼Œå¯¹äºå¤§å‹é¡¹ç›®çš„æ¶æ„è®¾è®¡æœ‰å¾ˆå¥½çš„å€Ÿé‰´ä»·å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.b-list.org/weblog/2022/dec/19/boring-python-code-quality/&#34;&gt;Boring Python: code quality&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;é€šè¿‡è®²è§£â€œæ— èŠâ€çš„Pythonä»£ç å¦‚ä½•æé«˜ä»£ç è´¨é‡ï¼Œæœ¬æ–‡å¼ºè°ƒäº†ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§çš„é‡è¦æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://sharats.me/posts/shell-script-best-practices/&#34;&gt;Shell Script Best Practices&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Shellè„šæœ¬æœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ å†™å‡ºæ›´åŠ å¥å£®å’Œå¯ç»´æŠ¤çš„Shellè„šæœ¬ï¼Œæé«˜å‘½ä»¤è¡Œå·¥å…·çš„è´¨é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.willett.io/posts/precepts/&#34;&gt;How to Build Software like an SRE&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ä»¥SREï¼ˆSite Reliability Engineeringï¼‰çš„è§†è§’ï¼Œåˆ†äº«äº†æ„å»ºé«˜å¯ç”¨è½¯ä»¶çš„åŸåˆ™å’Œå®è·µï¼Œå¯¹äºè¿½æ±‚ç³»ç»Ÿç¨³å®šæ€§çš„å¼€å‘è€…å°¤ä¸ºé‡è¦ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;é€šè¯†ç¯‡&#34;&gt;&lt;strong&gt;é€šè¯†ç¯‡&lt;/strong&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.huxiu.com/article/2440157.html&#34;&gt;OpenAIå®˜æ–¹æŒ‡å—ï¼šå¦‚ä½•è®©ChatGPTè¾“å‡ºæ›´å¥½çš„ç»“æœï¼Ÿ&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;äº†è§£å¦‚ä½•åˆ©ç”¨OpenAIçš„ChatGPTæ¨¡å‹è·å¾—æ›´ä¼˜è´¨çš„è¾“å‡ºç»“æœï¼Œå¯¹äºä¸è‡ªç„¶è¯­è¨€å¤„ç†ç›¸å…³çš„å¼€å‘è€…æœ‰ç€å®é™…æŒ‡å¯¼æ„ä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.luu.io/posts/mature-engineer&#34;&gt;One common behavior seen in â€œmatureâ€ software engineers&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æœ¬æ–‡æ¢è®¨äº†â€œæˆç†Ÿâ€è½¯ä»¶å·¥ç¨‹å¸ˆä¸­å¸¸è§çš„ä¸€äº›è¡Œä¸ºï¼Œå¯¹äºè¿½æ±‚èŒä¸šå‘å±•å’ŒæŠ€æœ¯æˆç†Ÿåº¦çš„è¯»è€…æœ‰å¾ˆå¥½çš„å¯ç¤ºã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://huyenchip.com/2023/01/24/what-we-look-for-in-a-candidate.html&#34;&gt;What we look for in a resume&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;é’ˆå¯¹ç®€å†ä¸­çš„å…³é”®è¦ç´ ï¼Œåˆ†äº«äº†æ‹›è˜è€…åœ¨å€™é€‰äººä¸­å¯»æ‰¾çš„ç‰¹è´¨ï¼Œæ˜¯ä¸€ä»½å®ç”¨çš„æ±‚èŒæŒ‡å—ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://jimmyislive.dev/posts/how-to-prioritize/&#34;&gt;How To Prioritize Tasks ?&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å­¦ä¼šå¦‚ä½•åˆç†ä¼˜å…ˆçº§åœ°å¤„ç†ä»»åŠ¡ï¼Œæé«˜å·¥ä½œæ•ˆç‡ï¼Œè¿™å¯¹äºä»»ä½•ä¸€ä½ç¨‹åºå‘˜éƒ½æ˜¯å¿…å¤‡çš„ç”Ÿå­˜æŠ€èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™äº›å»ºè®®çš„é˜…è¯»ææ–™å¸Œæœ›èƒ½å¤Ÿä¸ºä½ åœ¨ç¼–ç¨‹ä¹‹è·¯ä¸Šæä¾›æ–°çš„æ€è·¯å’ŒæŠ€èƒ½ï¼Œè®©æˆ‘ä»¬å…±åŒè¿›æ­¥ï¼Œè¿æ¥2024å¹´æ›´å¤šçš„æŠ€æœ¯æŒ‘æˆ˜ï¼&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>é€æ˜ä»£ç†å®è·µï¼šæŠ€æœ¯å°ç»“ä¸æ–¹æ¡ˆæ¼”è¿›</title>
      <link>https://zhu327.github.io/2023/12/23/%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86%E5%AE%9E%E8%B7%B5%E6%8A%80%E6%9C%AF%E5%B0%8F%E7%BB%93%E4%B8%8E%E6%96%B9%E6%A1%88%E6%BC%94%E8%BF%9B/</link>
      <pubDate>Sat, 23 Dec 2023 15:25:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2023/12/23/%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86%E5%AE%9E%E8%B7%B5%E6%8A%80%E6%9C%AF%E5%B0%8F%E7%BB%93%E4%B8%8E%E6%96%B9%E6%A1%88%E6%BC%94%E8%BF%9B/</guid>
      <description>&lt;h3 id=&#34;1-è·¯ç”±æ‹“æ‰‘&#34;&gt;1. è·¯ç”±æ‹“æ‰‘&lt;/h3&gt;

&lt;p&gt;åœ¨å®¶ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸­å›½ç§»åŠ¨æä¾›çš„åƒå…†å®½å¸¦æœåŠ¡ï¼Œé€šè¿‡ç§»åŠ¨è‡ªå¸¦çš„å…‰çŒ«è¿›è¡Œæ‹¨å·è¿æ¥ã€‚ç´§éšå…¶åæ˜¯ä¸€å°æ­è½½OpenWRTç³»ç»Ÿçš„è·¯ç”±å™¨ï¼Œè´Ÿè´£ç®¡ç†Wi-Fiä»¥åŠå±€åŸŸç½‘çš„ç½‘ç»œåœ°å€è½¬æ¢ï¼ˆNATï¼‰ã€‚ç”±äºå…‰çŒ«å·²å ç”¨äº†192.168.1.1ç½‘æ®µï¼Œæˆ‘ä»¬å°†è·¯ç”±å™¨é…ç½®ä¸º192.168.2.1ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç®¡ç†IPv4æµé‡ã€‚åœ¨IPv4ç½‘ç»œä¸­ï¼Œæ•°æ®æµç»è¿‡å…‰çŒ«å’Œè·¯ç”±å™¨çš„åŒå±‚NATè¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºIPv6ç½‘ç»œï¼Œç”±äºè·¯ç”±å™¨æ— æ³•ç›´æ¥è·å–åœ°å€å‰ç¼€ï¼Œæˆ‘ä»¬é…ç½®äº†IPv6 DHCP RelayåŠŸèƒ½ï¼Œç¡®ä¿å±€åŸŸç½‘å†…çš„æ¯ä¸ªè®¾å¤‡éƒ½èƒ½å¤Ÿè·å–IPv6åœ°å€ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ä¸‹æ˜¯æˆ‘ä»¬åœ¨OpenWRTè·¯ç”±å™¨ä¸Šçš„ç›¸å…³é…ç½®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# cat /etc/config/network
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;config interface &lt;span class=&#34;s1&#34;&gt;&amp;#39;lan&amp;#39;&lt;/span&gt;
	option &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;bridge&amp;#39;&lt;/span&gt;
	option ifname &lt;span class=&#34;s1&#34;&gt;&amp;#39;eth0 ra0 ra1 rai0 rai1&amp;#39;&lt;/span&gt;
	option proto &lt;span class=&#34;s1&#34;&gt;&amp;#39;static&amp;#39;&lt;/span&gt;
	option netmask &lt;span class=&#34;s1&#34;&gt;&amp;#39;255.255.255.0&amp;#39;&lt;/span&gt;
	option ipaddr &lt;span class=&#34;s1&#34;&gt;&amp;#39;192.168.2.1&amp;#39;&lt;/span&gt;
	option macaddr &lt;span class=&#34;s1&#34;&gt;&amp;#39;C8:BF:4C:87:EE:68&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡å°†LANå£çš„MACåœ°å€å›ºå®šè®¾ç½®ï¼Œä»¥é¿å…LAN IPv6åœ°å€çš„å˜åŒ–ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# cat /etc/config/dhcp
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;config dhcp &lt;span class=&#34;s1&#34;&gt;&amp;#39;lan&amp;#39;&lt;/span&gt;
	option interface &lt;span class=&#34;s1&#34;&gt;&amp;#39;lan&amp;#39;&lt;/span&gt;
	option start &lt;span class=&#34;s1&#34;&gt;&amp;#39;100&amp;#39;&lt;/span&gt;
	option limit &lt;span class=&#34;s1&#34;&gt;&amp;#39;150&amp;#39;&lt;/span&gt;
	option leasetime &lt;span class=&#34;s1&#34;&gt;&amp;#39;12h&amp;#39;&lt;/span&gt;
	option ra_slaac &lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;
	list ra_flags &lt;span class=&#34;s1&#34;&gt;&amp;#39;managed-config&amp;#39;&lt;/span&gt;
	list ra_flags &lt;span class=&#34;s1&#34;&gt;&amp;#39;other-config&amp;#39;&lt;/span&gt;
	option ra &lt;span class=&#34;s1&#34;&gt;&amp;#39;relay&amp;#39;&lt;/span&gt;
	option ndp &lt;span class=&#34;s1&#34;&gt;&amp;#39;relay&amp;#39;&lt;/span&gt;
	option dhcpv6 &lt;span class=&#34;s1&#34;&gt;&amp;#39;relay&amp;#39;&lt;/span&gt;
	option force &lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;
	list dns &lt;span class=&#34;s1&#34;&gt;&amp;#39;fe80::cabf:4cff:fe87:ee68&amp;#39;&lt;/span&gt;

config dhcp &lt;span class=&#34;s1&#34;&gt;&amp;#39;wan&amp;#39;&lt;/span&gt;
	option interface &lt;span class=&#34;s1&#34;&gt;&amp;#39;wan&amp;#39;&lt;/span&gt;
	option ignore &lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;
	option dhcpv6 &lt;span class=&#34;s1&#34;&gt;&amp;#39;relay&amp;#39;&lt;/span&gt;
	option ra &lt;span class=&#34;s1&#34;&gt;&amp;#39;relay&amp;#39;&lt;/span&gt;
	option ndp &lt;span class=&#34;s1&#34;&gt;&amp;#39;relay&amp;#39;&lt;/span&gt;
	option master &lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ­¤å¤„ï¼Œæˆ‘ä»¬é…ç½®äº†IPv6 DHCP RelayåŠŸèƒ½ï¼Œç›´æ¥ä»å…‰çŒ«è·å–IPv6åœ°å€ï¼Œå¹¶æŒ‡å®šLANå£IPv6åœ°å€ä½œä¸ºIPv6 DNSé€šå‘Šï¼Œä»¥ç¡®ä¿å±€åŸŸç½‘å†…çš„è®¾å¤‡çš„DNSé…ç½®æ— è®ºæ˜¯IPv4è¿˜æ˜¯IPv6åœ°å€éƒ½æ˜¯OpenWRTè·¯ç”±å™¨ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;2-dnsåˆ†æµé€æ˜ä»£ç†&#34;&gt;2. DNSåˆ†æµé€æ˜ä»£ç†&lt;/h3&gt;

&lt;p&gt;ä¸ºäº†æ»¡è¶³ä¸€äº›ç‰¹æ®Šéœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç‰¹å®šåŸŸåè¿›è¡Œä»£ç†ï¼Œä»¥ç¡®ä¿å±€åŸŸç½‘å†…çš„æ¯ä¸ªè®¾å¤‡éƒ½èƒ½è½»æ¾æ— é…ç½®åœ°äº«å—ä»£ç†æœåŠ¡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åœ¨OpenWRTè·¯ç”±å™¨ä¸Šé…ç½®äº†é€æ˜ä»£ç†ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºäº†å®ç°åªæœ‰ç‰¹å®šåŸŸåèµ°ä»£ç†çš„ç›®çš„ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨DNSå±‚é¢è¿›è¡Œåˆ†æµã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ›´ä¸ºç´§å‡‘çš„DNSåˆ†æµç¤ºæ„å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/zhu327/zhu327.github.io/assets/873883/594bdd94-3593-4278-8fa8-b8f7067b345e&#34; alt=&#34;Image1&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Dnsmasqè´Ÿè´£DNSåˆ†æµï¼Œå°†å‘½ä¸­ä»£ç†åŸŸååˆ—è¡¨çš„åŸŸååˆ†æµåˆ°SmartDNSï¼Œå¹¶å°†æŸ¥è¯¢çš„IPæ”¾å…¥ipsetä¸­ã€‚å¯¹äºç›´è¿çš„åŸŸåï¼Œç›´æ¥é€šè¿‡å…‰çŒ«è¿›è¡ŒDNSæŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;li&gt;SmartDNSè´Ÿè´£ä»£ç†åŸŸåçš„DNSæŸ¥è¯¢ï¼Œé€šè¿‡TCP DNSæŸ¥è¯¢èµ°é€æ˜ä»£ç†åˆ°è¿œç«¯çš„ä»£ç†æœåŠ¡å™¨ä¸Šï¼ŒæŸ¥è¯¢ä»£ç†æœåŠ¡å™¨ä¸Šæœ€ä½³çš„IPåœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;ipt2socksæ˜¯ä¸€ä¸ªå°†é€æ˜ä»£ç†è½¬æ¢ä¸ºSocks5ä»£ç†çš„å°å·¥å…·ï¼Œé€šè¿‡è¿™ä¸ªå·¥å…·å¯ä»¥é™ä½è·¯ç”±å™¨è´Ÿè½½ã€‚çœŸæ­£çš„ä»£ç†ç¨‹åºè¿è¡Œåœ¨å±€åŸŸç½‘å†…çš„NASä¸Šã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Dnsmasqåˆ†æµé…ç½®ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;server=/example.com/127.0.0.1#5335
ipset=/example.com/vpn
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·ï¼Œå‘½ä¸­åˆ†æµåˆ—è¡¨çš„åŸŸåä¼šè¢«å‘é€åˆ°SmartDNSï¼ŒåŒæ—¶æŸ¥è¯¢åˆ°çš„IPåœ°å€ä¼šè¢«æ”¾å…¥ipset vpnä¸­ã€‚&lt;/p&gt;

&lt;p&gt;SmartDNSé…ç½®ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bind :5335 -no-dualstack-selection -no-speed-check -force-aaaa-soa

server-tcp 8.8.8.8
server-tcp 1.1.1.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;SmartDNSå°†UDP DNSæŸ¥è¯¢è½¬æ¢ä¸ºTCP DNSæŸ¥è¯¢ï¼Œé€šè¿‡iptablesè·¯ç”±åˆ°ipt2socksï¼Œæœ€ç»ˆåœ¨è¿œç«¯çš„ä»£ç†æœåŠ¡å™¨ä¸ŠæŸ¥è¯¢ã€‚SmartDNSè¿˜å¼ºåˆ¶æ‰§è¡ŒSOA IPv6çš„DNSæŸ¥è¯¢ï¼Œä»¥é˜²æ­¢ä»£ç†æµé‡é€šè¿‡IPv6ç›´æ¥èµ°åˆ°å…‰çŒ«è€Œç»•è¿‡è·¯ç”±å™¨NATã€‚&lt;/p&gt;

&lt;p&gt;TCPåˆ†æµç¤ºæ„å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/zhu327/zhu327.github.io/assets/873883/91c390ba-c1a6-42a2-b8de-3d3e38b74f83&#34; alt=&#34;Image2&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å½“ç›®æ ‡IPå‘½ä¸­ipset vpnæµé‡æ—¶ï¼Œé‡å®šå‘åˆ°ipt2socksè¿›è¡Œä»£ç†ã€‚ç›´è¿çš„æµé‡åˆ™ç›´æ¥é€šè¿‡ç³»ç»Ÿå‡ºå£ã€‚&lt;/p&gt;

&lt;p&gt;iptablesé…ç½®ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# åˆ›å»ºipset
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;ipset create vpn hash:ip

iptables -t nat -N V2RAY &lt;span class=&#34;c1&#34;&gt;# æ–°å»ºä¸€ä¸ªåä¸º V2RAY çš„é“¾
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;iptables -t nat -A V2RAY -p tcp -m &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; --match-set vpn dst -j REDIRECT --to-ports &lt;span class=&#34;m&#34;&gt;12345&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# å‘½ä¸­ipset vpnçš„æµé‡é‡å®šå‘åˆ°ipt2socks
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;iptables -t nat -A PREROUTING -p tcp -j V2RAY &lt;span class=&#34;c1&#34;&gt;# å¯¹å±€åŸŸç½‘å…¶ä»–è®¾å¤‡è¿›è¡Œé€æ˜ä»£ç†
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;iptables -t nat -A OUTPUT -p tcp -j V2RAY # å¯¹æœ¬æœºè¿›è¡Œé€æ˜ä»£ç†&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ipt2sockså¯åŠ¨å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;/usr/bin/ipt2socks -R -4 -j &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; -s &lt;span class=&#34;m&#34;&gt;192&lt;/span&gt;.168.2.141 -p &lt;span class=&#34;m&#34;&gt;1080&lt;/span&gt; -l &lt;span class=&#34;m&#34;&gt;12345&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™ä¸€æ–¹æ¡ˆçš„å…·ä½“å®ç°é€šè¿‡OpenWRTçš„Passwallæ’ä»¶ï¼Œä½¿å¾—é…ç½®å˜å¾—éå¸¸ä¾¿æ·ã€‚å°½ç®¡è¿™ä¸ªæ–¹æ¡ˆåœ¨æ—¥å¸¸ä½¿ç”¨ä¸­è¡¨ç°è‰¯å¥½ï¼Œä½†ä¹Ÿå­˜åœ¨3ä¸ªä¸»è¦é—®é¢˜ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æµçš„DNSéœ€è¦é€šè¿‡è¿œç«¯ä»£ç†æŸ¥è¯¢&lt;/strong&gt;ï¼Œè™½ç„¶æˆ‘ä»¬åˆ©ç”¨DNSç¼“å­˜æ¥å‡è½»å½±å“ï¼Œä½†ä»å¯èƒ½å½±å“é¦–æ¬¡å“åº”é€Ÿåº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹äºä¸€äº›èµ°CDNçš„ç½‘ç«™ï¼Œæ˜¯å¦å°†å…¶IPåŠ å…¥ipsetä¸å¤ªç¡®å®š&lt;/strong&gt;ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸€äº›ç½‘ç«™æ— æ³•æ­£å¸¸è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ipsetå˜å¤§ä»¥åå½±å“iptablesåŒ¹é…æ•ˆç‡&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;3-fake-ipé€æ˜ä»£ç†&#34;&gt;3. Fake IPé€æ˜ä»£ç†&lt;/h3&gt;

&lt;p&gt;æœ€è¿‘æˆ‘äº†è§£åˆ°ä¸€ç§ç§°ä¸ºFake IPçš„ä»£ç†æ–¹æ¡ˆï¼Œå°†å…¶åº”ç”¨åˆ°æˆ‘çš„ç°æœ‰è§£å†³æ–¹æ¡ˆä¸­ï¼ŒæˆåŠŸè§£å†³äº†æ—§æ–¹æ¡ˆå­˜åœ¨çš„ä¸‰ä¸ªé—®é¢˜ã€‚æ–°æ–¹æ¡ˆæ›´ä¸ºç®€æ´é«˜æ•ˆï¼Œæ— éœ€ä¾èµ–SmartDNSå’ŒPasswallæ’ä»¶ï¼Œç›´æ¥æ‰‹åŠ¨æ­å»ºå³å¯ã€‚&lt;/p&gt;

&lt;h4 id=&#34;dnsæŸ¥è¯¢ç¤ºæ„å›¾&#34;&gt;DNSæŸ¥è¯¢ç¤ºæ„å›¾ï¼š&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/zhu327/zhu327.github.io/assets/873883/a9a68e6b-ca83-4397-9742-83732b7c07f7&#34; alt=&#34;Image3&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨DNSæŸ¥è¯¢ä¸­ï¼ŒDnsmasqé€šè¿‡åˆ†æµåï¼Œå‘½ä¸­ä»£ç†åŸŸåçš„æŸ¥è¯¢ä¼šè¢«å¼•å¯¼è‡³v2rayçš„Fake DNSä¸Šï¼Œè¯¥Fake DNSè¿”å›ä¸€ä¸ªå›ºå®šç½‘æ®µçš„Fake IPã€‚ä¸å†éœ€è¦è®¾ç½®ipsetï¼Œæ–¹æ¡ˆæ›´ä¸ºç®€åŒ–ã€‚&lt;/p&gt;

&lt;h4 id=&#34;tcpæµé‡ç¤ºæ„å›¾&#34;&gt;TCPæµé‡ç¤ºæ„å›¾ï¼š&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/zhu327/zhu327.github.io/assets/873883/2c05cec4-741a-43dd-b709-3f77d5e9ce7e&#34; alt=&#34;Image4&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨TCPæµé‡æ–¹é¢ï¼Œå‘½ä¸­å›ºå®šç½‘æ®µçš„iptablesè§„åˆ™åï¼Œæµé‡å°†è¢«é‡å®šå‘è‡³ipt2socksã€‚ipt2sockså°†é€æ˜ä»£ç†è½¬æ¢ä¸ºSocks5ä»£ç†ï¼Œå¹¶å°†æµé‡å‘é€è‡³v2rayã€‚v2rayæ£€æµ‹åˆ°ç›®æ ‡IPä¸ºFake IPåï¼Œå¡«å……æˆåŸŸåå¹¶å‘é€è‡³è¿œç«¯ä»£ç†æœåŠ¡å™¨ï¼Œå®ç°ä»£ç†åŸŸåçš„è§£æã€‚&lt;/p&gt;

&lt;h4 id=&#34;v2rayé…ç½®å‚è€ƒ&#34;&gt;v2rayé…ç½®å‚è€ƒï¼š&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;#34;log&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;loglevel&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;warning&amp;#34;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;#34;fakedns&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;ipPool&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;198.18.0.0/15&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;poolSize&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;65535&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;#34;dns&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;servers&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
      &lt;span class=&#34;s2&#34;&gt;&amp;#34;fakedns&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;queryStrategy&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;USE_IP4&amp;#34;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;#34;inbounds&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;port&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5335&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;tag&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;dns-in&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;dokodemo-door&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;settings&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;address&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;119.29.29.29&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;port&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;53&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;network&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;udp&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;port&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1080&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;socks&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;settings&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;auth&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;noauth&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;udp&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;sniffing&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;enabled&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;destOverride&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
          &lt;span class=&#34;s2&#34;&gt;&amp;#34;fakedns&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;metadataOnly&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;#34;outbounds&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;vless&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;err&#34;&gt;#&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;å‡ºå£åè®®&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;dns&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;#34;tag&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;dns-out&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;#34;routing&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;rules&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;field&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;inboundTag&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
          &lt;span class=&#34;s2&#34;&gt;&amp;#34;dns-in&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;#34;outboundTag&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;dns-out&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;#34;strategy&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;rules&amp;#34;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;iptablesè§„åˆ™ç¤ºä¾‹&#34;&gt;iptablesè§„åˆ™ç¤ºä¾‹ï¼š&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;iptables -t nat -N V2RAY
iptables -t nat -A V2RAY -d &lt;span class=&#34;m&#34;&gt;198&lt;/span&gt;.18.0.0/15 -p tcp -j REDIRECT --to-ports &lt;span class=&#34;m&#34;&gt;12345&lt;/span&gt;
iptables -t nat -A PREROUTING -p tcp -j V2RAY
iptables -t nat -A OUTPUT -p tcp -j V2RAY&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™ä¸€æ–°æ–¹æ¡ˆé€šè¿‡Fake IPçš„ä»£ç†æœºåˆ¶æˆåŠŸè§£å†³äº†æ—§æ–¹æ¡ˆå­˜åœ¨çš„é—®é¢˜ï¼Œæ›´åŠ ç®€æ´é«˜æ•ˆã€‚å…¶ä¸­ï¼Œv2rayçš„é…ç½®å’Œiptablesè§„åˆ™çš„è®¾ç½®ä½¿å¾—æ•´ä¸ªæ–¹æ¡ˆåœ¨å®è·µä¸­æ›´ä¸ºå¯è¡Œå’Œç¨³å®šã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-æ€»ç»“&#34;&gt;4. æ€»ç»“&lt;/h3&gt;

&lt;p&gt;é€šè¿‡å®è·µä¸ä¸æ–­çš„å°è¯•ï¼Œæˆ‘ä»¬æˆåŠŸå®ç°äº†ä¸€å¥—é«˜æ•ˆã€ç®€æ´çš„é€æ˜ä»£ç†æ–¹æ¡ˆï¼Œè®©å®¶ä¸­ç½‘ç»œæ›´å…·çµæ´»æ€§å’Œéšç§ä¿æŠ¤ã€‚é€šè¿‡é‡‡ç”¨Fake IPé€æ˜ä»£ç†ï¼Œæˆ‘ä»¬è§£å†³äº†æ—§æ–¹æ¡ˆä¸­å­˜åœ¨çš„DNSæŸ¥è¯¢é€Ÿåº¦ã€CDNç½‘ç«™ä¸ç¡®å®šæ€§ç­‰é—®é¢˜ã€‚æ–°æ–¹æ¡ˆæ— éœ€ä¾èµ–ç¹æ‚çš„æ’ä»¶ï¼Œé€šè¿‡æ‰‹åŠ¨é…ç½®å³å¯è½»æ¾æ­å»ºã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸€æ–¹æ¡ˆçš„ç²¾é«“åœ¨äºåˆ©ç”¨v2rayçš„Fake DNSåŠŸèƒ½ï¼Œå°†ç‰¹å®šåŸŸåçš„DNSæŸ¥è¯¢å¼•å¯¼è‡³Fake IPï¼Œè¿›è€Œå®ç°é€æ˜ä»£ç†ã€‚åŒæ—¶ï¼Œé€šè¿‡iptablesçš„è§„åˆ™è®¾ç½®ï¼Œæˆ‘ä»¬æˆåŠŸå°†æµé‡é‡å®šå‘è‡³ä»£ç†ï¼Œå®ç°äº†é€æ˜ä»£ç†çš„é«˜æ•ˆè¿ä½œã€‚è¿™ä¸ä»…æé«˜äº†ç½‘ç»œä½¿ç”¨ä½“éªŒï¼ŒåŒæ—¶ä¹ŸåŠ å¼ºäº†ç½‘ç»œéšç§å’Œå®‰å…¨ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ç¯‡æ–‡ç« è¯¦ç»†ä»‹ç»äº†å®¶åº­ç½‘ç»œçš„æ‹“æ‰‘ç»“æ„ã€IPv4ä¸IPv6çš„é…ç½®ä»¥åŠä¸‰ä¸ªé˜¶æ®µçš„é€æ˜ä»£ç†æ–¹æ¡ˆæ¼”è¿›ã€‚é€šè¿‡æœ¬æ–‡çš„åˆ†äº«ï¼Œå¸Œæœ›è¯»è€…åœ¨æ­å»ºè‡ªå·±çš„é€æ˜ä»£ç†æ–¹æ¡ˆæ—¶èƒ½å¤Ÿæœ‰æ‰€å€Ÿé‰´ï¼Œæ›´å¥½åœ°å®šåˆ¶é€‚åˆè‡ªå·±éœ€æ±‚çš„ç½‘ç»œç¯å¢ƒã€‚ç½‘ç»œæŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œä¹Ÿè®©æˆ‘ä»¬å¯¹æœªæ¥çš„ç½‘ç»œä½“éªŒå……æ»¡æœŸå¾…ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ç§‘æŠ€çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬å°†ä¸æ–­è¿½æ±‚åˆ›æ–°ï¼Œä¸æ–­å®Œå–„ï¼Œè®©ç§‘æŠ€æ›´å¥½åœ°æœåŠ¡äºæˆ‘ä»¬çš„ç”Ÿæ´»ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¯å‘ï¼Œä¸ºæ‚¨çš„ç½‘ç»œæ¢ç´¢ä¹‹è·¯æä¾›ä¸€äº›æœ‰ç›Šçš„å‚è€ƒã€‚&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>
