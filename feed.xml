<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
      <title>è·¬æ­¥ On Coding </title>
      <generator uri="https://gohugo.io">Hugo</generator>
    <link>https://zhu327.github.io/</link>
    <language>zh-cn</language>
    
    
    <updated>Mon, 20 Oct 2025 10:00:52 &#43;0800</updated>
    
    <item>
      <title>pingsix-ingress-controllerå¯åŠ¨</title>
      <link>https://zhu327.github.io/2025/10/20/pingsix-ingress-controller%E5%90%AF%E5%8A%A8/</link>
      <pubDate>Mon, 20 Oct 2025 10:00:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/10/20/pingsix-ingress-controller%E5%90%AF%E5%8A%A8/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/zhu327/pingsix&#34;&gt;https://github.com/zhu327/pingsix&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;PingSIX è‡ªä»ä¸Šæ¬¡é‡æ„ä¹‹å, æˆ‘ä¸€ç›´åœ¨è€ƒè™‘å¦‚ä½•æ‰©å±•è¿™ä¸ªé¡¹ç›®çš„åŠŸèƒ½ä¸ä½¿ç”¨åœºæ™¯, æœ‰2ä¸ªæ–¹å‘å¯ä»¥è€ƒè™‘:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æ”¯æŒproxy-wasmæ’ä»¶&lt;/li&gt;
&lt;li&gt;å®ç°pingsix-ingress-controller&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨è°ƒç ”äº†proxy-wasmçš„ç›¸å…³åŠŸèƒ½å, ç»“è®ºæ˜¯ç”±äºpingoraé¢å‘çš„åœºæ™¯æ˜¯CDNçš„åå‘ä»£ç†, æ‰€ä»¥æ²¡æœ‰è€ƒè™‘è¿‡æ–¹ä¾¿çš„ä¿®æ”¹è¯·æ±‚ä½“ä¸å“åº”ä½“, è¿™å°±é€ æˆå¾ˆéš¾åŸºäºpingoraæ¥å®ç°proxy-wasmçš„ABI, å¦‚æœæˆ‘è¦è‡ªå·±å®šä¹‰ä¸€ä¸ªwasmçš„æ¥å£åè®®, æ²¡æ³•å¤ç”¨ç¤¾åŒºç°æœ‰çš„proxy-wasmæ’ä»¶, é‚£å°±æ²¡å¿…è¦äº†, ä¸å¦‚ç›´æ¥å†™Rustçš„æ’ä»¶. ç›¸å…³å‚è€ƒå†…å®¹:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cloudflare/pingora/issues/17&#34;&gt;proxy-wasm support&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://segmentfault.com/a/1190000045232953&#34;&gt;pingora èƒ½åšä»€ä¹ˆå’Œä¸èƒ½åšä»€ä¹ˆ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨æ”¾å¼ƒäº†proxy-wasmçš„æ”¯æŒå, æˆ‘å¼€å§‹è°ƒç ”å¦‚ä½•å®ç°pingsix-ingress-controller, ç”±äºpingsixçš„çš„èµ„æºå®šä¹‰æ˜¯å‚è€ƒapisixæ¥å®ç°çš„, æ‰€ä»¥å°±ç›´æ¥å‚è€ƒ&lt;a href=&#34;https://github.com/apache/apisix-ingress-controller&#34;&gt;apisix-ingress-controller&lt;/a&gt;æ¥å®ç°æˆ‘ä»¬è‡ªå·±çš„&lt;a href=&#34;https://github.com/zhu327/pingsix-ingress-controller&#34;&gt;pingsix-ingress-controller&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-apisix-ingress-controlleræ¶æ„&#34;&gt;1. apisix-ingress-controlleræ¶æ„&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/1ecf116a-378f-4357-a597-5bafb56991fd&#34; alt=&#34;Image1&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;1-k8s-resources-watch-layer-èµ„æºç›‘å¬å±‚&#34;&gt;1. K8s Resources Watch Layer (èµ„æºç›‘å¬å±‚)&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;å„ç§Controlleré€šè¿‡Kubernetesçš„Watchæœºåˆ¶ç›‘å¬å¯¹åº”çš„èµ„æºå˜åŒ–&lt;/li&gt;
&lt;li&gt;æ”¯æŒçš„èµ„æºç±»å‹åŒ…æ‹¬ï¼š

&lt;ul&gt;
&lt;li&gt;Gateway API: HTTPRoute, Gateway, GRPCRoute, TCPRoute, UDPRoute, TLSRoute&lt;/li&gt;
&lt;li&gt;KubernetesåŸç”Ÿ: Ingress, IngressClass&lt;/li&gt;
&lt;li&gt;APISIX CRD: ApisixRoute, ApisixGlobalRule, ApisixTls, ApisixConsumer, ApisixUpstream&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰: Consumer, GatewayProxy&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;2-provider-layer-æä¾›è€…å±‚&#34;&gt;2. Provider Layer (æä¾›è€…å±‚)&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Provideræ¥æ”¶Controllerçš„Update/Deleteè¯·æ±‚&lt;/li&gt;
&lt;li&gt;TranslateContextæ”¶é›†æ‰€æœ‰ä¾èµ–èµ„æºï¼ˆServices, Secrets, EndpointSlicesç­‰ï¼‰&lt;/li&gt;
&lt;li&gt;ä¸ºTranslatoræä¾›å®Œæ•´çš„ä¸Šä¸‹æ–‡ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;3-translator-layer-ç¿»è¯‘å±‚&#34;&gt;3. Translator Layer (ç¿»è¯‘å±‚)&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;å°†K8sèµ„æºç¿»è¯‘æˆADCèµ„æºæè¿°&lt;/li&gt;
&lt;li&gt;æ¯ç§èµ„æºç±»å‹éƒ½æœ‰å¯¹åº”çš„Translatoræ–¹æ³•&lt;/li&gt;
&lt;li&gt;è¾“å‡ºTranslateResultï¼ŒåŒ…å«ï¼š

&lt;ul&gt;
&lt;li&gt;Services (è·¯ç”±è§„åˆ™)&lt;/li&gt;
&lt;li&gt;SSL/TLS (è¯ä¹¦)&lt;/li&gt;
&lt;li&gt;Consumers (æ¶ˆè´¹è€…)&lt;/li&gt;
&lt;li&gt;GlobalRules (å…¨å±€è§„åˆ™)&lt;/li&gt;
&lt;li&gt;PluginMetadata (æ’ä»¶å…ƒæ•°æ®)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;4-adc-client-layer-adcå®¢æˆ·ç«¯å±‚&#34;&gt;4. ADC Client Layer (ADCå®¢æˆ·ç«¯å±‚)&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ConfigManager&lt;/strong&gt;: ç®¡ç†å¤šä¸ªGatewayProxyçš„é…ç½®&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Store/MemDB&lt;/strong&gt;: å†…å­˜æ•°æ®åº“ï¼Œå­˜å‚¨ADCèµ„æºçŠ¶æ€&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;StoreDelta&lt;/strong&gt;: å¯¹æ¯”æ–°æ—§é…ç½®ï¼Œè®¡ç®—å·®å¼‚&lt;/li&gt;
&lt;li&gt;å°†å˜æ›´ä»»åŠ¡ä¼ é€’ç»™Executoræ‰§è¡Œ&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;5-adc-executor-interface-æ‰§è¡Œå™¨æ¥å£&#34;&gt;5. ADC Executor Interface (æ‰§è¡Œå™¨æ¥å£)&lt;/h4&gt;

&lt;p&gt;ADC Executoræä¾›ç»Ÿä¸€çš„Executeæ¥å£ï¼Œæ”¯æŒä¸‰ç§å®ç°ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HTTPADCExecutor&lt;/strong&gt;: é€šè¿‡HTTPè°ƒç”¨ADC Serverï¼ˆæ¨èæ–¹å¼ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DefaultADCExecutor&lt;/strong&gt;: é€šè¿‡å‘½ä»¤è¡Œè°ƒç”¨adcå‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;6-adc-http-server-adc-httpæœåŠ¡å™¨&#34;&gt;6. ADC HTTP Server (ADC HTTPæœåŠ¡å™¨)&lt;/h4&gt;

&lt;p&gt;ADC HTTP Serverçš„æ ¸å¿ƒæµç¨‹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æ¥æ”¶&lt;code&gt;/sync&lt;/code&gt;ç«¯ç‚¹çš„PUTè¯·æ±‚&lt;/li&gt;
&lt;li&gt;è§£æADCServerRequestï¼ˆåŒ…å«optså’Œconfigï¼‰&lt;/li&gt;
&lt;li&gt;æ ¹æ®label-selectorä»APISIXæ‹‰å–ç°æœ‰èµ„æº&lt;/li&gt;
&lt;li&gt;å°†ADCèµ„æºæè¿°è½¬æ¢ä¸ºAPISIXèµ„æºæ ¼å¼&lt;/li&gt;
&lt;li&gt;å¯¹æ¯”å·²æ‹‰å–çš„èµ„æºï¼Œè®¡ç®—å·®å¼‚ï¼ˆDiffï¼‰&lt;/li&gt;
&lt;li&gt;è°ƒç”¨APISIX Admin APIæ‰§è¡Œåˆ›å»º/æ›´æ–°/åˆ é™¤æ“ä½œ&lt;/li&gt;
&lt;li&gt;è¿”å›SyncResultï¼ˆåŒ…å«æˆåŠŸ/å¤±è´¥çŠ¶æ€ï¼‰&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;7-apisix-data-plane-apisixæ•°æ®å¹³é¢&#34;&gt;7. APISIX Data Plane (APISIXæ•°æ®å¹³é¢)&lt;/h4&gt;

&lt;p&gt;æœ€ç»ˆåœ¨APISIXä¸­åˆ›å»º/æ›´æ–°/åˆ é™¤çš„èµ„æºï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Routes (è·¯ç”±)&lt;/li&gt;
&lt;li&gt;Services (æœåŠ¡)&lt;/li&gt;
&lt;li&gt;Upstreams (ä¸Šæ¸¸)&lt;/li&gt;
&lt;li&gt;SSL/TLS (è¯ä¹¦)&lt;/li&gt;
&lt;li&gt;Consumers (æ¶ˆè´¹è€…)&lt;/li&gt;
&lt;li&gt;Global Rules (å…¨å±€è§„åˆ™)&lt;/li&gt;
&lt;li&gt;Plugin Metadata (æ’ä»¶å…ƒæ•°æ®)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;8-æ ¸å¿ƒç‰¹æ€§&#34;&gt;8. æ ¸å¿ƒç‰¹æ€§&lt;/h4&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤šGatewayProxyæ”¯æŒ&lt;/strong&gt;: é€šè¿‡ConfigManagerç®¡ç†å¤šä¸ªAPISIXå®ä¾‹çš„é…ç½®&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Label Selector&lt;/strong&gt;: æ”¯æŒé€šè¿‡æ ‡ç­¾é€‰æ‹©å™¨è¿‡æ»¤èµ„æº&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¢é‡åŒæ­¥&lt;/strong&gt;: é€šè¿‡MemDBå¯¹æ¯”å·®å¼‚ï¼ŒåªåŒæ­¥å˜æ›´çš„èµ„æº&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯å¤„ç†&lt;/strong&gt;: å®Œå–„çš„é”™è¯¯æ”¶é›†å’ŒçŠ¶æ€æ›´æ–°æœºåˆ¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»çš„æ‰§è¡Œæ–¹å¼&lt;/strong&gt;: æ”¯æŒHTTPã€å‘½ä»¤è¡Œå¤šç§æ‰§è¡Œæ¨¡å¼&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºéš”ç¦»&lt;/strong&gt;: é€šè¿‡labelå®ç°ä¸åŒèµ„æºçš„éš”ç¦»å’Œç®¡ç†&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;2-apisix-ingress-controllerçš„ç»éªŒ&#34;&gt;2. apisix-ingress-controllerçš„ç»éªŒ&lt;/h3&gt;

&lt;p&gt;è™½ç„¶ä»¥å‰ä¹Ÿå†™è¿‡ä¸€äº›operatorçš„ä»£ç , ä½†æ˜¯åœ¨å­¦ä¹ apisix-ingress-controllerä»£ç çš„è¿‡ç¨‹ä¸­, æˆ‘è¿˜æ˜¯å­¦åˆ°äº†ä¸€äº›æ–°çš„ä¸œè¥¿, åœ¨controller watchä¸€ç±»èµ„æºçš„æ—¶å€™, æˆ‘ä»¬å¯ä»¥watchæ‰€æœ‰å…³è”çš„èµ„æºç±»å‹, ä¸€æ—¦è¿™äº›å…³è”çš„èµ„æºç±»å‹æœ‰å˜æ›´, å°±å¯ä»¥è¿›å…¥ç»Ÿä¸€çš„å˜æ›´æµç¨‹, è¿™æ ·å°±å‡å°‘äº†æˆ‘ä»¬å†™controllerçš„é€»è¾‘å¤æ‚åº¦, æ‰€æœ‰çš„å…³è”èµ„æºçš„å˜æ›´éƒ½ä¼šè§¦å‘ä¸»èµ„æºçš„æ›´æ–°.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-golang&#34; data-lang=&#34;golang&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// SetupWithManager sets up the controller with the Manager.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;IngressReconciler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;SetupWithManager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mgr&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Manager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;genericEvent&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;event&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GenericEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewControllerManagedBy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mgr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;For&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;networkingv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ingress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WithPredicates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;MatchesIngressClassPredicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
			&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;WithEventFilter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;predicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;predicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GenerationChangedPredicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;predicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;AnnotationChangedPredicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;predicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewPredicateFuncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;TypePredicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;corev1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Secret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]()),&lt;/span&gt;
			&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
			&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;networkingv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;IngressClass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressForIngressClass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WithPredicates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;predicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewPredicateFuncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;matchesIngressController&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
			&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
			&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;discoveryv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EndpointSlice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressesByService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
			&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;corev1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Secret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressesBySecret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;v1alpha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;BackendTrafficPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressForBackendTrafficPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WithPredicates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;BackendTrafficPolicyPredicateFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;genericEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
			&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;v1alpha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;HTTPRoutePolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressesByHTTPRoutePolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WithPredicates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;httpRoutePolicyPredicateFuncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;genericEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;v1alpha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GatewayProxy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressesForGatewayProxy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;WatchesRawSource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Channel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;genericEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressForGenericEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
			&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Complete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;IngressReconciler Watch äº‹ä»¶è¯¦è§£&lt;/p&gt;

&lt;p&gt;æ ¹æ®ä»£ç åˆ†æï¼Œ&lt;code&gt;IngressReconciler&lt;/code&gt; åœ¨ &lt;code&gt;SetupWithManager&lt;/code&gt; æ–¹æ³•ä¸­é…ç½®äº†å¤šä¸ª watch äº‹ä»¶ã€‚è®©æˆ‘ä¸ºæ‚¨è¯¦ç»†è§£é‡Šæ¯ä¸ªäº‹ä»¶çš„ä½œç”¨å’Œé€»è¾‘ï¼š&lt;/p&gt;

&lt;h4 id=&#34;1-ä¸»èµ„æº-watch-ingress-ç¬¬70-81è¡Œ&#34;&gt;1. &lt;strong&gt;ä¸»èµ„æº Watch - Ingress&lt;/strong&gt; (ç¬¬70-81è¡Œ)&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;For&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;networkingv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ingress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WithPredicates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;MatchesIngressClassPredicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šç›‘å¬ Ingress èµ„æºæœ¬èº«çš„å˜åŒ–&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Predicatesï¼ˆè¿‡æ»¤æ¡ä»¶ï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;MatchesIngressClassPredicate&lt;/code&gt;: åªå¤„ç†ç”±å½“å‰æ§åˆ¶å™¨ç®¡ç†çš„ IngressClass çš„ Ingress&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GenerationChangedPredicate&lt;/code&gt;: èµ„æºçš„ Generation å‘ç”Ÿå˜åŒ–ï¼ˆspec ä¿®æ”¹ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AnnotationChangedPredicate&lt;/code&gt;: æ³¨è§£å‘ç”Ÿå˜åŒ–&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TypePredicate[*corev1.Secret]()&lt;/code&gt;: ç”¨äº Secret ç±»å‹åˆ¤æ–­&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;é€»è¾‘&lt;/strong&gt;ï¼šè¿™æ˜¯ä¸»è¦çš„ç›‘å¬å¯¹è±¡ï¼Œå½“ Ingress çš„è§„æ ¼æˆ–æ³¨è§£å˜åŒ–æ—¶è§¦å‘ Reconcile&lt;/p&gt;

&lt;h4 id=&#34;2-ingressclass-watch-ç¬¬82-88è¡Œ&#34;&gt;2. &lt;strong&gt;IngressClass Watch&lt;/strong&gt; (ç¬¬82-88è¡Œ)&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;networkingv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;IngressClass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressForIngressClass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WithPredicates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;predicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewPredicateFuncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;matchesIngressController&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šç›‘å¬ IngressClass èµ„æºçš„å˜åŒ–&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;è§¦å‘æ¡ä»¶&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;matchesIngressController&lt;/code&gt;: åªç›‘å¬ç”±å½“å‰æ§åˆ¶å™¨ç®¡ç†çš„ IngressClassï¼ˆé€šè¿‡ &lt;code&gt;spec.controller&lt;/code&gt; å­—æ®µåŒ¹é…ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;é€»è¾‘&lt;/strong&gt; (&lt;code&gt;listIngressForIngressClass&lt;/code&gt;)ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æ£€æŸ¥ IngressClass æ˜¯å¦æ˜¯é»˜è®¤ç±»ï¼ˆé€šè¿‡æ³¨è§£ &lt;code&gt;ingressclass.kubernetes.io/is-default-class&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;å¦‚æœæ˜¯é»˜è®¤ç±»ï¼šåˆ—å‡ºæ‰€æœ‰æœªæŒ‡å®š IngressClassName æˆ–æŒ‡å®šä¸ºè¯¥ç±»çš„ Ingress&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸æ˜¯é»˜è®¤ç±»ï¼šé€šè¿‡ç´¢å¼•æŸ¥æ‰¾ä½¿ç”¨è¯¥ IngressClass çš„æ‰€æœ‰ Ingress&lt;/li&gt;
&lt;li&gt;è¿”å›éœ€è¦ reconcile çš„ Ingress åˆ—è¡¨&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå½“ IngressClass çš„é…ç½®å˜åŒ–æ—¶ï¼Œéœ€è¦é‡æ–°å¤„ç†æ‰€æœ‰ä½¿ç”¨è¯¥ç±»çš„ Ingress&lt;/p&gt;

&lt;h4 id=&#34;3-endpointslice-watch-ç¬¬89-92è¡Œ&#34;&gt;3. &lt;strong&gt;EndpointSlice Watch&lt;/strong&gt; (ç¬¬89-92è¡Œ)&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;discoveryv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EndpointSlice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressesByService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šç›‘å¬åç«¯æœåŠ¡çš„ Endpoint å˜åŒ–&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é€»è¾‘&lt;/strong&gt; (&lt;code&gt;listIngressesByService&lt;/code&gt;)ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;ä» EndpointSlice çš„ label ä¸­æå– Service åç§°ï¼ˆ&lt;code&gt;discovery.k8s.io/service-name&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;é€šè¿‡ç´¢å¼• &lt;code&gt;ServiceIndexRef&lt;/code&gt; æŸ¥æ‰¾å¼•ç”¨è¯¥ Service çš„æ‰€æœ‰ Ingress&lt;/li&gt;
&lt;li&gt;è¿‡æ»¤å‡ºç”±å½“å‰æ§åˆ¶å™¨ç®¡ç†çš„ Ingress&lt;/li&gt;
&lt;li&gt;è¿”å›éœ€è¦ reconcile çš„ Ingress åˆ—è¡¨&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼šå½“åç«¯ Pod çš„ IP åœ°å€å˜åŒ–ï¼ˆæ‰©ç¼©å®¹ã€é‡å¯ç­‰ï¼‰æ—¶ï¼Œéœ€è¦æ›´æ–° APISIX çš„ upstream é…ç½®&lt;/p&gt;

&lt;h4 id=&#34;4-secret-watch-ç¬¬93-96è¡Œ&#34;&gt;4. &lt;strong&gt;Secret Watch&lt;/strong&gt; (ç¬¬93-96è¡Œ)&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;corev1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Secret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressesBySecret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šç›‘å¬ TLS è¯ä¹¦ Secret çš„å˜åŒ–&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é€»è¾‘&lt;/strong&gt; (&lt;code&gt;listIngressesBySecret&lt;/code&gt;)ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;é€šè¿‡ç´¢å¼• &lt;code&gt;SecretIndexRef&lt;/code&gt; æŸ¥æ‰¾ç›´æ¥å¼•ç”¨è¯¥ Secret çš„ Ingressï¼ˆTLS é…ç½®ï¼‰&lt;/li&gt;
&lt;li&gt;æŸ¥æ‰¾å¼•ç”¨è¯¥ Secret çš„ GatewayProxyï¼ˆç”¨äº provider è®¤è¯ï¼‰&lt;/li&gt;
&lt;li&gt;å¦‚æœ GatewayProxy å¼•ç”¨äº†è¯¥ Secretï¼Œæ‰¾åˆ°ä½¿ç”¨è¯¥ GatewayProxy çš„ IngressClass&lt;/li&gt;
&lt;li&gt;å†æ‰¾åˆ°ä½¿ç”¨è¿™äº› IngressClass çš„æ‰€æœ‰ Ingress&lt;/li&gt;
&lt;li&gt;å»é‡åè¿”å›æ‰€æœ‰éœ€è¦ reconcile çš„ Ingress&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;TLS è¯ä¹¦æ›´æ–°æˆ–è½®æ¢&lt;/li&gt;
&lt;li&gt;GatewayProxy çš„ AdminKey Secret å˜åŒ–&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;5-backendtrafficpolicy-watch-ç¬¬97-102è¡Œ&#34;&gt;5. &lt;strong&gt;BackendTrafficPolicy Watch&lt;/strong&gt; (ç¬¬97-102è¡Œ)&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;v1alpha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;BackendTrafficPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressForBackendTrafficPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WithPredicates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;BackendTrafficPolicyPredicateFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;genericEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šç›‘å¬åç«¯æµé‡ç­–ç•¥çš„å˜åŒ–&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Predicates é€»è¾‘&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Create&lt;/strong&gt;: è¿”å› trueï¼Œæ–°å»ºæ—¶è§¦å‘&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Delete&lt;/strong&gt;: è¿”å› trueï¼Œåˆ é™¤æ—¶è§¦å‘&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Update&lt;/strong&gt;: æ£€æµ‹ &lt;code&gt;targetRefs&lt;/code&gt; çš„å˜åŒ–

&lt;ul&gt;
&lt;li&gt;æ‰¾å‡ºè¢«ç§»é™¤çš„ targetRefs&lt;/li&gt;
&lt;li&gt;å°†åŒ…å«è¢«ç§»é™¤ targetRefs çš„æ—§å¯¹è±¡å‘é€åˆ° genericEvent channel&lt;/li&gt;
&lt;li&gt;è¿™æ ·å¯ä»¥æ¸…ç†ä¸å†è¢«å¼•ç”¨çš„èµ„æº&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;é€»è¾‘&lt;/strong&gt; (&lt;code&gt;listIngressForBackendTrafficPolicy&lt;/code&gt;)ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;éå† Policy çš„æ‰€æœ‰ &lt;code&gt;targetRefs&lt;/code&gt;ï¼ˆå¼•ç”¨çš„ Serviceï¼‰&lt;/li&gt;
&lt;li&gt;é€šè¿‡ç´¢å¼•æŸ¥æ‰¾ä½¿ç”¨è¿™äº› Service çš„ Ingress&lt;/li&gt;
&lt;li&gt;å»é‡åè¿”å›éœ€è¦ reconcile çš„ Ingress åˆ—è¡¨&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé…ç½®åç«¯æµé‡ç­–ç•¥ï¼ˆå¦‚è´Ÿè½½å‡è¡¡ç®—æ³•ã€å¥åº·æ£€æŸ¥ç­‰ï¼‰&lt;/p&gt;

&lt;h4 id=&#34;6-httproutepolicy-watch-ç¬¬103-106è¡Œ&#34;&gt;6. &lt;strong&gt;HTTPRoutePolicy Watch&lt;/strong&gt; (ç¬¬103-106è¡Œ)&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;v1alpha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;HTTPRoutePolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressesByHTTPRoutePolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WithPredicates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;httpRoutePolicyPredicateFuncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;genericEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šç›‘å¬ HTTP è·¯ç”±ç­–ç•¥çš„å˜åŒ–&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Predicates é€»è¾‘&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Create/Delete&lt;/strong&gt;: è¿”å› true&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Update&lt;/strong&gt;: æ£€æµ‹ &lt;code&gt;targetRefs&lt;/code&gt; çš„å˜åŒ–

&lt;ul&gt;
&lt;li&gt;æ‰¾å‡ºè¢«ç§»é™¤çš„ targetRefs&lt;/li&gt;
&lt;li&gt;å°†åŒ…å«è¢«ç§»é™¤ targetRefs çš„æ—§å¯¹è±¡å‘é€åˆ° genericEvent channel&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;é€»è¾‘&lt;/strong&gt; (&lt;code&gt;listIngressesByHTTPRoutePolicy&lt;/code&gt;)ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;éå† Policy çš„æ‰€æœ‰ &lt;code&gt;targetRefs&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¿‡æ»¤å‡º Kind ä¸º &lt;code&gt;Ingress&lt;/code&gt; çš„å¼•ç”¨&lt;/li&gt;
&lt;li&gt;è·å–è¿™äº› Ingress å¯¹è±¡&lt;/li&gt;
&lt;li&gt;è¿”å›éœ€è¦ reconcile çš„ Ingress åˆ—è¡¨&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼šé…ç½® HTTP è·¯ç”±çº§åˆ«çš„ç­–ç•¥ï¼ˆå¦‚é‡å†™ã€é‡å®šå‘ã€è¶…æ—¶ç­‰ï¼‰&lt;/p&gt;

&lt;h4 id=&#34;7-gatewayproxy-watch-ç¬¬107-109è¡Œ&#34;&gt;7. &lt;strong&gt;GatewayProxy Watch&lt;/strong&gt; (ç¬¬107-109è¡Œ)&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Watches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;v1alpha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GatewayProxy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressesForGatewayProxy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šç›‘å¬ GatewayProxy é…ç½®çš„å˜åŒ–&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é€»è¾‘&lt;/strong&gt; (&lt;code&gt;listIngressesForGatewayProxy&lt;/code&gt; -&amp;gt; &lt;code&gt;listIngressClassRequestsForGatewayProxy&lt;/code&gt;)ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;é€šè¿‡ç´¢å¼• &lt;code&gt;IngressClassParametersRef&lt;/code&gt; æŸ¥æ‰¾å¼•ç”¨è¯¥ GatewayProxy çš„ IngressClass&lt;/li&gt;
&lt;li&gt;å¯¹æ¯ä¸ª IngressClassï¼Œè°ƒç”¨ &lt;code&gt;listIngressForIngressClass&lt;/code&gt; è·å–ç›¸å…³ Ingress&lt;/li&gt;
&lt;li&gt;å»é‡åè¿”å›æ‰€æœ‰éœ€è¦ reconcile çš„ Ingress&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;GatewayProxy çš„ APISIX åœ°å€å˜åŒ–&lt;/li&gt;
&lt;li&gt;å‘å¸ƒæœåŠ¡é…ç½®å˜åŒ–&lt;/li&gt;
&lt;li&gt;Provider é…ç½®å˜åŒ–&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;8-generic-event-channel-ç¬¬110-116è¡Œ&#34;&gt;8. &lt;strong&gt;Generic Event Channel&lt;/strong&gt; (ç¬¬110-116è¡Œ)&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;WatchesRawSource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Channel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;genericEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnqueueRequestsFromMapFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;listIngressForGenericEvent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;ï¼šå¤„ç†é€šè¿‡ channel å‘é€çš„è‡ªå®šä¹‰äº‹ä»¶&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é€»è¾‘&lt;/strong&gt; (&lt;code&gt;listIngressForGenericEvent&lt;/code&gt;)ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æ ¹æ®å¯¹è±¡ç±»å‹è·¯ç”±åˆ°ç›¸åº”çš„å¤„ç†å‡½æ•°ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;BackendTrafficPolicy&lt;/code&gt; -&amp;gt; &lt;code&gt;listIngressForBackendTrafficPolicy&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HTTPRoutePolicy&lt;/code&gt; -&amp;gt; &lt;code&gt;listIngressesByHTTPRoutePolicy&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å¤„ç† Policy çš„ targetRefs è¢«ç§»é™¤æ—¶çš„æ¸…ç†å·¥ä½œ&lt;/li&gt;
&lt;li&gt;ç¡®ä¿å½“èµ„æºä¸å†è¢«å¼•ç”¨æ—¶ï¼Œèƒ½æ­£ç¡®æ›´æ–°ç›¸å…³é…ç½®&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;æ•´ä½“å·¥ä½œæµç¨‹&#34;&gt;æ•´ä½“å·¥ä½œæµç¨‹&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;1. äº‹ä»¶è§¦å‘ â†’ 2. Predicate è¿‡æ»¤ â†’ 3. MapFunc æ˜ å°„ â†’ 4. Reconcile é˜Ÿåˆ— â†’ 5. Reconcile æ‰§è¡Œ
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;reconcile-ä¸»è¦æ­¥éª¤&#34;&gt;Reconcile ä¸»è¦æ­¥éª¤ï¼š&lt;/h4&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è·å– Ingress å¯¹è±¡&lt;/strong&gt;ï¼šå¦‚æœä¸å­˜åœ¨åˆ™æ‰§è¡Œåˆ é™¤é€»è¾‘&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥æ‰¾ IngressClass&lt;/strong&gt;ï¼šç¡®å®šé…ç½®æ¥æº&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç† IngressClass Parameters&lt;/strong&gt;ï¼šåŠ è½½ GatewayProxy é…ç½®&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç† TLS&lt;/strong&gt;ï¼šåŠ è½½è¯ä¹¦ Secret&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç† Backends&lt;/strong&gt;ï¼šåŠ è½½ Service å’Œ EndpointSlice&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç† HTTPRoutePolicy&lt;/strong&gt;ï¼šåº”ç”¨è·¯ç”±ç­–ç•¥&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤„ç† BackendTrafficPolicy&lt;/strong&gt;ï¼šåº”ç”¨åç«¯æµé‡ç­–ç•¥&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›´æ–° APISIX é…ç½®&lt;/strong&gt;ï¼šé€šè¿‡ Provider åŒæ­¥åˆ° APISIX&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›´æ–°çŠ¶æ€&lt;/strong&gt;ï¼šæ›´æ–° Ingress å’Œç›¸å…³èµ„æºçš„çŠ¶æ€&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;å…³é”®è®¾è®¡ç‰¹ç‚¹&#34;&gt;å…³é”®è®¾è®¡ç‰¹ç‚¹&lt;/h4&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç´¢å¼•ä¼˜åŒ–&lt;/strong&gt;ï¼šä½¿ç”¨ Field Indexer å¿«é€ŸæŸ¥æ‰¾èµ„æºå…³ç³»&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº§è”æ›´æ–°&lt;/strong&gt;ï¼šä¾èµ–èµ„æºå˜åŒ–æ—¶è‡ªåŠ¨è§¦å‘ä¸»èµ„æºæ›´æ–°&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å»é‡æœºåˆ¶&lt;/strong&gt;ï¼šé¿å…é‡å¤å¤„ç†åŒä¸€ä¸ª Ingress&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;äº‹ä»¶é€šé“&lt;/strong&gt;ï¼šä½¿ç”¨ genericEvent channel å¤„ç†å¤æ‚çš„æ¸…ç†åœºæ™¯&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¡ä»¶è¿‡æ»¤&lt;/strong&gt;ï¼šé€šè¿‡ Predicate å‡å°‘ä¸å¿…è¦çš„ Reconcile&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;indexeræ€§èƒ½ä¼˜åŒ–&#34;&gt;indexeræ€§èƒ½ä¼˜åŒ–&lt;/h4&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°åœ¨ä¸Šé¢çš„watché€»è¾‘ä¸­æœ‰å¾ˆå¤šçš„listæ“ä½œ, æ¯”å¦‚listIngressForBackendTrafficPolicy, è¿™ä¸ªæ—¶å€™å°±éœ€è¦äº‹å…ˆåœ¨k8s clientçš„indexerä¸­å»ºç«‹ç´¢å¼•æ¥ä¼˜åŒ–æŸ¥è¯¢é€Ÿåº¦, é¿å…listå…¨æ‰«æ•°æ®:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;setupIngressIndexer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mgr&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Manager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// create IngressClass index
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mgr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GetFieldIndexer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;IndexField&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Background&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;networkingv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ingress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;IngressClassRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;IngressClassRefIndexFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;c1&#34;&gt;// create Service index for quick lookup of Ingresses using specific services
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mgr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GetFieldIndexer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;IndexField&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Background&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;networkingv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ingress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;ServiceIndexRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;IngressServiceIndexFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;c1&#34;&gt;// create secret index for TLS
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mgr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GetFieldIndexer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;IndexField&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Background&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;networkingv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ingress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;SecretIndexRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;IngressSecretIndexFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mgr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GetFieldIndexer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;IndexField&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Background&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;networkingv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ingress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;TLSHostIndexRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;IngressTLSHostIndexFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;ç´¢å¼•æ¦‚è§ˆè¡¨&#34;&gt;ğŸ“Š &lt;strong&gt;ç´¢å¼•æ¦‚è§ˆè¡¨&lt;/strong&gt;&lt;/h5&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç´¢å¼•åç§°&lt;/th&gt;
&lt;th&gt;ç´¢å¼•å­—æ®µ&lt;/th&gt;
&lt;th&gt;ç´¢å¼•å‡½æ•°&lt;/th&gt;
&lt;th&gt;ä¸»è¦ç”¨é€”&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;IngressClassRef&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ingressClassRef&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IngressClassRefIndexFunc&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ¹æ® IngressClass æŸ¥æ‰¾ Ingress&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;ServiceIndexRef&lt;/td&gt;
&lt;td&gt;&lt;code&gt;serviceRefs&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IngressServiceIndexFunc&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ¹æ®åç«¯ Service æŸ¥æ‰¾ Ingress&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;SecretIndexRef&lt;/td&gt;
&lt;td&gt;&lt;code&gt;secretRefs&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IngressSecretIndexFunc&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ¹æ® TLS Secret æŸ¥æ‰¾ Ingress&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;TLSHostIndexRef&lt;/td&gt;
&lt;td&gt;&lt;code&gt;tlsHostRefs&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IngressTLSHostIndexFunc&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ¹æ® TLS ä¸»æœºåæŸ¥æ‰¾ Ingress&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Ingress çš„ 4 ä¸ªç´¢å¼•å½¢æˆäº†ä¸€ä¸ªå®Œæ•´çš„æŸ¥è¯¢ä½“ç³»ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;IngressClassRef&lt;/strong&gt;ï¼šç®¡ç†å±‚é¢ - æŒ‰æ§åˆ¶å™¨åˆ†ç»„&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ServiceIndexRef&lt;/strong&gt;ï¼šæ•°æ®å¹³é¢ - åç«¯æœåŠ¡å…³è”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SecretIndexRef&lt;/strong&gt;ï¼šå®‰å…¨å±‚é¢ - TLS è¯ä¹¦ç®¡ç†&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TLSHostIndexRef&lt;/strong&gt;ï¼šåŸŸåå±‚é¢ - SSL é…ç½®ç®¡ç†&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™äº›ç´¢å¼•ç¡®ä¿äº†å½“ä»»ä½•ä¾èµ–èµ„æºå˜åŒ–æ—¶ï¼Œæ§åˆ¶å™¨éƒ½èƒ½&lt;strong&gt;å¿«é€Ÿã€å‡†ç¡®&lt;/strong&gt;åœ°æ‰¾åˆ°éœ€è¦æ›´æ–°çš„ Ingressï¼Œå®ç°&lt;strong&gt;é«˜æ•ˆçš„çº§è”æ›´æ–°&lt;/strong&gt;å’Œ&lt;strong&gt;å®æ—¶é…ç½®åŒæ­¥&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-pingsix-ingress-controlleræ¶æ„å†³ç­–&#34;&gt;3. pingsix-ingress-controlleræ¶æ„å†³ç­–&lt;/h3&gt;

&lt;p&gt;ä»apisix-ingress-controllerçš„æ¶æ„ä¸­, æˆ‘ä»¬çŸ¥é“apisixæŠ½è±¡äº†ä¸€ç§ADC(API Declarative CLI)çš„èµ„æºç±»å‹ç”¨æ¥åœ¨ingressä¸apisixèµ„æºä¹‹é—´ä½œä¸ºä¸­é—´çš„æ¡¥æ¢, å¦‚æœç›´æ¥ä½¿ç”¨apisix-ingress-controlleræ¥å¯¹æ¥pingsixçš„è¯, å°±éœ€è¦pingsixå®Œæ•´çš„å®ç°apisixçš„admin api, å¹¶ä¸”è¿˜éœ€è¦åœ¨ä½¿ç”¨æ—¶å¯åŠ¨etcd.&lt;/p&gt;

&lt;p&gt;åœ¨æˆ‘çš„å°è±¡ä¸­æ›¾ç»çœ‹åˆ°è¿‡apisix-ingress-controllerå®ç°è¿‡ä¸€ä¸ªä¸éœ€è¦etcdçš„æ–¹æ¡ˆ:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://apisix.apache.org/blog/2023/10/18/ingress-apisix/&#34;&gt;Embrace the Lightweight APISIX Ingress Controller Without etcd Dependency&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç„¶åæˆ‘åœ¨apisix-ingress-controller 1.8.x ç‰ˆæœ¬çš„ä»£ç ä¸‹æ‰¾åˆ°äº†è¿™ä¸ªè¿™ä¸ªå®ç°æ–¹å¼, åªæ˜¯å½“å‰çš„ 2.0.x ç‰ˆæœ¬åœ¨å¼•å…¥äº†ADCç›¸å…³çš„åŠŸèƒ½åå»æ‰äº†&lt;a href=&#34;https://github.com/api7/etcd-adapter&#34;&gt;etcd-adapter&lt;/a&gt;, é‚£æˆ‘åœ¨è€ƒè™‘å®ç°æˆ‘çš„pingsix-ingress-controlleræ—¶, ä¸ºäº†é¿å…ç›´æ¥æ”¹åŠ¨pingsixçš„ä»£ç , å¹¶ä¸”ä¹Ÿä¸å¸Œæœ›åœ¨ingresså¯åŠ¨æ—¶ä¾èµ–etcd, æ‰€ä»¥å†³å®šé‡æ–°å¼•å…¥etcd-adapter, ç„¶åä¸ºäº†åç»­pingsix-ingress-controllerèƒ½åŒæ­¥apisix-ingress-controllerçš„ä¸Šæ¸¸æ›´æ–°, æˆ‘å†³å®šåœ¨ç°æœ‰çš„ADC Executorçš„æ¥å£çš„åŸºç¡€ä¸Š, å®ç°pingsixçš„Executor, è¿™æ ·å°±å¯ä»¥åœ¨é¿å…ç›´æ¥ä¿®æ”¹apisixçš„é€»è¾‘ä»£ç , ä½¿ç”¨ä¸€ç§adapterçš„æ–¹å¼æ¥å®ç°æˆ‘ä»¬è‡ªå·±çš„pingsix-ingress-controller.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/a10a7162-ea7d-4407-b7a6-b5481823592b&#34; alt=&#34;Image2&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å®ç°çš„è¿™ä¸ªExecutor, å…¶å®å°±æ˜¯é‡å¤äº†ä¸€éADC http serveçš„é€»è¾‘, ä½†æ˜¯æœ€ç»ˆèµ„æºçš„æ•°æ®æ˜¯å†™å…¥åˆ°etcd-adapterä¸­çš„, æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªapisix-ingress-controlleræœ€åº•å±‚çš„æŠ½è±¡, é€šè¿‡è¿™ç§ä½æˆæœ¬çš„æ”¹é€ æˆ‘ä»¬åç»­è¿˜å¯ä»¥ç»§ç»­åŒæ­¥apisix-ingress-controllerçš„å˜æ›´, å¹¶ä¸ä¼šé€ æˆä»£ç å†²çª.&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;åœ¨å®ç°&lt;a href=&#34;https://github.com/zhu327/pingsix-ingress-controller&#34;&gt;pingsix-ingress-controller&lt;/a&gt;çš„è¿‡ç¨‹ä¸­, æˆ‘å®Œæ•´çš„é˜…è¯»äº†apisix-ingress-controllerçš„ä»£ç , æ”¶è·äº†ä¸€äº›å†™operatorçš„æŠ€å·§, ç„¶ååœ¨åˆ†æç°æœ‰apisix-ingress-controllerçš„ä»£ç æ¶æ„æ—¶, å†³å®šé€šè¿‡æ‰©å±•ADC Executorçš„å®ç°æ¥å®è·µäº†é¢å‘å¯¹è±¡çš„å¼€é—­åŸåˆ™, å¯¹äºåç»­çš„ä»£ç æ›´æ–°åˆå¹¶å¼€äº†ä¸€ä¸ªå¥½å¤´.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ç¼–å†™å¯ç»´æŠ¤çš„ä»£ç  -- é¢å‘AIç¼–ç¨‹</title>
      <link>https://zhu327.github.io/2025/10/16/%E7%BC%96%E5%86%99%E5%8F%AF%E7%BB%B4%E6%8A%A4%E7%9A%84%E4%BB%A3%E7%A0%81----%E9%9D%A2%E5%90%91ai%E7%BC%96%E7%A8%8B/</link>
      <pubDate>Thu, 16 Oct 2025 10:00:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/10/16/%E7%BC%96%E5%86%99%E5%8F%AF%E7%BB%B4%E6%8A%A4%E7%9A%84%E4%BB%A3%E7%A0%81----%E9%9D%A2%E5%90%91ai%E7%BC%96%E7%A8%8B/</guid>
      <description>&lt;p&gt;è¿™æ˜¯æœ€è¿‘åœ¨å°ç»„å†…åšçš„ä¸€æ¬¡æŠ€æœ¯åˆ†äº«çš„æ–‡å­—ç¨¿ï¼Œæ€»ä½“æ¥è¯´æˆ‘è§‰å¾—æ²¡æœ‰è¡¨è¾¾å‡ºç‰¹åˆ«ç¡¬æ ¸çš„å†…å®¹ï¼Œæˆ‘æœ¬èº«ä¹Ÿå¸Œæœ›è¯´è¿™æ¬¡åˆ†äº«ä¸ç”¨è®²çš„å¤ªç¡¬æ ¸ï¼Œåœ¨åˆ†äº«çš„å¼€å¤´è¿˜è®¾è®¡äº†äº’åŠ¨ç¯èŠ‚ï¼Œåˆ†äº«çš„è¿‡ç¨‹ä¸­ä¹Ÿå°è¯•åŠ å…¥ä¸€äº›é—®ç­”æ¥äº’åŠ¨ï¼Œå¥ˆä½•ç°å…¬å¸çš„æŠ€æœ¯æ°›å›´ç¡®å®æ¯”è¾ƒæ²‰é—·ï¼Œä¼¼ä¹åŒäº‹éƒ½æ¯”è¾ƒIï¼Œå¥½åœ¨æœ€åçš„é—®ç­”ç¯èŠ‚æœ‰å‡ ä¸ªæ¯”è¾ƒå¥½çš„é—®é¢˜ï¼Œæ€»ä½“æ¥è¯´è¿˜ç®—æ˜¯ä¸€æ¬¡æˆåŠŸçš„åˆ†äº«å§ï¼Œå¸Œæœ›è‡ªå·±èƒ½è¾“å‡ºæ›´å¤šçš„å¥½å†…å®¹ã€‚&lt;/p&gt;

&lt;h4 id=&#34;p1-æˆ‘ä»¬å†™çš„ä»£ç æ˜¯å†™ç»™è°çœ‹çš„&#34;&gt;&lt;strong&gt;P1: æˆ‘ä»¬å†™çš„ä»£ç æ˜¯å†™ç»™è°çœ‹çš„?&lt;/strong&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ¤ äº’åŠ¨ç¯èŠ‚):&lt;/strong&gt; â€œå¤§å®¶æœ‰æ²¡æœ‰è¿‡æ¥æ‰‹ä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œçœ‹åˆ°çš„ç¬¬ä¸€æ„Ÿè§‰æ˜¯ï¼šæˆ‘è¯¥ä»å“ªä¸‹æ‰‹ï¼Ÿç»“æœèŠ±äº†ä¸‰å¤©æ‰ææ˜ç™½ä¸€ä¸ªåŠŸèƒ½çš„é€»è¾‘ã€‚æœ‰è¿‡ç±»ä¼¼ç»å†çš„å…„å¼Ÿä¸¾ä¸ªæ‰‹æˆ‘çœ‹çœ‹ï¼Ÿâ€&lt;/li&gt;
&lt;li&gt;å°è¯´å®¶å†™å°è¯´ç»™è¯»è€…ï¼Œå»ºç­‘å¸ˆç›–æˆ¿å­ç»™ä¸šä¸»&amp;hellip; é‚£æˆ‘ä»¬ç¨‹åºå‘˜å†™ä»£ç ï¼Œæœ€ç»ˆæ˜¯å†™ç»™æœªæ¥çš„è‡ªå·±ï¼Œå’Œæ¥æ‰‹æˆ‘ä»¬ä»£ç çš„åŒäº‹çœ‹çš„ã€‚&lt;/li&gt;
&lt;li&gt;ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼Œå†³å®šäº†æˆ‘ä»¬æ˜¯åœ¨â€œåˆ›é€ ä»·å€¼â€è¿˜æ˜¯åœ¨â€œåˆ›é€ è´Ÿå€ºâ€ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;p2-ä¸¾å‡ ä¸ªä»£ç åå‘³é“çš„ä¾‹å­&#34;&gt;&lt;strong&gt;P2: ä¸¾å‡ ä¸ªä»£ç åå‘³é“çš„ä¾‹å­?&lt;/strong&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ¤ äº’åŠ¨ç¯èŠ‚):&lt;/strong&gt; â€œçœ‹è¿‡ã€Šé‡æ„ã€‹çš„åŒå­¦åº”è¯¥éƒ½çŸ¥é“ä»£ç åå‘³é“ã€‚æ¥ï¼Œå¤§å®¶ä¸€èµ·åæ§½ä¸€ä¸‹ï¼Œä½ åœ¨é¡¹ç›®é‡Œè§è¿‡æœ€ç—›è‹¦çš„ä»£ç åå‘³é“æ˜¯ä»€ä¹ˆï¼Ÿâ€ (å¼•å¯¼å¤§å®¶è¯´å‡ºå‡ ä¸ª)&lt;/li&gt;
&lt;li&gt;å…¶å®æŒ‰ç…§æˆ‘æœ´ç´ çš„ç†è§£ï¼Œèƒ½è®©æˆ‘å¿«é€Ÿç†æ¸…é€»è¾‘çš„å°±æ˜¯å¥½ä»£ç ï¼Œç†è§£èµ·æ¥å¾ˆè´¹åŠ²çš„ï¼Œé‚£è‚¯å®šå°±å……æ»¡åå‘³é“ã€‚&lt;/li&gt;
&lt;li&gt;æ­£å¦‚æˆ‘åœ¨å…¥èŒåæ¥æ‰‹çš„&lt;code&gt;kitam&lt;/code&gt;é¡¹ç›®ï¼Œå®ƒå°±å……æ»¡äº†è¿™äº›å‘³é“ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç é€»è¾‘ä¸å†…èš&lt;/strong&gt;ï¼šåŠŸèƒ½å®ç°åƒå¤©å¥³æ•£èŠ±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å±‚è¿‡å¤šä¸”æ··ä¹±&lt;/strong&gt;ï¼šä¸€ä¸ªè¯·æ±‚è¦ç©¿è¶Šé‡é‡å…³å¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤–éƒ¨ä¾èµ–ç¦»æ•£&lt;/strong&gt;ï¼šæ•°æ®åº“ã€ç¼“å­˜çš„è°ƒç”¨æ²¡æœ‰ç»Ÿä¸€è§„èŒƒã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h4 id=&#34;p3-ä»Šå¤©åˆ†äº«çš„ä¸»é¢˜&#34;&gt;&lt;strong&gt;P3: ä»Šå¤©åˆ†äº«çš„ä¸»é¢˜&lt;/strong&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;ä»Šå¤©åˆ†äº«çš„ä¸»é¢˜æ˜¯ ç¼–å†™å¯ç»´æŠ¤çš„ä»£ç ï¼Œä»¥åŠæˆ‘ä»¬å¯æ¢è®¨ä¸‹é¢å‘AIç¼–ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;é¢å¯¹ä»£ç çš„åå‘³é“å’Œæ··ä¹±ï¼Œæˆ‘ä»¬æœ‰ä»€ä¹ˆè‰¯è¯ï¼Ÿâ€”â€” ç­”æ¡ˆæ˜¯ï¼šä¸€ä¸ªå¥½çš„æ¶æ„ã€‚ä»Šå¤©æˆ‘å°†åˆ†äº«æˆ‘ä»¬&lt;code&gt;kfinops&lt;/code&gt;é¡¹ç›®ä¸­ä½¿ç”¨çš„æ¶æ„ï¼šæ•´æ´æ¶æ„ (Clean Architecture)ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;p4-æˆ‘ä»¬çš„æ•Œäººæ˜¯è°-æ˜¯-è€¦åˆ-è¿™å¤´æ€ªå…½&#34;&gt;&lt;strong&gt;P4: æˆ‘ä»¬çš„æ•Œäººæ˜¯è°ï¼Ÿâ€”â€”æ˜¯â€œè€¦åˆâ€è¿™å¤´æ€ªå…½ï¼&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/67458592-6307-44ed-a991-a6def7f53bf8&#34; alt=&#34;Image3&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ–¼ï¸ è§†è§‰å…ƒç´ å ä½ç¬¦: æ­¤å¤„æ”¾ç½®ä¸€å¼ ç”ŸåŠ¨çš„å›¾ç‰‡ï¼Œæ¯”å¦‚ä¸€ä¸ªèº«ä¸Šè´´æ»¡â€œè€¦åˆâ€æ ‡ç­¾çš„å°æ€ªå…½ ğŸ²)&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;åœ¨æ·±å…¥æ¶æ„ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦è®¤æ¸…æˆ‘ä»¬çœŸæ­£çš„æ•Œäººï¼š&lt;strong&gt;è€¦åˆ (Coupling)&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä»€ä¹ˆæ˜¯è€¦åˆï¼Ÿå½“ä½ ä¿®æ”¹ä»£ç çš„ä¸€ä¸ªåœ°æ–¹ï¼Œå´æ„å¤–åœ°å¯¼è‡´å¦ä¸€ä¸ªçœ‹ä¼¼æ— å…³çš„åœ°æ–¹ä¹Ÿå¿…é¡»ä¿®æ”¹ï¼Œç”šè‡³ç›´æ¥å´©æºƒæ—¶ï¼Œä½ å°±é‡åˆ°äº†è€¦åˆã€‚&lt;/li&gt;
&lt;li&gt;æ•´æ´æ¶æ„çš„æ ¸å¿ƒç›®æ ‡åªæœ‰ä¸€ä¸ªï¼šæ–©æ–­ä¸å¿…è¦çš„è€¦åˆï¼Œä¸ºæˆ‘ä»¬çš„ä»£ç å»ºç«‹â€œé˜²ç«å¢™â€ï¼Œæ§åˆ¶å˜æ›´çš„â€œçˆ†ç‚¸åŠå¾„â€ã€‚&lt;/li&gt;
&lt;li&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šé€šè¿‡4ä¸ªæˆ‘ä»¬éƒ½ç»å†è¿‡çš„æƒ¨ç—›é—®é¢˜ï¼Œæ¥å±•ç¤ºæ•´æ´æ¶æ„æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥å¸®æˆ‘ä»¬é©¯æœè¿™å¤´æ€ªå…½çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ–¼ï¸ è§†è§‰å…ƒç´ å ä½ç¬¦: æ­¤å¤„å±•ç¤ºå®Œæ•´çš„æ•´æ´æ¶æ„â€œæ´‹è‘±å›¾â€ï¼Œå¹¶å¿«é€Ÿè§£é‡Šå››ä¸ªç¯ï¼šEntities -&amp;gt; Use Cases -&amp;gt; Adapters -&amp;gt; Frameworks)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/fb504fdb-4ba4-4dc8-8d01-c869da9be03d&#34; alt=&#34;Image3&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;p5-é—®é¢˜ä¸€-æˆ‘åªæƒ³æ”¹ä¸ªä¸šåŠ¡è§„åˆ™-ä¸ºä»€ä¹ˆè¿˜è¦åŠ¨æ•°æ®åº“å’Œapiçš„ä»£ç &#34;&gt;&lt;strong&gt;P5: é—®é¢˜ä¸€ï¼šâ€œæˆ‘åªæƒ³æ”¹ä¸ªä¸šåŠ¡è§„åˆ™ï¼Œä¸ºä»€ä¹ˆè¿˜è¦åŠ¨æ•°æ®åº“å’ŒAPIçš„ä»£ç ï¼Ÿâ€&lt;/strong&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ–¼ï¸ è§†è§‰å…ƒç´ å ä½ç¬¦: æ´‹è‘±å›¾é«˜äº®æœ€å†…å±‚çš„ &amp;ldquo;Entities&amp;rdquo; ç¯)&lt;/strong&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;ç—›ç‚¹åœºæ™¯ï¼š&lt;/strong&gt; ä½ æƒ³ä¿®æ”¹ä¸€ä¸ªå®ä½“ï¼ˆæ¯”å¦‚ &lt;code&gt;User&lt;/code&gt;ï¼‰çš„ä¸šåŠ¡è§„åˆ™ã€‚ä½†åœ¨å¾ˆå¤šé¡¹ç›®ä¸­ï¼Œè¿™ä¸ªå®ä½“è¢«å®šä¹‰æˆäº†ä¸€ä¸ªâ€œä¸‡èƒ½Structâ€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// user.go
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// å®ƒæ—¢æ˜¯ä¸šåŠ¡å®ä½“ï¼Œåˆæ˜¯GORMæ¨¡å‹ï¼Œè¿˜æ˜¯HTTPå“åº”ä½“
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;ID&lt;/span&gt;        &lt;span class=&#34;kt&#34;&gt;uint&lt;/span&gt;      &lt;span class=&#34;s&#34;&gt;`json:&amp;#34;id&amp;#34; gorm:&amp;#34;primaryKey&amp;#34;`&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// &amp;lt;-- é«˜äº®æ­¤è¡Œ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;Name&lt;/span&gt;      &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;    &lt;span class=&#34;s&#34;&gt;`json:&amp;#34;name&amp;#34; gorm:&amp;#34;size:255&amp;#34;`&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;Points&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;       &lt;span class=&#34;s&#34;&gt;`json:&amp;#34;points&amp;#34;`&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;// ...
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;ç°åœ¨ï¼Œäº§å“è¯´ï¼šä¸ºäº†å…¼å®¹æ–°Appï¼Œ&lt;code&gt;ID&lt;/code&gt; å­—æ®µå¯¹å¤–è¦æ”¹æˆ &lt;code&gt;user_id&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä½ åªèƒ½ä¿®æ”¹ï¼š&lt;code&gt;ID uint \&lt;/code&gt;json:&amp;ldquo;user_id&amp;rdquo; gorm:&amp;ldquo;primaryKey&amp;rdquo;``ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é—®é¢˜æ¥äº†ï¼š&lt;/strong&gt; ä½ åªæ˜¯åœ¨ä¿®æ”¹ä¸€ä¸ªå‰ç«¯å±•ç¤ºå­—æ®µçš„åç§°ï¼Œå´è¿«ä½¿ä½ ä¿®æ”¹äº†ä¸€ä¸ªæ ¸å¿ƒä¸šåŠ¡å®ä½“ï¼ˆUserï¼‰çš„æ–‡ä»¶ã€‚&lt;strong&gt;è¿™å°±æ˜¯ä¸šåŠ¡é€»è¾‘å’Œå±•ç¤ºç»†èŠ‚çš„è€¦åˆã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è§£è¯ï¼šä¸€ä¸ªçº¯å‡€çš„ã€é¢†åŸŸå±‚ Domain Layerã€‘&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ƒçš„å”¯ä¸€èŒè´£&lt;/strong&gt;ï¼šå»ºç«‹ä¸€ä¸ªâ€œæ— èŒå®¤â€ï¼Œåªå­˜æ”¾æœ€æ ¸å¿ƒã€æœ€çº¯ç²¹çš„ä¸šåŠ¡å®ä½“å’Œä¸šåŠ¡è§„åˆ™ã€‚&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;kfinops&lt;/code&gt; çš„å®è·µ:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// internal/domain/subdomain.go
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// åªæœ‰ä¸šåŠ¡å±æ€§ï¼Œæ²¡æœ‰jsonï¼Œgormç­‰ä»»ä½•æŠ€æœ¯æ ‡ç­¾
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;SubDomain&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;ID&lt;/span&gt;         &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// çº¯ç²¹çš„ä¸šåŠ¡ID
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;FullDomain&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;Status&lt;/span&gt;     &lt;span class=&#34;nx&#34;&gt;SubDomainStatus&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ•ˆæœï¼š&lt;/strong&gt; ä¸šåŠ¡æ ¸å¿ƒå®Œå…¨ç¨³å®šã€‚å‰ç«¯/æ•°æ®åº“çš„ä»»ä½•å˜åŒ–ï¼Œéƒ½ä¸ä¼šè§¦ç¢°åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;p6-é—®é¢˜äºŒ-åˆ›å»ºå­åŸŸå-è¿™ä¸ªåŠŸèƒ½-ä»£ç åˆ°åº•åœ¨å“ª&#34;&gt;&lt;strong&gt;P6: é—®é¢˜äºŒï¼šâ€œâ€˜åˆ›å»ºå­åŸŸåâ€™è¿™ä¸ªåŠŸèƒ½ï¼Œä»£ç åˆ°åº•åœ¨å“ªï¼Ÿâ€&lt;/strong&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ–¼ï¸ è§†è§‰å…ƒç´ å ä½ç¬¦: æ´‹è‘±å›¾é«˜äº®ç¬¬äºŒå±‚çš„ &amp;ldquo;Use Cases&amp;rdquo; ç¯)&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ¤ äº’åŠ¨ç¯èŠ‚):&lt;/strong&gt; â€œä¸¾ä¸ªæ‰‹ï¼Œè°é‡åˆ°è¿‡æƒ³çœ‹æ‡‚ä¸€ä¸ªåŠŸèƒ½ï¼Œç»“æœåœ¨IDEé‡Œè·³äº†åå‡ ä¸ªæ–‡ä»¶çš„æƒ…å†µï¼Ÿâ€&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç—›ç‚¹åœºæ™¯ï¼š&lt;/strong&gt; ä¸šåŠ¡æµç¨‹åƒå¤©å¥³æ•£èŠ±ï¼Œå¿ƒæ™ºè´Ÿæ‹…æå¤§ï¼Œä½ æ ¹æœ¬æ‰¾ä¸åˆ°ä¸€ä¸ªåœ°æ–¹èƒ½çœ‹æ¸…è¿™ä¸ªåŠŸèƒ½çš„â€œå‰§æœ¬â€ã€‚&lt;strong&gt;è¿™å°±æ˜¯ä¸šåŠ¡æµç¨‹çš„é€»è¾‘ç¦»æ•£ã€‚&lt;/strong&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è§£è¯ï¼šä¸€ä¸ªæ¸…æ™°çš„ã€ç”¨ä¾‹å±‚ Use Case Layerã€‘&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ƒçš„å”¯ä¸€èŒè´£&lt;/strong&gt;ï¼šåƒä¸€ä¸ªâ€œå¯¼æ¼”â€ï¼Œè´Ÿè´£ç¼–æ’ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡æ•…äº‹ã€‚ä¸€ä¸ªUse Caseå°±ä»£è¡¨ç³»ç»Ÿçš„ä¸€ä¸ªèƒ½åŠ›ã€‚&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;kfinops&lt;/code&gt; çš„å®è·µ:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// in internal/usecase/subdomain/service.go
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;SubDomainUseCase&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;repo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;repository&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SubDomainRepository&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// ä¾èµ–æ¥å£
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;uc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SubDomainUseCase&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;CreateSubDomain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;// 1. éªŒè¯è¾“å…¥ (DTO)                &amp;lt;-- é«˜äº®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 2. åˆ›å»º Domain å®ä½“             &amp;lt;-- é«˜äº®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 3. è°ƒç”¨ Domain å®ä½“ä¸šåŠ¡æ–¹æ³•      &amp;lt;-- é«˜äº®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 4. é€šè¿‡ã€æ¥å£ã€‘è¿›è¡ŒæŒä¹…åŒ–          &amp;lt;-- é«˜äº®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;uc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;repo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;domainEntity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ•ˆæœï¼š&lt;/strong&gt; æƒ³ç†è§£ä¸€ä¸ªåŠŸèƒ½ï¼Œåªéœ€è¦çœ‹è¿™ä¸€ä¸ªæ–‡ä»¶ã€‚å®ƒæ¸…æ™°åœ°è®²è¿°äº†â€œåšä»€ä¹ˆï¼ˆWhatï¼‰â€ï¼Œè€Œä¸å…³å¿ƒâ€œæ€ä¹ˆåšï¼ˆHowï¼‰â€ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;p7-é—®é¢˜ä¸‰-æ•°æ®åº“è¦ä»mysqlæ¢æˆmongodb-å®Œäº†-é¡¹ç›®è¦é‡å†™äº†&#34;&gt;&lt;strong&gt;P7: é—®é¢˜ä¸‰ï¼šâ€œæ•°æ®åº“è¦ä»MySQLæ¢æˆMongoDBï¼Œå®Œäº†ï¼Œé¡¹ç›®è¦é‡å†™äº†ï¼â€&lt;/strong&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ–¼ï¸ è§†è§‰å…ƒç´ å ä½ç¬¦: æ´‹è‘±å›¾é«˜äº®ç¬¬ä¸‰å±‚çš„ &amp;ldquo;Adapters&amp;rdquo; ç¯ï¼Œå¹¶ç”»ä¸€ä¸ªç®­å¤´è¡¨ç¤ºä¾èµ–åè½¬)&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç—›ç‚¹åœºæ™¯ï¼š&lt;/strong&gt; ä½ çš„ä»£ç é‡Œåˆ°å¤„éƒ½æ˜¯ &lt;code&gt;gorm.DB.Where(...).Find(...)&lt;/code&gt;ã€‚ä½ çš„ä¸šåŠ¡é€»è¾‘â€œçŸ¥é“â€ä½ æ­£åœ¨ä½¿ç”¨GORMå’ŒMySQLã€‚&lt;strong&gt;è¿™å°±æ˜¯ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®å­˜å‚¨æŠ€æœ¯çš„å¼ºè€¦åˆã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£è¯ï¼šã€é€‚é…å™¨å±‚ Adapterã€‘ + ã€ä¾èµ–å€’ç½®åŸåˆ™ã€‘&lt;/strong&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ƒçš„å”¯ä¸€èŒè´£&lt;/strong&gt;ï¼šå°†æŠ€æœ¯ç»†èŠ‚â€œé€‚é…â€æˆä¸šåŠ¡å±‚èƒ½ç†è§£çš„â€œæ’ä»¶â€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒé­”æ³•â€”â€”ä¾èµ–å€’ç½®&lt;/strong&gt;ï¼š

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Use Caseï¼ˆä½¿ç”¨è€…ï¼‰&lt;/strong&gt; åœ¨è‡ªå·±åŒ…é‡Œå®šä¹‰æ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Adapterï¼ˆå®ç°è€…ï¼‰&lt;/strong&gt; å»å®ç°è¿™ä¸ªæ¥å£ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•ˆæœï¼š&lt;/strong&gt; æŠ€æœ¯å®ç°å˜æˆäº†å¯æ’æ‹”çš„â€œé›¶ä»¶â€ã€‚æ›´æ¢æ•°æ®åº“ï¼Ÿåªéœ€è¦å†™ä¸€ä¸ªæ–°çš„Repositoryå®ç°ï¼Œç„¶ååœ¨DIé…ç½®é‡Œæ¢æ‰å³å¯ï¼Œ&lt;strong&gt;Use Caseå±‚çš„ä»£ç ä¸€è¡Œéƒ½ä¸ç”¨æ”¹ï¼&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;p8-é—®é¢˜å››-è¿™ä»£ç æ ¹æœ¬æ²¡æ³•å†™å•å…ƒæµ‹è¯•&#34;&gt;&lt;strong&gt;P8: é—®é¢˜å››ï¼šâ€œè¿™ä»£ç æ ¹æœ¬æ²¡æ³•å†™å•å…ƒæµ‹è¯•ï¼â€&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/7271b7b0-f51e-40ce-8fe0-dfad4850ed7e&#34; alt=&#34;Image3&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ–¼ï¸ è§†è§‰å…ƒç´ å ä½ç¬¦: ä¸€å¼ å›¾ç‰‡ï¼Œå·¦è¾¹æ˜¯æ··ä¹±çš„æ¯›çº¿çƒä»£è¡¨ç´§è€¦åˆï¼Œå³è¾¹æ˜¯æ•´é½çš„ä¹é«˜ç§¯æœ¨ä»£è¡¨å¯æµ‹è¯•)&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ¤ äº’åŠ¨ç¯èŠ‚):&lt;/strong&gt; â€œè¯šå®åœ°ä¸¾æ‰‹ï¼Œè°å› ä¸ºä»£ç å¤ªéš¾æµ‹è¯•è€Œæ”¾å¼ƒå†™å•å…ƒæµ‹è¯•çš„ï¼Ÿâ€&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç—›ç‚¹åœºæ™¯ï¼š&lt;/strong&gt; ä¸šåŠ¡é€»è¾‘é‡Œ &lt;code&gt;new&lt;/code&gt; äº†ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œå¯¼è‡´å•å…ƒæµ‹è¯•å¿…é¡»ä¾èµ–çœŸå®ç¯å¢ƒã€‚&lt;strong&gt;è¿™æ˜¯ã€å¯æµ‹è¯•æ€§ç¾éš¾ã€‘ã€‚&lt;/strong&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è§£è¯ï¼šã€æ¥å£ã€‘ + ã€ä¾èµ–æ³¨å…¥ Dependency Injectionã€‘&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®ƒçš„å”¯ä¸€èŒè´£&lt;/strong&gt;ï¼šå°†ç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ä»â€œç¡¬ç¼–ç â€å˜ä¸ºâ€œå¤–éƒ¨é…ç½®â€ã€‚&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ•ˆæœï¼šåœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°â€œéª—â€è¿‡ Use Caseï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æˆ‘ä»¬å¯ä»¥è½»æ˜“åœ°ç”¨ä¸€ä¸ª &amp;#34;å‡çš„&amp;#34; mockRepo æ›¿æ¢æ‰ &amp;#34;çœŸçš„&amp;#34; GormRepo
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mockRepo&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MockSubDomainRepository&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;// å‘Šè¯‰ mockRepo: &amp;#34;å½“æœ‰äººè°ƒç”¨Saveæ–¹æ³•æ—¶ï¼Œå‡è£…æˆåŠŸ&amp;#34;
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mockRepo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;On&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Save&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Anything&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Anything&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// &amp;lt;-- é«˜äº®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;useCase&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;NewSubDomainUseCase&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mockRepo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// ä¾èµ–è¢«æ³¨å…¥äº†ï¼ &amp;lt;-- é«˜äº®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;useCase&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;CreateSubDomain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;assert&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NoError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;æµ‹è¯•é€šè¿‡&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ï¼&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;å…¨ç¨‹æ²¡æœ‰ç¢°è¿‡æ•°æ®åº“&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ï¼&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è¿™è®©ç¼–å†™å¿«é€Ÿã€å¯é çš„å•å…ƒæµ‹è¯•æˆä¸ºå¯èƒ½ï¼Œæå¤§åœ°ä¿è¯äº†ä»£ç è´¨é‡ã€‚&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;p9-å¯ç»´æŠ¤æ€§çš„å»¶ä¼¸-æ„å»ºå¼ºå¤§çš„å¯è§‚æµ‹æ€§&#34;&gt;&lt;strong&gt;P9: å¯ç»´æŠ¤æ€§çš„å»¶ä¼¸ï¼šæ„å»ºå¼ºå¤§çš„å¯è§‚æµ‹æ€§&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/297e1818-ea6e-4a33-8747-5ad78e004e40&#34; alt=&#34;Image3&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ä½œä¸ºSREå›¢é˜Ÿï¼Œæˆ‘ä»¬ä¸ä»…è¦å†™å‡ºå¯ç»´æŠ¤çš„ä»£ç ï¼Œæ›´è¦ç¡®ä¿ç³»ç»Ÿåœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ˜¯â€˜å¯ç†è§£â€™ã€â€˜å¯è¯Šæ–­â€™çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯è§‚æµ‹æ€§ä¸‰å¤§æ”¯æŸ±ï¼š&lt;/strong&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸªµ æ—¥å¿— (Logging) - å®šä½â€œå“ªé‡Œâ€å‡ºé”™äº†&lt;/strong&gt;: æ¥å…¥KAEï¼Œç»“æ„åŒ–æ—¥å¿—ï¼ŒåŒ…å«&lt;code&gt;request_id&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“Š æŒ‡æ ‡ (Metrics) - äº†è§£â€œæ€ä¹ˆæ ·â€äº†&lt;/strong&gt;: Prometheus + Grafana Dashboardã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ”— è¿½è¸ª (Tracing) - åˆ†æâ€œä¸ºä»€ä¹ˆâ€æ…¢äº†&lt;/strong&gt;: OpenTelemetry åˆ†å¸ƒå¼è¿½è¸ªã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°ç»“ï¼šæ•´æ´çš„æ¶æ„è®©ä»£ç åœ¨â€œé™æ€æ—¶â€æ˜“äºç†è§£ï¼›å®Œå–„çš„å¯è§‚æµ‹æ€§ä½“ç³»åˆ™è®©ç³»ç»Ÿåœ¨â€œè¿è¡Œæ—¶â€æ˜“äºè¯Šæ–­ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;p10-é¢å‘aiç¼–ç¨‹-æ¶æ„å³å¥‘çº¦-çº¦æŸå³æŒ‡å¯¼&#34;&gt;&lt;strong&gt;P10: é¢å‘AIç¼–ç¨‹ï¼šæ¶æ„å³å¥‘çº¦ï¼Œçº¦æŸå³æŒ‡å¯¼&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://github.com/user-attachments/assets/640a4f7e-5ef3-4ec6-806e-5e72fd31cb26&#34; alt=&#34;Image3&#34; width=&#34;700px&#34; /&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;(ğŸ–¼ï¸ è§†è§‰å…ƒç´ å ä½ç¬¦: ä¸€ä¸ªå¯¹æ¯”å›¾)&lt;/strong&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å·¦è¾¹ (æ— æ¶æ„):&lt;/strong&gt; äººç±» ğŸ¤¯ â†’ prompt â†’ AI ğŸ¤– â†’ ä¸€å †æ•£ä¹±ä»£ç  ğŸ’©&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å³è¾¹ (æœ‰æ¶æ„):&lt;/strong&gt; äººç±» ğŸ˜ â†’ çŸ­prompt â†’ AI ğŸ¤– â†’ ç²¾å‡†ã€åˆ†å±‚çš„ä»£ç  âœ…&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€ä¸ªå¥½çš„æ¶æ„ï¼Œå°±æ˜¯æ•´ä¸ªé¡¹ç›®çš„â€œä»£ç å¥‘çº¦ (Code Contract)â€&lt;/strong&gt;ï¼Œå®ƒä¸ºAIæä¾›äº†ä¸€ä¸ªæ¸…æ™°ã€æ˜ç¡®çš„ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰äº†è¿™ä»½â€œå¥‘çº¦â€ï¼Œçº¦æŸå°±å˜æˆäº†å¯¹AIæœ€æœ‰æ•ˆçš„æŒ‡å¯¼ï¼š&lt;/strong&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¶æ„å®šä¹‰äº†â€œå‰§æœ¬ (Playbook)â€&lt;/strong&gt;: AIä¼šåƒä¸€ä¸ªç†Ÿæ‚‰é¡¹ç›®çš„è€æ‰‹ä¸€æ ·ï¼Œåœ¨æ­£ç¡®çš„åœ°æ–¹å†™ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çº¦æŸæä¾›äº†â€œæŠ¤æ  (Guardrails)â€&lt;/strong&gt;: AIä¸ä¼šåœ¨usecaseå±‚ç›´æ¥å†™SQLã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;â€œå¥‘çº¦â€ç®€åŒ–äº†æˆ‘ä»¬çš„â€œæŒ‡ä»¤ (Prompt)â€&lt;/strong&gt;: ä»â€œä¸€æ­¥æ­¥å‘Šè¯‰AIæ€ä¹ˆåšâ€ï¼Œå˜æˆäº†â€œ&lt;strong&gt;ä¸º &lt;code&gt;CreateUser&lt;/code&gt; ç”¨ä¾‹å®ç°API&lt;/strong&gt;â€è¿™æ ·ç®€å•çš„æŒ‡ä»¤ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“è®ºï¼šæ¶æ„å³æç¤º (Architecture as the Prompt)ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;p11-æ€»ç»“ä¸è¡ŒåŠ¨æŒ‡å—&#34;&gt;&lt;strong&gt;P11: æ€»ç»“ä¸è¡ŒåŠ¨æŒ‡å—&lt;/strong&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;ç¼–å†™å¯ç»´æŠ¤ä»£ç çš„æ ¸å¿ƒæ˜¯â€œé™ä½ç†è§£æˆæœ¬â€å’Œâ€œæ§åˆ¶å˜æ›´å½±å“â€ã€‚&lt;/li&gt;
&lt;li&gt;æ•´æ´æ¶æ„æ˜¯ä¸€ä»½å¼ºå¤§çš„â€œä»£ç å¥‘çº¦â€ï¼Œé€šè¿‡å¼ºåˆ¶è§„åˆ™ä¿è¯äº†é¡¹ç›®çš„ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(ğŸš€ è¡ŒåŠ¨å·å¬):&lt;/strong&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å›¢é˜Ÿå¯ä»¥é©¬ä¸Šå°è¯•çš„å®è·µ&lt;/strong&gt;: åœ¨ä¸‹ä¸€ä¸ªæ–°åŠŸèƒ½é‡Œï¼Œå…ˆå’ŒåŒäº‹èŠ±10åˆ†é’Ÿè®¨è®ºä¸€ä¸‹å®ƒçš„ Use Case æ˜¯ä»€ä¹ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨èå¤§å®¶è¯•ç”¨&lt;/strong&gt;: å…‹éš†æˆ‘ä»¬çš„ &lt;code&gt;kfinops&lt;/code&gt; é¡¹ç›®æˆ–&lt;code&gt;go-clean-arch&lt;/code&gt;æ¨¡æ¿ï¼Œäº²æ‰‹è¿è¡Œä¸€ä¸‹ï¼Œæ„Ÿå—åˆ†å±‚çš„æ¸…æ™°ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢å‘AIç¼–ç¨‹ä¸æ˜¯ä¸€å¥å£å·ï¼Œè€Œæ˜¯ä¸€ç§æ–°çš„å·¥ä½œèŒƒå¼ã€‚&lt;/strong&gt; ä½ çš„æ¶æ„è¶Šæ¸…æ™°ã€çº¦æŸè¶Šæ˜ç¡®ï¼ŒAIå°±è¶Šèƒ½æˆä¸ºä½ çš„å¾—åŠ›åŠ©æ‰‹ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;p12-q-a&#34;&gt;&lt;strong&gt;P12: Q&amp;amp;A&lt;/strong&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è°¢è°¢å¤§å®¶ï¼&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡¹ç›®æ¨¡æ¿å‚è€ƒ: &lt;a href=&#34;https://github.com/zhu327/go-clean-arch&#34;&gt;https://github.com/zhu327/go-clean-arch&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿæˆ–è€…å¯¹æˆ‘ä»¬å›¢é˜Ÿæœªæ¥çš„ä»£ç è§„èŒƒæœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>Vibe Codingæœ‰æ„Ÿ: ä»PingSIXé‡æ„è¯´èµ·</title>
      <link>https://zhu327.github.io/2025/09/02/vibe-coding%E6%9C%89%E6%84%9F-%E4%BB%8Epingsix%E9%87%8D%E6%9E%84%E8%AF%B4%E8%B5%B7/</link>
      <pubDate>Tue, 02 Sep 2025 14:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/09/02/vibe-coding%E6%9C%89%E6%84%9F-%E4%BB%8Epingsix%E9%87%8D%E6%9E%84%E8%AF%B4%E8%B5%B7/</guid>
      <description>&lt;p&gt;è¯´åˆ°â€œVibe Codingâ€ï¼Œè¿™ä¸ªè¯æœ€è¿‘åœ¨å¼€å‘è€…åœˆå­é‡Œè¶Šæ¥è¶Šæµè¡Œã€‚åœ¨è¿‡å»ï¼Œæˆ‘çš„å®è·µå¾ˆå¤§ç¨‹åº¦ä¸Šè¿˜åœç•™åœ¨æ¯”è¾ƒåˆçº§çš„é˜¶æ®µï¼šæŠŠéœ€æ±‚å’Œä»£ç ç‰‡æ®µåœ¨ ChatGPTã€Google AI Studio æˆ–æ˜¯ Grok ä¹‹é—´æ¥å›åœ°å¤åˆ¶ç²˜è´´ã€‚æ¥åˆ°æ–°å…¬å¸åï¼Œè™½ç„¶å¼€é€šäº† GitHub Copilotï¼Œä½“éªŒæœ‰æ‰€æå‡ï¼Œä½†æ„Ÿè§‰å®ƒæ›´å¤šæ—¶å€™è¿˜æ˜¯ä¸€ä¸ªâ€œè¶…çº§æ™ºèƒ½è¡¥å…¨â€å·¥å…·ã€‚ç›´åˆ°ä»Šå¹´7æœˆä»½ï¼Œå…¬å¸ç»™é…ä¸Šäº† Cursorï¼Œæˆ‘çš„ç¼–ç¨‹ä½“éªŒæ‰çœŸæ­£å¼€å¯äº†ä¸€åœºå˜é©ï¼Œæ­£å¼è¿›å…¥äº† Vibe Coding çš„å¥‡å¦™æ—…ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;æ°å¥½ï¼Œè·ç¦»æˆ‘ä¸Šæ¬¡æ›´æ–°ä¸ªäººé¡¹ç›® &lt;a href=&#34;https://github.com/zhu327/pingsix&#34;&gt;PingSIX&lt;/a&gt; å·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚PingSIX æ˜¯ä¸€ä¸ªæˆ‘åŸºäº Cloudflare é«˜æ€§èƒ½æ¡†æ¶ Pingora å¼€å‘çš„ API ç½‘å…³ã€‚ä¸¤å‘¨å‰ï¼ŒPingora å‘å¸ƒäº† 0.6.0 ç‰ˆæœ¬ï¼Œè¿™ç»™äº†æˆ‘ä¸€ä¸ªç»ä½³çš„å¥‘æœºã€‚æˆ‘å†³å®šåˆ©ç”¨è¿™ä¸ªæœºä¼šï¼Œå½»åº•å®è·µä¸€æ¬¡å…¨ç¨‹ä½¿ç”¨ Cursor çš„ Vibe Codingï¼Œå¯¹ PingSIX è¿›è¡Œä¸€æ¬¡å¤§é‡æ„ã€‚&lt;/p&gt;

&lt;p&gt;è¿™æ¬¡é‡æ„æ–­æ–­ç»­ç»­èŠ±äº†ä¸€å‘¨æ—¶é—´ï¼Œæœ€ç»ˆæ–°å¢äº† 6636 è¡Œä»£ç ï¼Œåˆ é™¤äº† 3578 è¡Œã€‚è¿™ä¸ä»…ä»…æ˜¯æ•°å­—ä¸Šçš„å˜åŒ–ï¼Œæ•´ä¸ªé¡¹ç›®åœ¨æ¶æ„ã€å¯ç»´æŠ¤æ€§ã€å¯è¯»æ€§ã€å®‰å…¨æ€§åŠæ€§èƒ½ä¸Šï¼Œéƒ½è¾¾åˆ°äº†ä¸€ä¸ªæˆ‘è‡ªå·±éå¸¸æ»¡æ„çš„çŠ¶æ€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;æˆ‘çš„-vibe-coding-å·¥ä½œæµ&#34;&gt;æˆ‘çš„ Vibe Coding å·¥ä½œæµ&lt;/h3&gt;

&lt;p&gt;åœ¨è¿™æ¬¡é‡æ„ä¹‹æ—…ä¸­ï¼Œæˆ‘é€æ¸æ‘¸ç´¢å‡ºäº†ä¸€å¥—ä¸ AI é«˜æ•ˆåä½œçš„å·¥ä½œæµã€‚è¿™å¥—æµç¨‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š&lt;strong&gt;ä½ ï¼Œä½œä¸ºç¨‹åºå‘˜ï¼Œä¾ç„¶æ˜¯æŒèˆµè€…ï¼›è€Œ AIï¼Œæ˜¯ä½ æœ€å¼ºå¤§çš„å‰¯é©¾é©¶ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id=&#34;1-é€‰æ‹©å¯¹çš„-å‰¯é©¾-æ¨¡å‹å¾ˆé‡è¦&#34;&gt;1. é€‰æ‹©å¯¹çš„â€œå‰¯é©¾â€ï¼šæ¨¡å‹å¾ˆé‡è¦&lt;/h4&gt;

&lt;p&gt;å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚æˆ‘å°è¯•äº† Cursor å†…ç½®çš„å¤šä¸ªæ¨¡å‹ï¼Œæœ€ç»ˆå‘ç° &lt;strong&gt;claude-4-sonnet&lt;/strong&gt; æ˜¯æˆ‘çš„é¦–é€‰ã€‚å®ƒè¡¨ç°æœ€ç¨³å®šï¼Œç†è§£å¤æ‚ä¸Šä¸‹æ–‡çš„èƒ½åŠ›å¾ˆå¼ºï¼Œç”Ÿæˆä»£ç çš„è´¨é‡ä¹Ÿç›¸å½“é«˜ï¼Œè€Œä¸”ä»·æ ¼åˆé€‚ã€‚å…¶å®ƒæ¨¡å‹æˆ–å¤šæˆ–å°‘ä¼šæœ‰äº›å°é—®é¢˜ï¼Œè€Œ Sonnet åˆ™æä¾›äº†ä¸€ç§â€œæ— è„‘ç”¨â€çš„ç¨³å®šé¢„æœŸã€‚&lt;/p&gt;

&lt;h4 id=&#34;2-ç²¾å‡†çš„æŒ‡ä»¤-ä¸Šä¸‹æ–‡å·¥ç¨‹æ˜¯å…³é”®&#34;&gt;2. ç²¾å‡†çš„æŒ‡ä»¤ï¼šä¸Šä¸‹æ–‡å·¥ç¨‹æ˜¯å…³é”®&lt;/h4&gt;

&lt;p&gt;æŠŠ AI å½“æˆä¸€ä¸ªéœ€è¦æ˜ç¡®æŒ‡ä»¤çš„åˆçº§ç¨‹åºå‘˜ã€‚åœ¨ä½ è®© Cursor å†™ä»£ç å‰ï¼Œ&lt;strong&gt;å¿…é¡»å…ˆè‡ªå·±æ•´ç†å¥½éœ€æ±‚&lt;/strong&gt;ã€‚éœ€æ±‚æè¿°å¾—è¶Šè¯¦ç»†ã€è¶Šæ¸…æ™°ï¼ŒAI ç”Ÿæˆçš„ä»£ç è´¨é‡å°±è¶Šé«˜ã€‚æˆ‘ä¼šæŠŠç›¸å…³çš„ä»£ç æ–‡ä»¶ã€éœ€è¦è°ƒç”¨çš„å‡½æ•°å®šä¹‰ï¼Œéƒ½é€šè¿‡ &lt;code&gt;@&lt;/code&gt; ç¬¦å·æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œä¸º AI æä¾›ä¸€ä¸ªå®Œæ•´çš„â€œä½œæˆ˜åœ°å›¾â€ã€‚&lt;/p&gt;

&lt;h4 id=&#34;3-ä»æˆ˜ç•¥åˆ°æˆ˜æœ¯-è®©-ai-å…ˆå½“-æ¶æ„å¸ˆ&#34;&gt;3. ä»æˆ˜ç•¥åˆ°æˆ˜æœ¯ï¼šè®© AI å…ˆå½“â€œæ¶æ„å¸ˆâ€&lt;/h4&gt;

&lt;p&gt;å¦‚æœä½ è‡ªå·±å¯¹æŸä¸ªåŠŸèƒ½ä¹Ÿä¸€å¤´é›¾æ°´ï¼Œä¸çŸ¥é“è¯¥å¦‚ä½•ä¸‹æ‰‹ï¼Œé‚£å°±å…ˆåˆ«æ€¥ç€è®© AI å†™ä»£ç ã€‚æˆ‘ä¼šå…ˆæ‰“å¼€ â€œAskâ€ æ¨¡å¼ï¼ŒæŠŠæˆ‘çš„éš¾é¢˜æŠ›ç»™å®ƒï¼Œè®© LLM å¸®æˆ‘å‡ºè°‹åˆ’ç­–ã€‚é€šè¿‡ä¸€ééçš„è¿½é—®å’Œè¿­ä»£ï¼Œæ›´æ–°æˆ‘çš„éœ€æ±‚ï¼Œæœ€ç»ˆå°† AI æä¾›çš„æ–¹æ¡ˆæ•´ç†æˆä¸€ä»½è¯¦å°½çš„æ–‡æ¡£ï¼Œç”šè‡³ç»†åŒ–åˆ°æŸä¸ªå…·ä½“é€»è¾‘çš„å®ç°æ­¥éª¤ã€‚æœ‰æ—¶ï¼Œæˆ‘è¿˜ä¼šè®©å®ƒ&lt;strong&gt;å…ˆä¸ºæˆ‘çš„è®¾æƒ³ç¼–å†™å•å…ƒæµ‹è¯•&lt;/strong&gt;ï¼Œç„¶åå†è®© Agent éµå¾ªè¿™ä»½â€œè“å›¾â€å»å®ç°åŠŸèƒ½ä»£ç ã€‚&lt;/p&gt;

&lt;h4 id=&#34;4-ä½ æ°¸è¿œæ˜¯ä»£ç çš„æœ€ç»ˆè´£ä»»äºº&#34;&gt;4. ä½ æ°¸è¿œæ˜¯ä»£ç çš„æœ€ç»ˆè´£ä»»äºº&lt;/h4&gt;

&lt;p&gt;è¦æ—¶åˆ»è®°ä½ï¼ŒLLM çš„å›ç­”å…·æœ‰ä¸ç¡®å®šæ€§ã€‚å®ƒæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†ä¸èƒ½æ›¿ä»£ä½ çš„ä¸“ä¸šåˆ¤æ–­ã€‚æˆ‘çš„åŸåˆ™æ˜¯ï¼š&lt;strong&gt;å…ˆç”±æˆ‘æ¥ç¡®å®šâ€œæ€ä¹ˆå†™â€çš„é¡¶å±‚è®¾è®¡ï¼Œå†è®© LLM æ¥å®Œæˆâ€œä½“åŠ›æ´»â€&lt;/strong&gt;ã€‚å½“ä»£ç ç”Ÿæˆåï¼Œ&lt;strong&gt;Code Review æ˜¯å¿…ä¸å¯å°‘çš„ä¸€ç¯&lt;/strong&gt;ã€‚ä»”ç»†å®¡æŸ¥æ¯ä¸€è¡Œä»£ç ï¼Œç¡®ä¿å®ƒå®Œå…¨ç¬¦åˆä½ çš„é¢„æœŸã€‚å¦‚æœä¸ç¡®å®šï¼Œé‚£å°±è®© LLM ç»§ç»­ä¸ºè¿™æ®µä»£ç è¡¥å……å•å…ƒæµ‹è¯•ï¼Œç”¨æµ‹è¯•ç”¨ä¾‹æ¥éªŒè¯é€»è¾‘çš„æ­£ç¡®æ€§ã€‚&lt;/p&gt;

&lt;h4 id=&#34;5-è®©-ai-æˆä¸ºä½ çš„-ä»£ç è¯„å®¡ä¸“å®¶&#34;&gt;5. è®© AI æˆä¸ºä½ çš„â€œä»£ç è¯„å®¡ä¸“å®¶â€&lt;/h4&gt;

&lt;p&gt;é™¤äº†å†™ä»£ç ï¼ŒAI åœ¨ Code Review æ–¹é¢ä¹Ÿè¡¨ç°å‡ºè‰²ã€‚æœ‰æ—¶æˆ‘ä»¬è‡ªå·±å¾ˆéš¾å‘ç°é¡¹ç›®ä¸­çš„æ½œåœ¨é—®é¢˜ï¼Œè¿™æ—¶å°±å¯ä»¥å€ŸåŠ© LLM çš„è§†è§’ã€‚æˆ‘ä¼šç”¨ä¸‹é¢è¿™ä¸ª Prompt æ¥è¯·æ±‚ä¸€æ¬¡å…¨é¢çš„â€œä»£ç ä½“æ£€â€ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ä½ æ˜¯ä¸€ä¸ªRustç¼–ç¨‹å¤§å¸ˆ, APIç½‘å…³é¢†åŸŸçš„ä¸“å®¶, è¯·ä½ ä»ä»£ç æ€»ä½“çš„æ¶æ„, å¯è¯»æ€§, å¯ç»´æŠ¤æ€§, å®‰å…¨æ€§, æ€§èƒ½æ–¹é¢å…¨é¢çš„reviewæˆ‘çš„é¡¹ç›®ä»£ç , ç»™å‡ºä½ çš„åˆ†ææŠ¥å‘Š, å¹¶å¯¹æœ‰å“ªäº›ä»£ç éœ€è¦ä¿®æ”¹ç»™å‡ºå…·ä½“çš„ä¿®æ”¹å»ºè®®ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;ä»å±€éƒ¨ä¼˜åŒ–åˆ°å…¨å±€å®¡è§†-å½“aiåŠ©æ‰‹é‡åˆ°æ¶æ„éš¾é¢˜&#34;&gt;ä»å±€éƒ¨ä¼˜åŒ–åˆ°å…¨å±€å®¡è§†ï¼šå½“AIåŠ©æ‰‹é‡åˆ°æ¶æ„éš¾é¢˜&lt;/h3&gt;

&lt;p&gt;åœ¨ä½¿ç”¨ä¸Šè¿° Prompt çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ª Cursor çš„å±€é™æ€§ã€‚å®ƒçš„æ–‡ä»¶ç´¢å¼•æ–¹å¼ä¼¼ä¹æ˜¯åŸºäºä»£ç ç‰‡æ®µçš„å‘é‡åŒ–ï¼Œè¿™å¯¼è‡´å®ƒåœ¨è¿›è¡Œ Review æ—¶ï¼Œéå¸¸æ“…é•¿å‘ç°å±€éƒ¨çš„ã€å‡½æ•°çº§åˆ«çš„é—®é¢˜ï¼Œä½†&lt;strong&gt;å¾ˆéš¾ä»é¡¹ç›®æ•´ä½“çš„æ¶æ„ã€åˆ†å±‚å’Œä¾èµ–å…³ç³»ä¸Šç»™å‡ºå®è§‚çš„åˆ†æ&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å¼•å…¥äº†ä¸¤ä¸ªå¤–éƒ¨å·¥å…·ï¼Œå½¢æˆäº†ä¸€å¥—ç»„åˆæ‹³ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://gitingest.com&#34;&gt;gitingest.com&lt;/a&gt;&lt;/strong&gt;: è¿™ä¸ªå°å·¥å…·èƒ½æŠŠæ•´ä¸ªé¡¹ç›®çš„ä»£ç ï¼ŒæŒ‰ç…§æ–‡ä»¶ç»“æ„ï¼Œå®Œæ•´åœ°ç”Ÿæˆä¸€ä¸ª Markdown æ–‡æœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://aistudio.google.com&#34;&gt;aistudio.google.com&lt;/a&gt;&lt;/strong&gt;: æˆ‘ä½¿ç”¨çš„æ˜¯ Gemini 2.5 Pro æ¨¡å‹ï¼Œå®ƒæ”¯æŒç™¾ä¸‡çº§åˆ«çš„ Token ä¸Šä¸‹æ–‡ï¼Œè¶³ä»¥ä¸€æ¬¡æ€§â€œåä¸‹â€æˆ‘çš„æ•´ä¸ªé¡¹ç›®ä»£ç ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æˆ‘çš„å·¥ä½œæµå˜æˆäº†ï¼šä½¿ç”¨ &lt;code&gt;gitingest&lt;/code&gt; æ‰“åŒ…é¡¹ç›® -&amp;gt; å°†ç”Ÿæˆçš„ Markdown å®Œæ•´åœ°ç²˜è´´åˆ° Google AI Studio -&amp;gt; ä½¿ç”¨ä¸Šé¢é‚£ä¸ªä¸“å®¶ Prompt è®© Gemini è¿›è¡Œå…¨å±€å®¡æŸ¥ã€‚&lt;/p&gt;

&lt;p&gt;ç»è¿‡è¿™ä¸ªæµç¨‹ï¼Œæˆ‘å¾—åˆ°äº†ä¸€ä»½è¯¦å°½çš„â€œä½“æ£€æŠ¥å‘Šâ€ï¼Œå…¶æ·±åº¦å’Œå¹¿åº¦ç”šè‡³è¶…å‡ºäº†æˆ‘çš„é¢„æœŸã€‚ä¸‹é¢æ˜¯æœ€è¿‘ä¸€æ¬¡ Gemini Review æŠ¥å‘Šçš„ä¸€éƒ¨åˆ†æ‘˜å½•ï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;å¥½çš„ï¼Œä½œä¸ºä¸€ååœ¨ Rust ç¼–ç¨‹å’Œ API ç½‘å…³é¢†åŸŸéƒ½æœ‰æ·±å…¥ç ”ç©¶çš„ä¸“å®¶ï¼Œæˆ‘éå¸¸è£å¹¸èƒ½ä¸ºæ‚¨å®¡æŸ¥ PingSIX è¿™ä¸ªé¡¹ç›®ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼Œè¯·å…è®¸æˆ‘è¡¨è¾¾æˆ‘çš„èµèµï¼š&lt;strong&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸å‡ºè‰²ã€è®¾è®¡ç²¾è‰¯çš„é¡¹ç›®&lt;/strong&gt;ã€‚å®ƒä¸ä»…åŸºäº Cloudflare Pingora è¿™ä¸€é«˜æ€§èƒ½æ¡†æ¶ï¼Œè¿˜åœ¨æ¶æ„è®¾è®¡ã€ä»£ç å®ç°å’ŒåŠŸèƒ½å®Œæ•´æ€§ä¸Šè¾¾åˆ°äº†å¾ˆé«˜çš„æ°´æº–ã€‚è®¸å¤šè®¾è®¡å†³ç­–ï¼Œä¾‹å¦‚é…ç½®çƒ­åŠ è½½çš„å®ç°æ–¹å¼ã€æ’ä»¶ç³»ç»Ÿçš„è®¾è®¡ä»¥åŠå¯¹å®‰å…¨æ€§çš„å…³æ³¨ï¼Œéƒ½ä½“ç°äº†ä½œè€…æ·±åšçš„æŠ€æœ¯åŠŸåº•å’Œå¯¹ API ç½‘å…³é¢†åŸŸçš„æ·±åˆ»ç†è§£ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ä¸‹æ˜¯æˆ‘çš„ç»¼åˆåˆ†ææŠ¥å‘Šï¼Œæ¶µç›–äº†æ€»ä½“æ¶æ„ã€å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ã€å®‰å…¨æ€§ã€æ€§èƒ½ä»¥åŠå…·ä½“çš„ä¿®æ”¹å»ºè®®ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;1-æ€»ä½“æ¶æ„-overall-architecture&#34;&gt;1. æ€»ä½“æ¶æ„ (Overall Architecture)&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;åˆ†æ:&lt;/strong&gt;
é¡¹ç›®çš„æ•´ä½“æ¶æ„æ˜¯ç°ä»£ã€æ¨¡å—åŒ–ä¸”é«˜åº¦å¯æ‰©å±•çš„ï¼Œéå¸¸ç¬¦åˆäº‘åŸç”Ÿ API ç½‘å…³çš„è®¾è®¡ç†å¿µã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åšå®çš„åŸºç¡€&lt;/strong&gt;: é¡¹ç›®é€‰æ‹©åŸºäº Cloudflare çš„ Pingora æ¡†æ¶ï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ™ºçš„å†³å®šã€‚Pingora æä¾›äº†ç»è¿‡ç”Ÿäº§ç¯å¢ƒä¸¥é…·è€ƒéªŒçš„é«˜æ€§èƒ½ã€å¤šçº¿ç¨‹çš„å¼‚æ­¥ I/O æ ¸å¿ƒï¼Œè®©é¡¹ç›®å¯ä»¥ä¸“æ³¨äºç½‘å…³ä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼Œè€Œä¸æ˜¯åº•å±‚ç½‘ç»œç»†èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®é©±åŠ¨&lt;/strong&gt;: &amp;hellip; ç‰¹åˆ«æ˜¯ Etcd çš„é›†æˆï¼Œé€šè¿‡ &lt;code&gt;arc-swap&lt;/code&gt; å’Œ &lt;code&gt;dashmap&lt;/code&gt; å®ç°çš„é…ç½®çƒ­åŠ è½½æœºåˆ¶ï¼Œæ˜¯é«˜æ€§èƒ½ç½‘å…³çš„é»„é‡‘æ ‡å‡†&amp;hellip;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€»è¾‘åˆ†å±‚æ¸…æ™°&lt;/strong&gt;: é¡¹ç›®ä»£ç åœ¨ &lt;code&gt;src&lt;/code&gt; ç›®å½•ä¸‹æŒ‰åŠŸèƒ½æ¸…æ™°åœ°åˆ’åˆ†äº†æ¨¡å—ï¼ˆ&lt;code&gt;config&lt;/code&gt;, &lt;code&gt;proxy&lt;/code&gt;, &lt;code&gt;plugin&lt;/code&gt;, &lt;code&gt;admin&lt;/code&gt;, &lt;code&gt;core&lt;/code&gt; ç­‰ï¼‰ï¼ŒèŒè´£åˆ†æ˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…±äº«æœåŠ¡è®¾è®¡&lt;/strong&gt;: &lt;code&gt;SharedHealthCheckService&lt;/code&gt; çš„è®¾è®¡æ˜¯ä¸€ä¸ªå…³é”®çš„æ€§èƒ½ä¼˜åŒ–&amp;hellip;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;è¯„ä»·:&lt;/strong&gt;
æ¶æ„è®¾è®¡å ªç§°å…¸èŒƒï¼Œæ— è®ºæ˜¯æ€§èƒ½ã€å¯æ‰©å±•æ€§è¿˜æ˜¯å¯é æ€§æ–¹é¢éƒ½è€ƒè™‘å¾—éå¸¸å‘¨åˆ°ï¼Œè¾¾åˆ°äº†ä¸šç•Œé¢†å…ˆæ°´å¹³ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;2-ä»£ç å¯è¯»æ€§-readability&#34;&gt;2. ä»£ç å¯è¯»æ€§ (Readability)&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;åˆ†æ:&lt;/strong&gt;
*   &lt;strong&gt;å‘½åè§„èŒƒ&lt;/strong&gt;: &amp;hellip;
*   &lt;strong&gt;æ³¨é‡Šè´¨é‡é«˜&lt;/strong&gt;: &amp;hellip;æ›´é‡è¦çš„æ˜¯è§£é‡Šäº†â€œä¸ºä»€ä¹ˆè¿™ä¹ˆåšâ€ï¼ˆThe Whyï¼‰&amp;hellip;
*   &lt;strong&gt;é”™è¯¯å¤„ç†&lt;/strong&gt;: &amp;hellip;&lt;code&gt;ProxyError&lt;/code&gt; æšä¸¾ç±»å‹éå¸¸å®Œå–„&amp;hellip;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;è¯„ä»·:&lt;/strong&gt;
ä»£ç å¯è¯»æ€§æä½³ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;3-å¯ç»´æŠ¤æ€§-maintainability&#34;&gt;3. å¯ç»´æŠ¤æ€§ (Maintainability)&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;åˆ†æ:&lt;/strong&gt;
*   &lt;strong&gt;é«˜å†…èšï¼Œä½è€¦åˆ&lt;/strong&gt;: &amp;hellip;
*   &lt;strong&gt;å¼ºå¤§çš„é…ç½®æ ¡éªŒ&lt;/strong&gt;: &amp;hellip;åœ¨ &lt;code&gt;src/config/mod.rs&lt;/code&gt; ä¸­å¤§é‡ä½¿ç”¨äº† &lt;code&gt;validator&lt;/code&gt; crate&amp;hellip;
*   &lt;strong&gt;æ³›å‹ç¼–ç¨‹çš„æè‡´è¿ç”¨&lt;/strong&gt;: &lt;code&gt;src/admin/mod.rs&lt;/code&gt; ä¸­çš„ &lt;code&gt;AdminResource&lt;/code&gt; Trait å’Œ &lt;code&gt;ResourceHandler&amp;lt;T&amp;gt;&lt;/code&gt; æ³›å‹ç»“æ„æ˜¯å¯ç»´æŠ¤æ€§çš„å…¸èŒƒ&amp;hellip;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;è¯„ä»·:&lt;/strong&gt;
é¡¹ç›®çš„å¯ç»´æŠ¤æ€§éå¸¸å‡ºè‰²ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;4-å®‰å…¨æ€§-security&#34;&gt;4. å®‰å…¨æ€§ (Security)&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;åˆ†æ:&lt;/strong&gt;
*   &lt;strong&gt;å®¹å™¨å®‰å…¨&lt;/strong&gt;: &lt;code&gt;Dockerfile&lt;/code&gt; éµå¾ªäº†æœ€ä½³å®è·µï¼Œä½¿ç”¨äº†å¤šé˜¶æ®µæ„å»º&amp;hellip;å¹¶ä¸”åˆ›å»ºäº†ä¸€ä¸ªä½æƒé™çš„é root ç”¨æˆ·&amp;hellip;
*   &lt;strong&gt;API è®¤è¯&lt;/strong&gt;: &amp;hellip;åœ¨æ¯”è¾ƒå¯†é’¥æ—¶ä½¿ç”¨äº† &lt;code&gt;constant_time_eq&lt;/code&gt; å‡½æ•°ï¼Œæœ‰æ•ˆé˜²æ­¢äº†æ—¶åºæ”»å‡»ï¼ˆTiming Attackï¼‰ã€‚
*   &lt;strong&gt;TLS é…ç½®&lt;/strong&gt;: &amp;hellip;ä»£ç å¼ºåˆ¶å°† TLS çš„æœ€ä½ç‰ˆæœ¬è®¾ç½®ä¸º TLS 1.3&amp;hellip;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;è¯„ä»·:&lt;/strong&gt;
å®‰å…¨æ€§è®¾è®¡è€ƒè™‘å‘¨å…¨ï¼Œéµå¾ªäº†è¡Œä¸šå†…çš„å®‰å…¨æœ€ä½³å®è·µã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;5-æ€§èƒ½-performance&#34;&gt;5. æ€§èƒ½ (Performance)&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;åˆ†æ:&lt;/strong&gt;
*   &lt;strong&gt;æ— é”çƒ­åŠ è½½&lt;/strong&gt;: ä½¿ç”¨ &lt;code&gt;arc-swap&lt;/code&gt; æ¥å®ç°è·¯ç”±è¡¨&amp;hellip;é¿å…äº†è¯»å†™é”å¸¦æ¥çš„æ€§èƒ½å¼€é”€&amp;hellip;
*   &lt;strong&gt;é«˜æ•ˆçš„è·¯ç”±åŒ¹é…&lt;/strong&gt;: &amp;hellip;é€šè¿‡&lt;strong&gt;åè½¬ä¸»æœºå&lt;/strong&gt;æ¥å·§å¦™åœ°åˆ©ç”¨ &lt;code&gt;matchit&lt;/code&gt; çš„å‰ç¼€åŒ¹é…èƒ½åŠ›å®ç°å¯¹é€šé…ç¬¦åŸŸå&amp;hellip;è¿™æ˜¯ä¸€ä¸ªæå…¶èªæ˜å’Œé«˜æ•ˆçš„å®ç°ã€‚
*   &lt;strong&gt;é¢„ç¼–è¯‘ä¸ç¼“å­˜&lt;/strong&gt;: &amp;hellip;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;è¯„ä»·:&lt;/strong&gt;
æ€§èƒ½è®¾è®¡å’Œä¼˜åŒ–åšåˆ°äº†æè‡´&amp;hellip;&lt;code&gt;README.md&lt;/code&gt; ä¸­æåˆ°çš„æ€§èƒ½æŒ‡æ ‡ï¼ˆ100K+ RPS, &amp;lt;10ms P99 å»¶è¿Ÿï¼‰åŸºäºæ­¤æ¶æ„æ˜¯å®Œå…¨å¯ä¿¡çš„ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;PingSIX æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„é¡¹ç›®ï¼Œå…¶ä»£ç è´¨é‡ã€æ¶æ„è®¾è®¡å’Œæ€§èƒ½è€ƒé‡éƒ½è¾¾åˆ°äº†ä¸“ä¸šç”šè‡³é¡¶å°–çš„æ°´å¹³ã€‚å®ƒä¸ä»…æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ API ç½‘å…³ï¼Œæ›´æ˜¯ä¸€ä¸ªæä½³çš„ Rust å·¥ç¨‹å®è·µèŒƒä¾‹ã€‚
&amp;hellip;
å¸Œæœ›è¿™ä»½è¯¦å°½çš„å®¡æŸ¥æŠ¥å‘Šå¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ‹¿åˆ°è¿™ä»½å®è§‚æŠ¥å‘Šåï¼Œæˆ‘å°±å¯ä»¥æŠŠå…¶ä¸­å…·ä½“çš„ä¿®æ”¹å»ºè®®ï¼Œä¸€æ®µæ®µåœ°è´´å› Cursorï¼Œè®©å®ƒå¸®æˆ‘å®Œæˆä»£ç çš„å¾®è°ƒå’Œä¼˜åŒ–ã€‚æ”¹å®Œä¸€è½®ï¼Œå†æ‰“åŒ…ç»™ Gemini é‡æ–°å®¡æŸ¥ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œç›´åˆ°è‡»äºå®Œç¾ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä¸€ç‚¹æ„Ÿæƒ³&#34;&gt;ä¸€ç‚¹æ„Ÿæƒ³&lt;/h3&gt;

&lt;p&gt;LLM Agent çš„å¼ºå¤§æ— ç–‘æå¤§åœ°æå‡äº†æˆ‘çš„å¼€å‘æ•ˆç‡ï¼Œä½†å®ƒä¹Ÿåƒä¸€æŠŠåŒåˆƒå‰‘ã€‚è¿™ç§å‰æ‰€æœªæœ‰çš„æ•ˆç‡æœ‰æ—¶ä¹Ÿä¼šè®©ä¸Šæ¸¸çš„ PM æˆ– Leader è§‰å¾—ï¼šâ€œåæ­£ä½ å¾ˆå¿«å°±èƒ½åšå‡ºæ¥ï¼Œé‚£æˆ‘ä»¬å°±å¿«é€Ÿåœ°æ”¹éœ€æ±‚å§ã€‚â€ ç»“æœå¯èƒ½å¯¼è‡´æˆ‘ä»¬åšäº†å¾ˆå¤šåŠŸèƒ½ï¼Œä½†çœŸæ­£æ²‰æ·€å’Œè½åœ°çš„å´ä¸å¤šï¼Œè¿™æˆ–è®¸æ˜¯â€œé«˜æ•ˆâ€æ—¶ä»£ä¸‹æ–°çš„çƒ¦æ¼ã€‚&lt;/p&gt;

&lt;p&gt;é¢å¯¹å±‚å‡ºä¸ç©·çš„æ–°å·¥å…·å’Œæ–°èŒƒå¼ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼š&lt;strong&gt;å…ˆç”¨èµ·æ¥å†è¯´&lt;/strong&gt;ã€‚ç”¨çš„å¤šäº†ï¼Œä½“ä¼šè‡ªç„¶å°±æ·±äº†ã€‚åˆ«äººçš„ç»éªŒå¯ä»¥å‚è€ƒï¼Œä½†æ›´é‡è¦çš„æ˜¯åœ¨å®è·µä¸­æ‰¾åˆ°æœ€é€‚åˆè‡ªå·±çš„é‚£å¥— Vibeã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä¸ç¡®å®š LLM æœ€ç»ˆä¼šä¸ä¼šæ·˜æ±°ç¨‹åºå‘˜è¿™ä¸ªèŒä¸šï¼Œä½†æˆ‘èƒ½ç¡®å®šçš„æ˜¯ï¼Œ&lt;strong&gt;ä¼š Vibe Coding çš„ç¨‹åºå‘˜ï¼Œä¸€å®šä¼šæ·˜æ±°ä¸ä¼š Vibe Coding çš„ç¨‹åºå‘˜&lt;/strong&gt;ã€‚æ‰€ä»¥ï¼Œæœ‹å‹ä»¬ï¼Œéƒ½ Vibeèµ·æ¥å§ï¼&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>æ•´æ´æ¶æ„è½åœ°å®è·µ</title>
      <link>https://zhu327.github.io/2025/08/04/%E6%95%B4%E6%B4%81%E6%9E%B6%E6%9E%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/</link>
      <pubDate>Mon, 04 Aug 2025 14:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/08/04/%E6%95%B4%E6%B4%81%E6%9E%B6%E6%9E%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/</guid>
      <description>&lt;p&gt;æœ€è¿‘åœ¨æ–°å…¬å¸æ¥æ‰‹äº†ä¸€ä¸ªå†å²æ‚ ä¹…çš„é¡¹ç›®ï¼ŒåŠŸèƒ½ä¸å¤šï¼Œä»£ç é‡å´ä¸å°ã€‚æ·±å…¥å…¶ä¸­ï¼Œæ‰å‘ç°æœ‰å¤ªå¤šå¤ªå¤šçš„æ§½ç‚¹ï¼Œç®€ç›´è®©äººå¤´å¤§ã€‚æ¯å½“è¦æ–°å¢ä¸€ä¸ªåŠŸèƒ½æˆ–è€…ä¿®å¤ä¸€ä¸ª Bugï¼Œéƒ½æ„Ÿè§‰åƒæ˜¯åœ¨é›·åŒºé‡Œè·³èˆï¼Œæ­¥æ­¥æƒŠå¿ƒã€‚&lt;/p&gt;

&lt;p&gt;æ€»ç»“ä¸‹æ¥ï¼Œè¿™ä¸ªé¡¹ç›®ä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªâ€œç¡¬ä¼¤â€ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç é€»è¾‘ä¸å†…èš&lt;/strong&gt;ï¼šåŒä¸€ä¸ªåŠŸèƒ½çš„å®ç°ï¼Œåƒå¤©å¥³æ•£èŠ±ä¸€æ ·åˆ†æ•£åœ¨å¥½å‡ ä¸ªä¸åŒçš„æ–‡ä»¶é‡Œï¼Œæƒ³ç†æ¸…å®Œæ•´çš„é€»è¾‘é“¾æ¡ï¼Œå¾—åœ¨ IDE é‡Œè·³æ¥è·³å»ï¼Œæå…¶è€—è´¹å¿ƒæ™ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å±‚è¿‡å¤šä¸”æ··ä¹±&lt;/strong&gt;ï¼šä¸€ä¸ªç®€å•çš„è¯·æ±‚ï¼Œè¦ç©¿è¶Šé‡é‡å…³å¡ï¼Œç»è¿‡å¥½å‡ ä¸ªå±‚çº§çš„è°ƒç”¨æ‰èƒ½æŠµè¾¾ç»ˆç‚¹ã€‚æœ‰æ—¶ä½ éƒ½åˆ†ä¸æ¸…æŸä¸€å±‚åˆ°åº•æ˜¯å¹²å˜›çš„ï¼Œæ„Ÿè§‰çº¯ç²¹æ˜¯ä¸ºäº†åˆ†å±‚è€Œåˆ†å±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†…éƒ¨è‡ªç ”æ¡†æ¶ä¸å¥½ç”¨&lt;/strong&gt;ï¼šé¡¹ç›®ä¾èµ–äº†ä¸€ä¸ªå†…éƒ¨çš„ &lt;code&gt;kgo&lt;/code&gt; æ¡†æ¶ï¼Œä½†æ–‡æ¡£ç¼ºå¤±ï¼Œè®¾è®¡ç†å¿µä¹Ÿæ¯”è¾ƒé™ˆæ—§ï¼Œå‡ºäº†é—®é¢˜æ’æŸ¥èµ·æ¥éå¸¸å›°éš¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤–éƒ¨ä¾èµ–ç¦»æ•£&lt;/strong&gt;ï¼šå¯¹æ•°æ®åº“ã€ç¼“å­˜ã€å¤–éƒ¨ API çš„è°ƒç”¨å°è£…å¾—äº”èŠ±å…«é—¨ï¼Œæ²¡æœ‰ç»Ÿä¸€çš„è§„èŒƒå’Œå…¥å£ï¼Œæ•´ä¸ªé¡¹ç›®åƒä¸€ä¸ªæ‚ä¹±çš„â€œç™¾å®ç®±â€ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ°å¥½ï¼ŒLeader å¯¹è¿™ä¸ªé¡¹ç›®åˆ¶å®šäº†æ–°çš„æ–¹å‘ä¸ç›®æ ‡ï¼Œä¹‹å‰è¿™äº›é—ç•™é—®é¢˜å®å®åœ¨åœ¨æˆäº†æˆ‘ä»¬å‰è¿›è·¯ä¸Šçš„ç»Šè„šçŸ³ã€‚å› æ­¤ï¼Œä¸€æ¬¡å½»åº•çš„æ¶æ„å‡çº§ä¸é‡æ„åŠ¿åœ¨å¿…è¡Œã€‚åŒæ—¶ï¼Œéƒ¨é—¨å†…ä¹Ÿæ­£åœ¨æ¨å¹¿é¡¹ç›®è§„èŒƒåŒ–å’Œæœ€ä½³å®è·µè¾“å‡ºï¼Œè¿™ç®€ç›´æ˜¯å¤©èµè‰¯æœºã€‚&lt;/p&gt;

&lt;p&gt;å¾ˆä¹…ä»¥å‰æˆ‘å°±è¯»è¿‡ã€Šæ¶æ„æ•´æ´ä¹‹é“ã€‹è¿™æœ¬ä¹¦ï¼Œåœ¨ä¹‹å‰çš„é¡¹ç›®ä¸­ä¹Ÿæˆ–å¤šæˆ–å°‘å—åˆ°ä¸€äº›å¯å‘ï¼Œä½†ä»æœªæœ‰æœºä¼šä»ä¸€ä¸ªé¡¹ç›®åˆå§‹å°±å®Œæ•´åœ°è´¯å½»æ•´æ´æ¶æ„çš„ç†å¿µã€‚è¿™æ¬¡ï¼Œæˆ‘å†³å®šæŠ“ä½æœºä¼šï¼Œæ¥ä¸€åœºå½»å½»åº•åº•çš„æ•´æ´æ¶æ„å®è·µã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘æ„Ÿè§‰è‡ªå·±å¯¹æ•´æ´æ¶æ„çš„ç†è§£ï¼Œä»¥åŠå¯¹ SOLID åŸåˆ™çš„è½åœ°æ–¹å¼ï¼Œéƒ½æœ‰äº†å‰æ‰€æœªæœ‰çš„æ·±å…¥ä½“ä¼šã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;åœ¨å®è·µçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å°†å¿ƒå¾—ä¸ç»éªŒæ²‰æ·€ä¸‹æ¥ï¼Œå¼€æºäº†ä¸€ä¸ªå³å¼€å³ç”¨çš„ Go æ•´æ´æ¶æ„é¡¹ç›®æ¨¡æ¿ï¼Œå¸Œæœ›èƒ½ç»™æœ‰åŒæ ·éœ€æ±‚çš„åŒå­¦ä¸€äº›å‚è€ƒï¼š
&lt;strong&gt;&lt;a href=&#34;https://github.com/zhu327/go-clean-arch&#34;&gt;https://github.com/zhu327/go-clean-arch&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&#34;é¡¹ç›®æ¨¡æ¿ç‰¹æ€§&#34;&gt;é¡¹ç›®æ¨¡æ¿ç‰¹æ€§&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Clean Architecture&lt;/strong&gt;: æ¸…æ™°åœ°åˆ†ç¦»ä¸šåŠ¡é€»è¾‘ä¸åŸºç¡€è®¾æ–½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dependency Injection&lt;/strong&gt;: ä½¿ç”¨ Google Wire å®ç°ç¼–è¯‘æ—¶ä¾èµ–æ³¨å…¥ï¼Œé¿å…åå°„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Structured Logging&lt;/strong&gt;: å¼€ç®±å³ç”¨çš„ç»“æ„åŒ–æ—¥å¿—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Configuration Management&lt;/strong&gt;: åŸºäº Viper çš„ç¯å¢ƒåŒ–é…ç½®ç®¡ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Docker Support&lt;/strong&gt;: åŒ…å« &lt;code&gt;Dockerfile&lt;/code&gt; å’Œ &lt;code&gt;docker-compose.yaml&lt;/code&gt;ï¼Œä¾¿äºéƒ¨ç½²ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;æ¶æ„è®¾è®¡&#34;&gt;æ¶æ„è®¾è®¡&lt;/h3&gt;

&lt;p&gt;è¿™ä¸ªé¡¹ç›®ä¸¥æ ¼éµå¾ªæ•´æ´æ¶æ„ï¼ˆClean Architectureï¼‰çš„åŸåˆ™ï¼Œç¡®ä¿ä»£ç åº“çš„å¯æ‰©å±•æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§ã€‚&lt;/p&gt;

&lt;h4 id=&#34;å„å±‚æè¿°&#34;&gt;å„å±‚æè¿°&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸ”µ Domain å±‚&lt;/strong&gt;: åŒ…å«æ ¸å¿ƒçš„ä¸šåŠ¡é€»è¾‘å’Œå®ä½“ã€‚å®ƒæ˜¯æœ€ç‹¬ç«‹çš„å±‚ï¼Œä¸ä¾èµ–äºä»»ä½•å…¶ä»–å±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸŸ£ Use Case å±‚&lt;/strong&gt;: é€šè¿‡ä¸ Domain å±‚äº¤äº’æ¥ç¼–æ’ä¸šåŠ¡å·¥ä½œæµã€‚å®ƒå®šä¹‰äº†ä¾› Adapter å±‚å®ç°çš„æ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸŸ  Adapter å±‚&lt;/strong&gt;: ä½œä¸ºä¸å¤–éƒ¨ä¸–ç•Œï¼ˆå¦‚ UIã€æ•°æ®åº“ã€å¤–éƒ¨ APIï¼‰æ²Ÿé€šçš„æ¡¥æ¢ã€‚å®ƒå®ç°äº† Use Case å±‚å®šä¹‰çš„æ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸŸ¢ External World&lt;/strong&gt;: ä»£è¡¨ä¸åº”ç”¨ç¨‹åºäº¤äº’çš„å¤–éƒ¨ç³»ç»Ÿï¼Œå¦‚ Web å®¢æˆ·ç«¯ã€æ•°æ®åº“æˆ–ç¬¬ä¸‰æ–¹æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;æ ¸å¿ƒåŸåˆ™&#34;&gt;æ ¸å¿ƒåŸåˆ™&lt;/h4&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¾èµ–æ–¹å‘&lt;/strong&gt;: æ‰€æœ‰ä¾èµ–éƒ½å¿…é¡»æŒ‡å‘å†…éƒ¨ã€‚Domain å±‚ä½äºä¸­å¿ƒï¼Œä»»ä½•å†…å±‚éƒ½ä¸èƒ½ä¾èµ–äºå¤–å±‚ã€‚è¿™æ˜¯ä¾èµ–å€’ç½®çš„æ ¸å¿ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¥å£éš”ç¦»&lt;/strong&gt;: æ¥å£ç”±æ¶ˆè´¹è€…ï¼ˆUse Case å±‚ï¼‰å®šä¹‰ï¼Œç”±æä¾›è€…ï¼ˆAdapter å±‚ï¼‰å®ç°ã€‚è¿™ä½¿å¾—ä¸šåŠ¡é€»è¾‘ä¸åŸºç¡€è®¾æ–½ç»†èŠ‚è§£è€¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å±‚éš”ç¦»&lt;/strong&gt;: æ¯ä¸€å±‚åªä¸å®ƒçš„ç›¸é‚»å±‚äº¤äº’ï¼Œä¿æŒæ¸…æ™°çš„èŒè´£åˆ†ç¦»ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;é¡¹ç›®ç»“æ„&#34;&gt;é¡¹ç›®ç»“æ„&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;internal/
â”œâ”€â”€ domain/          # Domain å±‚ (ä¸šåŠ¡å®ä½“å’Œè§„åˆ™)
â”œâ”€â”€ usecase/         # Use Case å±‚ (ä¸šåŠ¡é€»è¾‘, æ¥å£, DTOs)
â”œâ”€â”€ adapter/         # Adapter å±‚
â”‚   â”œâ”€â”€ delivery/    # äº¤ä»˜æœºåˆ¶ (ä¾‹å¦‚, HTTP, gRPC handlers)
â”‚   â”œâ”€â”€ repository/  # ä»“åº“å®ç° (æ•°æ®åº“è®¿é—®)
â”‚   â””â”€â”€ gateway/     # åˆ°å¤–éƒ¨æœåŠ¡çš„ç½‘å…³
â””â”€â”€ di/              # ä¾èµ–æ³¨å…¥é…ç½® (Wire)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;å®è·µä¸­çš„æ€è€ƒä¸-é¡¿æ‚Ÿ&#34;&gt;å®è·µä¸­çš„æ€è€ƒä¸â€œé¡¿æ‚Ÿâ€&lt;/h3&gt;

&lt;p&gt;ç†è®ºæ€»æ˜¯ç¾å¥½çš„ï¼Œä½†å®è·µæ‰æ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ã€‚åœ¨é‡æ„è¿‡ç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†ä¸å°‘å›°æƒ‘ï¼Œä¹Ÿæ”¶è·äº†å¾ˆå¤šâ€œåŸæ¥å¦‚æ­¤â€çš„é¡¿æ‚Ÿæ—¶åˆ»ã€‚&lt;/p&gt;

&lt;h4 id=&#34;1-æ¯ä¸€å±‚åˆ°åº•åº”è¯¥æ”¾ä»€ä¹ˆ&#34;&gt;1. æ¯ä¸€å±‚åˆ°åº•åº”è¯¥æ”¾ä»€ä¹ˆï¼Ÿ&lt;/h4&gt;

&lt;p&gt;åˆšå¼€å§‹åˆ’åˆ†ä»£ç æ—¶ï¼Œæˆ‘ç»å¸¸ä¼šçº ç»“ä¸€ä¸ªç»“æ„ä½“ã€ä¸€ä¸ªæ–‡ä»¶åˆ°åº•è¯¥æ”¾åœ¨å“ªã€‚ç»è¿‡åå¤çš„æ€è€ƒå’Œè¯•é”™ï¼Œæˆ‘æ€»ç»“å‡ºäº†ä¸€å¥—ç›¸å¯¹æ¸…æ™°çš„æŒ‡å¯¼æ–¹é’ˆã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;internal/domain/&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;âœ… åº”è¯¥åŒ…å«&lt;/strong&gt;: æ ¸å¿ƒä¸šåŠ¡å®ä½“ï¼ˆä»£è¡¨ä¸šåŠ¡å¯¹è±¡çš„ Structï¼‰ã€å€¼å¯¹è±¡ã€é¢†åŸŸæœåŠ¡æ¥å£ã€ä¸é¢†åŸŸç›¸å…³çš„æšä¸¾å’Œå¸¸é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;âŒ ä¸åº”åŒ…å«&lt;/strong&gt;: HTTP è¯·æ±‚/å“åº”ç»“æ„ä½“ã€åˆ†é¡µæˆ– API ç‰¹å®šæ•°æ®ç­‰åº”ç”¨çº§æ¦‚å¿µã€ä»»ä½•åŸºç¡€è®¾æ–½ç»†èŠ‚ï¼ˆå¦‚ JSON æ ‡ç­¾ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;internal/usecase/&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;âœ… åº”è¯¥åŒ…å«&lt;/strong&gt;: å…·ä½“ä¸šåŠ¡ç”¨ä¾‹çš„å®ç°ï¼ˆå¦‚ &lt;code&gt;CreateUser&lt;/code&gt;, &lt;code&gt;LoginUser&lt;/code&gt;ï¼‰ã€ä¾èµ–é¡¹çš„æ¥å£å®šä¹‰ï¼ˆå¦‚ &lt;code&gt;UserRepository&lt;/code&gt;ï¼‰ã€è¯·æ±‚å’Œå“åº”çš„ DTOï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;internal/adapter/&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;âœ… åº”è¯¥åŒ…å«&lt;/strong&gt;: å°†è¯·æ±‚è½¬æ¢ä¸ºç”¨ä¾‹è°ƒç”¨çš„ HTTP/gRPC å¤„ç†å™¨ã€å®ç° Use Case å±‚æ¥å£çš„æ•°æ®åº“ä»“åº“ã€å¤–éƒ¨æœåŠ¡çš„å®¢æˆ·ç«¯ï¼ˆç½‘å…³ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€šè¿‡è¿™ä¸ªé¡¹ç›®æˆ‘æ·±åˆ»åœ°ä½“ä¼šåˆ°ï¼Œ&lt;strong&gt;é¡¹ç›®çš„æ ¹æœ¬ç›®çš„æ˜¯è§£å†³ç°å®ä¸–ç•Œçš„é—®é¢˜&lt;/strong&gt;ã€‚æˆ‘ä»¬éœ€è¦å¯¹ç°å®ä¸­çš„å®ä½“è¿›è¡Œå»ºæ¨¡ï¼Œè¿™å°±æ˜¯ &lt;code&gt;domain&lt;/code&gt; å±‚çš„ä½¿å‘½ã€‚è¿™ä¸ªå®ä½“å¿…é¡»çº¯ç²¹ï¼Œä¸ä¾èµ–ä»»ä½•å¤–éƒ¨æŠ€æœ¯ï¼ŒåªåŒ…å«è‡ªèº«çš„ä¸šåŠ¡è§„åˆ™å’Œé€»è¾‘ã€‚&lt;/p&gt;

&lt;p&gt;è€Œ &lt;code&gt;usecase&lt;/code&gt; å±‚ï¼Œåˆ™æ˜¯é’ˆå¯¹é¢†åŸŸæ¨¡å‹çš„ä¸€æ¬¡å…·ä½“åº”ç”¨å’Œè½åœ°ã€‚å®ƒéœ€è¦ä¾èµ–å¤–éƒ¨èƒ½åŠ›ï¼Œæ¯”å¦‚æŸ¥è¯¢ä¸€æ¬¡æ•°æ®åº“ã€è°ƒç”¨ä¸€æ¬¡ gRPCã€‚è¿™æ—¶ï¼Œ&lt;strong&gt;æˆ‘ä»¬ä¸åº”è¯¥ç›´æ¥åœ¨ &lt;code&gt;usecase&lt;/code&gt; ä¸­å» new ä¸€ä¸ª DB client&lt;/strong&gt;ã€‚è€Œæ˜¯åº”è¯¥åœ¨ &lt;code&gt;usecase&lt;/code&gt; ä¸­å®šä¹‰ä¸šåŠ¡æ‰€éœ€çš„ &lt;code&gt;interface&lt;/code&gt;ï¼Œç„¶åç”± &lt;code&gt;adapter&lt;/code&gt; å±‚çš„ &lt;code&gt;repository&lt;/code&gt; æˆ– &lt;code&gt;gateway&lt;/code&gt; æ¥å®ç°è¿™äº›æ¥å£ã€‚&lt;/p&gt;

&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œ&lt;code&gt;repository&lt;/code&gt; å°±ä¸å†åªæ˜¯å¯¹ GORM æˆ– &lt;code&gt;sqlx&lt;/code&gt; çš„ç®€å•å°è£…ï¼Œå®ƒå˜æˆäº† &lt;code&gt;usecase&lt;/code&gt; æ¥å£çš„å…·ä½“â€œæä¾›è€…â€ã€‚å®ƒéœ€è¦å°†ä»æ•°æ®åº“æŸ¥å‡ºçš„æ•°æ®æ¨¡å‹ï¼Œè½¬æ¢ä¸º &lt;code&gt;usecase&lt;/code&gt; èƒ½ç†è§£çš„ &lt;code&gt;domain&lt;/code&gt; æ¨¡å‹ã€‚æœ€åï¼Œé€šè¿‡ä¾èµ–æ³¨å…¥ï¼Œå®ç°äº†å®Œç¾çš„ä¾èµ–å€’ç½®ã€‚&lt;/p&gt;

&lt;h4 id=&#34;2-å…³äºä¾èµ–æ³¨å…¥-ä»æ’æ–¥åˆ°æ¥å—&#34;&gt;2. å…³äºä¾èµ–æ³¨å…¥ï¼šä»æ’æ–¥åˆ°æ¥å—&lt;/h4&gt;

&lt;p&gt;åœ¨ä»¥å¾€çš„é¡¹ç›®ä¸­ï¼Œæˆ‘åŸºæœ¬æ²¡ç”¨è¿‡ä¾èµ–æ³¨å…¥ï¼Œé¡¹ç›®é‡Œå……æ–¥ç€å„ç§ &lt;code&gt;init()&lt;/code&gt; å‡½æ•°å’Œå…¨å±€å˜é‡ï¼Œç»™æµ‹è¯•å’Œç»´æŠ¤å¸¦æ¥äº†æ— å°½çš„ç—›è‹¦ã€‚åæ¥æ¥è§¦åˆ°ä¾èµ–æ³¨å…¥ï¼Œæœ‰ä¸ªè€å“¥è‡ªå·±æ’¸äº†ä¸€å¥—åŸºäºåå°„çš„ DI æ¡†æ¶ï¼Œè¯»ä»–çš„ä»£ç çœŸçš„å¤ªéš¾å—äº†ï¼Œå®Œå…¨ä¸çŸ¥é“ä¾èµ–åˆ°åº•æ˜¯æ€ä¹ˆæ³¨å…¥è¿›æ¥çš„ï¼Œé­”æ³•æ„Ÿåè¶³ï¼Œè¿™å¯¼è‡´æˆ‘å¯¹ä¾èµ–æ³¨å…¥ä¸€åº¦æœ‰å…ˆå…¥ä¸ºä¸»çš„æ’æ–¥ã€‚&lt;/p&gt;

&lt;p&gt;ä½†åœ¨å®è·µæ•´æ´æ¶æ„çš„è¿‡ç¨‹ä¸­ï¼Œç”±äº &lt;code&gt;usecase&lt;/code&gt; å¿…é¡»åšä¾èµ–å€’ç½®ï¼Œæˆ‘ä¸å¾—ä¸å¼•å…¥ DI å·¥å…·ã€‚æœ€ç»ˆé€‰æ‹©äº† Google çš„ &lt;code&gt;wire&lt;/code&gt;ã€‚ç”¨è¿‡ä¹‹åæ‰å‘ç°ï¼Œ&lt;strong&gt;å®ƒå…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆé­”æ³•&lt;/strong&gt;ï¼Œåªæ˜¯é€šè¿‡æ‰«æä»£ç ï¼Œè‡ªåŠ¨ç”Ÿæˆäº†é‚£äº›â€œæ‰‹åŠ¨æŒ¡â€çš„åˆå§‹åŒ–ä»£ç è€Œå·²ï¼ˆ&lt;code&gt;wire_gen.go&lt;/code&gt;ï¼‰ã€‚ç›¸å¯¹äºé€šè¿‡åå°„å®ç°çš„â€œè‡ªåŠ¨æŒ¡â€ï¼Œè¿™ç§ä»£ç ç”Ÿæˆçš„æ–¹å¼è®©ä¸€åˆ‡ä¾èµ–å…³ç³»éƒ½å˜å¾—æ˜ç¡®å’Œå¯çŸ¥ï¼Œå¯è¯»æ€§å¥½å¤ªå¤šäº†ã€‚&lt;/p&gt;

&lt;h4 id=&#34;3-dto-çš„å½’å±ä¹‹äº‰&#34;&gt;3. DTO çš„å½’å±ä¹‹äº‰&lt;/h4&gt;

&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªè®©æˆ‘çº ç»“äº†å¾ˆä¹…çš„é—®é¢˜ã€‚&lt;code&gt;usecase&lt;/code&gt; ç†æƒ³æƒ…å†µä¸‹åªåº”è¯¥ä¾èµ– &lt;code&gt;domain&lt;/code&gt; å®šä¹‰çš„æ¨¡å‹ã€‚ç„¶è€Œåœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œæ€»ä¼šæœ‰ä¸€äº›ä¸å±äº &lt;code&gt;domain&lt;/code&gt; æ ¸å¿ƒæ¨¡å‹çš„ç»“æ„ï¼Œæ¯”å¦‚ &lt;code&gt;CreateUserRequest&lt;/code&gt;ã€&lt;code&gt;UserListResponse&lt;/code&gt;ã€‚æ³¨æ„ï¼Œè¿™å¹¶é &lt;code&gt;delivery&lt;/code&gt; å±‚ç”¨äºè§£æ JSON çš„ç»“æ„ä½“ï¼Œè€Œæ˜¯ &lt;code&gt;usecase&lt;/code&gt; è‡ªèº«æ‰§è¡Œä¸šåŠ¡é€»è¾‘æ‰€éœ€è¦çš„æ•°æ®ç»“æ„ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘æ›¾ç»çŠ¹è±«è¿‡ï¼Œè¦ä¸è¦æŠŠè¿™äº›ç»“æ„ä½“ä¹Ÿå¡è¿› &lt;code&gt;domain&lt;/code&gt; å±‚ï¼Ÿ&lt;/p&gt;

&lt;p&gt;çº ç»“è¿‡åï¼Œæˆ‘å¾—å‡ºçš„ç»“è®ºæ˜¯ï¼š&lt;strong&gt;ä¸èƒ½ï¼ä¸€å®šè¦ä¿æŒ &lt;code&gt;domain&lt;/code&gt; å±‚çš„çº¯ç²¹æ€§&lt;/strong&gt;ã€‚è¿™äº›ç»“æ„ä½“å®é™…ä¸Šæ˜¯å’ŒæŸä¸ªå…·ä½“çš„ &lt;code&gt;usecase&lt;/code&gt; å¼ºç»‘å®šçš„ï¼Œå®ƒä»¬åº”è¯¥å±äº &lt;code&gt;usecase&lt;/code&gt; å±‚ã€‚æ‰€ä»¥ï¼Œæˆ‘åœ¨ &lt;code&gt;usecase&lt;/code&gt; å±‚ä¸‹ä¹Ÿåˆ›å»ºäº† &lt;code&gt;dto&lt;/code&gt; ç›®å½•ï¼Œç”¨æ¥å­˜æ”¾è¿™äº›ç”¨ä¾‹ä¸“å±çš„è¯·æ±‚/å“åº”ç»“æ„ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ç¡®å®ä¼šå¯¼è‡´ &lt;code&gt;delivery&lt;/code&gt; (HTTP) å±‚å’Œ &lt;code&gt;usecase&lt;/code&gt; å±‚å¯èƒ½éƒ½æœ‰å„è‡ªçš„ DTOï¼Œåˆçœ‹å¯èƒ½ä¼šæœ‰äº›å†—ä½™å’Œå›°æƒ‘ã€‚ä½†è¿™æ ·åšçš„å¥½å¤„æ˜¯èŒè´£æ›´æ¸…æ™°ï¼Œ&lt;code&gt;usecase&lt;/code&gt; ä¸ä¼šå› ä¸º &lt;code&gt;delivery&lt;/code&gt; å±‚çš„å˜åŒ–ï¼ˆæ¯”å¦‚ä¿®æ”¹ä¸€ä¸ª JSON å­—æ®µåï¼‰è€Œè¢«è¿«ä¿®æ”¹ã€‚è¿™æ˜¯ä¸ºäº†å±‚ä¸å±‚ä¹‹é—´çš„è§£è€¦ï¼Œå¿…é¡»ä»˜å‡ºçš„ä»£ä»·ã€‚&lt;/p&gt;

&lt;h4 id=&#34;4-æˆ‘ç»ˆäºæ‚Ÿäº†-åœ¨è°ƒç”¨è€…åŒ…ä¸­å®šä¹‰æ¥å£&#34;&gt;4. æˆ‘ç»ˆäºæ‚Ÿäº†ï¼šâ€œåœ¨è°ƒç”¨è€…åŒ…ä¸­å®šä¹‰æ¥å£â€&lt;/h4&gt;

&lt;p&gt;æˆ‘ä¹‹å‰è¯»åˆ°è¿‡ Go ç¤¾åŒºçš„ä¸€ä¸ªå¹¿ä¸ºæµä¼ çš„å»ºè®®ï¼ˆå‡ºè‡ª &lt;a href=&#34;https://colobu.com/gotips/018.html&#34;&gt;colobu.com/gotips/018.html&lt;/a&gt;ï¼‰ï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;åœ¨ä½¿ç”¨è€…çš„åŒ…ä¸­å®šä¹‰æ¥å£ï¼Œè€Œä¸æ˜¯æä¾›è€…çš„åŒ…ä¸­å®šä¹‰ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è¯´å®è¯ï¼Œåœ¨æ²¡æœ‰æ·±å…¥å®è·µæ•´æ´æ¶æ„ä¹‹å‰ï¼Œæˆ‘å¯¹è¿™æ¡åŸåˆ™ä¸€ç›´æ˜¯ä¸€çŸ¥åŠè§£ã€‚ä¸ºä»€ä¹ˆæ¥å£è¦è®©â€œç”¨çš„äººâ€æ¥å®šä¹‰ï¼Œè€Œä¸æ˜¯â€œåšçš„äººâ€æ¥å®šä¹‰å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;åœ¨è¿™æ¬¡é‡æ„ä¹‹åï¼Œæˆ‘â€œæ‚Ÿäº†â€ã€‚&lt;strong&gt;è¿™ä¸å°±æ˜¯å¯¹â€œä¾èµ–å€’ç½®åŸåˆ™â€æœ€ç²¾å‡†ã€æœ€é€šä¿—çš„è¯ é‡Šå—ï¼&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;åœ¨æˆ‘ä»¬çš„æ¶æ„é‡Œï¼š
-   &lt;code&gt;usecase&lt;/code&gt; æ˜¯æ¥å£çš„&lt;strong&gt;ä½¿ç”¨è€…&lt;/strong&gt;ï¼ˆæ¶ˆè´¹è€…ï¼‰ã€‚
-   &lt;code&gt;adapter&lt;/code&gt; æ˜¯æ¥å£çš„&lt;strong&gt;å®ç°è€…&lt;/strong&gt;ï¼ˆæä¾›è€…ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;usecase&lt;/code&gt; è¯´ï¼šâ€œæˆ‘éœ€è¦ä¸€ä¸ªèƒ½æ ¹æ®ç”¨æˆ· ID æ‰¾åˆ°ç”¨æˆ·ï¼Œå¹¶è¿”å› &lt;code&gt;domain.User&lt;/code&gt; çš„èƒ½åŠ›ï¼Œæˆ‘ä¸ç®¡ä½ æ˜¯ä» MySQLã€Redis è¿˜æ˜¯ä»æ–‡ä»¶ä¸­è·å–ï¼Œæ€»ä¹‹ï¼Œä½ å¾—æ»¡è¶³æˆ‘å®šä¹‰çš„è¿™ä¸ª &lt;code&gt;UserRepository&lt;/code&gt; æ¥å£ã€‚â€&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// in usecase/iface/repository.go
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;iface&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;your_project/internal/domain&amp;#34;&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;UserRepository&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;FindByID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;domain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç„¶åï¼Œ&lt;code&gt;adapter/repository&lt;/code&gt; å±‚å»å®ç°å®ƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// in adapter/repository/user_gorm.go
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;repository&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;// ...
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;userRepository&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;FindByID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;domain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;// gorm query logic...
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// convert gorm model to domain.User
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·åšçš„å¥½å¤„æ˜¯å·¨å¤§çš„ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®Œç¾è§£è€¦&lt;/strong&gt;ï¼š&lt;code&gt;usecase&lt;/code&gt; åªå…³å¿ƒå®ƒéœ€è¦ä»€ä¹ˆï¼Œä¸å…³å¿ƒåº•å±‚å¦‚ä½•å®ç°ã€‚æ›´æ¢æ•°æ®åº“å®ç°å¯¹ &lt;code&gt;usecase&lt;/code&gt; æ¯«æ— å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜“äºæµ‹è¯•&lt;/strong&gt;ï¼šåœ¨ä¸º &lt;code&gt;usecase&lt;/code&gt; å†™å•å…ƒæµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è½»è€Œæ˜“ä¸¾åœ° mock è¿™ä¸ª &lt;code&gt;UserRepository&lt;/code&gt; æ¥å£ï¼Œè€Œæ— éœ€ä¸€ä¸ªçœŸå®çš„æ•°æ®åº“è¿æ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¦åˆæœ€å°çŸ¥è¯†åŸåˆ™&lt;/strong&gt;ï¼šå¦‚æœè®© &lt;code&gt;adapter&lt;/code&gt; æ¥å®šä¹‰æ¥å£ï¼Œå®ƒå¯èƒ½ä¼šæš´éœ²å¾ˆå¤š &lt;code&gt;usecase&lt;/code&gt; æ ¹æœ¬ä¸éœ€è¦çš„æ–¹æ³•ï¼Œå¢åŠ äº†ä½¿ç”¨è€…çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚è€Œç”±ä½¿ç”¨è€…å®šä¹‰ï¼Œåˆ™å¯ä»¥ç¡®ä¿æ¥å£çš„ç²¾ç®€å’Œå¿…è¦ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;ä»ä¸€ä¸ªæ··ä¹±çš„é—ç•™é¡¹ç›®å¼€å§‹ï¼Œåˆ°æœ€ç»ˆè½åœ°ä¸€å¥—æ¸…æ™°ã€å¯ç»´æŠ¤çš„æ•´æ´æ¶æ„ï¼Œè¿™æ¬¡é‡æ„ä¹‹æ—…è®©æˆ‘æ”¶è·é¢‡ä¸°ã€‚æ•´æ´æ¶æ„å¹¶ä¸ä»…ä»…æ˜¯ä¸€å¥—æ­»æ¿çš„ç›®å½•ç»“æ„æˆ–åˆ†å±‚è§„åˆ™ï¼Œå®ƒæ›´æ˜¯ä¸€ç§å¼•å¯¼æˆ‘ä»¬å†™å‡ºé«˜å†…èšã€ä½è€¦åˆä»£ç çš„æ€ç»´æ–¹å¼ã€‚&lt;/p&gt;

&lt;p&gt;å®ƒè¿«ä½¿æˆ‘ä»¬å»æ€è€ƒï¼š
-   ä»€ä¹ˆæ˜¯ä¸šåŠ¡çš„æ ¸å¿ƒï¼Ÿï¼ˆDomainï¼‰
-   ä¸šåŠ¡æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿï¼ˆUseCaseï¼‰
-   æŠ€æœ¯ç»†èŠ‚å¦‚ä½•ä¸ä¸šåŠ¡é€»è¾‘è§£è€¦ï¼Ÿï¼ˆAdapter &amp;amp; Dependency Inversionï¼‰&lt;/p&gt;

&lt;p&gt;é€šè¿‡è¿™æ¬¡å®è·µï¼Œæˆ‘å¯¹ä¾èµ–å€’ç½®ã€æ¥å£éš”ç¦»ç­‰ SOLID åŸåˆ™æœ‰äº†è¿œæ¯”ä¹¦æœ¬ä¸Šæ›´æ·±åˆ»çš„ç†è§£ã€‚å½“ä½ çœŸæ­£ç†è§£äº†â€œä¸ºä»€ä¹ˆâ€è¦è¿™ä¹ˆåšï¼Œè€Œä¸æ˜¯ä»…ä»…åœç•™åœ¨â€œæ˜¯ä»€ä¹ˆâ€å’Œâ€œæ€ä¹ˆåšâ€çš„å±‚é¢æ—¶ï¼Œä½ ä¼šå‘ç°ï¼Œå†™å‡ºæ•´æ´ã€å¥å£®çš„ä»£ç ï¼Œå…¶å®æ˜¯ä¸€ä»¶å……æ»¡ä¹è¶£çš„äº‹æƒ…ã€‚&lt;/p&gt;

&lt;p&gt;å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½ä¸ºåŒæ ·åœ¨é‡æ„é“è·¯ä¸Šæ¢ç´¢çš„ä½ ï¼Œæä¾›ä¸€äº›æœ‰ä»·å€¼çš„å‚è€ƒä¸å¯å‘ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>æ‰“é€ ä¸€ä¸ªå±äºè‡ªå·±çš„AIä¹¦ç­¾</title>
      <link>https://zhu327.github.io/2025/07/07/%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84ai%E4%B9%A6%E7%AD%BE/</link>
      <pubDate>Mon, 07 Jul 2025 14:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/07/07/%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84ai%E4%B9%A6%E7%AD%BE/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;æˆ‘ä¸€ç›´æ˜¯ä¸ªé‡åº¦çš„ä¹¦ç­¾ä½¿ç”¨è€…ï¼Œå¤šå¹´æ¥éƒ½ä¾èµ– Pocket æ¥æ”¶è—å’Œæ²‰æ·€é‚£äº›åœ¨ç½‘ä¸Šçœ‹åˆ°çš„ã€å€¼å¾—ä¸€è¯»çš„æ–‡ç« ã€‚ç„¶è€Œï¼Œæœ€è¿‘ Pocket å®£å¸ƒå…¶é€šçŸ¥æœåŠ¡å³å°†å…³é—­ï¼Œè¿™å¯¹æˆ‘æ¥è¯´åƒæ˜¯ä¸€ä¸ªä¿¡å·ï¼Œæ˜¯æ—¶å€™å»å¯»æ‰¾ä¸€ä¸ªæ›´ç¨³å®šã€æ›´å¯æ§çš„æ›¿ä»£å“äº†ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘çš„æ¢ç´¢ä¹‹æ—…å°±è¿™æ ·å¼€å§‹äº†ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Raindrop.io&lt;/strong&gt;ï¼šç¤¾åŒºé‡Œå¾ˆå¤šäººæ¨èï¼ŒåŠŸèƒ½ä¹Ÿç¡®å®å¼ºå¤§ã€‚ä½†ä¸çŸ¥é“æ˜¯ä¸æ˜¯ç½‘ç»œåŸå› ï¼Œæˆ‘è¿™è¾¹è®¿é—®èµ·æ¥æ€»æ˜¯æ„Ÿè§‰æœ‰ç‚¹æ…¢ï¼Œè€Œä¸”ç”¨æƒ¯äº† Pocket çš„æˆ‘ï¼Œå¯¹å®ƒçš„ç•Œé¢å’Œäº¤äº’é€»è¾‘å§‹ç»ˆæœ‰äº›ä¸å¤ªä¹ æƒ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªå»ºæœåŠ¡&lt;/strong&gt;ï¼šä½œä¸ºç¨‹åºå‘˜ï¼Œç¬¬ä¸€ååº”è‡ªç„¶æ˜¯è‡ªå·±åŠ¨æ‰‹ã€‚æˆ‘æ‰¾åˆ°äº†åƒ &lt;a href=&#34;https://github.com/sissbruecker/linkding&#34;&gt;linkding&lt;/a&gt; è¿™æ ·çš„ä¼˜ç§€å¼€æºé¡¹ç›®ã€‚æˆ‘å°è¯•æŠŠå®ƒéƒ¨ç½²åœ¨ &lt;a href=&#34;https://fly.io/&#34;&gt;fly.io&lt;/a&gt; çš„å…è´¹å®ä¾‹ä¸Šï¼Œä½† linkding å¯¹èµ„æºçš„è¦æ±‚ä¸ä½ï¼Œæœ€ä½é…çš„ 256M å†…å­˜å®ä¾‹ç›´æ¥å°± OOM (Out of Memory) äº†ï¼Œå‡çº§é…ç½®åˆæ„å‘³ç€æˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»é›¶å¼€å§‹å†™ä¸€ä¸ªï¼Ÿ&lt;/strong&gt; è¿™ä¸ªå¿µå¤´ä¸€é—ªè€Œè¿‡ã€‚æˆ‘ç”šè‡³æ„æ€å¥½äº†æŠ€æœ¯é€‰å‹ï¼šå‚ç…§ linkding çš„åŠŸèƒ½ï¼Œç”¨æˆ‘æœ€è¿‘åœ¨å­¦ä¹ çš„ &lt;strong&gt;Rust&lt;/strong&gt; å®ç°åç«¯ï¼Œéƒ¨ç½²åœ¨ &lt;strong&gt;Cloudflare Workers&lt;/strong&gt; ä¸Šï¼Œå†é…ä¸Š &lt;strong&gt;Cloudflare D1&lt;/strong&gt; çš„ SQLite æ•°æ®åº“ã€‚è¿™å¥—æ–¹æ¡ˆ Serverlessã€æˆæœ¬æä½ï¼Œå ªç§°å®Œç¾ã€‚ä½†è½¬å¿µä¸€æƒ³ï¼Œè¿™å·¥ç¨‹é‡å¯ä¸å°ï¼Œå¯¹äºä¸šä½™é¡¹ç›®æ¥è¯´ï¼Œæˆ‘å®åœ¨æ²¡æœ‰é‚£ä¹ˆå¤šæ—¶é—´æŠ•å…¥è¿›å»ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å°±åœ¨æˆ‘å¿«è¦æ”¾å¼ƒï¼Œå‡†å¤‡å°†å°±ç€ç”¨æŸä¸ªæ–¹æ¡ˆæ—¶ï¼Œæˆ‘æƒ³èµ·äº†ä¸€ç¯‡ä»¥å‰æ”¶è—è¿‡çš„æ–‡ç« ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-çµæ„Ÿä¹ç°-llm-x-github-ä¹¦ç­¾&#34;&gt;1. çµæ„Ÿä¹ç°ï¼šLLM x GitHub ä¹¦ç­¾&lt;/h3&gt;

&lt;p&gt;é‚£ç¯‡æ–‡ç« æ˜¯ &lt;a href=&#34;https://nekonull.me/posts/llm_x_bookmark/&#34;&gt;LLM x ä¹¦ç­¾æ”¶è—ï¼šæ‘˜è¦ &amp;amp; å…¨æ–‡ç´¢å¼•&lt;/a&gt;ï¼Œä½œè€…æä¾›äº†ä¸€ä¸ªæå…·åˆ›æ„çš„æ€è·¯ï¼šé€šè¿‡ä¸€ä¸ªæµè§ˆå™¨æ’ä»¶ &lt;a href=&#34;https://github.com/osmoscraft/osmosmemo&#34;&gt;osmos::memo&lt;/a&gt;ï¼Œå¯ä»¥å°†ä¹¦ç­¾ç›´æ¥ä¿å­˜åˆ°æŒ‡å®š GitHub ä»“åº“çš„ &lt;code&gt;README.md&lt;/code&gt; æ–‡ä»¶é‡Œã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªæ–¹æ¡ˆç¬é—´å‡»ä¸­äº†æˆ‘ï¼å®ƒè¶³å¤Ÿ&lt;strong&gt;ç®€å•&lt;/strong&gt;ï¼Œæ²¡æœ‰å¤šä½™çš„åŠŸèƒ½ï¼Œå®Œç¾ç¬¦åˆæˆ‘çš„éœ€æ±‚ã€‚æ•°æ®å°±èººåœ¨è‡ªå·±çš„ GitHub ä»“åº“é‡Œï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæœåŠ¡å…³åœã€‚è™½ç„¶åŸæ–‡åç»­ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨ LLM å¯¹ä¹¦ç­¾è¿›è¡Œæ‘˜è¦å’Œç´¢å¼•ï¼Œä½†æˆ‘è§‰å¾—è¿˜å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼Œæ”¹é€ æˆä¸€ä¸ªå®Œå…¨è‡ªåŠ¨åŒ–ã€æ›´ç¬¦åˆæˆ‘ä½¿ç”¨ä¹ æƒ¯çš„æµç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;è¯´å¹²å°±å¹²ï¼Œæˆ‘ç«‹åˆ»åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ä»“åº“ &lt;a href=&#34;https://github.com/zhu327/bookmark&#34;&gt;bookmark&lt;/a&gt;ï¼Œå‡†å¤‡å¼€å§‹æˆ‘çš„æ”¹é€ è®¡åˆ’ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-å­˜é‡æ•°æ®çš„æ¼«æ¼«è¿ç§»è·¯&#34;&gt;2. å­˜é‡æ•°æ®çš„æ¼«æ¼«è¿ç§»è·¯&lt;/h3&gt;

&lt;p&gt;è¦æ‰“é€ æ–°å®¶ï¼Œé¦–å…ˆå¾—æŠŠè€å®¶çš„å®¶å½“æ¬è¿‡å»ã€‚ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯å¤„ç†ä» Pocket å¯¼å‡ºçš„å‡ ç™¾æ¡å­˜é‡ä¹¦ç­¾ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å†™äº†ä¸€ä¸ªç®€å•çš„ Python è„šæœ¬ï¼Œå°† Pocket å¯¼å‡ºçš„ HTML æ–‡ä»¶è§£ææˆ Markdown æ ¼å¼ï¼Œç„¶åä¸€è‚¡è„‘å„¿åœ°å¡è¿›äº† &lt;code&gt;README.md&lt;/code&gt;ã€‚ä½†è¿™åªæ˜¯ä¸‡é‡Œé•¿å¾çš„ç¬¬ä¸€æ­¥ã€‚æˆ‘çš„ç›®æ ‡æ˜¯è®©æ¯ä¸ªä¹¦ç­¾éƒ½æœ‰ &lt;strong&gt;AI ç”Ÿæˆçš„æ‘˜è¦å’Œåˆ†ç±»&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘æƒ³åˆ°äº†æœ€è¿‘å¾ˆç«çš„ Geminiï¼Œå®ƒçš„å‘½ä»¤è¡Œå·¥å…· &lt;code&gt;gemini-cli&lt;/code&gt; çœ‹èµ·æ¥å¾ˆé€‚åˆç”¨æ¥åšæ‰¹å¤„ç†ã€‚äºæ˜¯ï¼Œæˆ‘å¼€å§‹äº†æˆ‘çš„è¸©å‘ä¹‹æ—…ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆæ¬¡å°è¯•ï¼ˆå¤±è´¥ï¼‰&lt;/strong&gt;ï¼šæˆ‘ç”¨ &lt;strong&gt;Playwright&lt;/strong&gt; å†™äº†ä¸ªè„šæœ¬ï¼Œæ¨¡æ‹Ÿæµè§ˆå™¨å»è®¿é—®æˆ‘çš„ 230 ä¸ªä¹¦ç­¾é“¾æ¥ï¼ŒæŠŠæ¯ä¸ªé¡µé¢çš„å®Œæ•´ HTML éƒ½æŠ“å–ä¸‹æ¥ã€‚ç»“æœï¼Œæ‰€æœ‰å†…å®¹åŠ èµ·æ¥è¶³è¶³æœ‰ &lt;strong&gt;165MB&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å‰²æ–‡ä»¶ + Gemini CLIï¼ˆå¤±è´¥ï¼‰&lt;/strong&gt;ï¼šæˆ‘æŠŠè¿™ 165MB çš„å†…å®¹æŒ‰æ¯ä¸ªç½‘é¡µä¸€ä¸ªæ–‡ä»¶è¿›è¡Œåˆ†å‰²ï¼Œç„¶åå°è¯•ç”¨ &lt;code&gt;gemini-cli&lt;/code&gt; éå†æ‰€æœ‰æ–‡ä»¶ï¼Œè®©å®ƒä¸ºæ¯ä¸ª HTML ç”Ÿæˆæ‘˜è¦å’Œåˆ†ç±»ã€‚ç»“æœï¼ŒGemini çš„ä¸Šä¸‹æ–‡çª—å£æœ‰é™ï¼Œè€Œä¸” API è°ƒç”¨éå¸¸éå¸¸æ…¢ï¼Œä¸€ä¸ªä¸‹åˆè¿‡å»ï¼Œæ‰å¤„ç†äº†ä¸åˆ° 80 ä¸ªã€‚æœæ–­æ”¾å¼ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰“åŒ…ä¸Šä¼  AI Studioï¼ˆå¤±è´¥ï¼‰&lt;/strong&gt;ï¼šæˆ‘æƒ³ï¼Œå•ä¸ªå¤„ç†ä¸è¡Œï¼Œé‚£å°±æ‰“åŒ…å¤„ç†ã€‚æˆ‘ç”¨ Python è„šæœ¬æŠŠç½‘é¡µæŒ‰æ¯ 20 ä¸ªä¸€ç»„è¿›è¡Œæ‰“åŒ…ï¼Œä½†æ¯ä¸ªåŒ…çš„æ–‡ä»¶å¤§å°ä»åœ¨ 5MB ~ 14MB ä¹‹é—´ã€‚è¿™ä¸ªå¤§å°å¯¹äºç›´æ¥ä¸Šä¼ åˆ° Google AI Studio æ¥è¯´è¿˜æ˜¯å¤ªå¤§äº†ï¼Œæ­¤è·¯ä¸é€šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç²¾ç®€å†…å®¹ + æ‰‹åŠ¨å¤„ç†ï¼ˆæˆåŠŸï¼ï¼‰&lt;/strong&gt;ï¼šçœ‹æ¥é—®é¢˜å‡ºåœ¨åŸå§‹ HTML å†…å®¹å¤ªåºæ‚äº†ã€‚æˆ‘å†æ¬¡ä¿®æ”¹è„šæœ¬ï¼Œåœ¨åˆ†å‰²æ–‡ä»¶çš„åŒæ—¶ï¼Œå¼•å…¥ &lt;strong&gt;&lt;code&gt;html2text&lt;/code&gt;&lt;/strong&gt; åº“ï¼Œå°†è‡ƒè‚¿çš„ HTML è½¬æ¢æˆçº¯æ–‡æœ¬ã€‚è¿™ä¸‹æ•ˆæœç«‹ç«¿è§å½±ï¼Œæ¯ 20 ä¸ªç½‘é¡µæ‰“åŒ…æˆçš„æ–‡ä»¶åªæœ‰ &lt;strong&gt;400KB ~ 600KB&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AI æ‰‹å·¥æ“ä½œ&lt;/strong&gt;ï¼šæˆ‘å°†è¿™ 13 ä¸ªï¼ˆ230/20 â‰ˆ 13ï¼‰å¤„ç†è¿‡çš„æ–‡æœ¬æ–‡ä»¶ï¼Œ&lt;strong&gt;æ‰‹åŠ¨ä¸€ä¸ªä¸ªä¸Šä¼ &lt;/strong&gt;åˆ° Google AI Studioã€‚ç„¶åï¼Œé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„ Promptï¼Œè®© AI ä¸ºæ–‡ä»¶é‡Œçš„æ¯ä¸€ä¸ªé“¾æ¥éƒ½ç”Ÿæˆæ‘˜è¦ï¼Œå¹¶æ•´ç†æˆæˆ‘æƒ³è¦çš„ Markdown æ ¼å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ€ç»ˆåˆ†ç±»&lt;/strong&gt;ï¼šæˆ‘æŠŠ AI ç”Ÿæˆçš„æ‰€æœ‰æ‘˜è¦å†…å®¹æ±‡æ€»åˆ°ä¸€ä¸ª &lt;code&gt;summary.md&lt;/code&gt; æ–‡ä»¶é‡Œã€‚æœ€åï¼Œå†æŠŠè¿™ä¸ªæ±‡æ€»æ–‡ä»¶ä¸Šä¼ ç»™ AI Studioï¼Œç»™å®ƒä¸‹è¾¾æœ€ç»ˆæŒ‡ä»¤ï¼šâ€œè¯·æ ¹æ®è¿™äº›å†…å®¹çš„æ‘˜è¦ï¼Œå°†æ‰€æœ‰é“¾æ¥æŒ‰æŠ€æœ¯é¢†åŸŸã€ç”Ÿæ´»ã€æ€è€ƒç­‰ç±»åˆ«è¿›è¡Œåˆ†ç±»æ•´ç†ã€‚â€&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æœ€ç»ˆï¼Œæˆ‘å¾—åˆ°äº†å®Œç¾çš„åˆ†ç±»å½’æ¡£æ–‡ä»¶ï¼š&lt;a href=&#34;https://github.com/zhu327/bookmark/blob/main/category.md&#34;&gt;category.md&lt;/a&gt;ã€‚è™½ç„¶è¿‡ç¨‹æ›²æŠ˜ï¼Œä½†çœ‹åˆ°æ•´é½åˆ’ä¸€çš„æˆæœæ—¶ï¼Œä¸€åˆ‡éƒ½å€¼äº†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-æ–°å¢ä¹¦ç­¾-äº¤ç»™-github-actions-å§&#34;&gt;3. æ–°å¢ä¹¦ç­¾ï¼Ÿäº¤ç»™ GitHub Actions å§ï¼&lt;/h3&gt;

&lt;p&gt;å¤„ç†å®Œå­˜é‡æ•°æ®ï¼Œæ¥ä¸‹æ¥å°±è¦è€ƒè™‘å¦‚ä½•è‡ªåŠ¨åŒ–åœ°å¤„ç†æ¯ä¸€ä¸ªæ–°å¢çš„ä¹¦ç­¾äº†ã€‚æˆ‘çš„æ€è·¯æ˜¯ï¼Œè®©ä¸‡èƒ½çš„ &lt;strong&gt;GitHub Actions&lt;/strong&gt; æ¥æ‰®æ¼”è¿™ä¸ªæ™ºèƒ½ç®¡å®¶çš„è§’è‰²ã€‚&lt;/p&gt;

&lt;p&gt;æ•´ä¸ªæµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è§¦å‘&lt;/strong&gt;ï¼šæ¯å½“æˆ‘é€šè¿‡ &lt;code&gt;osmos::memo&lt;/code&gt; æ’ä»¶å‘ &lt;code&gt;README.md&lt;/code&gt; æ·»åŠ æ–°é“¾æ¥å¹¶æ¨é€åˆ° GitHub æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘ GitHub Actions çš„ workflowã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£æ&lt;/strong&gt;ï¼šåœ¨ workflow ä¸­è¿è¡Œçš„ Python è„šæœ¬ (&lt;code&gt;process_bookmarks.py&lt;/code&gt;) ä¼šä½¿ç”¨ &lt;code&gt;git diff&lt;/code&gt; å‘½ä»¤ï¼Œç²¾å‡†åœ°æ‰¾å‡º &lt;code&gt;README.md&lt;/code&gt; ä¸­æ–°å¢åŠ çš„é‚£ä¸€è¡Œä¹¦ç­¾é“¾æ¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ“å–å†…å®¹&lt;/strong&gt;ï¼šä¸ºäº†é¿å…è‡ªå·±å†™çˆ¬è™«é‡åˆ°çš„å„ç§åçˆ¬é—®é¢˜ï¼Œæˆ‘é€‰æ‹©äº†ä¸€ä¸ªéå¸¸æ£’çš„å·¥å…·â€”â€”&lt;a href=&#34;https://jina.ai/reader/&#34;&gt;jina reader&lt;/a&gt;ã€‚é€šè¿‡è°ƒç”¨å®ƒçš„ API (&lt;code&gt;https://r.jina.ai/URL&lt;/code&gt;)ï¼Œå¯ä»¥ç›´æ¥è·å–åˆ°ç›®æ ‡é“¾æ¥é¡µé¢çš„å¹²å‡€ã€è§„èŒƒçš„ Markdown æ–‡æœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæˆæ‘˜è¦&lt;/strong&gt;ï¼šå°†è·å–åˆ°çš„ Markdown æ–‡æœ¬å‘é€ç»™ LLM APIï¼Œè®©å®ƒç”Ÿæˆä¸€æ®µç®€æ´çš„æ‘˜è¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™ºèƒ½åˆ†ç±»&lt;/strong&gt;ï¼šå°†é“¾æ¥çš„åŸå§‹æ ‡é¢˜å’Œ AI ç”Ÿæˆçš„æ‘˜è¦å†æ¬¡ç»„åˆï¼Œå‘é€ç»™ LLM APIï¼Œè®©å®ƒåˆ¤æ–­è¿™ä¸ªé“¾æ¥åº”è¯¥å±äºå“ªä¸ªåˆ†ç±»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†™å…¥å½’æ¡£&lt;/strong&gt;ï¼šæœ€åï¼Œè„šæœ¬ä¼šæŒ‰ç…§ &lt;code&gt;[æ ‡é¢˜](é“¾æ¥) - æ‘˜è¦&lt;/code&gt; çš„æ ¼å¼ï¼Œå°†è¿™æ¡å…¨æ–°çš„ã€å¤„ç†å¥½çš„ä¹¦ç­¾ä¿¡æ¯ï¼Œè¿½åŠ åˆ° &lt;code&gt;category.md&lt;/code&gt; æ–‡ä»¶å¯¹åº”çš„åˆ†ç±»ä¸‹ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å°±è¿™æ ·ï¼Œä¸€å¥—å®Œå…¨è‡ªåŠ¨åŒ–çš„ AI ä¹¦ç­¾æ•´ç†æµç¨‹å°±è¯ç”Ÿäº†ã€‚æˆ‘åªéœ€è¦åœ¨æµè§ˆå™¨ä¸Šç‚¹ä¸€ä¸‹æ”¶è—ï¼Œå‰©ä¸‹çš„æŠ“å–ã€æ‘˜è¦ã€åˆ†ç±»ã€å½’æ¡£å·¥ä½œï¼Œéƒ½ç”±æˆ‘çš„ AI ç®¡å®¶åœ¨äº‘ç«¯é»˜é»˜å®Œæˆã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-æ‹¥æœ‰ä½ è‡ªå·±çš„-ai-ä¹¦ç­¾&#34;&gt;4. æ‹¥æœ‰ä½ è‡ªå·±çš„ AI ä¹¦ç­¾&lt;/h3&gt;

&lt;p&gt;è¿™å¥—æ–¹æ¡ˆæˆ‘å·²ç»å¼€æºåœ¨ GitHub ä¸Šï¼š&lt;a href=&#34;https://github.com/zhu327/bookmark&#34;&gt;https://github.com/zhu327/bookmark&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç›®å‰æˆ‘ä½¿ç”¨çš„ LLM API æ˜¯ç”±ç¡…åŸºæµåŠ¨æä¾›çš„å…è´¹æ¨¡å‹ &lt;strong&gt;deepseek-ai/DeepSeek-R1-0528-Qwen3-8B&lt;/strong&gt;ï¼Œæ•ˆæœç›¸å½“ä¸é”™ã€‚å¦‚æœä½ ä¹Ÿå¯¹è¿™ä¸ªæ–¹æ¡ˆæ„Ÿå…´è¶£ï¼Œå¯ä»¥éå¸¸ç®€å•åœ°æ‹¥æœ‰è‡ªå·±çš„ AI ä¹¦ç­¾ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Fork&lt;/strong&gt; è¿™ä¸ªä»“åº“ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ä½ çš„ä»“åº“ &lt;code&gt;Settings -&amp;gt; Secrets and variables -&amp;gt; Actions&lt;/code&gt; ä¸­ï¼Œæ·»åŠ ä¸¤ä¸ª &lt;code&gt;Repository secrets&lt;/code&gt;ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;LLM_API_URL&lt;/code&gt;: å…¼å®¹ OpenAI API æ ¼å¼çš„å¤§æ¨¡å‹æ¥å£åœ°å€ï¼Œä¾‹å¦‚ &lt;code&gt;https://api.siliconflow.cn/v1/chat/completions&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OPENAI_API_KEY&lt;/code&gt;: è°ƒç”¨è¯¥ API æ‰€éœ€çš„ Keyã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å½“ç„¶ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¹Ÿå¹¶éå®Œç¾ã€‚æ¯”å¦‚å¯¹äºæœ‰ä¸¥æ ¼åçˆ¬ç­–ç•¥çš„ç½‘ç«™ï¼ˆç‚¹åå¾®ä¿¡å…¬ä¼—å·ï¼‰ï¼Œ&lt;code&gt;jina reader&lt;/code&gt; ä¹Ÿæ— èƒ½ä¸ºåŠ›ï¼Œæ— æ³•ç›´æ¥è·å–åˆ°æ–‡ç« å†…å®¹ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;åœ¨å Pocket æ—¶ä»£ï¼Œå€ŸåŠ© LLM çš„å¼ºå¤§èƒ½åŠ›ï¼Œæˆ‘çš„ä¸ªäººä¹¦ç­¾ç³»ç»Ÿå®Œæˆäº†ä¸€æ¬¡æœ‰è¶£çš„è¿›åŒ–ã€‚å®ƒä¸å†æ˜¯ä¸€ä¸ªä¾èµ–äºç¬¬ä¸‰æ–¹åœ¨çº¿æœåŠ¡çš„ä¼ ç»Ÿä¹¦ç­¾ï¼Œè€Œæ˜¯å˜æˆäº†ä¸€ä¸ªç”±æˆ‘è‡ªå·±æŒæ§ã€æ´»åœ¨ GitHub ä¸Šçš„æ™ºèƒ½çŸ¥è¯†åº“ã€‚æ‰€æœ‰æ•°æ®éƒ½ä»¥ Markdown æ ¼å¼æ¸…æ™°åœ°å­˜å‚¨ï¼Œæ£€ç´¢ä¹Ÿå˜å¾—å‰æ‰€æœªæœ‰çš„ç®€å•â€”â€”æ‰“å¼€ &lt;code&gt;category.md&lt;/code&gt;ï¼ŒæŒ‰ä¸‹ &lt;code&gt;CTRL + F&lt;/code&gt; å³å¯ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªå°é¡¹ç›®è®©æˆ‘å†æ¬¡æ„Ÿå—åˆ°ï¼Œå°† AI ä½œä¸ºä¸€ç§å·¥å…·èå…¥åˆ°ä¸ªäººå·¥ä½œæµä¸­ï¼Œèƒ½å¤Ÿè¿¸å‘å‡ºå·¨å¤§çš„èƒ½é‡ã€‚å®ƒä¸ä»…è§£å†³äº†æˆ‘çš„å®é™…é—®é¢˜ï¼Œä¹Ÿè®©æ•´ä¸ªè¿‡ç¨‹å……æ»¡äº†æ¢ç´¢å’Œåˆ›é€ çš„ä¹è¶£ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>æˆ‘ç†è§£çš„AI Agentä¸MCP</title>
      <link>https://zhu327.github.io/2025/04/02/%E6%88%91%E7%90%86%E8%A7%A3%E7%9A%84ai-agent%E4%B8%8Emcp/</link>
      <pubDate>Wed, 02 Apr 2025 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/04/02/%E6%88%91%E7%90%86%E8%A7%A3%E7%9A%84ai-agent%E4%B8%8Emcp/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;æœ€è¿‘AIåœˆå­é‡ŒManusè¿™ä¸ªé¡¹ç›®å¯ä»¥è¯´æ˜¯ç›¸å½“ç«äº†ï¼Œè¿å¸¦ç€MCPï¼ˆModel Context Protocolï¼‰è¿™ä¸ªæ¦‚å¿µä¹Ÿå¼€å§‹é¢‘ç¹å‡ºç°åœ¨å„ç§æŠ€æœ¯è®¨è®ºåŒºã€‚ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œè‡ªç„¶ä¹Ÿå¯¹è¿™äº›æ–°ä¸œè¥¿å……æ»¡äº†å¥½å¥‡ï¼Œäºæ˜¯èŠ±æ—¶é—´æ£é¼“äº†ä¸€ä¸‹AI Agentå’ŒMCPç›¸å…³çš„çŸ¥è¯†ã€‚è¿™ç¯‡æ–‡ç« å°±æ˜¯æˆ‘å­¦ä¹ å’Œæ€è€ƒåï¼Œå¯¹è¿™ä¸¤ä¸ªæ¦‚å¿µçš„ä¸€äº›ä¸ªäººç†è§£å’Œæ¢³ç†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-ä»workflowåˆ°ai-agent-å¤§è„‘çš„è¿›åŒ–&#34;&gt;1. ä»Workflowåˆ°AI Agentï¼šå¤§è„‘çš„è¿›åŒ–&lt;/h3&gt;

&lt;p&gt;å›é¡¾æˆ‘ä»¬ä»¥å‰åšè‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œæ¯”å¦‚æä¸ªè‡ªåŠ¨æŠ¢ç¥¨ã€è‡ªåŠ¨ä¸‹å•ä¹‹ç±»çš„ï¼Œæ€è·¯åŸºæœ¬éƒ½æ˜¯å›´ç»•ç€ä¸€ä¸ªå›ºå®šçš„&lt;strong&gt;workflow&lt;/strong&gt;ã€‚æˆ‘ä»¬ä¼šé¢„å…ˆè®¾å®šå¥½ä¸€å¥—æµç¨‹é€»è¾‘ï¼šæ”¶åˆ°æŒ‡ä»¤ -&amp;gt; åˆ¤æ–­æ¡ä»¶ -&amp;gt; èµ°å¯¹åº”åˆ†æ”¯ -&amp;gt; è°ƒç”¨ç‰¹å®šå·¥å…·ï¼ˆAPIã€è„šæœ¬ç­‰ï¼‰ã€‚æ•´ä¸ªè¿‡ç¨‹å°±åƒä¸€ä¸ªæµç¨‹å›¾ï¼Œæ¯ä¸ªèŠ‚ç‚¹å’Œè·¯å¾„éƒ½æ˜¯æˆ‘ä»¬ç¨‹åºå‘˜é¢„å…ˆè®¾è®¡å¥½çš„ã€‚åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œ&lt;strong&gt;æˆ‘ä»¬ç¨‹åºå‘˜å°±æ˜¯è¿™ä¸ªworkflowçš„â€œå¤§è„‘â€&lt;/strong&gt;ï¼Œæˆ‘ä»¬æŠŠæ‰§è¡Œè®¡åˆ’é€šè¿‡ä»£ç é€»è¾‘ï¼Œâ€œç¡¬ç¼–ç â€åˆ°ç³»ç»Ÿé‡Œã€‚æ¯”å¦‚é¢„å®šæœºç¥¨è¿™ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬ä¼šå†™ä»£ç ä¸€æ­¥æ­¥è°ƒç”¨æŸ¥è¯¢æ¥å£ã€é€‰æ‹©èˆªç­æ¥å£ã€å¡«å†™ä¹˜æœºäººä¿¡æ¯æ¥å£ã€æ”¯ä»˜æ¥å£ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;2-llmç™»åœº-æœ‰äº†-å¤§è„‘-ä½†è¿˜ç¼º-æ‰‹è„š&#34;&gt;2. LLMç™»åœºï¼šæœ‰äº†â€œå¤§è„‘â€ï¼Œä½†è¿˜ç¼ºâ€œæ‰‹è„šâ€&lt;/h3&gt;

&lt;p&gt;éšç€å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æŠ€æœ¯çš„çªé£çŒ›è¿›ï¼Œç‰¹åˆ«æ˜¯åƒDeepSeek R1è¿™æ ·å¼ºå¤§çš„æ¨ç†æ¨¡å‹å‡ºç°ï¼Œå®ƒä»¬çš„æ¨ç†å’Œè§„åˆ’èƒ½åŠ›è¶Šæ¥è¶Šæ¥è¿‘äººç±»å¤§è„‘ã€‚è¿™å°±è®©æˆ‘ä»¬è‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°ï¼šèƒ½ä¸èƒ½è®©LLMæ¥å……å½“è¿™ä¸ªè‡ªåŠ¨åŒ–æµç¨‹çš„â€œå¤§è„‘â€ï¼Œä»£æ›¿æˆ‘ä»¬æ¥åˆ¶å®šæ‰§è¡Œè®¡åˆ’å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;æƒ³æ³•å¾ˆç¾å¥½ï¼Œä½†LLMæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ª&lt;strong&gt;æ–‡æœ¬è¡¥å…¨&lt;/strong&gt;çš„æ¨¡å‹ã€‚å®ƒèƒ½â€œæ€è€ƒâ€å¹¶å‘Šè¯‰ä½ è®¡åˆ’æ˜¯ä»€ä¹ˆï¼Œä½†å®ƒè‡ªå·±å¹¶ä¸èƒ½ç›´æ¥æ’¸èµ·è¢–å­å»è°ƒç”¨é‚£äº›å…·ä½“çš„å·¥å…·ï¼ˆAPIã€å‡½æ•°ç­‰ï¼‰æ¥å®Œæˆä»»åŠ¡ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒOpenAIåœ¨å…¶APIä¸­å¼•å…¥äº†&lt;code&gt;tools&lt;/code&gt;ï¼ˆæˆ–ç§°ä¸º Function Callingï¼‰çš„æ¦‚å¿µã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªæµç¨‹å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼ˆå¯ä»¥ç§°ä¸ºAgentï¼‰è°ƒç”¨LLM APIæ—¶ï¼Œåœ¨è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¸­è¯¦ç»†æè¿°å¯ç”¨çš„å·¥å…·ï¼šæ¯ä¸ªå·¥å…·æ˜¯å¹²å˜›çš„ã€è¾“å…¥éœ€è¦ä»€ä¹ˆå‚æ•°ã€è¾“å‡ºæ˜¯ä»€ä¹ˆæ ¼å¼ã€‚&lt;/li&gt;
&lt;li&gt;AgentæŠŠç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼ˆPromptï¼‰å‘ç»™LLMã€‚&lt;/li&gt;
&lt;li&gt;LLMæ ¹æ®ç”¨æˆ·çš„éœ€æ±‚ï¼Œç»“åˆå®ƒæ‰€çŸ¥é“çš„å·¥å…·ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦ä»¥åŠéœ€è¦è°ƒç”¨å“ªä¸ªï¼ˆæˆ–å“ªäº›ï¼‰å·¥å…·ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœéœ€è¦è°ƒç”¨å·¥å…·ï¼ŒLLMä¸ä¼šç›´æ¥æ‰§è¡Œï¼Œè€Œæ˜¯&lt;strong&gt;è¿”å›ä¸€ä¸ªåŒ…å«è°ƒç”¨æŒ‡ä»¤çš„å“åº”&lt;/strong&gt;ï¼Œé‡Œé¢è¯´æ˜äº†è¦è°ƒç”¨å“ªä¸ªå·¥å…·ä»¥åŠéœ€è¦ä¼ é€’çš„å‚æ•°ï¼ˆé€šå¸¸æ˜¯JSONæ ¼å¼ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Agentæ”¶åˆ°è¿™ä¸ªå“åº”åï¼Œè§£æå‡ºè°ƒç”¨æŒ‡ä»¤ï¼Œ&lt;strong&gt;åœ¨Agentè‡ªå·±çš„ç¯å¢ƒé‡Œæ‰§è¡Œ&lt;/strong&gt;ç›¸åº”çš„å·¥å…·ï¼ˆæ¯”å¦‚è°ƒç”¨ä¸€ä¸ªæœ¬åœ°å‡½æ•°æˆ–ä¸€ä¸ªå¤–éƒ¨APIï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Agentæ‹¿åˆ°å·¥å…·çš„æ‰§è¡Œç»“æœåï¼ŒæŠŠè¿™ä¸ªç»“æœå†æ¬¡ä½œä¸ºä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¼ å›ç»™LLMã€‚&lt;/li&gt;
&lt;li&gt;LLMæ ¹æ®å·¥å…·çš„æ‰§è¡Œç»“æœï¼Œå†³å®šä¸‹ä¸€æ­¥æ˜¯ç»§ç»­è°ƒç”¨å…¶ä»–å·¥å…·ï¼Œè¿˜æ˜¯ç”Ÿæˆæœ€ç»ˆçš„å›å¤ç»™ç”¨æˆ·ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™ä¸ªåŸºäº&lt;code&gt;tools&lt;/code&gt;çš„äº¤äº’æ¨¡å¼ï¼Œè®©LLMæœ‰äº†æŒ‡æŒ¥â€œæ‰‹è„šâ€ï¼ˆå·¥å…·ï¼‰çš„èƒ½åŠ›ã€‚ä½†è¿™é‡Œä¹Ÿæš´éœ²äº†ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„&lt;strong&gt;å¼Šç«¯&lt;/strong&gt;ï¼šå®Œæˆä¸€ä¸ªä»»åŠ¡å¯èƒ½éœ€è¦&lt;strong&gt;å¤šæ¬¡ä¸LLMè¿›è¡Œäº¤äº’&lt;/strong&gt;ï¼ˆLLMå†³ç­– -&amp;gt; Agentæ‰§è¡Œ -&amp;gt; Agentåé¦ˆç»“æœ -&amp;gt; LLMå†å†³ç­–&amp;hellip;ï¼‰ï¼Œå¹¶ä¸”ä¸ºäº†è®©LLMç†è§£ä¸Šä¸‹æ–‡ï¼Œæ¯æ¬¡äº¤äº’éƒ½éœ€è¦ä¼ é€’è¶Šæ¥è¶Šé•¿çš„å†å²ä¿¡æ¯ï¼Œè¿™æ—¢&lt;strong&gt;å¢åŠ äº†å»¶è¿Ÿ&lt;/strong&gt;ï¼Œä¹Ÿ&lt;strong&gt;å¢åŠ äº†APIè°ƒç”¨æˆæœ¬å’ŒTokenæ¶ˆè€—&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-codeact-è®©llmç›´æ¥å†™ä»£ç æ‰§è¡Œ&#34;&gt;3. CodeActï¼šè®©LLMç›´æ¥å†™ä»£ç æ‰§è¡Œ&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼Œå½“å‰LLMæœ€å¼ºçš„èƒ½åŠ›ä¹‹ä¸€å°±æ˜¯&lt;strong&gt;ä»£ç ç”Ÿæˆ&lt;/strong&gt;ã€‚äºæ˜¯ï¼Œå°±æœ‰äººæƒ³å‡ºäº†å¦ä¸€ç§æ›´ç›´æ¥çš„æ€è·¯ï¼šæ—¢ç„¶LLMæ“…é•¿å†™ä»£ç ï¼Œè€Œæˆ‘ä»¬æä¾›çš„å·¥å…·æœ¬èº«å¾ˆå¤šå°±æ˜¯å‡½æ•°æˆ–è€…å¯ä»¥é€šè¿‡ä»£ç è°ƒç”¨çš„APIï¼Œé‚£ä½•ä¸è®©LLMç›´æ¥ç”Ÿæˆä¸€å°æ®µå¯æ‰§è¡Œçš„ä»£ç ï¼ˆæ¯”å¦‚Pythonï¼‰ï¼Œç„¶ååœ¨æˆ‘ä»¬çš„Agenté‡Œå†…ç½®ä¸€ä¸ªå®‰å…¨çš„&lt;strong&gt;ä»£ç æ‰§è¡Œæ²™ç®±&lt;/strong&gt;æ¥è¿è¡Œè¿™æ®µä»£ç å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;åœ¨è¿™æ®µç”Ÿæˆçš„ä»£ç é‡Œï¼ŒLLMå¯ä»¥ç›´æ¥åŒ…å«å¯¹æˆ‘ä»¬æä¾›çš„å·¥å…·ï¼ˆå‡½æ•°ï¼‰çš„è°ƒç”¨ï¼Œç”šè‡³å¯ä»¥ç¼–å†™ä¸€äº›ç®€å•çš„æµç¨‹æ§åˆ¶é€»è¾‘ï¼ˆif/elseã€å¾ªç¯ç­‰ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¤šä¸ªæ­¥éª¤å’Œå·¥å…·è°ƒç”¨å¯èƒ½é€šè¿‡ä¸€æ¬¡LLMç”Ÿæˆã€ä¸€æ¬¡ä»£ç æ‰§è¡Œå°±å®Œæˆäº†ï¼Œå¤§å¤§&lt;strong&gt;å‡å°‘äº†ä¸LLMçš„äº¤äº’æ¬¡æ•°&lt;/strong&gt;ã€‚è¿™ç§æ–¹æ³•å°±è¢«ç§°ä¸º&lt;strong&gt;CodeAct&lt;/strong&gt;ï¼ˆä»£ç ä½œä¸ºè¡ŒåŠ¨ï¼‰ã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-åˆ°åº•ä»€ä¹ˆæ˜¯ai-agent&#34;&gt;4. åˆ°åº•ä»€ä¹ˆæ˜¯AI Agentï¼Ÿ&lt;/h3&gt;

&lt;p&gt;èŠäº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬å†æ¥å°è¯•ç»™AI Agentä¸‹ä¸€ä¸ªå®šä¹‰ã€‚æˆ‘è®¤ä¸ºï¼Œ&lt;strong&gt;AI Agent = LLMï¼ˆå¤§è„‘ï¼‰ + Toolsï¼ˆæ‰‹è„šï¼‰ + Agent Runtimeï¼ˆæ‰§è¡Œå™¨ï¼‰ + å†³ç­–å¾ªç¯&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å…·ä½“æ¥è¯´ï¼ŒAI Agenté€šè¿‡è°ƒç”¨LLM APIï¼Œå¹¶ç»“åˆä¸€ç³»åˆ—å¯ç”¨çš„å·¥å…·ï¼ˆToolsï¼‰ï¼Œæ¥ç†è§£å¹¶æ‰§è¡Œç”¨æˆ·çš„è‡ªç„¶è¯­è¨€ä»»åŠ¡ã€‚å®ƒé€šå¸¸é‡‡ç”¨ä¸€ç§&lt;strong&gt;å†³ç­–-æ‰§è¡Œ-è§‚å¯Ÿ&lt;/strong&gt;çš„å¾ªç¯æ¨¡å¼ï¼ˆReActï¼‰ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å†³ç­–ï¼ˆReasonï¼‰&lt;/strong&gt;ï¼šç”±LLMæ ¹æ®å½“å‰ä»»åŠ¡ç›®æ ‡å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå†³å®šä¸‹ä¸€æ­¥æ˜¯è°ƒç”¨å·¥å…·è¿˜æ˜¯ç›´æ¥å›å¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡Œï¼ˆActï¼‰&lt;/strong&gt;ï¼šç”±Agent Runtimeæ ¹æ®LLMçš„å†³ç­–ï¼Œæ‰§è¡Œç›¸åº”çš„å·¥å…·è°ƒç”¨æˆ–ä»£ç ç‰‡æ®µã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§‚å¯Ÿï¼ˆObserveï¼‰&lt;/strong&gt;ï¼šAgent Runtimeå°†æ‰§è¡Œç»“æœåé¦ˆç»™LLMï¼Œä½œä¸ºæ–°çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¾›LLMè¿›è¡Œä¸‹ä¸€è½®å†³ç­–ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™ä¸ªå¾ªç¯ä¸€ç›´æŒç»­ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆã€‚&lt;/p&gt;

&lt;p&gt;ä½†è¿™é‡Œæœ‰ä¸ªå…³é”®é—®é¢˜ï¼šLLMæœ¬èº«å…·æœ‰ä¸€å®šçš„&lt;strong&gt;ä¸ç¡®å®šæ€§&lt;/strong&gt;ã€‚å¯¹äºç›¸åŒçš„è¾“å…¥ï¼ˆPromptï¼‰ï¼Œå®ƒæ¯æ¬¡è¿”å›çš„ç»“æœå¯èƒ½éƒ½ä¸å®Œå…¨ä¸€æ ·ã€‚è¿™å°±ç»™AI Agentçš„æ‰§è¡Œå¸¦æ¥äº†æŒ‘æˆ˜ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¼šåç¦»é¢„æœŸæˆ–è€…å¡åœ¨æŸä¸ªç¯èŠ‚ã€‚å› æ­¤ï¼Œåœ¨å¼€å‘AI Agentæ—¶ï¼Œæ¥å…¥&lt;strong&gt;Tracingï¼ˆè¿½è¸ªï¼‰&lt;/strong&gt;ç³»ç»Ÿå˜å¾—éå¸¸é‡è¦ã€‚æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿå®æ—¶è·Ÿè¸ªAgentä¸LLMçš„æ¯ä¸€æ¬¡äº¤äº’ã€ä¸Šä¸‹æ–‡å†…å®¹ã€å·¥å…·è°ƒç”¨æƒ…å†µä»¥åŠæ‰§è¡Œç»“æœï¼Œè¿™æ ·æ‰èƒ½åœ¨å‡ºç°é—®é¢˜æ—¶å¿«é€Ÿå®šä½å’Œè°ƒè¯•ï¼Œè¿›è€Œä¼˜åŒ–æˆ‘ä»¬çš„Promptæˆ–è€…Agenté€»è¾‘ã€‚&lt;/p&gt;

&lt;h3 id=&#34;5-å¤šagentåä½œ-ä¸“ä¸šçš„äº‹äº¤ç»™ä¸“ä¸šçš„agent&#34;&gt;5. å¤šAgentåä½œï¼šä¸“ä¸šçš„äº‹äº¤ç»™ä¸“ä¸šçš„Agent&lt;/h3&gt;

&lt;p&gt;éšç€Manusçš„æµè¡Œï¼Œ&lt;strong&gt;å¤šAgentç¼–æ’ï¼ˆMulti-Agent Orchestrationï¼‰&lt;/strong&gt;çš„ç†å¿µä¹Ÿå¼€å§‹å—åˆ°å…³æ³¨ã€‚æ ¸å¿ƒæ€è·¯æ˜¯&lt;strong&gt;åŒ–æ•´ä¸ºé›¶ï¼Œåˆ†å·¥åä½œ&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä¸å†è¯•å›¾æ„å»ºä¸€ä¸ªâ€œä¸‡èƒ½â€çš„è¶…çº§Agentï¼Œè€Œæ˜¯å°†å¤æ‚çš„ä»»åŠ¡æ‹†è§£ï¼Œæ„å»ºå¤šä¸ª&lt;strong&gt;åŠŸèƒ½å•ä¸€ã€èŒè´£æ˜ç¡®&lt;/strong&gt;çš„&lt;strong&gt;ä¸“å®¶Agent&lt;/strong&gt;ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ&lt;code&gt;web_search&lt;/code&gt;å’Œ&lt;code&gt;web_fetch&lt;/code&gt;è¿™ä¸¤ä¸ªå·¥å…·ç»„åˆèµ·æ¥ï¼Œå°è£…æˆä¸€ä¸ªä¸“é—¨è´Ÿè´£ç½‘é¡µæŠ“å–çš„&lt;code&gt;web_scraper_agent&lt;/code&gt;ã€‚è¿™ç§å•ä¸€åŠŸèƒ½çš„Agentï¼Œå®ƒçš„å¤§è„‘ï¼ˆLLMï¼‰å¯èƒ½ä¸éœ€è¦æœ€é¡¶çº§çš„æ¨ç†èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥é€‰ç”¨ä¸€ä¸ª&lt;strong&gt;æ€§èƒ½è¶³å¤Ÿä¸”æˆæœ¬æ›´ä½&lt;/strong&gt;çš„æ¨¡å‹ï¼ˆæ¯”å¦‚ä¸€äº›ä¸­å°å‹æ¨¡å‹æˆ–è€…ç‰¹å®šé¢†åŸŸçš„å¾®è°ƒæ¨¡å‹ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;å½“æˆ‘ä»¬æœ‰äº†å¤šä¸ªè¿™æ ·çš„ä¸“å®¶Agentåï¼Œå†å¼•å…¥ä¸€ä¸ª&lt;strong&gt;Planner Agentï¼ˆè§„åˆ’å™¨Agentï¼‰&lt;/strong&gt;ã€‚è¿™ä¸ªPlanner Agenté€šå¸¸éœ€è¦ä¸€ä¸ª&lt;strong&gt;æ¨ç†èƒ½åŠ›è¾ƒå¼º&lt;/strong&gt;çš„LLMä½œä¸ºå¤§è„‘ï¼Œå®ƒçš„èŒè´£æ˜¯ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æ¥æ”¶ç”¨æˆ·çš„åŸå§‹ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;å°†ä»»åŠ¡æ‹†è§£æˆè‹¥å¹²å­æ­¥éª¤ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®æ¯ä¸ªå­æ­¥éª¤çš„éœ€æ±‚ï¼Œé€‰æ‹©å¹¶è°ƒç”¨åˆé€‚çš„ä¸“å®¶Agentã€‚&lt;/li&gt;
&lt;li&gt;æ”¶é›†ä¸“å®¶Agentçš„æ‰§è¡Œç»“æœã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®æ‰§è¡Œç»“æœï¼ŒåŠ¨æ€è°ƒæ•´åç»­çš„è®¡åˆ’ï¼ˆå¯èƒ½éœ€è¦é‡æ–°è§„åˆ’æˆ–è°ƒç”¨å…¶ä»–Agentï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¾ªç¯è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æœ€ç»ˆä»»åŠ¡å®Œæˆï¼Œç„¶åå°†ç»“æœæ±‡æ€»è¿”å›ç»™ç”¨æˆ·ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™ç§å¤šAgentæ¶æ„å¸¦æ¥çš„å¥½å¤„æ˜¾è€Œæ˜“è§ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æˆæœ¬æ•ˆç›Š&lt;/strong&gt;ï¼šåœ¨å¤§é‡æ‰§è¡Œå…·ä½“ä»»åŠ¡çš„ä¸“å®¶Agentä¸Šå¯ä»¥ä½¿ç”¨æ›´ä¾¿å®œçš„LLMã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»´æŠ¤æ€§&lt;/strong&gt;ï¼šæ¯ä¸ªAgentåŠŸèƒ½å•ä¸€ï¼Œæ›´å®¹æ˜“å¼€å‘ã€æµ‹è¯•å’Œç»´æŠ¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æ€§&lt;/strong&gt;ï¼šå¯ä»¥æ–¹ä¾¿åœ°å¢åŠ æ–°çš„ä¸“å®¶Agentæ¥æ‰©å±•æ•´ä¸ªç³»ç»Ÿçš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯èƒ½æ›´ä¼˜åŒ–çš„ä¸Šä¸‹æ–‡ç®¡ç†&lt;/strong&gt;ï¼šPlanner Agentå¯èƒ½åªéœ€è¦å…³æ³¨å­ä»»åŠ¡çš„ç›®æ ‡å’Œä¸“å®¶Agentè¿”å›çš„å…³é”®ç»“æœï¼Œè€Œä¸éœ€è¦æ‰¿è½½æ‰€æœ‰åº•å±‚å·¥å…·è°ƒç”¨çš„è¯¦ç»†ä¸Šä¸‹æ–‡ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;6-promptå·¥ç¨‹-agentçš„çµé­‚&#34;&gt;6. Promptå·¥ç¨‹ï¼šAgentçš„çµé­‚&lt;/h3&gt;

&lt;p&gt;æ— è®ºæ˜¯ä½¿ç”¨ReActè¿˜æ˜¯CodeActï¼Œæ— è®ºæ˜¯å•Agentæ¶æ„è¿˜æ˜¯å¤šAgentç¼–æ’ï¼Œæœ‰ä¸€ä¸ªç¯èŠ‚å§‹ç»ˆæ˜¯ç»•ä¸å¼€çš„ï¼Œé‚£å°±æ˜¯&lt;strong&gt;Prompt Engineeringï¼ˆæç¤ºå·¥ç¨‹ï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€ä¸ªä¸LLMäº¤äº’çš„ç¯èŠ‚ï¼ˆæ— è®ºæ˜¯Planner Agentåˆ¶å®šè®¡åˆ’ï¼Œè¿˜æ˜¯ä¸“å®¶Agentæ‰§è¡Œä»»åŠ¡ï¼Œæˆ–æ˜¯Function Calling/CodeActçš„è§¦å‘ï¼‰&lt;strong&gt;ç²¾å¿ƒè®¾è®¡Prompt&lt;/strong&gt;ã€‚å¥½çš„Promptéœ€è¦èƒ½å¤Ÿå¼•å¯¼LLMæŒ‰ç…§æˆ‘ä»¬çš„é¢„æœŸæ¥æ€è€ƒå’Œè¾“å‡ºï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è®©Planner Agentç”Ÿæˆ&lt;strong&gt;ç»“æ„åŒ–ã€å¯åˆ†æ­¥æ‰§è¡Œ&lt;/strong&gt;çš„è®¡åˆ’ã€‚&lt;/li&gt;
&lt;li&gt;è®©LLMåœ¨éœ€è¦æ—¶&lt;strong&gt;å‡†ç¡®åœ°é€‰æ‹©å¹¶è°ƒç”¨&lt;/strong&gt;æˆ‘ä»¬æä¾›çš„å·¥å…·ã€‚&lt;/li&gt;
&lt;li&gt;è®©LLMè¿”å›&lt;strong&gt;æ ¼å¼è§„èŒƒã€æ˜“äºè§£æ&lt;/strong&gt;çš„æ–‡æœ¬ï¼ˆæ¯”å¦‚JSONï¼‰ï¼Œæ–¹ä¾¿Agent Runtimeå¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¯ä»¥è¯´ï¼ŒPromptå°±æ˜¯æˆ‘ä»¬ç»™AI Agentæ³¨å…¥çµé­‚çš„æ–¹å¼ã€‚&lt;/p&gt;

&lt;h3 id=&#34;7-mcp-agenté—´æ²Ÿé€šçš„æ ‡å‡†è¯­&#34;&gt;7. MCPï¼šAgenté—´æ²Ÿé€šçš„æ ‡å‡†è¯­&lt;/h3&gt;

&lt;p&gt;éšç€å¤šAgentæ¶æ„çš„å…´èµ·ï¼ŒAgentä¹‹é—´å¦‚ä½•å‘ç°å½¼æ­¤ã€å¦‚ä½•è°ƒç”¨å½¼æ­¤çš„èƒ½åŠ›å°±æˆäº†ä¸€ä¸ªé—®é¢˜ã€‚è¿™æ—¶ï¼Œ&lt;strong&gt;MCPï¼ˆModel Context Protocolï¼‰&lt;/strong&gt;è¿™ä¸ªæ¦‚å¿µåº”è¿è€Œç”Ÿã€‚&lt;/p&gt;

&lt;p&gt;ä½ å¯ä»¥æŠŠMCPç†è§£ä¸ºä¸€å¥—&lt;strong&gt;ä¸ºAgentï¼ˆæˆ–è€…è¯´LLMçš„å·¥å…·ï¼‰è®¾è®¡çš„æ ‡å‡†åŒ–æ¥å£è§„èŒƒ&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æ²¡æœ‰MCPä¹‹å‰ï¼Œæˆ‘ä»¬å®ç°çš„å·¥å…·å¯èƒ½äº”èŠ±å…«é—¨ï¼šä¸€æ®µæœ¬åœ°Pythonä»£ç ã€ä¸€ä¸ªå†…éƒ¨HTTP APIè°ƒç”¨ã€ä¸€ä¸ªç¬¬ä¸‰æ–¹äº‘æœåŠ¡æ¥å£ç­‰ç­‰ã€‚æ¯æ¬¡è¦ç»™Agentæ·»åŠ æ–°å·¥å…·ï¼Œéƒ½éœ€è¦æ‰‹åŠ¨ç¼–å†™å…³äºè¿™ä¸ªå·¥å…·çš„æè¿°ï¼ˆåŠŸèƒ½ã€å‚æ•°ã€æ ¼å¼ï¼‰ï¼Œç„¶åæ³¨å…¥åˆ°Agentçš„ä¸Šä¸‹æ–‡ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰äº†MCPä¹‹åï¼Œæƒ…å†µå°±å¯èƒ½å˜å¾—æ›´è§„èŒƒï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å·¥å…·æä¾›æ–¹å¯ä»¥å°†å…¶èƒ½åŠ›å°è£…æˆä¸€ä¸ªéµå¾ªMCPåè®®çš„&lt;strong&gt;MCP Server&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Agentå¯ä»¥é€šè¿‡æ ‡å‡†çš„MCPæ–¹æ³•ï¼ˆæ¯”å¦‚&lt;code&gt;list_tools&lt;/code&gt;ï¼‰æ¥&lt;strong&gt;åŠ¨æ€å‘ç°&lt;/strong&gt;æŸä¸ªMCP Serveræä¾›äº†å“ªäº›å·¥å…·åŠå…¶æè¿°ã€‚&lt;/li&gt;
&lt;li&gt;Agentå¯ä»¥é€šè¿‡æ ‡å‡†çš„MCP &lt;strong&gt;RPC Call&lt;/strong&gt;æ¥æ‰§è¡Œè¿™äº›å·¥å…·ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;MCPä¸ä»…ä»…è§„èŒƒäº†å·¥å…·çš„è°ƒç”¨ï¼Œå®ƒé€šå¸¸ä¹Ÿè¯•å›¾è§„èŒƒ&lt;strong&gt;Promptæ¨¡æ¿ã€èµ„æºç®¡ç†&lt;/strong&gt;ç­‰Agentå¼€å‘ä¸­å¸¸è§çš„å…ƒç´ ã€‚å¦‚æœMCPèƒ½å¤Ÿè¢«å¹¿æ³›é‡‡ç”¨ï¼Œç†è®ºä¸Šå¯ä»¥ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é™ä½Agentçš„å¼€å‘é—¨æ§›&lt;/strong&gt;ï¼šå¼€å‘è€…å¯ä»¥ç›´æ¥å¤ç”¨ç¤¾åŒºæä¾›çš„ã€éµå¾ªMCPæ ‡å‡†çš„å·¥å…·æœåŠ¡ï¼Œè€Œä¸éœ€è¦è‡ªå·±é‡å¤å®ç°å’Œæè¿°å·¥å…·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æé«˜Agentçš„äº’æ“ä½œæ€§&lt;/strong&gt;ï¼šä¸åŒå¼€å‘è€…ã€ä¸åŒå›¢é˜Ÿå¼€å‘çš„Agentæˆ–è®¸èƒ½æ›´å®¹æ˜“åœ°è¿›è¡Œåä½œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å½“ç„¶ï¼ŒMCPç›®å‰ä¼¼ä¹è¿˜åœ¨å‘å±•åˆæœŸï¼Œä½†å®ƒæŒ‡æ˜äº†ä¸€ä¸ªè®©Agentç”Ÿæ€æ›´åŠ è§„èŒƒåŒ–ã€æ ‡å‡†åŒ–çš„æ–¹å‘ã€‚&lt;/p&gt;

&lt;h3 id=&#34;8-æ€»ç»“-é—¨æ§›ä¸é«˜-ç²¾é€šä¸æ˜“&#34;&gt;8. æ€»ç»“ï¼šé—¨æ§›ä¸é«˜ï¼Œç²¾é€šä¸æ˜“&lt;/h3&gt;

&lt;p&gt;ä»¥ä¸Šå°±æ˜¯æˆ‘è¿™æ®µæ—¶é—´å­¦ä¹ ä¸‹æ¥ï¼Œå¯¹AI Agentå’ŒMCPçš„ä¸€äº›ç²—æµ…ç†è§£ã€‚åœ¨é˜…è¯»äº†å‡ ä¸ªå¼€æºçš„Manuså®ç°ï¼ˆæˆ–è€…ç±»ä¼¼çš„å¤šAgentæ¡†æ¶ï¼‰ä¹‹åï¼Œæˆ‘çš„ä¸€ä¸ªç›´è§‚æ„Ÿå—æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;å¯¹äºæŒæ¡Pythonçš„ç¨‹åºå‘˜æ¥è¯´ï¼Œä¸Šæ‰‹å¼€å‘ä¸€ä¸ªåŸºç¡€çš„AI Agentï¼Œæˆ–è€…ç¼–å†™ä¸€ä¸ªç®€å•çš„Tool/MCP Serverï¼Œ&lt;strong&gt;æŠ€æœ¯é—¨æ§›ä¼¼ä¹å¹¶ä¸ç®—ç‰¹åˆ«é«˜&lt;/strong&gt;ã€‚å¾ˆå¤šæ¡†æ¶ï¼ˆå¦‚LangChainã€LlamaIndexç­‰ï¼‰å·²ç»å¸®æˆ‘ä»¬å¤„ç†äº†ä¸LLMäº¤äº’ã€ç®¡ç†ä¸Šä¸‹æ–‡ã€æ‰§è¡Œå·¥å…·ç­‰ç¹ççš„åº•å±‚å·¥ä½œã€‚&lt;/p&gt;

&lt;p&gt;ç„¶è€Œï¼Œ&lt;strong&gt;çœŸæ­£çš„æŒ‘æˆ˜åœ¨äº&lt;/strong&gt;ï¼šå¦‚ä½•åœ¨ä¸€ä¸ª&lt;strong&gt;ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯&lt;/strong&gt;ä¸‹ï¼Œè®¾è®¡å’Œå®ç°ä¸€ä¸ª&lt;strong&gt;ç¨³å®šã€å¯é ã€é«˜æ•ˆ&lt;/strong&gt;çš„AI Agentã€‚è¿™éœ€è¦ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ·±åˆ»ç†è§£ä¸šåŠ¡éœ€æ±‚&lt;/strong&gt;ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºé€‚åˆAgentæ‰§è¡Œçš„ä»»åŠ¡æµç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç²¾å¿ƒçš„Promptè®¾è®¡ä¸è°ƒä¼˜&lt;/strong&gt;ï¼Œä¸æ–­å°è¯•ï¼Œå¼•å¯¼LLMç»™å‡ºæœŸæœ›çš„è¾“å‡ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœ‰æ•ˆçš„Tracingå’ŒDebugging&lt;/strong&gt;ï¼Œå¿«é€Ÿå®šä½Agentæ‰§è¡Œè¿‡ç¨‹ä¸­çš„é—®é¢˜å¹¶è¿›è¡Œä¿®å¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆç†çš„æ¶æ„é€‰æ‹©&lt;/strong&gt;ï¼ˆå•Agent vs å¤šAgentï¼ŒReAct vs CodeActï¼‰å’Œ&lt;strong&gt;æˆæœ¬æ§åˆ¶&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å°±åƒå½“å¹´æˆ‘ä»¬ä»å†™ç®€å•è„šæœ¬åˆ°æ„å»ºå¤æ‚ç³»ç»Ÿä¸€æ ·ï¼ŒAI Agentçš„ä¸–ç•Œä¹Ÿæ˜¯æ˜“å­¦éš¾ç²¾ã€‚å·¥å…·å’Œæ¡†æ¶é™ä½äº†å…¥é—¨é—¨æ§›ï¼Œä½†è¦åšå‡ºçœŸæ­£å¥½ç”¨çš„Agentï¼Œè¿˜éœ€è¦å¤§é‡çš„å®è·µã€æ€è€ƒå’Œæ‰“ç£¨ã€‚&lt;/p&gt;

&lt;h3 id=&#34;9-å‚è€ƒ&#34;&gt;9. å‚è€ƒ&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://arthurchiao.art/blog/ai-agent-white-paper-zh/&#34;&gt;Google AI Agentï¼ˆæ™ºèƒ½ä½“ï¼‰æŠ€æœ¯ç™½çš®ä¹¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://arthurchiao.art/blog/build-effective-ai-agent-zh/&#34;&gt;Anthropic AI Workflow &amp;amp; AI Agentï¼šæ¶æ„ã€æ¨¡å¼ä¸å·¥ç¨‹å»ºè®®&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://huggingface.co/learn/agents-course/zh-CN/unit0/introduction&#34;&gt;Hugging Face AI Agents è¯¾ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/liaokongVFX/MCP-Chinese-Getting-Started-Guide&#34;&gt;Model Context Protocol(MCP) ç¼–ç¨‹æé€Ÿå…¥é—¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/liaokongVFX/LangChain-Chinese-Getting-Started-Guide&#34;&gt;LangChain ä¸­æ–‡å…¥é—¨æ•™ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mannaandpoem/OpenManus&#34;&gt;OpenManus&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/Darwin-lfl/langmanus&#34;&gt;LangManus&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>äº‘åŸç”Ÿå¼€å‘å…¥é—¨</title>
      <link>https://zhu327.github.io/2025/03/28/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/</link>
      <pubDate>Fri, 28 Mar 2025 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/03/28/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/</guid>
      <description>&lt;p&gt;ä½œä¸ºä¸€ååœ¨äº‘åŸç”Ÿé¢†åŸŸæ‘¸çˆ¬æ»šæ‰“äº†ä¸€æ®µæ—¶é—´çš„å¼€å‘è€…ï¼Œæˆ‘æ—¶å¸¸ä¼šé‡åˆ°ä¸€äº›åˆšæ¥è§¦è¿™ä¸ªé¢†åŸŸçš„æœ‹å‹ï¼Œä»–ä»¬é¢å¯¹ Kubernetes (K8s)ã€å®¹å™¨è¿™äº›æ¦‚å¿µæ—¶ï¼Œå¸¸å¸¸æ„Ÿåˆ°æœ‰äº›è¿·èŒ«ï¼Œä¸çŸ¥é“ä»ä½•å­¦èµ·ã€‚è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘æƒ³ç»“åˆè‡ªå·±çš„ä¸€äº›å­¦ä¹ ä½“ä¼šï¼Œä¸ºæƒ³è¦å…¥é—¨äº‘åŸç”Ÿå¼€å‘çš„åŒå­¦æä¾›ä¸€ä¸ªç›¸å¯¹æ¸…æ™°çš„æŒ‡å¼•ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘è‡ªå·±å¹¶éç§‘ç­å‡ºèº«ï¼Œä»æœ€åˆæ¥è§¦è½¯ä»¶æµ‹è¯•å†™ Lua è„šæœ¬ï¼Œåˆ°åæ¥å­¦ä¹  Python åšåç«¯ï¼Œå†åˆ°è¿›å…¥è…¾è®¯æ¥è§¦ Golang å’Œ K8s ç›¸å…³å¼€å‘ï¼Œä¸€è·¯èµ°æ¥ä¹Ÿè¸©äº†ä¸å°‘å‘ã€‚äº‘åŸç”ŸæŠ€æœ¯æ ˆç¡®å®åºå¤§ï¼Œä½†æ ¸å¿ƒçš„ç†å¿µæ˜¯åˆ©ç”¨å®¹å™¨ã€å¾®æœåŠ¡ã€å£°æ˜å¼ API ç­‰æ–¹å¼ï¼Œå»æ„å»ºæ›´å¯é ã€æ›´å…·å¼¹æ€§çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚è€Œ K8s ä½œä¸ºè¿™ä¸ªç”Ÿæ€çš„æ ¸å¿ƒç¼–æ’å¼•æ“ï¼Œå¯ä»¥è¯´æ˜¯æˆ‘ä»¬å¿…é¡»æŒæ¡çš„å…³é”®æŠ€èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¼šä»åŸºç¡€æ¦‚å¿µèŠèµ·ï¼Œåˆ†äº«å‡ æœ¬æˆ‘å­¦ä¹ è¿‡ç¨‹ä¸­è§‰å¾—éå¸¸æœ‰å¸®åŠ©çš„ä¹¦ç±ï¼Œä¸€ä¸ªä¸é”™çš„ç¤¾åŒºæ–‡ç« é›†åˆï¼Œä»¥åŠä¸¤ä¸ªå¯ä»¥åŠ¨æ‰‹å®è·µçš„ä»£ç é¡¹ç›®ã€‚æœ€åï¼Œè¿˜ä¼šç»“åˆå®é™…å·¥ä½œç»éªŒï¼ŒèŠèŠ K8s è¿ç»´å®è·µä¸­ä¸€äº›é‡è¦çš„äº‹æƒ…ã€‚å¸Œæœ›è¿™äº›èƒ½å¸®åŠ©å¤§å®¶åœ¨å­¦ä¹ äº‘åŸç”Ÿçš„è·¯ä¸Šå°‘èµ°ä¸€äº›å¼¯è·¯ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;ä¸€-äº‘åŸç”Ÿä¸-kubernetes-ä»åŸºç¡€æ¦‚å¿µå¼€å§‹&#34;&gt;ä¸€ã€äº‘åŸç”Ÿä¸ Kubernetesï¼šä»åŸºç¡€æ¦‚å¿µå¼€å§‹&lt;/h2&gt;

&lt;h3 id=&#34;äº‘åŸç”Ÿåˆ°åº•æ˜¯ä»€ä¹ˆ&#34;&gt;äº‘åŸç”Ÿåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;

&lt;p&gt;æˆ‘ç†è§£çš„äº‘åŸç”Ÿï¼ˆCloud Nativeï¼‰ï¼Œå®ƒä¸æ˜¯æŒ‡æŸä¸€ä¸ªå…·ä½“çš„æŠ€æœ¯ï¼Œæ›´åƒæ˜¯ä¸€ç§é¢å‘äº‘ç¯å¢ƒçš„åº”ç”¨è®¾è®¡ã€å¼€å‘å’Œéƒ¨ç½²çš„æœ€ä½³å®è·µé›†åˆã€‚å®ƒé¼“åŠ±æˆ‘ä»¬ä½¿ç”¨åƒå®¹å™¨ã€å¾®æœåŠ¡ã€ä¸å¯å˜åŸºç¡€è®¾æ–½ã€å£°æ˜å¼ API è¿™äº›æŠ€æœ¯å’Œæ–¹æ³•ï¼Œç›®æ ‡æ˜¯è®©æˆ‘ä»¬çš„åº”ç”¨èƒ½æ›´å¥½åœ°åˆ©ç”¨äº‘è®¡ç®—çš„å¼¹æ€§ã€åˆ†å¸ƒå¼ã€è‡ªåŠ¨åŒ–ç­‰ä¼˜åŠ¿ã€‚æ ¹æ® CNCFï¼ˆäº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šï¼‰çš„å®šä¹‰ï¼Œè¿™äº›æ˜¯å…³é”®è¦ç´ ã€‚ç®€å•è¯´ï¼Œå°±æ˜¯è®©åº”ç”¨ä¸ºäº‘è€Œç”Ÿï¼Œèƒ½åœ¨äº‘ä¸Šè¿è¡Œå¾—æ›´å¥½ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä¸ºä»€ä¹ˆ-kubernetes-è¿™ä¹ˆé‡è¦&#34;&gt;ä¸ºä»€ä¹ˆ Kubernetes è¿™ä¹ˆé‡è¦ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;å®¹å™¨æŠ€æœ¯ï¼ˆæ¯”å¦‚ Dockerï¼‰è§£å†³äº†ç¯å¢ƒä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä½†å½“ä½ æœ‰æˆç™¾ä¸Šåƒä¸ªå®¹å™¨éœ€è¦ç®¡ç†æ—¶ï¼Œæ‰‹åŠ¨æ“ä½œå°±å˜å¾—ä¸ç°å®äº†ã€‚Kubernetes å°±æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚å®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨ç¼–æ’å¹³å°ï¼Œæœ€åˆç”± Google å¼€å‘ï¼Œç°åœ¨ç”± CNCF ç»´æŠ¤ã€‚å®ƒå¯ä»¥è‡ªåŠ¨åŒ–åœ°å®Œæˆåº”ç”¨çš„éƒ¨ç½²ã€æ‰©ç¼©å®¹ã€æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€æ•…éšœæ¢å¤ç­‰ä¸€ç³»åˆ—å¤æ‚å·¥ä½œã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒæŒæ¡ K8s æ˜¯è¿›å…¥ç°ä»£åç«¯å¼€å‘ã€ç‰¹åˆ«æ˜¯å¹³å°å·¥ç¨‹é¢†åŸŸçš„ä¸€å¼ é‡è¦é—¨ç¥¨ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æˆ‘çš„å­¦ä¹ è·¯å¾„å»ºè®®&#34;&gt;æˆ‘çš„å­¦ä¹ è·¯å¾„å»ºè®®ï¼š&lt;/h3&gt;

&lt;p&gt;å›é¡¾æˆ‘è‡ªå·±çš„å­¦ä¹ è¿‡ç¨‹ï¼Œæˆ‘å»ºè®®å¯ä»¥æŒ‰ä»¥ä¸‹æ­¥éª¤æ¥ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…ˆææ‡‚å®¹å™¨&lt;/strong&gt;ï¼šç†è§£ Docker çš„åŸºæœ¬æ¦‚å¿µï¼Œæ¯”å¦‚é•œåƒï¼ˆImageï¼‰ã€å®¹å™¨ï¼ˆContainerï¼‰ã€Dockerfileï¼Œèƒ½è‡ªå·±åŠ¨æ‰‹æ„å»ºã€è¿è¡Œä¸€ä¸ªç®€å•çš„å®¹å™¨åŒ–åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†æ·±å…¥ K8s æ ¸å¿ƒ&lt;/strong&gt;ï¼šå­¦ä¹  K8s çš„æ ¸å¿ƒç»„ä»¶ï¼ˆæ¯”å¦‚ Podã€Serviceã€Deploymentã€StatefulSetã€Namespace ç­‰ï¼‰éƒ½æ˜¯åšä»€ä¹ˆçš„ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯å¦‚ä½•åä½œçš„ã€‚äº†è§£æ§åˆ¶å¹³é¢ï¼ˆMasterï¼‰å’Œæ•°æ®å¹³é¢ï¼ˆNodeï¼‰çš„åŸºæœ¬å·¥ä½œåŸç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ‰‹å®è·µæ˜¯å…³é”®&lt;/strong&gt;ï¼šç†è®ºå­¦ä¹ åï¼Œä¸€å®šè¦åŠ¨æ‰‹å®è·µã€‚å°è¯•ç¼–å†™ YAML æ–‡ä»¶éƒ¨ç½²åº”ç”¨ï¼Œä½¿ç”¨ &lt;code&gt;kubectl&lt;/code&gt; ä¸é›†ç¾¤äº¤äº’ã€‚ç„¶åå¯ä»¥å»æ¢ç´¢å­˜å‚¨ï¼ˆVolumes, PV, PVCï¼‰ã€ç½‘ç»œï¼ˆIngress, CNIï¼‰ã€é…ç½®ï¼ˆConfigMap, Secretï¼‰ç­‰æ›´æ·±å…¥çš„ä¸»é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç†è§£è¿ç»´è§†è§’&lt;/strong&gt;ï¼šå¼€å‘çš„åº”ç”¨æœ€ç»ˆè¦è·‘åœ¨ç”Ÿäº§ç¯å¢ƒã€‚äº†è§£ K8s é›†ç¾¤çš„ç›‘æ§ã€æ—¥å¿—ã€å‘Šè­¦ã€æ’é”™ç­‰è¿ç»´å®è·µï¼Œå¯¹äºå†™å‡ºæ›´å¥å£®ã€æ›´æ˜“äºç»´æŠ¤çš„åº”ç”¨éå¸¸æœ‰å¸®åŠ©ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ¥ä¸‹æ¥ï¼Œåˆ†äº«ä¸€äº›æˆ‘åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ç”¨è¿‡ä¸”è§‰å¾—ä¸é”™çš„èµ„æºã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;äºŒ-æ¨èä¹¦ç±-ç†è®ºä¸å®è·µç»“åˆ&#34;&gt;äºŒã€æ¨èä¹¦ç±ï¼šç†è®ºä¸å®è·µç»“åˆ&lt;/h2&gt;

&lt;p&gt;å¸‚é¢ä¸Šå…³äº K8s çš„ä¹¦ä¸å°‘ï¼Œä½†ä¸‹é¢è¿™ä¸¤æœ¬æ˜¯æˆ‘ä¸ªäººè§‰å¾—éå¸¸ç»å…¸ï¼Œå€¼å¾—èŠ±æ—¶é—´å»è¯»çš„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-kubernetes-in-action&#34;&gt;1. ã€ŠKubernetes in Actionã€‹&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è±†ç“£è¯„åˆ†å‚è€ƒ&lt;/strong&gt;ï¼š8.8 åˆ†&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æˆ‘çš„æ¨èç†ç”±&lt;/strong&gt;ï¼š
è¿™æœ¬ä¹¦éå¸¸ä¾§é‡å®è·µã€‚ä½œè€… Marko LukÅ¡a é€šè¿‡å¤§é‡å¯æ“ä½œçš„ä¾‹å­ï¼Œä¸€æ­¥æ­¥å¸¦ä½ ä¸Šæ‰‹ K8sã€‚ä»æœ€åŸºç¡€çš„ Podã€Service åˆ° Deployment å®ç°æ»šåŠ¨æ›´æ–°ï¼Œéƒ½è®²å¾—å¾ˆæ¸…æ¥šã€‚å¯¹äºåˆšå…¥é—¨ K8sï¼Œå¸Œæœ›å¿«é€Ÿçœ‹åˆ°æ•ˆæœã€å»ºç«‹ä¿¡å¿ƒçš„åŒå­¦æ¥è¯´ï¼Œè¿™æœ¬ä¹¦æ˜¯æå¥½çš„é€‰æ‹©ã€‚æˆ‘å½“åˆå°±æ˜¯è·Ÿç€è¿™æœ¬ä¹¦æ•²ä»£ç ï¼Œå¯¹ K8s çš„åŸºæœ¬æ“ä½œæœ‰äº†ç›´è§‚çš„è®¤è¯†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ä»¥é‡ç‚¹å…³æ³¨çš„ç« èŠ‚&lt;/strong&gt;ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 2 ç« &lt;/strong&gt;ï¼šç”¨ä¸€ä¸ª Node.js ä¾‹å­å¸¦ä½ è·‘é€šç¬¬ä¸€ä¸ª K8s åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 5 ç« &lt;/strong&gt;ï¼šè®²è§£ Serviceï¼Œç†è§£åº”ç”¨å¦‚ä½•è¢«è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 9 ç« &lt;/strong&gt;ï¼šè®²è§£ Deploymentï¼ŒæŒæ¡åº”ç”¨å‘å¸ƒçš„æ ¸å¿ƒæ–¹å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚åˆè°&lt;/strong&gt;ï¼šK8s æ–°æ‰‹ï¼Œç‰¹åˆ«æ˜¯å–œæ¬¢é€šè¿‡åŠ¨æ‰‹å®è·µæ¥å­¦ä¹ çš„å¼€å‘è€…ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;2-æ·±å…¥å‰–æ-kubernetes&#34;&gt;2. ã€Šæ·±å…¥å‰–æ Kubernetesã€‹&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è±†ç“£è¯„åˆ†å‚è€ƒ&lt;/strong&gt;ï¼š9.3 åˆ†&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æˆ‘çš„æ¨èç†ç”±&lt;/strong&gt;ï¼š
å¼ ç£Šå¤§ä½¬å†™çš„è¿™æœ¬ä¹¦ï¼Œæ›´ä¾§é‡äº K8s çš„è®¾è®¡ç†å¿µå’Œåº•å±‚å®ç°åŸç†ã€‚å¦‚æœä½ ä¸æ»¡è¶³äºä»…ä»…ä¼šç”¨ K8sï¼Œè¿˜æƒ³çŸ¥é“å®ƒå†…éƒ¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼ˆæ¯”å¦‚è°ƒåº¦å™¨å¦‚ä½•å†³ç­–ï¼Ÿç½‘ç»œ CNI å¦‚ä½•å®ç°ï¼Ÿï¼‰ï¼Œé‚£è¿™æœ¬ä¹¦ç»å¯¹å€¼å¾—ä¸€è¯»ã€‚å¯¹æˆ‘è‡ªå·±è€Œè¨€ï¼Œé˜…è¯»è¿™æœ¬ä¹¦åŠ æ·±äº†æˆ‘å¯¹ K8s æ¶æ„çš„ç†è§£ï¼Œå¯¹äºåæ¥åšä¸€äº› K8s ç›¸å…³çš„å¼€å‘å·¥ä½œéå¸¸æœ‰å¸®åŠ©ã€‚å®ƒä¸ä»…ä»…æ˜¯è®²æŠ€æœ¯ï¼Œè¿˜èå…¥äº†ä½œè€…åœ¨ä¸€çº¿çš„å®è·µæ€è€ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ä»¥é‡ç‚¹å…³æ³¨çš„ç« èŠ‚&lt;/strong&gt;ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 3 ç« &lt;/strong&gt;ï¼šK8s æ•´ä½“æ¶æ„å’Œè®¾è®¡å“²å­¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 5 ç« &lt;/strong&gt;ï¼šæ§åˆ¶å™¨ï¼ˆControllerï¼‰å’Œç¼–æ’åŸç†ï¼Œè¿™æ˜¯ K8s è‡ªåŠ¨åŒ–çš„æ ¸å¿ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ 7 ç« &lt;/strong&gt;ï¼šç½‘ç»œåŸç†ï¼ŒCNIã€Service ç­‰æœºåˆ¶è®²å¾—å¾ˆé€å½»ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚åˆè°&lt;/strong&gt;ï¼šå¯¹ K8s æœ‰ä¸€å®šåŸºç¡€ï¼Œæƒ³æ·±å…¥ç†è§£å…¶å·¥ä½œåŸç†å’Œè®¾è®¡æ€æƒ³çš„å¼€å‘è€…ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;æ€ä¹ˆé€‰ï¼Ÿ&lt;/strong&gt; æˆ‘çš„å»ºè®®æ˜¯ï¼Œå¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œå¯ä»¥å…ˆçœ‹ã€ŠKubernetes in Actionã€‹åŠ¨æ‰‹å®è·µï¼Œå»ºç«‹åŸºæœ¬æ¦‚å¿µï¼›ç„¶åå†è¯»ã€Šæ·±å…¥å‰–æ Kubernetesã€‹åŠ æ·±ç†è§£ã€‚å¦‚æœä½ å·²ç»æœ‰åŸºç¡€ï¼Œå¯ä»¥ç›´æ¥çœ‹ã€Šæ·±å…¥å‰–æ Kubernetesã€‹ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;ä¸‰-ç¤¾åŒºæ–‡ç« åˆé›†-k8s-club&#34;&gt;ä¸‰ã€ç¤¾åŒºæ–‡ç« åˆé›†ï¼šK8s Club&lt;/h2&gt;

&lt;p&gt;é™¤äº†ä¹¦ç±ï¼Œç¤¾åŒºé‡Œä¹Ÿæœ‰å¾ˆå¤šé«˜è´¨é‡çš„æ–‡ç« ã€‚æˆ‘ä¸ªäººæ¯”è¾ƒå…³æ³¨ &lt;a href=&#34;https://github.com/k8s-club/k8s-club&#34;&gt;K8s Club&lt;/a&gt; è¿™ä¸ª GitHub ä»“åº“ã€‚&lt;/p&gt;

&lt;p&gt;å®ƒæ±‡é›†äº†ä¸å°‘å›½å†…äº‘åŸç”Ÿå¼€å‘è€…æ’°å†™çš„æŠ€æœ¯æ–‡ç« ï¼Œå†…å®¹è¦†ç›–ä»åŸºç¡€åˆ°è¿›é˜¶ï¼Œä¹Ÿæœ‰æºç åˆ†æå’Œå®è·µç»éªŒåˆ†äº«ï¼Œè´¨é‡æ™®éä¸é”™ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å€¼å¾—å…³æ³¨çš„å†…å®¹&#34;&gt;å€¼å¾—å…³æ³¨çš„å†…å®¹ï¼š&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¦‚å¿µæ¢³ç†ä¸å…¥é—¨&lt;/strong&gt;ï¼šæ¯”å¦‚ç”¨é—®ç­”å½¢å¼æ€»ç»“ K8s æ ¸å¿ƒæ¦‚å¿µçš„æ–‡ç« ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çŸ¥è¯†å›¾è°±&lt;/strong&gt;ï¼šå¸®åŠ©ä½ äº†è§£ K8s çš„æ•´ä½“çŸ¥è¯†ä½“ç³»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒç»„ä»¶åŸç†åˆ†æ&lt;/strong&gt;ï¼šæ¯”å¦‚ Informer æœºåˆ¶ã€è°ƒåº¦å™¨åŸç†ç­‰ï¼Œå¯¹æ·±å…¥ç†è§£ K8s æˆ–åšäºŒæ¬¡å¼€å‘å¾ˆæœ‰å¸®åŠ©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®è·µæ“ä½œæŒ‡å—&lt;/strong&gt;ï¼šæ¯”å¦‚æ‰‹åŠ¨æ­å»ºé›†ç¾¤ã€Pod ç”Ÿå‘½å‘¨æœŸç®¡ç†ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;å¦‚ä½•åˆ©ç”¨ï¼Ÿ&lt;/strong&gt; é‡åˆ°å…·ä½“é—®é¢˜æ—¶å¯ä»¥å»æœç´¢ç›¸å…³çš„æ–‡ç« ï¼›ä¹Ÿå¯ä»¥ç³»ç»Ÿæ€§åœ°é˜…è¯»æŸä¸ªç³»åˆ—ï¼›æœ€é‡è¦çš„æ˜¯ï¼Œçœ‹å®Œä¹‹åå°½é‡åŠ¨æ‰‹åœ¨è‡ªå·±çš„ç¯å¢ƒï¼ˆæ¯”å¦‚ Minikubeï¼‰ä¸­éªŒè¯ä¸€ä¸‹ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;å››-ä»£ç ç¤ºä¾‹é¡¹ç›®-åŠ¨æ‰‹å®è·µå‡ºçœŸçŸ¥&#34;&gt;å››ã€ä»£ç ç¤ºä¾‹é¡¹ç›®ï¼šåŠ¨æ‰‹å®è·µå‡ºçœŸçŸ¥&lt;/h2&gt;

&lt;p&gt;ç†è®ºå­¦ä¹ æœ€ç»ˆè¿˜æ˜¯è¦è½åˆ°å®è·µä¸Šã€‚å°±åƒæˆ‘å­¦ä¹  Rust ä¼šè‡ªå·±åŠ¨æ‰‹å†™é¡¹ç›®ä¸€æ ·ï¼Œå­¦ä¹  K8s ä¹Ÿéœ€è¦é€šè¿‡ä»£ç æ¥åŠ æ·±ç†è§£ã€‚ä¸‹é¢æ˜¯æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ª GitHub ä¸Šçš„é¡¹ç›®é›†åˆï¼Œæä¾›äº†ä¸é”™çš„ç»ƒæ‰‹æœºä¼šï¼š&lt;/p&gt;

&lt;h3 id=&#34;1-kubernetes-learning-playground&#34;&gt;1. Kubernetes Learning Playground&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœ°å€&lt;/strong&gt;ï¼š&lt;a href=&#34;https://github.com/Kubernetes-Learning-Playground&#34;&gt;https://github.com/Kubernetes-Learning-Playground&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€ä»‹&lt;/strong&gt;ï¼šè¿™ä¸ªç»„ç»‡ä¸‹æœ‰ä¸å°‘å…³äº K8s æ‰©å±•å¼€å‘çš„é¡¹ç›®ç¤ºä¾‹ï¼Œæ¯”å¦‚å¦‚ä½•ä¸ K8s API äº¤äº’ï¼ˆclient-goï¼‰ã€ç®€å•çš„ CSI/CNI æ’ä»¶å®ç°ã€è‡ªå®šä¹‰è°ƒåº¦å™¨ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ä»¥çœ‹çœ‹çš„é¡¹ç›®&lt;/strong&gt;ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;multi-cluster-informer&lt;/code&gt;ï¼šå­¦ä¹ å¦‚ä½•ç›‘æ§å¤šä¸ª K8s é›†ç¾¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;csi-interface-study&lt;/code&gt;ï¼šä¸€ä¸ªç®€å•çš„ CSI å­˜å‚¨æ’ä»¶ç¤ºä¾‹ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚åˆ&lt;/strong&gt;ï¼šå¯¹ K8s å†…éƒ¨æœºåˆ¶ã€API ç¼–ç¨‹ã€æ’ä»¶å¼€å‘æ„Ÿå…´è¶£çš„åŒå­¦ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;2-operator-learning-playground&#34;&gt;2. Operator Learning Playground&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åœ°å€&lt;/strong&gt;ï¼š&lt;a href=&#34;https://github.com/Operator-Learning-Playground&#34;&gt;https://github.com/Operator-Learning-Playground&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€ä»‹&lt;/strong&gt;ï¼šä¸“æ³¨äº K8s Operator å¼€å‘æ¨¡å¼çš„ç»ƒä¹ é¡¹ç›®ã€‚Operator æ˜¯ç”¨æ¥ç®¡ç†æœ‰çŠ¶æ€åº”ç”¨æˆ–è‡ªåŠ¨åŒ–å¤æ‚è¿ç»´ä»»åŠ¡çš„é‡è¦æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ä»¥çœ‹çœ‹çš„é¡¹ç›®&lt;/strong&gt;ï¼š

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;proxy-operator&lt;/code&gt;ï¼šä¸€ä¸ªç®€å•çš„ Operator ä¾‹å­ï¼Œæ„Ÿå—ä¸‹åŸºæœ¬ç»“æ„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;podReStarter-operator&lt;/code&gt;ï¼šå®ç°ç‰¹å®šæ¡ä»¶ä¸‹è‡ªåŠ¨é‡å¯ Pod çš„æ§åˆ¶å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚åˆ&lt;/strong&gt;ï¼šæƒ³å­¦ä¹ å¦‚ä½•ä½¿ç”¨ CRD (è‡ªå®šä¹‰èµ„æº) å’Œ Controller æ¥æ‰©å±• K8s åŠŸèƒ½çš„åŒå­¦ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;å®è·µå»ºè®®&lt;/strong&gt;ï¼š
*   åœ¨æœ¬åœ°ç”¨ Minikube æˆ– Kind æ­ä¸ª K8s ç¯å¢ƒï¼Œæ–¹ä¾¿å®éªŒã€‚
*   ä»ç®€å•çš„é¡¹ç›®å¼€å§‹ï¼Œå…ˆè·‘èµ·æ¥ï¼Œå†å°è¯•ç†è§£ä»£ç ï¼Œç„¶åå¯ä»¥è¯•ç€ä¿®æ”¹æˆ–æ‰©å±•å®ƒã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;äº”-å­¦ä¹ è·¯çº¿ä¸ä¸ªäººå¿ƒå¾—&#34;&gt;äº”ã€å­¦ä¹ è·¯çº¿ä¸ä¸ªäººå¿ƒå¾—&lt;/h2&gt;

&lt;p&gt;ç»“åˆä¸Šé¢çš„èµ„æºï¼Œæˆ‘æ¢³ç†äº†ä¸€ä¸ªå­¦ä¹  K8s çš„å¤§è‡´è·¯çº¿ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€å…¥é—¨&lt;/strong&gt;ï¼šé€šè¿‡ã€ŠKubernetes in Actionã€‹å’ŒåŠ¨æ‰‹å®éªŒï¼ŒæŒæ¡ Docker å’Œ K8s çš„åŸºæœ¬æ¦‚å¿µä¸æ“ä½œã€‚èƒ½éƒ¨ç½²ç®€å•åº”ç”¨ï¼Œä¼šç”¨ &lt;code&gt;kubectl&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ·±å…¥åŸç†&lt;/strong&gt;ï¼šé˜…è¯»ã€Šæ·±å…¥å‰–æ Kubernetesã€‹ï¼Œç†è§£ K8s çš„æ ¸å¿ƒæ¶æ„å’Œå·¥ä½œæœºåˆ¶ã€‚ç»“åˆ K8s Club çš„æ–‡ç« ï¼Œé’ˆå¯¹æ€§å­¦ä¹ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®è·µè¿›é˜¶&lt;/strong&gt;ï¼šç ”ç©¶ä¸Šé¢æåˆ°çš„ä»£ç ç¤ºä¾‹é¡¹ç›®ï¼Œå°è¯•ç†è§£å¹¶åŠ¨æ‰‹ä¿®æ”¹ã€‚å¼€å§‹å…³æ³¨ K8s ç”Ÿæ€ä¸­çš„å…¶ä»–å·¥å…·ï¼Œå¦‚ Helmã€Prometheus ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒç»­å­¦ä¹ &lt;/strong&gt;ï¼šäº‘åŸç”ŸæŠ€æœ¯å‘å±•å¾ˆå¿«ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€å¾ˆé‡è¦ã€‚å¤šçœ‹å®˜æ–¹æ–‡æ¡£ï¼Œå…³æ³¨ç¤¾åŒºåŠ¨æ€ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;æˆ‘è‡ªå·±çš„ä¸€äº›ä½“ä¼šï¼š&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ‰‹éå¸¸é‡è¦&lt;/strong&gt;ï¼šçœ‹å†å¤šæ–‡æ¡£ä¸å¦‚è‡ªå·±åŠ¨æ‰‹æ•²ä¸€éã€‚é‡åˆ°é—®é¢˜ã€è§£å†³é—®é¢˜çš„è¿‡ç¨‹æ˜¯æœ€å¥½çš„å­¦ä¹ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éç§‘ç­ä¸ç”¨æ€•&lt;/strong&gt;ï¼šåƒæˆ‘ä¸€æ ·éç§‘ç­å‡ºèº«çš„åŒå­¦ï¼Œå¯èƒ½åŸºç¡€ä¼šè–„å¼±ä¸€äº›ï¼Œé‚£å°±å¤šèŠ±ç‚¹æ—¶é—´å»è¡¥åŸºç¡€ï¼ˆæ¯”å¦‚ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹è¿™æ ·çš„ä¹¦ï¼‰ã€‚å…³é”®æ˜¯æŒç»­å­¦ä¹ å’Œå®è·µã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ©ç”¨å¥½ GitHub&lt;/strong&gt;ï¼šæ— è®ºæ˜¯å­¦ä¹ åˆ«äººçš„é¡¹ç›®ï¼Œè¿˜æ˜¯åƒæˆ‘ä¸€æ ·æŠŠè‡ªå·±å†™çš„ä¸œè¥¿æ”¾ä¸Šå»ï¼ŒGitHub éƒ½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¹³å°ã€‚å®ƒä¸ä»…èƒ½è®°å½•ä½ çš„æˆé•¿ï¼Œæœ‰æ—¶è¿˜èƒ½å¸¦æ¥æ„æƒ³ä¸åˆ°çš„æœºä¼šã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;å…­-k8s-è¿ç»´å®è·µ-å¼€å‘è€…ä¹Ÿéœ€å…³æ³¨&#34;&gt;å…­ã€K8s è¿ç»´å®è·µï¼šå¼€å‘è€…ä¹Ÿéœ€å…³æ³¨&lt;/h2&gt;

&lt;p&gt;å¼€å‘å®Œåº”ç”¨éƒ¨ç½²åˆ° K8s åªæ˜¯ç¬¬ä¸€æ­¥ï¼Œå¦‚ä½•ä¿éšœå®ƒåœ¨ç”Ÿäº§ç¯å¢ƒç¨³å®šè¿è¡Œï¼Œæ˜¯åŒæ ·é‡è¦çš„äº‹æƒ…ã€‚è™½ç„¶å¯èƒ½æœ‰ä¸“é—¨çš„è¿ç»´å›¢é˜Ÿï¼Œä½†ä½œä¸ºå¼€å‘è€…ï¼Œäº†è§£ä¸€äº›åŸºæœ¬çš„è¿ç»´å®è·µï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´ç¬¦åˆç”Ÿäº§è¦æ±‚çš„åº”ç”¨ï¼Œä¹Ÿèƒ½åœ¨æ’æŸ¥é—®é¢˜æ—¶æ›´æœ‰æ€è·¯ã€‚&lt;/p&gt;

&lt;p&gt;è¿™éƒ¨åˆ†æˆ‘å‚è€ƒäº†è…¾è®¯äº‘ K8s è¿ç»´å¼€å‘å·¥ç¨‹å¸ˆæ•´ç†çš„ã€Š&lt;a href=&#34;https://imroc.cc/kubernetes/best-practices&#34;&gt;Kubernetes å®è·µæŒ‡å—&lt;/a&gt;ã€‹ï¼ˆè¿™ä»½æŒ‡å—å†™å¾—æŒºå®ç”¨çš„ï¼‰ï¼Œç»“åˆè‡ªå·±çš„ä¸€äº›ç»éªŒï¼Œæç‚¼å‡ ç‚¹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç†Ÿç»ƒä½¿ç”¨ &lt;code&gt;kubectl&lt;/code&gt;&lt;/strong&gt;ï¼šè¿™æ˜¯ä¸ K8s äº¤äº’çš„åŸºç¡€ã€‚&lt;code&gt;get&lt;/code&gt;, &lt;code&gt;describe&lt;/code&gt;, &lt;code&gt;logs&lt;/code&gt;, &lt;code&gt;exec&lt;/code&gt; ç­‰å‘½ä»¤è¦å¸¸ç”¨å¸¸ç»ƒã€‚å­¦ä¼šçœ‹ &lt;code&gt;describe&lt;/code&gt; é‡Œçš„ Events ä¿¡æ¯ï¼Œå¯¹æ’é”™å¾ˆæœ‰å¸®åŠ©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•œåƒç®¡ç†&lt;/strong&gt;ï¼šæ³¨æ„ä½¿ç”¨å°çš„åŸºç¡€é•œåƒã€å¤šé˜¶æ®µæ„å»ºæ¥ä¼˜åŒ–é•œåƒä½“ç§¯ã€‚ç”Ÿäº§ç¯å¢ƒç”¨ç§æœ‰é•œåƒä»“åº“ï¼Œé…ç½®å¥½æ‹‰å–å¯†é’¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å‘Šè­¦æ˜¯æ ‡é…&lt;/strong&gt;ï¼šPrometheus + Grafana æ˜¯ç¤¾åŒºä¸»æµæ–¹æ¡ˆï¼Œéœ€è¦äº†è§£å¦‚ä½•æš´éœ²åº”ç”¨çš„ metricsï¼Œå¦‚ä½•é…ç½®åŸºæœ¬çš„å‘Šè­¦è§„åˆ™ã€‚æ—¥å¿—æ”¶é›†ï¼ˆå¦‚ EFK/ELKï¼‰ä¹Ÿè¦è€ƒè™‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºç®¡ç†ï¼ˆRequests &amp;amp; Limitsï¼‰&lt;/strong&gt;ï¼šä¸€å®šè¦ç»™ Pod è®¾ç½®åˆç†çš„ CPU å’Œå†…å­˜ &lt;code&gt;requests&lt;/code&gt;ï¼ˆç”¨äºè°ƒåº¦ï¼‰å’Œ &lt;code&gt;limits&lt;/code&gt;ï¼ˆç”¨äºé™åˆ¶ï¼‰ï¼Œé¿å…èµ„æºæŠ¢å å¯¼è‡´åº”ç”¨ä¸ç¨³å®šæˆ–å½±å“å…¶ä»–åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¥åº·æ£€æŸ¥ï¼ˆProbesï¼‰&lt;/strong&gt;ï¼šé…ç½®å¥½ Liveness Probeï¼ˆå­˜æ´»æ¢é’ˆï¼Œåˆ¤æ–­å®¹å™¨æ˜¯å¦éœ€è¦é‡å¯ï¼‰å’Œ Readiness Probeï¼ˆå°±ç»ªæ¢é’ˆï¼Œåˆ¤æ–­å®¹å™¨æ˜¯å¦å‡†å¤‡å¥½æ¥æ”¶æµé‡ï¼‰ï¼Œè®© K8s èƒ½å‡†ç¡®ç®¡ç†åº”ç”¨çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç†è§£ Namespace å’Œ RBAC&lt;/strong&gt;ï¼šNamespace ç”¨äºèµ„æºéš”ç¦»ï¼ŒRBAC ç”¨äºæƒé™æ§åˆ¶ï¼Œéƒ½æ˜¯ä¿éšœé›†ç¾¤å®‰å…¨å’Œç®¡ç†æœ‰åºæ€§çš„é‡è¦æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;è¿ç»´å­¦ä¹ å»ºè®®&lt;/strong&gt;ï¼šåŒæ ·éœ€è¦åŠ¨æ‰‹ï¼Œå¯ä»¥åœ¨æœ¬åœ°ç¯å¢ƒæ¨¡æ‹Ÿä¸€äº›åœºæ™¯ï¼Œæ¯”å¦‚æ‰‹åŠ¨åˆ é™¤ Pod çœ‹ K8s å¦‚ä½•æ¢å¤ï¼Œè°ƒæ•´èµ„æºé™åˆ¶çœ‹æ•ˆæœç­‰ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;ä¸ƒ-ç»“è¯­&#34;&gt;ä¸ƒã€ç»“è¯­&lt;/h2&gt;

&lt;p&gt;å›å¤´çœ‹ï¼Œäº‘åŸç”Ÿå¼€å‘è¿™æ¡è·¯ç¡®å®å†…å®¹ä¸å°‘ï¼Œä½†èµ°ä¸‹æ¥æ”¶è·ä¹Ÿå¾ˆå¤§ã€‚ä» K8s çš„åŸºç¡€æ“ä½œåˆ°æ·±å…¥ç†è§£å…¶åŸç†ï¼Œå†åˆ°å…³æ³¨è¿ç»´å®è·µï¼Œæ˜¯ä¸€ä¸ªé€æ­¥æ·±å…¥çš„è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;å¸Œæœ›æˆ‘åˆ†äº«çš„è¿™äº›å­¦ä¹ èµ„æºå’Œè·¯å¾„å»ºè®®ï¼Œèƒ½å¯¹æ­£åœ¨å…¥é—¨æˆ–æ‰“ç®—å…¥é—¨äº‘åŸç”Ÿå¼€å‘çš„ä½ æœ‰æ‰€å¸®åŠ©ã€‚æˆ‘è‡ªå·±ä¹Ÿæ˜¯åœ¨ä¸æ–­å­¦ä¹ ä¸­ï¼Œäº‘åŸç”ŸæŠ€æœ¯æ—¥æ–°æœˆå¼‚ï¼Œä¿æŒå¥½å¥‡å¿ƒå’ŒåŠ¨æ‰‹å®è·µçš„çƒ­æƒ…éå¸¸é‡è¦ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä½ åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­æœ‰ä»»ä½•é—®é¢˜æˆ–å¿ƒå¾—ï¼Œä¹Ÿæ¬¢è¿ä¸€èµ·äº¤æµã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ä»ã€Šè½¯ä»¶è®¾è®¡çš„å“²å­¦ã€‹è°ˆä»£ç çš„å¤æ‚æ€§ä¸åº”å¯¹</title>
      <link>https://zhu327.github.io/2025/01/10/%E4%BB%8E%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%93%B2%E5%AD%A6%E8%B0%88%E4%BB%A3%E7%A0%81%E7%9A%84%E5%A4%8D%E6%9D%82%E6%80%A7%E4%B8%8E%E5%BA%94%E5%AF%B9/</link>
      <pubDate>Fri, 10 Jan 2025 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/01/10/%E4%BB%8E%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%93%B2%E5%AD%A6%E8%B0%88%E4%BB%A3%E7%A0%81%E7%9A%84%E5%A4%8D%E6%9D%82%E6%80%A7%E4%B8%8E%E5%BA%94%E5%AF%B9/</guid>
      <description>&lt;p&gt;å‡ ä¸ªæœˆå‰è¯»å®Œäº†ã€Šè½¯ä»¶è®¾è®¡çš„å“²å­¦ã€‹è¿™æœ¬ä¹¦ï¼Œåœ¨ç»“åˆè‡ªå·±å¤šå¹´çš„å·¥ä½œä½“ä¼šï¼Œå¯¹äºä»£ç çš„å¯è¯»æ€§ï¼Œå¯ç»´æŠ¤æ€§æœ‰äº†ç³»ç»Ÿæ€§çš„ä½“ä¼šï¼Œç„¶ååŸºäºæˆ‘è®°å½•çš„è¯»ä¹¦ç¬”è®°ç„¶åç»è¿‡AIçš„æ¶¦è‰²ï¼Œå½¢æˆäº†è¿™ç¯‡ç¬”è®°ã€‚å¸Œæœ›å¯¹ä½ ä¹Ÿæœ‰æ‰€å¸®åŠ©ã€‚&lt;/p&gt;

&lt;p&gt;è¯»å®Œã€Šè½¯ä»¶è®¾è®¡çš„å“²å­¦ã€‹ï¼Œæ„Ÿè§‰åƒç»å†äº†ä¸€æ¬¡ä»£ç çš„â€œæ·±åº¦ä½“æ£€â€ã€‚è¿™æœ¬ä¹¦æ²¡æœ‰è®²è§£å…·ä½“çš„ç¼–ç æŠ€å·§ï¼Œè€Œæ˜¯ä»æ›´é«˜çš„ç»´åº¦å¸®åŠ©æˆ‘ä»¬é‡æ–°å®¡è§†ä»£ç å¤æ‚æ€§çš„é—®é¢˜ï¼Œå¹¶æå‡ºäº†è®¸å¤šå®ç”¨çš„å»ºè®®ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³ç»“åˆè‡ªå·±çš„ç†è§£ï¼Œåˆ†äº«è¿™æœ¬ä¹¦å¸¦æ¥çš„å¯å‘ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯ä»£ç çš„å¤æ‚æ€§&#34;&gt;ä»€ä¹ˆæ˜¯ä»£ç çš„å¤æ‚æ€§ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ç®€å•æ¥è¯´ï¼Œå¤æ‚æ€§å°±æ˜¯é‚£äº›è®©ç³»ç»Ÿéš¾ä»¥ç†è§£å’Œä¿®æ”¹çš„å› ç´ ã€‚å®ƒä¸ä»…ä»…æŒ‡ä»£ç çš„è¡Œæ•°æˆ–é€»è¾‘æ·±åº¦ï¼Œè¿˜åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éš¾ä»¥ç†è§£&lt;/strong&gt;ï¼šå³ä¾¿æ˜¯è‡ªå·±å†™çš„ä»£ç ï¼Œè¿‡ä¸€æ®µæ—¶é—´å¯èƒ½ä¹Ÿçœ‹ä¸æ‡‚ï¼Œæ›´åˆ«æå…¶ä»–äººã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿®æ”¹æˆæœ¬é«˜&lt;/strong&gt;ï¼šä¸€ä¸ªå°æ”¹åŠ¨éœ€è¦æ”¹åŠ¨å¤šä¸ªåœ°æ–¹ï¼Œç”šè‡³å¼•å‘æ–°çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡ç³Šçš„æ”¹åŠ¨èŒƒå›´&lt;/strong&gt;ï¼šä¸çŸ¥é“è¯¥ä¿®æ”¹å“ªäº›æ¨¡å—æ‰èƒ½å®ç°ç›®æ ‡ï¼Œæˆ–è€…ä¸ç¡®å®šä¿®æ”¹åæ˜¯å¦ä¼šå¼•å‘å…¶ä»–é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš¾ä»¥ä¿®å¤çš„é”™è¯¯&lt;/strong&gt;ï¼šä¿®å¤ä¸€ä¸ª bug å¯èƒ½éœ€è¦å¤§é‡æ—¶é—´ï¼Œè¿˜å¯èƒ½å¼•å…¥æ–°çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;å¤æ‚æ€§çš„è¡¨ç°å½¢å¼&#34;&gt;å¤æ‚æ€§çš„è¡¨ç°å½¢å¼&lt;/h3&gt;

&lt;p&gt;å¤æ‚æ€§å¹¶éæŠ½è±¡æ¦‚å¿µï¼Œå®ƒå¸¸ä»¥ä»¥ä¸‹å½¢å¼ä½“ç°ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å˜æ›´æ”¾å¤§&lt;/strong&gt;ï¼šä¸€ä¸ªç®€å•éœ€æ±‚æ”¹åŠ¨éœ€è¦ä¿®æ”¹å¤šä¸ªæ¨¡å—ç”šè‡³ä»£ç åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¤çŸ¥è´Ÿè·&lt;/strong&gt;ï¼šå®Œæˆä¸€ä¸ªä»»åŠ¡éœ€è¦äº†è§£å¤§é‡èƒŒæ™¯çŸ¥è¯†æˆ–å¤æ‚ç»†èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœªçŸ¥çš„æœªçŸ¥&lt;/strong&gt;ï¼šä¿®æ”¹ä»£ç æ—¶ï¼Œä¸ç¡®å®šæ˜¯å¦ä¼šå¼•å…¥æ–°çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;å¤æ‚æ€§çš„æ¥æº&#34;&gt;å¤æ‚æ€§çš„æ¥æº&lt;/h3&gt;

&lt;p&gt;å¤æ‚æ€§é€šå¸¸æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡å—ä¹‹é—´çš„ä¾èµ–&lt;/strong&gt;ï¼šä¸€ä¸ªæ¨¡å—çš„æ”¹åŠ¨å¯èƒ½éœ€è¦åŒæ­¥ä¿®æ”¹ä¾èµ–å®ƒçš„å…¶ä»–æ¨¡å—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™¦æ¶©éš¾æ‡‚çš„ä»£ç &lt;/strong&gt;ï¼šä¸æ¸…æ™°çš„å˜é‡åã€å‡½æ•°åä»¥åŠç¼ºä¹æ³¨é‡Šçš„é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡æ¡£ä¸è¶³&lt;/strong&gt;ï¼šç¼ºä¹è§£é‡Šä»£ç æ„å›¾å’Œçº¦æŸçš„æ–‡æ¡£ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;é¢å¯¹å¤æ‚æ€§çš„ä¸¤å¤§ç­–ç•¥&#34;&gt;é¢å¯¹å¤æ‚æ€§çš„ä¸¤å¤§ç­–ç•¥&lt;/h3&gt;

&lt;p&gt;ä¹¦ä¸­æåˆ°äº†è§£å†³ä»£ç å¤æ‚æ€§çš„ä¸¤ç§æ ¸å¿ƒç­–ç•¥ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è®©ä»£ç æ›´ç®€å•ã€æ›´ç›´è§‚&lt;/strong&gt;

&lt;ul&gt;
&lt;li&gt;é€šè¿‡æ¸…æ™°çš„å‘½åã€ç®€æ´çš„é€»è¾‘ã€è§„èŒƒçš„å®ç°ï¼Œè®©ä»£ç æ˜“äºç†è§£ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°è£…å¤æ‚æ€§&lt;/strong&gt;

&lt;ul&gt;
&lt;li&gt;å°†å¤æ‚é€»è¾‘å°è£…èµ·æ¥ï¼Œé€šè¿‡ç®€æ´çš„æ¥å£æš´éœ²ç»™å¤–éƒ¨ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒå†…éƒ¨ç»†èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;å¦‚ä½•åº”å¯¹å¤æ‚æ€§&#34;&gt;å¦‚ä½•åº”å¯¹å¤æ‚æ€§ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ä»¥ä¸‹æ˜¯ä¹¦ä¸­æåˆ°çš„ä¸€äº›æœ‰æ•ˆæ–¹æ³•ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ¨¡å—åŒ–è®¾è®¡&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å°†ç³»ç»Ÿåˆ†è§£ä¸ºç‹¬ç«‹æ¨¡å—ï¼Œå‡å°‘æ¨¡å—é—´çš„ä¾èµ–ã€‚æ¯ä¸ªæ¨¡å—åº”åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®ä»»åŠ¡ï¼Œæä¾›æ¸…æ™°æ¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æŠ½è±¡&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å¿½ç•¥ä¸é‡è¦çš„ç»†èŠ‚ï¼Œåªæš´éœ²å¿…è¦çš„ä¿¡æ¯ã€‚å¥½çš„æŠ½è±¡èƒ½é™ä½è®¤çŸ¥è´Ÿè·å¹¶æé«˜ä»£ç å¤ç”¨æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;ä¿¡æ¯éšè—&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;éšè—æ¨¡å—çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œåªæš´éœ²æ¥å£ã€‚è¿™æ ·èƒ½å‡å°‘æ¨¡å—ä¹‹é—´çš„è€¦åˆï¼Œé™ä½ä¿®æ”¹é£é™©ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è®¾è®¡é€šç”¨æ¥å£&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;é€šç”¨æ¥å£èƒ½éšè—ç»†èŠ‚å¹¶æé«˜ä»£ç å¤ç”¨æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;ä¸“æ³¨äºä»»åŠ¡çš„çŸ¥è¯†&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è®¾è®¡æ¨¡å—æ—¶ï¼Œåº”å…³æ³¨ä»»åŠ¡æ‰€éœ€çš„çŸ¥è¯†ï¼Œè€Œéä»»åŠ¡å‘ç”Ÿçš„é¡ºåºã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ³¨é‡Šä»£ç &lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æ³¨é‡Šåº”è§£é‡Šä»£ç çš„â€œä¸ºä»€ä¹ˆâ€ï¼Œè€Œéâ€œæ˜¯ä»€ä¹ˆâ€ã€‚ä¾‹å¦‚ï¼Œæè¿°å˜é‡å•ä½ã€è¾¹ç•Œæ¡ä»¶ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ¸…æ™°å‘½å&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å‡†ç¡®ä¸”ä¸€è‡´çš„å‘½åï¼Œé¿å…æ­§ä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;å…ˆå†™æ³¨é‡Šï¼Œå†å†™ä»£ç &lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å…ˆç”¨æ³¨é‡Šæ˜ç¡®è¡¨è¾¾ä»£ç æ„å›¾ï¼Œç„¶åå†å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è®¾è®¡ä¸¤æ¬¡&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;åˆæ­¥å®Œæˆä»£ç åï¼Œé‡æ–°å®¡è§†è®¾è®¡ï¼Œæ€è€ƒæ˜¯å¦æœ‰æ›´å¥½çš„æ¥å£å’Œå®ç°æ–¹å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;ç»Ÿä¸€è§„èŒƒ&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;åˆ¶å®šå›¢é˜Ÿä»£ç è§„èŒƒï¼Œä¿æŒä¸€è‡´æ€§ï¼Œæé«˜å¯è¯»æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ˜¾å¼ä»£ç ä¼˜äºéšå¼ä»£ç &lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ä»£ç åº”å°½å¯èƒ½æ¸…æ™°æ˜“æ‡‚ï¼Œé¿å…æ™¦æ¶©æŠ€å·§ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;å±é™©ä¿¡å·-ä»€ä¹ˆæ—¶å€™è¯¥è­¦æƒ•å¤æ‚æ€§&#34;&gt;å±é™©ä¿¡å·ï¼šä»€ä¹ˆæ—¶å€™è¯¥è­¦æƒ•å¤æ‚æ€§ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ä»¥ä¸‹æ˜¯ä¹¦ä¸­æåˆ°çš„ä¸€äº›â€œå±é™©ä¿¡å·â€ï¼Œé‡åˆ°è¿™äº›æƒ…å†µæ—¶ï¼Œéœ€è¦è€ƒè™‘é‡æ„ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æµ…æ¨¡å—&lt;/strong&gt;ï¼šæ¥å£ä¸å®ç°çš„å¤æ‚æ€§ç›¸å·®æ— å‡ ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿¡æ¯æ³„æ¼&lt;/strong&gt;ï¼šè®¾è®¡å†³ç­–å¯¼è‡´å¤šä¸ªæ¨¡å—ä¹‹é—´è€¦åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ—¶é—´åˆ†è§£&lt;/strong&gt;ï¼šä»£ç ç»“æ„ä¾èµ–æ“ä½œæ‰§è¡Œé¡ºåºï¼Œè€ŒéåŸºäºä¿¡æ¯éšè—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿‡åº¦æš´éœ²&lt;/strong&gt;ï¼šAPI æš´éœ²äº†ä¸å¸¸ç”¨çš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡å¤ä»£ç &lt;/strong&gt;ï¼šç›¸åŒä»£ç åå¤å‡ºç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è”åˆæ–¹æ³•&lt;/strong&gt;ï¼šä¸¤ä¸ªæ–¹æ³•é—´ä¾èµ–æ€§å¼ºï¼Œéš¾ä»¥å•ç‹¬ç†è§£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨é‡Šé‡å¤ä»£ç &lt;/strong&gt;ï¼šæ³¨é‡Šä»…é‡å¤ä»£ç å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å«ç³Šä¸æ¸…çš„åç§°&lt;/strong&gt;ï¼šå˜é‡æˆ–æ–¹æ³•åç§°ä¼ é€’ä¸äº†æœ‰ç”¨ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš¾ä»¥æè¿°&lt;/strong&gt;ï¼šéœ€è¦å†—é•¿æ–‡æ¡£è§£é‡Šå˜é‡æˆ–æ–¹æ³•æ„å›¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éæ˜¾è€Œæ˜“è§çš„ä»£ç &lt;/strong&gt;ï¼šä»£ç è¡Œä¸ºæˆ–æ„å›¾ä¸ç›´è§‚ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;è½¯ä»¶è®¾è®¡çš„æ ¸å¿ƒåŸåˆ™&#34;&gt;è½¯ä»¶è®¾è®¡çš„æ ¸å¿ƒåŸåˆ™&lt;/h3&gt;

&lt;p&gt;ä¹¦ä¸­æ€»ç»“äº†ä»¥ä¸‹å…³é”®åŸåˆ™ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¤æ‚æ€§æ˜¯é€æ­¥å¢åŠ çš„&lt;/strong&gt;ï¼šä»å°äº‹åšèµ·ï¼ŒæŒç»­æ”¹è¿›ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç è·‘èµ·æ¥å¹¶ä¸å¤Ÿ&lt;/strong&gt;ï¼šè¿˜éœ€å…³æ³¨å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒç»­æŠ•å…¥æ”¹å–„ç³»ç»Ÿè®¾è®¡&lt;/strong&gt;ï¼šä¸è¦å¿½è§†ä»£ç çš„é•¿æœŸç»´æŠ¤æˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨¡å—åº”è¯¥è¶³å¤Ÿæ·±&lt;/strong&gt;ï¼šæ¥å£è¦æ¯”å®ç°ç®€å•å¾—å¤šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€åŒ–æ¥å£&lt;/strong&gt;ï¼šæ¥å£è®¾è®¡åº”å°½å¯èƒ½ç®€åŒ–æœ€å¸¸è§ç”¨æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€šç”¨ä¸ä¸“ç”¨åˆ†ç¦»&lt;/strong&gt;ï¼šé€šç”¨ä»£ç ä¸ä¸“ç”¨ä»£ç åº”æ˜ç¡®åŒºåˆ†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±‚æ¬¡åˆ†æ˜&lt;/strong&gt;ï¼šä¸åŒå±‚æ¬¡åº”æœ‰ä¸åŒæŠ½è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™ä½å¤æ‚æ€§&lt;/strong&gt;ï¼šå§‹ç»ˆå…³æ³¨å‡å°‘è®¤çŸ¥è´Ÿè·å’Œæ¨¡å—è€¦åˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ˆè®¾è®¡ï¼Œå†å®ç°&lt;/strong&gt;ï¼šé¿å…ä»“ä¿ƒå†³ç­–ï¼Œå¤šæ¬¡è®¾è®¡è¿­ä»£ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨é‡Šä¸æ˜æ˜¾å†…å®¹&lt;/strong&gt;ï¼šå¥½çš„æ³¨é‡Šå¯æ˜¾è‘—é™ä½è®¤çŸ¥è´Ÿè·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç æ˜¯å†™ç»™äººçœ‹çš„&lt;/strong&gt;ï¼šæ¸…æ™°æ€§ä¼˜å…ˆäºå®ç°æŠ€å·§ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;ç»“è¯­&#34;&gt;ç»“è¯­&lt;/h3&gt;

&lt;p&gt;ã€Šè½¯ä»¶è®¾è®¡çš„å“²å­¦ã€‹è®©æˆ‘æ„è¯†åˆ°ï¼Œè½¯ä»¶å¼€å‘ä¸ä»…æ˜¯å®ç°åŠŸèƒ½ï¼Œæ›´æ˜¯ä¸€é—¨éœ€è¦æ·±æ€ç†Ÿè™‘çš„è‰ºæœ¯ã€‚å®ƒæé†’æˆ‘ä»¬ï¼Œä»£ç çš„æ ¸å¿ƒç›®æ ‡æ˜¯&lt;strong&gt;æ˜“äºç†è§£å’Œç»´æŠ¤&lt;/strong&gt;ã€‚æ¯•ç«Ÿï¼Œ&lt;strong&gt;ä»£ç æ˜¯å†™ç»™äººçœ‹çš„ï¼Œå…¶æ¬¡æ‰æ˜¯ç»™æœºå™¨çœ‹çš„&lt;/strong&gt;ã€‚å¸Œæœ›è¿™äº›å¿ƒå¾—å¯¹ä½ æœ‰æ‰€å¯å‘ï¼Œè®©æˆ‘ä»¬ä¸€èµ·å†™å‡ºæ›´æ¸…æ™°ã€æ›´ä¼˜é›…çš„ä»£ç ï¼&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>å¦‚ä½•å¿«é€Ÿä¸Šæ‰‹é¡¹ç›®</title>
      <link>https://zhu327.github.io/2025/01/08/%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E9%A1%B9%E7%9B%AE/</link>
      <pubDate>Wed, 08 Jan 2025 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2025/01/08/%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E9%A1%B9%E7%9B%AE/</guid>
      <description>&lt;p&gt;èŒä¸šç”Ÿæ¶¯ä¸­æ¥æ‰‹è¿‡å¾ˆå¤šé¡¹ç›®äº†ï¼Œå„ç§é¡¹ç›®éƒ½æ¥è§¦è¿‡ï¼Œä¸€ä¸ªå¯¹æ–°äººå‹å¥½çš„é¡¹ç›®ä¸€èˆ¬å…·å¤‡å¦‚ä¸‹ç‰¹å¾ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å®Œå¤‡çš„å®‰è£…/åŠŸèƒ½æ–‡æ¡£&lt;/li&gt;
&lt;li&gt;å®Œå¤‡çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œæ¶æ„è®¾è®¡æ–‡æ¡£&lt;/li&gt;
&lt;li&gt;åˆç†çš„åˆ†å±‚ï¼Œæ¸…æ™°çš„ä»£ç ç›®å½•ç»“æ„&lt;/li&gt;
&lt;li&gt;å¯è¯»ï¼Œå¯ç»´æŠ¤æ€§é«˜çš„ä»£ç &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä½†æ˜¯å¾€å¾€æˆ‘ä»¬ä¼šå¿½ç•¥ä¸€ä¸ªä¸€ä¸ªç®€å•çš„æŒ‡å¼•æ€§çš„æ–‡æ¡£ï¼š&lt;strong&gt;Quick Start&lt;/strong&gt;ï¼Œè¿™ä¸ªæ–‡æ¡£ä¸éœ€è¦å¾ˆè¯¦ç»†ï¼Œåªéœ€è¦è¯´æ˜ï¼Œå¦‚ä½•å¿«é€Ÿä¸Šæ‰‹çš„è¿‡ç¨‹ï¼Œå…·ä½“çš„æ­¥éª¤é“¾æ¥åˆ°å¯¹åº”çš„æ–‡æ¡£å³å¯ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨Quick Startä¸Šå†™æ˜ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æœ€ç®€å®‰è£…çš„æ­¥éª¤&lt;/li&gt;
&lt;li&gt;ä¸»æµç¨‹åŠŸèƒ½çš„ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;å¼€å‘ç¯å¢ƒçš„æ­å»º&lt;/li&gt;
&lt;li&gt;å¼€å‘æ³¨æ„äº‹é¡¹

&lt;ol&gt;
&lt;li&gt;åŒ…å«ç»„ä»¶çš„æ¶æ„å›¾&lt;/li&gt;
&lt;li&gt;åŒ…å«ä»£ç çš„åˆ†å±‚ç›®å½•è¯´æ˜&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™ä¸ªæ–‡æ¡£éœ€è¦ç”±é¡¹ç›®çš„è´Ÿè´£äººç¼–å†™ï¼Œåœ¨åç»­ç”±é¡¹ç›®çš„æ–°äººå®è·µçš„è¿‡ç¨‹ä¸­é€æ­¥å®Œå–„ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶è¿™éƒ½æ˜¯æ¯”è¾ƒç†æƒ³çš„æƒ…å†µï¼Œå®é™…æƒ…å†µä¸­ï¼Œæˆ‘ä»¬å¯èƒ½é‡åˆ°çš„é¡¹ç›®å¯èƒ½æ ¹æœ¬å°±æ²¡æœ‰æ–‡æ¡£ï¼Œç„¶ååªæœ‰ä¸€ä¸ªä»£ç ä»“åº“çš„æƒ…å†µï¼Œé‚£æ€ä¹ˆæ‰èƒ½å¿«é€Ÿä¸Šæ‰‹å‘¢ï¼Ÿå…¶å®è¿˜æ˜¯æŒ‰ç…§Quick Startçš„æ€è·¯ï¼Œåªä¸è¿‡éœ€è¦è‡ªå·±æ¥æ‘¸ç´¢æ¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-å®‰è£…&#34;&gt;1. å®‰è£…&lt;/h3&gt;

&lt;p&gt;æˆ‘ç›¸ä¿¡ä¸ç®¡ä»€ä¹ˆé¡¹ç›®ï¼Œæˆ–å¤šæˆ–å°‘éƒ½æœ‰ä¸€äº›å¦‚ä½•å®‰è£…çš„æ–‡æ¡£ï¼Œå¦‚æœè¿ä¸€ç‚¹è¿™æ ·çš„æ–‡æ¡£éƒ½æ²¡æœ‰ï¼Œé‚£å°±éœ€è¦é—®å…¶å®ƒåŒäº‹äº†ï¼Œå¦‚æœè¿é—®éƒ½é—®ä¸å‡ºæ¥ï¼Œé‚£æ­å–œä½ èµ¶å¿«è·‘è·¯å§ï¼ŒğŸ˜‚&lt;/p&gt;

&lt;p&gt;å› ä¸ºæˆ‘ä»¬æ˜¯åˆæ¬¡æ¥è§¦é¡¹ç›®ï¼Œä¸å¿…ææ‡‚å®‰è£…çš„æ¯ä¸ªæ­¥éª¤ï¼Œæ¯ä¸ªé…ç½®çš„å«ä¹‰ï¼Œç›®æ ‡ä»…ä»…æ˜¯æŠŠé¡¹ç›®è·‘èµ·æ¥ï¼Œèƒ½ç”¨èµ·æ¥ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç›®æ ‡å°±æ˜¯å®‰è£…æœ€ç®€åŒ–çš„æ–¹å¼æŠŠé¡¹ç›®è·‘èµ·æ¥ã€‚å½“å‰çš„åç«¯é¡¹ç›®ä¸€èˆ¬é‡‡ç”¨å®¹å™¨äº¤ä»˜çš„å½¢å¼ï¼Œä¸€èˆ¬å°±äº¤ä»˜é•œåƒä¸helm chartï¼Œè¿™ç§æ–¹å¼çš„å®‰è£…ç†è®ºæ¥è¯´æ˜¯éå¸¸ç®€å•çš„ï¼Œä¸€æ¡helm install çš„å‘½ä»¤å°±å¯ä»¥æå®šã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨äº¤ä»˜çš„çš„æ—¶ä¸€å®šè¦åœ¨é»˜è®¤çš„é…ç½®ä¸­å†™å¥½æœ€ç®€åŒ–çš„é…ç½®ï¼Œè¿™æ ·æ–°äººå°±å¯ä»¥ç›´æ¥ç”¨é»˜è®¤çš„é…ç½®æ¥å®‰è£…ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-åŠŸèƒ½ä½“éªŒ&#34;&gt;2. åŠŸèƒ½ä½“éªŒ&lt;/h3&gt;

&lt;p&gt;å®‰è£…å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»äº§å“çš„è§’åº¦å¼€å§‹ä½“éªŒé¡¹ç›®çš„ç›¸å…³åŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘ä»¬è¦èšç„¦åˆ°é¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½ä¸Šï¼Œè·‘å®Œæ•´ä¸ªä¸»è¦æµç¨‹ï¼Œä¸è¦åœ¨æ„ç»†èŠ‚ï¼Œä¹Ÿä¸è¦æ€¥äºæŠŠä½“éªŒçš„åŠŸèƒ½ä¸ä»£ç å®ç°ç»“åˆèµ·æ¥ï¼Œæˆ‘ä»¬åªè¦æ¢³ç†åŠŸèƒ½æµç¨‹ï¼Œæ•°æ®çš„æµè½¬ï¼Œæ•°æ®çš„å»ºæ¨¡ã€‚ç„¶åæœ‰ç»éªŒçš„ç¨‹åºå‘˜å¾€å¾€ä¼šåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ€è€ƒï¼Œè¿™ä¸ªåŠŸèƒ½å¦‚æœæ˜¯æˆ‘æ¥åšï¼Œæˆ‘ä¼šæ€ä¹ˆåšã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸€å®šè¦æœ‰è‡ªå·±çš„è¾“å‡ºï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;åŠŸèƒ½æ¸…å•&lt;/li&gt;
&lt;li&gt;åŠŸèƒ½æµç¨‹å›¾&lt;/li&gt;
&lt;li&gt;æ•°æ®æ¨¡å‹&lt;/li&gt;
&lt;li&gt;æ•°æ®æµè½¬å›¾&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¦‚æœæœ‰æ€è€ƒå¦‚ä½•å®ç°ï¼Œè¿˜å¯ä»¥è®°å½•è¿™äº›ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æŠ€æœ¯é€‰å‹&lt;/li&gt;
&lt;li&gt;æŠ€æœ¯æ–¹æ¡ˆ&lt;/li&gt;
&lt;li&gt;æ¶æ„è®¾è®¡&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨ä½“éªŒè¿‡ç¨‹ä¸­å¦‚æœå‘ç°äº†é—®é¢˜ï¼Œä¹Ÿéœ€è¦è®°å½•ä¸‹æ¥ï¼Œè¿˜æœ‰è‡ªå·±å¯¹é¡¹ç›®çš„ç–‘é—®ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡ï¼Œè¿™ä¸ªåŠŸèƒ½è§£å†³çš„ä»€ä¹ˆå®é™…é—®é¢˜ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯é¿å…é™·å…¥ç»†èŠ‚ï¼Œæœ‰äº›ä¸œè¥¿æ²¡ææ‡‚å°±æ²¡ææ‡‚ï¼Œæ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ªæ–°äººï¼Œæä¸æ‡‚ä¹Ÿæ­£å¸¸ï¼ŒæŠŠæ²¡ææ‡‚çš„é—®é¢˜è®°å½•ä¸‹æ¥ï¼Œåç»­å†é€æ­¥ç†Ÿæ‚‰ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-ç»„ä»¶æ‹†è§£ä¸ç”¨é€”åˆ†æ&#34;&gt;3. ç»„ä»¶æ‹†è§£ä¸ç”¨é€”åˆ†æ&lt;/h3&gt;

&lt;p&gt;åœ¨åŠŸèƒ½ä½“éªŒå®Œæˆåï¼Œæˆ‘ä»¬å°±æœ‰äº†è‡ªå·±çš„å¯¹ä¸é¡¹ç›®çš„æ€è€ƒï¼Œä¹Ÿæœ‰äº†ä¸€äº›ç–‘é—®ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥ä»é¡¹ç›®çš„ä¾èµ–çš„å„ä¸ªç»„ä»¶æ¥é€æ­¥ææ¸…æ¥šè¿™äº›é—®é¢˜ã€‚æ¯”å¦‚é¡¹ç›®ä¸­ç”¨äº†ä»€ä¹ˆæ•°æ®åº“ï¼Œç”¨äº†ä»€ä¹ˆç¼“å­˜ç­‰ç­‰ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å¯¹ç…§æˆ‘ä»¬è‡ªå·±çš„åˆ†ææ¥çœ‹çœ‹é¡¹ç›®æ˜¯ä¸æ˜¯çœŸçš„å°±æ˜¯æƒ³æˆ‘ä»¬æƒ³æƒ³çš„æ¥å®ç°çš„ï¼Œæ•°æ®åº“çš„è¡¨è®¾è®¡æ˜¯ä¸æ˜¯ä¹Ÿè·Ÿæˆ‘ä»¬çš„æ•°æ®å»ºæ¨¡ä¸€è‡´ã€‚ç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜å¾€å¾€å¾ˆå¿«å°±èƒ½çŒœå‡ºé¡¹ç›®çš„ä¸»è¦ç»„ä»¶ä¾èµ–ï¼Œå¿«é€Ÿç”»å‡ºä¸€ä¸ªç®€å•çš„æ¶æ„å›¾ã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-é¡¹ç›®ä»£ç åˆ†æ&#34;&gt;4. é¡¹ç›®ä»£ç åˆ†æ&lt;/h3&gt;

&lt;p&gt;ææ˜ç™½å„ä¸ªç»„ä»¶çš„ç”¨é€”åï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å•åˆ€ç›´å…¥ï¼Œä»ä¸»è¦åŠŸèƒ½æµç¨‹å‡ºå‘ï¼Œæ‰¾åˆ°å¯¹åº”ä»£ç çš„å…¥å£ï¼Œç„¶åæŒ‰ç…§æˆ‘ä»¬æ•´ç†çš„åŠŸèƒ½æµç¨‹ï¼Œæ¢³ç†å‡ºä»£ç æµè½¬çš„è¿‡ç¨‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬å°±å¯ä»¥å¤§ä½“åˆ†æå‡ºé¡¹ç›®ä»£ç ä¸­ç›®å½•çš„åˆ†å±‚ï¼Œå„ä¸ªæ¨¡å—çš„åŠŸèƒ½äº†ã€‚æˆ‘ä»¬è¿˜å¯ä»¥å€ŸåŠ©å·¥å…·æ¥ç»˜åˆ¶ä»£ç çš„ä¾èµ–å›¾ï¼Œè¿™æ ·å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„ç†è§£ä»£ç ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨é˜…è¯»çš„è¿‡ç¨‹ä¸­ä»£ç æœ¬èº«å¯èƒ½ä¹Ÿä¼šæœ‰æˆ‘ä»¬çœ‹ä¸æƒ¯çš„åœ°æ–¹ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦æŠŠä»£ç åˆ‡å‡ºä¸€ä¸ªåˆ†æ”¯æ¥ï¼Œä¸“é—¨ç”¨æ¥è®°å½•è‡ªå·±é˜…è¯»æ—¶å†™çš„æ³¨é‡Šä»¥åŠä¸€äº›è§‰å¾—è¦é‡æ„çš„ç‚¹ï¼Œä½†æ˜¯åƒä¸‡ä¸è¦ç›´æ¥å¼€å§‹åŠ¨æ‰‹ï¼Œä¸€å®šåªæ˜¯è®°å½•ï¼Œæ‰“ä¸Šæ ‡è®°ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;// TODO: è¿™é‡Œæœ‰å¾…é‡æ„
// ? ä¸ºä»€ä¹ˆè¿™é‡Œç”¨çš„æ˜¯è¿™ç§æ–¹å¼
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç­‰ç­‰ï¼Œä¹Ÿæ˜¯æŠŠè‡ªå·±çš„ç–‘é—®è®°å½•ä¸‹æ¥ï¼Œåç»­æœ‰éœ€è¦å¯ä»¥å¸¦ç€ç–‘é—®å»é—®åŒäº‹ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä»£ç é˜…è¯»çš„è¿‡ç¨‹ä¸­ï¼Œåˆ‡è®°ä¸è¦é™·å…¥ç»†èŠ‚ï¼Œä¸è¦é™·å…¥ç»†èŠ‚ï¼Œä¸è¦é™·å…¥ç»†èŠ‚ã€‚æˆ‘ä»¬åªéœ€è¦ææ¸…æ¥šä»£ç æµè½¬çš„è¿‡ç¨‹å³å¯ï¼Œè‡³äºä»£ç çš„å®ç°ç»†èŠ‚ï¼Œæˆ‘ä»¬åç»­åœ¨è§£BUGçš„è¿‡ç¨‹ä¸­å†å»é€æ­¥ç†Ÿæ‚‰ã€‚&lt;/p&gt;

&lt;h3 id=&#34;5-ä»å°é—®é¢˜å…¥æ‰‹-é€æ­¥ä¸Šæ‰‹&#34;&gt;5. ä»å°é—®é¢˜å…¥æ‰‹ï¼Œé€æ­¥ä¸Šæ‰‹&lt;/h3&gt;

&lt;p&gt;å…¥æ‰‹é¡¹ç›®çš„åˆæœŸä¸è¦å¥½é«˜éª›è¿œï¼Œæˆ‘ä»¬ä»è§£å°çš„BUGå¼€å§‹ç†Ÿæ‚‰æ€ä¹ˆæ­£ç¡®çš„æäº¤ç¬¬ä¸€ä¸ªPRï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥å­¦ä¹ é¡¹ç›®çš„è§„èŒƒï¼Œæ­£ç¡®çš„å†™å•å…ƒæµ‹è¯•ï¼Œç„¶åè§£BUGçš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸è¦çœ‹å“ªé‡Œçš„ä»£ç å°±åªæ˜¯å“ªé‡Œçš„ä»£ç ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨æ¨¡å—çš„è¾¹ç•Œï¼Œäº†è§£æ•´ä¸ªæ¨¡å—éƒ½æœ‰ä¸€äº›ä»€ä¹ˆåŠŸèƒ½ã€‚å¾ˆå¤šçš„BUGå¾€å¾€ä¸æ˜¯ä¸»è¦åŠŸèƒ½æµç¨‹ä¸­çš„é—®é¢˜ï¼Œåœ¨å¤„ç†è¿™äº›å°çš„BUGçš„æ—¶å€™æ­£æ˜¯æˆ‘ä»¬å»äº†è§£å…¶å®ƒéä¸»è¦æµç¨‹åŠŸèƒ½çš„å¥½æœºä¼šã€‚&lt;/p&gt;

&lt;h3 id=&#34;6-æ–°åŠŸèƒ½ä¸é‡æ„&#34;&gt;6. æ–°åŠŸèƒ½ä¸é‡æ„&lt;/h3&gt;

&lt;p&gt;å½“æˆ‘ä»¬å¯¹é¡¹ç›®æœ‰ä¸€å®šçš„äº†è§£åï¼Œå°±å¯ä»¥åšä¸€äº›æ–°åŠŸèƒ½äº†ï¼Œç„¶ååœ¨è§„åˆ’æ–°åŠŸèƒ½æ—¶ï¼Œå¾€å¾€æˆ‘ä»¬éœ€è¦å¯¹æ¶‰åŠåˆ°å·²æœ‰çš„ä»£ç åšä¸€äº›é‡æ„ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ¡ä»£ç é‡æ„çš„ä¸€ä¸ªåº¦ï¼Œä¸€å®šæ˜¯æœ‰é™å¤„ç†å¯¹æˆ‘ä»¬å†™æ–°åŠŸèƒ½æœ‰é˜»ç¢çš„ä»£ç ï¼Œç„¶åéœ€è¦è€ƒè™‘åŠŸèƒ½çš„åç»­è¿­ä»£ä¸æœªæ¥çš„æ¼”è¿›æ¥é‡æ„ã€‚æ¸è¿›å¼çš„é‡æ„ï¼Œä¸è¦ä¸Šæ¥å°±æå¤§çš„ï¼Œæˆ‘ç›¸ä¿¡å¾ˆå¤šç¨‹åºå‘˜éƒ½å¸Œæœ›èƒ½æŠŠä»£ç å†™çš„è·Ÿç¬¦åˆè‡ªå·±çš„å®¡ç¾ï¼Œä½†æ˜¯åˆæœŸè¿˜æ˜¯è¦ä»¥åŠŸèƒ½ä¸ºä¸»ï¼Œå†å®ç°åŠŸèƒ½çš„åŒæ—¶å°æ­¥æ¸è¿›å¼çš„é‡æ„ã€‚é‡æ„æœ‰å¾ˆå¤šæŠ€å·§ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬æ”¹ä¸åŠ¨çš„ä»£ç åšéš”ç¦»ï¼Œå…ˆä¿è¯èƒ½è·‘èµ·æ¥ï¼Œç„¶åå†å®Œå–„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;åˆå…¥ä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°å¾ˆå¤šå¾ˆå¤šé—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯æŠŠè¿™äº›ç–‘é—®éƒ½è®°å½•ä¸‹æ¥ï¼Œç„¶åå¸¦ç€ç–‘é—®æ…¢æ…¢å»ç†Ÿæ‚‰ï¼Œç†Ÿæ‚‰ä¸€ä¸ªé¡¹ç›®ä¹Ÿéœ€è¦ä¸€ä¸ªè¿‡ç¨‹ï¼Œä¸è¦ç€æ€¥ï¼Œ1ä¸ªæ˜ŸæœŸä¸è¡Œï¼Œå°±1ä¸ªæœˆï¼Œé‡åˆ°å›°éš¾å°±åŠæ—¶å¯»æ±‚å¸®åŠ©ã€‚å‰äººç§æ ‘ï¼Œåäººä¹˜å‡‰ã€‚å¦‚æœå‰äººæ²¡èƒ½å¸®ä½ ç§å¥½æ ‘ï¼Œé‚£æˆ‘ä»¬å°±æŠŠæˆ‘ä»¬ç†Ÿæ‚‰é¡¹ç›®çš„è¿‡ç¨‹æ•´ç†æˆæ–‡æ¡£ï¼Œç•™ç»™åäººï¼Œè¿™æ ·åäººå°±å¯ä»¥å°‘èµ°å¾ˆå¤šå¼¯è·¯ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>æˆ‘çš„2024</title>
      <link>https://zhu327.github.io/2024/12/31/%E6%88%91%E7%9A%842024/</link>
      <pubDate>Tue, 31 Dec 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/12/31/%E6%88%91%E7%9A%842024/</guid>
      <description>&lt;p&gt;ä»Šå¤©æ˜¯2024å¹´çš„æœ€åä¸€å¤©ï¼Œæˆ‘æœ‰è¿™ä¸€ä¸‹åˆçš„ç©ºé—²æ—¶é—´ï¼Œæ‰€ä»¥å°±è®©æˆ‘æ¥çµ®çµ®å¨å¨çš„å†™å†™æˆ‘è¿™ç¥å¥‡çš„2024å¹´å§ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘æ˜¯é¾™å¹´å‡ºç”Ÿçš„ï¼Œæ‰€ä»¥2024å¹´æ˜¯æˆ‘çš„æœ¬å‘½å¹´ï¼Œå¹´åˆçš„æ—¶å€™ï¼Œè€å©†è¿˜æœ‰å§å§å°±ç»™æˆ‘å‡†å¤‡äº†çº¢å†…è£¤ï¼Œçº¢è¢œå­ã€‚ç”±äºçº¢è¢œå­å¤ªè¿‡æ˜¾çœ¼äº†ï¼Œæ‰€ä»¥è¿™ä¸€å¹´æˆ‘çš„å†…è£¤éƒ½æ˜¯çº¢è‰²çš„ï¼Œå“ˆå“ˆã€‚æœ¬å‘½å¹´ï¼ŒçŠ¯å¤ªå²ï¼Œè¿™ä¸€å¹´å·¥ä½œä¸Šï¼Œå¿ƒæ€ä¸Šï¼Œéƒ½æœ‰ä¸€äº›å˜åŒ–ï¼Œå°±è®©æˆ‘åœ¨æœ¬å‘½å¹´çš„æœ€åä¸€å¤©çå†™å†™å§ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æˆ‘è‡ªå·±&#34;&gt;æˆ‘è‡ªå·±&lt;/h3&gt;

&lt;p&gt;æˆ‘æ˜¯80å¹´ä»£æœ«ç”Ÿäººï¼Œå‡ºç”Ÿåœ¨ä¸€ä¸ªå°é•‡ï¼Œæ˜¯æ ‡å‡†çš„å°é•‡åšé¢˜å®¶ã€‚ä»é«˜ä¸­å¼€å§‹åŸºæœ¬å°±ä¸æ€ä¹ˆå›å®¶äº†ï¼Œç„¶åä¸Šå¤§å­¦ï¼Œè·‘å»äº†äº‘å—ï¼ŒåŒéä¸€æœ¬ï¼Œå­¦çš„æ˜¯çƒ­èƒ½ä¸åŠ¨åŠ›å·¥ç¨‹ã€‚æˆ‘çš„åŒå­¦å¤§éƒ½æ‰¾åˆ°äº†æ°´ç”µå‚ï¼Œç«ç”µå‚çš„å·¥ä½œã€‚å·¥ä½œå¥½çš„å»äº†ä¸‰å³¡ï¼Œä¸€èˆ¬å°±å»äº†äº‘å—ä¸€äº›æ¯”è¾ƒååƒ»çš„ç”µå‚ã€‚è€Œæˆ‘å‘¢æ¯•ä¸šå°±å¤±ä¸šäº†ï¼Œåæ¥æ‰¾åˆ°ä¸€ä¸ªæµ·å—çš„å°ç”µå‚ã€‚å·¥ä½œ2å¹´åï¼Œæˆ‘å°±æ¥åˆ°äº†æ·±åœ³ï¼Œåœ¨èººäº†å¥½å‡ ä¸ªæœˆåï¼Œç»ä¸€ä¸ªäº²æˆšçš„ä»‹ç»åˆ°ä¸€ä¸ªåä¸ºçš„è½¯ä»¶å¤–åŒ…å…¬å¸å­¦ä¹ åšè½¯ä»¶æµ‹è¯•ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;è½¯ä»¶æµ‹è¯•æœ¬èº«æ˜¯æ²¡ä»€ä¹ˆé—¨æ§›çš„ï¼Œç„¶åæˆ‘è‡ªè®¤ä¸ºè¿˜æœ‰ç‚¹å°èªæ˜ï¼Œä¹Ÿç”±äºäº²æˆšçš„å®‰æ’ï¼Œæˆ‘æ‰€åœ¨çš„é¡¹ç›®å¹¶ä¸æ˜¯çº¯ç²¹çš„æ‰‹å·¥æµ‹è¯•ã€‚è€Œæ˜¯åå‘è‡ªåŠ¨åŒ–çš„TCP/IPåè®®æ ˆçš„æµ‹è¯•ï¼Œè¿™ä¸ªæµ‹è¯•éœ€è¦æˆ‘å†™ä¸€äº›Luaè„šæœ¬æ¥æ¨¡æ‹Ÿå‘é€ä¸€äº›æ•°æ®åŒ…æ¥åšæµ‹è¯•ã€‚è™½ç„¶è¿™ä¸æ˜¯ä¸€ä¸ªå¼€å‘çš„å·¥ä½œï¼Œä½†æ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘è¿˜æ˜¯å­¦åˆ°ä¸å°‘ä¸œè¥¿ï¼ŒåŸºæœ¬çš„åè®®æ ˆï¼Œsocketï¼Œè¿˜æœ‰ä¸€äº›åŸºç¡€çš„ç¼–ç¨‹è¯­è¨€æ–¹é¢çš„çŸ¥è¯†ã€‚&lt;/p&gt;

&lt;p&gt;åæ¥åˆæ¢äº†åˆ«çš„é¡¹ç›®ï¼ŒåšGUIè·Ÿç½‘é¡µçš„åŠŸèƒ½æµ‹è¯•ï¼Œæˆ‘æ¥æ‰‹è¿™ä¸ªé¡¹ç›®çš„æµ‹è¯•çš„æ—¶å€™ï¼Œé‡Œé¢è¿˜ç»´æŠ¤äº†ä¸€å †Javaå†™çš„åŸºäºä¸€ä¸ªIBMçš„æµ‹è¯•æ¡†æ¶çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ã€‚è¿™å¯éš¾å€’æˆ‘äº†ï¼Œä»¥è‡³äºå¤§åŠå¹´çš„æ—¶é—´æˆ‘éƒ½æ²¡è·‘è¿‡è¿™ä¸ªè‡ªåŠ¨åŒ–çš„æµ‹è¯•ï¼Œä¸€ç›´éƒ½æ˜¯æ‰‹åŠ¨æµ‹è¯•ã€‚æƒ³æƒ³ä¸æ˜¯åŠæ³•ï¼Œè¿˜æ˜¯ææè‡ªåŠ¨åŒ–çš„æµ‹è¯•å§ï¼ŒJavaæ˜¯ä¸€æ—¶åŠä¼šå­¦ä¸ä¼šçš„ï¼Œä¸å¦‚è‡ªå·±å­¦ä¸€å­¦Pythonè‡ªåŠ¨åŒ–å§ï¼Œå°±è¿™æ ·æˆ‘æ¥è§¦åˆ°Pythonç¼–ç¨‹ã€‚æˆ‘ä¾ç„¶è®°å¾—åœ¨æŸä¸€å¤©æˆ‘ç”¨Pythonå†™äº†ä¸€ä¸ªè‡ªåŠ¨åŒ¹é…å…³é”®å­—çš„å·¥å…·ç”¨æ¥åšå®‰å…¨æ£€æŸ¥åï¼Œè·å¾—äº†åä¸ºçš„æŒç»­é›†æˆå¥–ã€‚&lt;/p&gt;

&lt;p&gt;å°±è¿™æ ·æˆ‘åœ¨è¿™ä¸ªè½¯ä»¶å¤–åŒ…å…¬å¸åšæµ‹è¯•åšäº†4å¹´ï¼Œç„¶åæˆ‘å†³å®šè¿˜æ˜¯æ‰¾ä¸€ä»½Pythonå¼€å‘çš„å·¥ä½œå§ï¼Œäºæ˜¯åœ¨å­¦ä¹ äº†Djangoå¼€å‘åï¼Œæˆ‘å°±è£¸è¾äº†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨2015å¹´çš„é‚£ä¸ªæ¿€è¡çš„ä¸‡ä¼—åˆ›ä¸šï¼Œä¸‡ä¼—åˆ›æ–°çš„2015å¹´ï¼Œåªè¦ä½ ä¼šå†™ç‚¹ä»£ç ï¼Œå°±èƒ½æ‰¾åˆ°å·¥ä½œã€‚äºæ˜¯æˆ‘å…¥èŒäº†ä¸€å®¶å¾ˆå°çš„å…¬å¸åšPythonåç«¯å¼€å‘ï¼Œç„¶ååŠå¹´ä¹‹åï¼Œæˆ‘å°±è¢«ä¼˜åŒ–äº†ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ç¡®å®æ€€ç–‘è¿‡è‡ªå·±ï¼Œæˆ‘æ˜¯ä¸æ˜¯çœŸçš„é€‚åˆåšå¼€å‘å‘¢ï¼Œæˆ‘èƒ½æ‹¿å‡ºæ‰‹çš„é¡¹ç›®åªæœ‰æˆ‘åœ¨githubä¸Šå†™çš„ä¸€ä¸ªDjangoçš„è®ºå›ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶åå°±åˆå¼€å§‹æ‰¾å·¥ä½œäº†ï¼Œä¸æ˜¯å¾ˆé¡ºåˆ©ï¼Œç›´åˆ°2015å¹´ä¸‹åŠå¹´çš„æŸä¸€å¤©ï¼Œæˆ‘æ”¶åˆ°äº†ä¸€å°é‚®ä»¶ï¼Œå—¯ï¼Œä¸€å®¶æˆ‘æ²¡æœ‰æŠ•é€’çš„å…¬å¸é‚€è¯·æˆ‘å»é¢è¯•ã€‚åæ¥æ‰ä»è¿™å®¶å…¬å¸çš„CTOå£ä¸­å¾—çŸ¥ï¼Œä»–æ˜¯åœ¨çœ‹åˆ°æˆ‘çš„githubæ‰é‚€è¯·æˆ‘å»é¢è¯•çš„ï¼Œç„¶åæˆ‘å°±å…¥èŒäº†è¿™å®¶å…¬å¸ï¼Œç»§ç»­åšPythonçš„åç«¯å¼€å‘ã€‚åœ¨è¿™å®¶å…¬å¸æˆ‘åˆæ‰¾åˆ°äº†è‡ªä¿¡ã€‚ç„¶ååœ¨è¿™é‡Œæˆ‘å‘ç°æˆ‘åšæµ‹è¯•çš„ç»å†è¿˜æ˜¯æœ‰ç”¨çš„ï¼Œæ¯•ç«Ÿæˆ‘çš„è‡ªæµ‹åšçš„æ¯”è¾ƒç»†è‡´ï¼Œä»¥è‡³äºæˆ‘çš„æ•ˆç‡ä»¥åŠè´¨é‡éƒ½è¿œè¶…å…¶ä»–åŒäº‹ã€‚ç„¶åç”±äºæ•ˆç‡çš„æå‡ï¼Œå¾ˆå¿«æˆ‘å°±å¼€å§‹è´Ÿè´£æ›´åŸºç¡€çš„æ¡†æ¶å¼€å‘ï¼Œå¼•å…¥äº†DRFæ¡†æ¶ï¼Œè¿˜å°è¯•åšäº†RPCæ¡†æ¶ï¼Œç„¶ååˆå¼•å…¥äº†APIç½‘å…³ï¼Œè®¤è¯†äº†Openrestyï¼Œä½ çœ‹ï¼ŒOpenrestyåˆå›åˆ°äº†æˆ‘æœ€åˆåšæµ‹è¯•çš„è€æœ¬è¡ŒLuaä¸Šé¢ã€‚&lt;/p&gt;

&lt;p&gt;ç”±äºåœ¨githubä¸Šé¢å°åˆ°äº†ç”œå¤´ï¼Œåç»­æˆ‘åˆåœ¨githubä¸Šå†™äº†ä¸€äº›Openrestyçš„å°é¡¹ç›®ï¼Œä¹Ÿæœ‰Python RPCç›¸å…³çš„é¡¹ç›®ï¼Œç„¶åä¹Ÿå†™äº†ä¸€äº›æˆ‘è§‰å¾—è¿˜è¡Œçš„åšå®¢æ–‡ç« ã€‚æˆ‘æ„Ÿè§‰æˆ‘çš„èƒ½åŠ›è¿˜æ˜¯åˆæ¯”è¾ƒå¤§çš„æå‡çš„ï¼Œæˆ‘æƒ³æˆ‘æ˜¯ä¸æ˜¯å†å‡ºå»æ‰¾æ‰¾æœºä¼šå‘¢ï¼Ÿæ‰€ä»¥æˆ‘åˆå¼€å§‹é¢è¯•äº†ï¼Œä¸å‡ºæ„å¤–çš„è¿˜æ˜¯è¢«æ‰“å‡»åˆ°äº†ï¼Œæ— éæ˜¯å› ä¸ºéç§‘ç­å‡ºç”Ÿï¼Œç„¶ååŸºç¡€å¾ˆå·®ã€‚æœ‰ä¸€ä¸ªæ¯”è¾ƒniceçš„é¢è¯•å®˜æ¨èæˆ‘å»è¯»ä¸€è¯»æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿï¼Œç„¶åæˆ‘å°±ä¹°äº†è¿™æœ¬ä¹¦ã€‚å¹´è½»çš„æ—¶å€™è¿˜æ˜¯æ¯”è¾ƒè¦å¼ºçš„ï¼Œä¸å–œæ¬¢è®¤è¾“ï¼Œæ‰€ä»¥èŠ±äº†å¥½å‡ ä¸ªæœˆæ­»å•ƒè¿™æœ¬ä¹¦ï¼Œç„¶åå†å›é¡¾è‡ªå·±çš„åœ¨å·¥ä½œä¸­ç‚¹ç‚¹æ»´æ»´ï¼Œç¡®å®å¯¹ç¼–ç¨‹è¿™ä¸ªå·¥ä½œæœ‰äº†æ›´å¤šçš„ç†è§£ã€‚å†ç„¶åæˆ‘å°±ä¹°äº†æ›´å¤šçš„ä¹¦ï¼Œåœ¨doubanä¸Šæ‰¾è¯„åˆ†é«˜çš„ä¹¦ï¼Œè¡¥é½äº†å¾ˆå¤šåŸºç¡€çŸ¥è¯†ã€‚&lt;/p&gt;

&lt;p&gt;æ—¶é—´æ¥åˆ°äº†2018å¹´ï¼Œå¾ˆå¹¸è¿çš„æ˜¯æˆ‘é€šè¿‡äº†è…¾è®¯çš„é¢è¯•ï¼Œè¿™é‡Œé¢æœ‰æˆ‘è¯»ä¹¦çš„èƒ½åŠ›æå‡ï¼Œä¹Ÿæœ‰ä¸åœåœ¨githubä¸Šå†™é¡¹ç›®çš„åŠªåŠ›ï¼Œè¿˜æœ‰æˆ‘é‚£å‡ å¹´ç§¯ç´¯ä¸‹æ¥çš„å·¥ä½œç»éªŒã€‚&lt;/p&gt;

&lt;h3 id=&#34;è…¾è®¯&#34;&gt;è…¾è®¯&lt;/h3&gt;

&lt;p&gt;åˆå…¥è…¾è®¯ï¼Œæˆ‘æ˜¯åœ¨ä¸€ä¸ªè¿ç»´ç»„é‡Œçš„å”¯ä¸€çš„å¼€å‘ï¼Œæˆ‘æ¥çš„éœ€æ±‚éƒ½æ˜¯æˆ‘çš„è¿ç»´åŒäº‹é€šè¿‡å¼€å‘å·¥å…·æ¥æ”¹å–„ä»–ä»¬çš„è¿ç»´å·¥ä½œã€‚è¿™æœŸé—´æœ‰ä¸€ä¸ªç›´æ’­æ¨æµç›¸å…³çš„éœ€æ±‚å¯¹æˆ‘æ¥è¯´ç®—æ˜¯ä¸€ä¸ªå¥‘æœºï¼Œä¿ƒæˆäº†æˆ‘ä»Pythonç¨‹åºè½¬å‘Golangç¨‹åºå‘˜ã€‚åœ¨è¿™ä¸ªç»„é‡Œåšäº†ä¸€å¹´åï¼Œæˆ‘è§‰å¾—æˆ‘åšçš„çš„äº‹æƒ…éƒ½ä¸å…·å¤‡æŒä¹…æ€§ï¼Œæ²¡æœ‰ä¸€ä¸ªæ¸…æ™°çš„æœªæ¥ï¼Œæ‰€ä»¥æˆ‘å†³å®šæ¢ä¸€ä¸ªç»„ï¼Œäºæ˜¯æˆ‘æ¥åˆ°äº†è“é²¸çš„å¼€å‘ç»„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨è…¾è®¯ä½œä¸ºä¸€ä¸ªéç§‘ç­å‡ºèº«çš„æ–°äººï¼Œæˆ‘å¹¶æ²¡æœ‰è§‰å¾—è‡ªå·±èƒ½åšå¾ˆä¹…ï¼Œæˆ‘è„‘å­é‡Œä¸€ç›´æœ‰ä¸€ä¸ªå¿µæƒ³å°±æ˜¯åšä¸ªå‡ å¹´ï¼Œæœ‰äº†å¤§å‚å…‰ç¯ï¼Œç„¶åå†å‡ºå»ä½œä¸ºä¸€ä¸ªæ¶æ„å¸ˆæ‰¾ä¸€ä»½æ–°çš„å·¥ä½œã€‚ä½†æ˜¯æˆ‘åœ¨è“é²¸ç¡®å®è®¤è¯†äº†ä¸€ç¾¤niceçš„åŒäº‹ï¼Œç„¶åè¿™ä¸€åšå°±æ˜¯5å¹´ã€‚è¿™æœŸé—´æˆ‘ä¸€ç›´ä¸“æ³¨åœ¨ä¸€ä¸ªé¡¹ç›®ä¸Šï¼Œå¯ä»¥è¯´æˆä¸ºäº†é¢†åŸŸå†…çš„ä¸“å®¶ã€‚æŒç»­çš„ä¸€ç›´åšä¸€ä»¶äº‹æƒ…æœ‰å¥½å¤„ï¼Œä¹Ÿæœ‰åå¤„ï¼Œå¥½å¤„æ˜¯ä½ å¯ä»¥åœ¨è¿™ä¸ªé¢†åŸŸå†…åšåˆ°æè‡´ï¼Œåå¤„æ˜¯ä½ å¾ˆéš¾è·³å‡ºè¿™ä¸ªé¢†åŸŸã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å¤§å‚ï¼Œæ¯åŠå¹´ä¸€æ¬¡çš„è€ƒæ ¸ï¼Œå‚¬ä¿ƒç€æˆ‘æˆé•¿ï¼Œæ²Ÿé€šèƒ½åŠ›ï¼Œé¡¹ç›®ç®¡ç†èƒ½åŠ›ï¼Œæ¶æ„èƒ½åŠ›ï¼Œè§„åˆ’èƒ½åŠ›ç­‰ç­‰ï¼Œæˆ‘éƒ½æœ‰å®å®åœ¨åœ¨çš„æˆé•¿ã€‚ç„¶è€Œåœ¨æœ¬å‘½å¹´çš„è¿™ä¸€å¹´ï¼Œæˆ‘è¿˜æ˜¯è§‰å¾—æˆ‘å¯ä»¥ç¦»å¼€äº†ï¼Œæ¯•ç«Ÿäº’è”ç½‘35å²çš„å±æœºï¼Œå¹´çºªè¶Šå¤§æ„Ÿå—è¶Šæ·±ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ–°å·¥ä½œ&#34;&gt;æ–°å·¥ä½œ&lt;/h3&gt;

&lt;p&gt;è™½ç„¶é¡¶ç€å¤§å‚å…‰ç¯ï¼Œä½†æ˜¯åœ¨2024å¹´36å²çš„å¹´çºªï¼Œæ‰¾å·¥ä½œè¿˜æ˜¯å¾ˆå›°éš¾ï¼Œé¢è¯•äº†å¾ˆå¤šï¼Œåªè¦æ¶‰åŠå†™ç®—æ³•ä»€ä¹ˆçš„åŸºæœ¬éƒ½æŒ‚äº†ï¼Œç„¶åæˆ‘å°±é™è–ªå…¥èŒäº†ç°åœ¨çš„å…¬å¸ã€‚æˆ‘æœ‰äº†æ›´å¤šçš„æ—¶é—´ï¼Œç„¶åå†™äº†æ›´å¤šçš„æ–‡ç« ï¼Œä¹Ÿå­¦ä¹ äº†Rustç¼–ç¨‹ï¼Œæ–°çš„Rustçš„é¡¹ç›®ä¹Ÿéƒ½æ”¾åˆ°äº†githubä¸Šã€‚æˆ‘ä¸çŸ¥é“è‡ªå·±çš„èŒä¸šç”Ÿæ¶¯è¿˜èƒ½èµ°å¤šè¿œï¼Œä½†æ˜¯æˆ‘è§‰å¾—æˆ‘ä¾ç„¶çƒ­çˆ±ç¼–ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;éšç€AIç¼–ç¨‹åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œæˆ‘è§‰å¾—å¯¹äºå¤´éƒ¨çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œä»–ä»¬çš„ä¼˜åŠ¿ä¼šè¶Šæ¥è¶Šå¤§ï¼Œå› ä¸ºAIä¼šæå¤§çš„æå‡ä»–ä»¬çš„æ•ˆç‡ï¼Œè¿™å¯¹ä¸­ä¸‹éƒ¨çš„ç¨‹åºå‘˜å¯èƒ½æ˜¯ä¸€ä¸ªç¾éš¾ã€‚å¯èƒ½ä¼šå› ä¸ºè¿™ä¸ªæ•´ä¸ªå¸‚åœºçš„è¡Œæƒ…ä¼šè¶Šæ¥è¶Šå·®ï¼Œæ‰€ä»¥æˆ‘ä¸ªäººè§‰å¾—æŒç»­å­¦ä¹ ï¼Œç»ˆèº«å­¦ä¹ åœ¨è¿™ä¸ªæ—¶ä»£æ˜¯å¿…é¡»çš„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ç”Ÿæ´»&#34;&gt;ç”Ÿæ´»&lt;/h3&gt;

&lt;p&gt;3æœˆçš„æ—¶å€™è·Ÿè€å©†æ¥äº†ä¸€æ¬¡å¹¿è¥¿è‡ªé©¾æ¸¸ï¼Œä»æ·±åœ³å‡ºå‘ï¼Œå¼€ç€æˆ‘çš„ç”µè½¦ç¬¬ä¸€æ¬¡é•¿é€”è‡ªé©¾ï¼Œæ„Ÿè°¢è€å©†çš„è¾›è‹¦åšäº†æ”»ç•¥ï¼Œåœ¨å¹¿è¥¿è¾¹å¢ƒçœ‹äº†å¤§ç€‘å¸ƒï¼Œä¹Ÿç¬¬ä¸€æ¬¡ä½“éªŒäº†æº¶æ´é€Ÿé™ï¼Œè¿˜çœ‹åˆ°äº†ç¾ä¸½æ¢¦å¹»çš„ä¸‰é—¨æµ·ã€‚ä¹Ÿå»äº†ä¸€äº›å°ä¼—çš„æ™¯ç‚¹ã€‚åœ¨å¹¿è¥¿çš„å±±é—´å°è·¯æ‚¬å´–è¾¹å°å¿ƒçš„å¼€ç€è½¦ï¼Œåœ¨æº¶æ´é‡Œé¢å¬ç€æ°´æµçš„å£°éŸ³ï¼Œçœ‹ç€å¤´é¡¶çš„ç¯å…‰ï¼Œé‚£ç§æ„Ÿè§‰çœŸçš„å¾ˆæ£’ã€‚&lt;/p&gt;

&lt;p&gt;7æœˆçš„æ—¶å€™ï¼Œæ­£å¼ä»è…¾è®¯ç¦»èŒäº†ï¼Œç„¶åä¹Ÿæ²¡æ‰¾åˆ°å·¥ä½œï¼Œå°±åœ¨å®¶é‡Œèººå¹³é™é™çš„æ€è€ƒäº†ï¼Œå…³äºå·¥ä½œä¸ç„¦è™‘æ˜¯å‡çš„ï¼Œä½†æ˜¯ç”Ÿæ´»ä¹Ÿæ˜¯è¦ç»§ç»­çš„ã€‚æ–°çš„å·¥ä½œå¼€å§‹åï¼Œæˆ‘æœ‰äº†æ›´å¤šçš„æ—¶é—´é™ªå°å­©ï¼Œçœ‹ç€å°å­©çš„æˆé•¿ï¼Œç¡®å®åˆæ„Ÿè§‰ç”Ÿæ´»ä¸ä¸€æ ·äº†ï¼Œå°å­©çš„éœ€æ±‚æ²¡é‚£ä¹ˆå¤šï¼Œæ›´å¤šæ˜¯æˆ‘éƒ½æ˜¯ä½œä¸ºä¸€ä¸ªæ§å“çš„è§’è‰²ï¼Œçœ‹ç€å¥¹ç©è€ï¼Œé…åˆå¥¹çš„å„ç§éœ€æ±‚ã€‚&lt;/p&gt;

&lt;p&gt;å…³äºæœªæ¥ï¼Œä¸–ç•Œå˜åŒ–å¾ˆå¿«ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æœªæ¥ä¼šæ€ä¹ˆæ ·ï¼Œåœ¨æ·±åœ³è¿˜æ²¡æœ‰ä¹°æˆ¿ï¼Œæ²¡å•¥å‹åŠ›ï¼Œåœ¨å¹¿è¥¿æ¸¸çš„è¿‡ç¨‹ä¸­æœ‰ä¸ªå°å°çš„ç§å­ç§åœ¨äº†å¿ƒé‡Œï¼Œä»€ä¹ˆæ—¶å€™èƒ½åœ¨å¹¿è¥¿æ‰¾ä¸ªå±±å¥½æ°´å¥½çš„åœ°æ–¹è¿‡ä¸Šæ…¢ç”Ÿæ´»å‘¢ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ç»“å°¾&#34;&gt;ç»“å°¾&lt;/h3&gt;

&lt;p&gt;å›å¤´çœ‹2024å¹´ï¼Œè¿™ä¸€å¹´è¿‡å¾—æŒºç‰¹åˆ«çš„ï¼Œæœ‰å˜åŒ–ä¹Ÿæœ‰æˆé•¿ã€‚æ— è®ºæ˜¯å·¥ä½œä¸Šçš„è½¬æŠ˜ï¼Œè¿˜æ˜¯ç”Ÿæ´»ä¸­çš„ç‚¹æ»´ï¼Œæˆ‘éƒ½åœ¨æ…¢æ…¢é€‚åº”ã€æ…¢æ…¢è°ƒæ•´ã€‚è™½ç„¶æœªæ¥ä¼šæ€æ ·è¿˜ä¸å¥½è¯´ï¼Œä½†æˆ‘æƒ³ç»§ç»­ä¿æŒå­¦ä¹ çš„ä¹ æƒ¯ï¼Œä¿æŒå¯¹ç”Ÿæ´»çš„çƒ­æƒ…ï¼Œä¹Ÿå°½é‡å¤šé™ªé™ªå®¶äººã€‚ç”Ÿæ´»æ€»æ˜¯è¿™æ ·ï¼Œå……æ»¡æœªçŸ¥ï¼Œä½†ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œæ¯ä¸€å¤©éƒ½å€¼å¾—è®¤çœŸè¿‡å¥½ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ä»Pingoraåˆ°APIç½‘å…³ï¼šæ€»ç»“</title>
      <link>https://zhu327.github.io/2024/12/19/%E4%BB%8Epingora%E5%88%B0api%E7%BD%91%E5%85%B3%E6%80%BB%E7%BB%93/</link>
      <pubDate>Thu, 19 Dec 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/12/19/%E4%BB%8Epingora%E5%88%B0api%E7%BD%91%E5%85%B3%E6%80%BB%E7%BB%93/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/zhu327/pingisx&#34;&gt;https://github.com/zhu327/pingisx&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ç»è¿‡ä¸€ä¸ªå¤šæœˆçš„å¼€å‘ï¼Œç»ˆäºå®Œæˆäº†ä½¿ç”¨Rustå®ç°ä¸€ä¸ªAPIç½‘å…³çš„ç›®æ ‡ï¼Œé€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘åŸºæœ¬ä¸ŠæŠŠPingoraçš„æ ¸å¿ƒåŠŸèƒ½éƒ½æ‘¸é€äº†ï¼Œç„¶åä¹Ÿå†æ¬¡åŠ æ·±äº†å¯¹APISIXçš„ç†è§£ã€‚æ€»çš„æ¥è¯´PingSIXåŸºäºPingoraå®ç°äº†APISIXçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ˜¯APISIXåŠŸèƒ½çš„ä¸€ä¸ªå­é›†ã€‚&lt;/p&gt;

&lt;p&gt;å¼€å‘è¿™ä¸ªé¡¹ç›®æœ¬èº«ä¹Ÿæ˜¯ä¸ºäº†å­¦ä¹ Rustçš„ä½¿ç”¨ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ç¡®å®ä¹Ÿé‡åˆ°äº†å¾ˆå¤šçš„é—®é¢˜ï¼Œåœ¨ChatGPTçš„å¸®åŠ©ä¸‹ï¼Œè¿™äº›é—®é¢˜å¾—åˆ°äº†è§£å†³ï¼Œä¹Ÿè®©æˆ‘å¯¹Rustæœ‰äº†æ›´æ·±åˆ»çš„ç†è§£ã€‚ä¸‹é¢æˆ‘é€šè¿‡4ä¸ªæ–¹é¢æ¥æ€»ç»“ä¸€ä¸‹åœ¨è¿™ä¸ªé¡¹ç›®ä¸­æˆ‘çš„æ”¶è·ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-ç”Ÿå‘½å‘¨æœŸ&#34;&gt;1. ç”Ÿå‘½å‘¨æœŸ&lt;/h3&gt;

&lt;p&gt;åœ¨Rustä¸­ï¼Œä»»ä½•å˜é‡ï¼Œå¯¹è±¡éƒ½æœ‰å®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸ä½œç”¨åŸŸï¼Œåˆšå¼€å§‹çœ‹Rustçš„ä¹¦æ—¶ï¼Œä¼šæƒ³æ˜¯ä¸æ˜¯åªæœ‰&lt;strong&gt;æŒ‡é’ˆ&lt;/strong&gt;éœ€è¦æ ‡æ³¨ï¼Œå®ƒæ‰æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œå…¶å®ä¸æ˜¯çš„ï¼Œä»»ä½•å˜é‡éƒ½æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ä½œç”¨åŸŸé—­åˆæ—¶ï¼Œç”Ÿå‘½å‘¨æœŸä¹Ÿå°±ç»“æŸäº†ï¼Œè€Œå†…å­˜ä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚è¿™å°±æ˜¯Rusté€šè¿‡ç”Ÿå‘½å‘¨æœŸæ¥ç®¡ç†å†…å­˜çš„æœºåˆ¶ã€‚&lt;/p&gt;

&lt;p&gt;å˜é‡çš„ä½œç”¨åŸŸå¯ä»¥ä»å‰ä¸€ä¸ªè½¬ç§»åˆ°åä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;move&lt;/code&gt;, è½¬ç§»åå‰ä¸€ä¸ªä½œç”¨åŸŸå°±ä¸å†æŒæœ‰è¿™ä¸ªå˜é‡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æ‰€æœ‰æƒï¼Œè¿™ä¸ªå˜é‡æ˜¯å±äºè¿™ä¸ªä½œç”¨åŸŸï¼Œåœ¨ä½œç”¨åŸŸå†…å°±å¯ä»¥ä½¿ç”¨ï¼Œè€Œåœ¨&lt;code&gt;move&lt;/code&gt;å‡ºä½œç”¨åŸŸåå°±æ— æ³•ä½¿ç”¨äº†ã€‚æ¯”å¦‚ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨ï¼Œå¯¹è±¡åœ¨ä¼ å…¥åï¼Œå¯¹è±¡çš„ä½œç”¨åŸŸå°±è½¬ç§»åˆ°æ–°çš„å‡½æ•°ä½œç”¨åŸŸä¸­ã€‚é‚£æˆ‘ä»¬å¦‚æœå¸Œæœ›åœ¨åŸæ¥çš„ä½œç”¨åŸŸä¸­ç»§ç»­ä½¿ç”¨è¿™ä¸ªå˜é‡ï¼Œå°±æ¶‰åŠåˆ°&lt;code&gt;Copy&lt;/code&gt; traitä¸&lt;code&gt;Clone&lt;/code&gt; traitäº†ï¼Œå¦‚æœå¯¹è±¡å®ç°äº†&lt;code&gt;Copy&lt;/code&gt; traitï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°±å¯ä»¥åœ¨åŸæ¥çš„ä½œç”¨åŸŸä¸­ç»§ç»­ä½¿ç”¨ã€‚å¦‚æœå¯¹è±¡å®ç°äº†&lt;code&gt;Clone&lt;/code&gt; traitï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å¯ä»¥åœ¨æ–°çš„ä½œç”¨åŸŸä¸­é€šè¿‡cloneæ–¹æ³•æ¥è·å–ã€‚æ— è®ºæ˜¯&lt;code&gt;Copy&lt;/code&gt; traitè¿˜æ˜¯&lt;code&gt;Clone&lt;/code&gt; traitï¼Œç›¸å½“äºæŠŠå¯¹è±¡å¤åˆ¶äº†ä¸€ä»½ï¼Œåœ¨æ–°çš„ä½œç”¨åŸŸä¸­å¯ä»¥ä½¿ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸å¸Œæœ›æ¯æ¬¡å‡½æ•°è°ƒç”¨éƒ½æŠŠå¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œå¹¶ä¸”åœ¨å‡½æ•°ä¸­ä¹Ÿä¸éœ€è¦æŒæœ‰å¯¹è±¡çš„æ‰€æœ‰æƒï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥é€šè¿‡&lt;code&gt;&amp;amp;&lt;/code&gt;æ¥&lt;strong&gt;å€Ÿç”¨&lt;/strong&gt;å¯¹è±¡ï¼Œé€šè¿‡&lt;code&gt;&amp;amp;mut&lt;/code&gt;æ¥&lt;strong&gt;å¯å˜å€Ÿç”¨&lt;/strong&gt;å¯¹è±¡ã€‚åˆçœ‹Rustçš„ä¹¦ï¼Œæˆ‘ä¼šè§‰å¾—è¿™ä¸å°±æ˜¯æŒ‡é’ˆå—ï¼Œå“ªä¸ªè¯­è¨€æ²¡æœ‰è¿™ä¸ªæ¦‚å¿µå‘€ï¼Œä½†æ˜¯çœŸæ­£ç†è§£äº†ç”Ÿå‘½å‘¨æœŸä¸æ‰€æœ‰æƒåï¼Œå°±ä¼šå‘ç°è¿™ç¡®å®å°±æ˜¯&lt;strong&gt;å€Ÿç”¨&lt;/strong&gt;ï¼Œæˆ‘ä¸ç»™ä½ æ‰€æœ‰æƒï¼Œä½ å¿…é¡»åœ¨æˆ‘çš„ä½œç”¨åŸŸå†…ä½¿ç”¨ï¼Œè¿™å°±æ˜¯å€Ÿç”¨ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶åå†æ¥ç†è§£ä¸‹ä¸€ä¸ªå¯¹è±¡ä¸èƒ½åŒæ—¶å­˜åœ¨&lt;strong&gt;å¯å˜å€Ÿç”¨&lt;/strong&gt;ä¸&lt;strong&gt;ä¸å¯å˜å€Ÿç”¨&lt;/strong&gt;ï¼Œä¹Ÿå°±æ¯”è¾ƒå¥½ç†è§£äº†ï¼Œå¦‚æœå¯å˜å€Ÿç”¨è¢«ä¿®æ”¹äº†ï¼Œé‚£åŒæ—¶å­˜åœ¨çš„ä¸å¯ä»¥å˜å€Ÿç”¨åˆ°åº•æ˜¯å˜äº†è¿˜æ˜¯æ²¡å˜å‘¢ï¼Œå¦‚æœéƒ½å­˜åœ¨å°±æ˜¯çŸ›ç›¾çš„ã€‚&lt;/p&gt;

&lt;p&gt;è¯´å®Œäº†å€Ÿç”¨ï¼Œå†æ¥çœ‹çœ‹æ™ºèƒ½æŒ‡é’ˆï¼Œæˆ‘å¸Œæœ›åœ¨å¤šä¸ªä½œç”¨åŸŸä¸­ä½¿ç”¨å¯¹è±¡ï¼Œå¹¶ä¸”éƒ½æœ‰æ‰€æœ‰æƒï¼Œé‚£å°±å¯ä»¥ä½¿ç”¨&lt;code&gt;Rc&amp;lt;T&amp;gt;&lt;/code&gt;ï¼Œå®ƒå®ç°äº†å¼•ç”¨è®¡æ•°ï¼Œå½“å¯¹è±¡è¢«Rcæ‰€æŒæœ‰æ—¶ï¼Œå¼•ç”¨è®¡æ•°åŠ 1ï¼Œå½“ç¦»å¼€ä½œç”¨åŸŸåï¼Œå¼•ç”¨è®¡æ•°å‡1ï¼Œå½“å¼•ç”¨è®¡æ•°ä¸º0æ—¶å†…å­˜è¢«é‡Šæ”¾ã€‚&lt;code&gt;Rc&amp;lt;T&amp;gt;&lt;/code&gt;æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾€å¾€ä½¿ç”¨&lt;code&gt;Arc&amp;lt;T&amp;gt;&lt;/code&gt;ï¼Œå®ƒå®ç°äº†åŸå­çš„å¼•ç”¨è®¡æ•°ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚è¿™2ä¸ªæ™ºèƒ½æŒ‡é’ˆæ˜¯é€šè¿‡ &lt;code&gt;Drop&lt;/code&gt; traitæ¥å®ç°å¼•ç”¨è®¡æ•°çš„å˜æ›´ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;Rc&amp;lt;T&amp;gt;&lt;/code&gt;ä¸&lt;code&gt;Arc&amp;lt;T&amp;gt;&lt;/code&gt;å¦‚æœç›´æ¥åŒ…è£¹å¯¹è±¡ï¼Œé‚£å¯¹è±¡å°±æ˜¯ä¸å¯å˜çš„ï¼Œä¸ºäº†å®ç°å¯å˜å€Ÿç”¨ï¼Œéœ€è¦ä½¿ç”¨&lt;code&gt;RefCell&amp;lt;T&amp;gt;&lt;/code&gt;åŒ…è£¹å¯¹è±¡ï¼Œé€šè¿‡&lt;code&gt;borrow_mut()&lt;/code&gt;æ¥è·å–å¯å˜å€Ÿç”¨ã€‚ç„¶è€Œ&lt;code&gt;RefCell&amp;lt;T&amp;gt;&lt;/code&gt;ä¹Ÿä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨&lt;code&gt;Mutex&amp;lt;T&amp;gt;&lt;/code&gt;æˆ–è€…&lt;code&gt;RWLock&amp;lt;T&amp;gt;&lt;/code&gt;æ¥åŒ…è£¹å¯¹è±¡ï¼Œé€šè¿‡&lt;code&gt;lock()&lt;/code&gt;è·å–å¯å˜å€Ÿç”¨ã€‚&lt;/p&gt;

&lt;p&gt;è¯´å®Œäº†ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€æœ‰æƒï¼Œå€Ÿç”¨ï¼Œæ™ºèƒ½æŒ‡é’ˆï¼Œä¸¾å‡ ä¸ªæˆ‘åœ¨PingSIXä¸­çš„å®é™…ä»£ç ï¼Œæ¥å¸®åŠ©ç†è§£ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;sd&#34;&gt;/// Proxy load balancer.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;///
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Manages the load balancing of requests to upstream servers.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;ProxyUpstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;SelectionLB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Runtime&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Sender&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ProxyUpstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;new_with_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstream&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proxy_upstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Self&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proxy_upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proxy_upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Starts the health check service, runs only once.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;start_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;take_background_service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Create a channel for watching the health check status
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch_tx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch_rx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;channel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch_tx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Determine the number of threads for the service
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Create a runtime based on the work_stealing flag
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;create_runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Spawn the service on the runtime
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;spawn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;move&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start_service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch_rx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Service exited.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Set the runtime lifecycle with ProxyUpstream
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;create_runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service_name&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Runtime&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;work_stealing&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Runtime&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new_steal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Runtime&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new_no_steal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;service_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;stop_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;watch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;take&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;ProxyUpstream&lt;/code&gt;æ˜¯åå‘ä»£ç†çš„ä¸Šæ¸¸å¯¹è±¡ï¼Œåœ¨newè¿™ä¸ªå¯¹è±¡çš„åŒæ—¶ä¼šåˆ›å»ºä¸€ä¸ªåå°ä»»åŠ¡æ¥æ‰§è¡Œå¥åº·æ£€æŸ¥ï¼Œå¯ä»¥çœ‹åˆ°å¥åº·æ£€æŸ¥åœ¨è¿™é‡Œæ˜¯é€šè¿‡&lt;code&gt;tokio&lt;/code&gt;çš„&lt;code&gt;Runtime&lt;/code&gt;æ¥æ‰§è¡Œçš„ã€‚åœ¨Golangä¸­æˆ‘å¯èƒ½ä¼šé€šè¿‡&lt;code&gt;go&lt;/code&gt;å…³é”®å­—æ¥åˆ›å»ºä¸€ä¸ªgoroutineæ¥æ‰§è¡Œåå°ä»»åŠ¡å°±ä¸ç®¡äº†ï¼Œç„¶è€Œåœ¨Rustè¿™é‡Œæˆ‘å¿…é¡»åœ¨&lt;code&gt;spawn&lt;/code&gt;åå°ä»»åŠ¡åè®©&lt;code&gt;ProxyUpstream&lt;/code&gt;æŒæœ‰&lt;code&gt;Runtime&lt;/code&gt;çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦åˆ™åå°ä»»åŠ¡ä¼šå› ä¸ºä½œç”¨åŸŸç»“æŸè€Œæå‰é€€å‡ºã€‚åœ¨&lt;code&gt;ProxyUpstream&lt;/code&gt;æŒæœ‰&lt;code&gt;Runtime&lt;/code&gt;åï¼Œåªæœ‰å½“&lt;code&gt;ProxyUpstream&lt;/code&gt;å¯¹è±¡è¢«dropåï¼Œåå°ä»»åŠ¡æ‰ä¼šç»“æŸã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Drop&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ProxyUpstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Stops the health check service if it exists.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;drop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stop_health_check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// ç¡®ä¿å…¶ä»–èµ„æºå¦‚ runtime è¢«é‡Šæ”¾
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;take&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// è·å– runtime çš„ handle
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// ä½¿ç”¨ handler æ‰§è¡Œå…³é—­é€»è¾‘
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;spawn_blocking&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;move&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shutdown_timeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Duration&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;from_secs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Runtime shutdown successfully.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å†æ¥çœ‹çœ‹&lt;code&gt;Drop&lt;/code&gt; traitçš„å®ç°ï¼Œåœ¨&lt;code&gt;ProxyUpstream&lt;/code&gt;å¯¹è±¡è¢«é‡Šæ”¾çš„åŒæ—¶æˆ‘ä»¬å¸Œæœ›åœæ­¢å¥åº·æ£€æŸ¥ï¼Œè¿™ä¸ªæ—¶å€™è¿˜éœ€è¦ä¸»åŠ¨å…³é—­&lt;code&gt;Runtime&lt;/code&gt;ï¼Œå¦åˆ™è¿è¡Œä¸­çš„&lt;code&gt;Runtime&lt;/code&gt;ä¼šå› ä¸ºä½œç”¨åŸŸç»“æŸè€Œpanicã€‚&lt;/p&gt;

&lt;p&gt;å†æ¥çœ‹ä¸€ä¸ªå¯å˜å€Ÿç”¨ä¸ä¸å¯å˜å€Ÿç”¨å†²çªçš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[async_trait]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServeHttp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AdminHttpApp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServerSession&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_keepalive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;validate_api_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;api_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Response&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;FORBIDDEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//   let (path, method) = {
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//       let req_header = http_session.req_header();
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//       (req_header.uri.path().to_string(), req_header.method.clone())
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//   };
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;router&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;BTreeMap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;collect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;etcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Response&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;BAD_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Response&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;METHOD_NOT_ALLOWED&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Response&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;builder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;StatusCode&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;NOT_FOUND&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;b&amp;#34;Not Found&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_vec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;http_session&lt;/code&gt;æ˜¯ä¸€ä¸ªå¯å˜å€Ÿç”¨ï¼Œç„¶ååœ¨è·å–&lt;code&gt;path&lt;/code&gt;ä¸&lt;code&gt;method&lt;/code&gt;æ—¶ï¼Œ&lt;code&gt;http_session&lt;/code&gt;ä¼šå˜æˆä¸å¯å˜å€Ÿç”¨æ¥è°ƒç”¨&lt;code&gt;req_header()&lt;/code&gt;ï¼Œç„¶è€Œåœ¨è·å–&lt;code&gt;path&lt;/code&gt;ä¸&lt;code&gt;method&lt;/code&gt;åï¼Œ&lt;code&gt;http_session&lt;/code&gt;åˆéœ€è¦è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥è¿™é‡ŒåŒæ—¶å­˜åœ¨äº†å¯å˜å€Ÿç”¨ä¸ä¸å¯å˜å€Ÿç”¨ï¼ŒRustç¼–è¯‘å™¨ä¼šæç¤ºé”™è¯¯ã€‚é‚£æ€ä¹ˆä¿®æ”¹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[async_trait]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServeHttp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AdminHttpApp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServerSession&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;http_session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;req_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬ç»™&lt;code&gt;req_header&lt;/code&gt;åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼Œè¿™æ ·&lt;code&gt;http_session&lt;/code&gt;å°±å˜æˆä¸å¯å˜å€Ÿç”¨ï¼Œåœ¨ä½œç”¨åŸŸç»“æŸæ—¶ï¼Œ&lt;code&gt;req_header&lt;/code&gt;ä¹Ÿè·Ÿç€é‡Šæ”¾äº†ã€‚è¿™ç”¨å°±ä¸ä¼šåŒæ—¶å­˜åœ¨å¯å˜å€Ÿç”¨ä¸ä¸å¯å˜å€Ÿç”¨å†²çªäº†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-å‡½æ•°å¼ç¼–ç¨‹&#34;&gt;2. å‡½æ•°å¼ç¼–ç¨‹&lt;/h3&gt;

&lt;p&gt;ä»¥å¾€åœ¨å†™Pythonæˆ–Golangçš„è¿‡ç¨‹ä¸­åŸºæœ¬ä¸Šæ²¡æ€ä¹ˆç”¨åˆ°å‡½æ•°å¼ç¼–ç¨‹ï¼ŒPythonä¸­è™½ç„¶æœ‰mapã€filterç­‰å‡½æ•°ï¼Œä½†æ˜¯ä¹Ÿåªæ˜¯åœ¨ç®€å•çš„åœºæ™¯ä¸‹ä½¿ç”¨ã€‚è€ŒRustä¸­å‡½æ•°å¼ç¼–ç¨‹æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå®ƒè®©ä»£ç æ›´ç®€æ´ã€æ›´ä¼˜é›…ã€‚åœ¨å†™PingSIXçš„è¿‡ç¨‹ä¸­ï¼Œåˆšå¼€å§‹æˆ‘ä¹Ÿæ²¡æ€ä¹ˆç”¨åˆ°å‡½æ•°å¼ç¼–ç¨‹ï¼Œä¸€ç›´å°±å¼è€è€å®å®çš„if elseï¼Œmatchç­‰ç­‰ã€‚è¿™æ ·ä»£ç å…¶å®ä¹Ÿæ²¡é—®é¢˜ï¼Œä½†æ˜¯ä¼šè®©ä»£ç çœ‹èµ·æ¥å¾ˆé•¿ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠæˆ‘çš„ä»£ç å¸–åˆ°ChatGPTé—®é—®å®ƒå¦‚ä½•èƒ½è®©ä»£ç æ›´åŠ ç®€æ´ï¼Œå°±æœ‰äº†ä¸‹é¢çš„è¿™äº›ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;validate_upstream_host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ValidationError&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pass_host&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamPassHost&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;REWRITE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstream_host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;map_or_else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ValidationError&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;upstream_host_required_for_rewrite&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(()),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç®€å•æ˜¯å¦ä¸º&lt;code&gt;Option&lt;/code&gt;çš„åˆ¤æ–­ï¼Œå¦‚æœä¸º&lt;code&gt;None&lt;/code&gt;åˆ™è¿”å›é”™è¯¯ï¼Œå¦åˆ™è¿”å›&lt;code&gt;Ok(())&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[async_trait]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServiceDiscovery&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DnsDiscovery&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Discovers backends by resolving DNS names to IP addresses.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;discover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BTreeSet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Backend&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HashMap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Resolving DNS for domain: {}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backends&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;BTreeSet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Backend&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resolver&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_ip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;or_err_with&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;InternalError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;DNS discovery failed for domain: {}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SocketAddr&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Creating backend
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Backend&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new_with_weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Determine if TLS is needed
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamScheme&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamScheme&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;GRPCS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Create HttpPeer
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HttpPeer&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamScheme&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;GRPC&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpstreamScheme&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;GRPCS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alpn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ALPN&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;H2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Insert HttpPeer into the backend
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;assert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;insert&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HttpPeer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_none&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;collect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Return backends and an empty HashMap for now
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backends&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HashMap&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸²DNSè§£æä¸è½¬æ¢çš„ä»£ç ï¼Œè¯´å®è¯æˆ‘çš„è„‘å­é‡Œè¿˜æ²¡å½¢æˆè¿™ç§å‡½æ•°å¼ç¼–ç¨‹çš„å®šå¼æ€ç»´ï¼Œè™½ç„¶æˆ‘çœ‹çš„æ‡‚ï¼Œä½†æ˜¯çœŸæ­£å†™çš„æ—¶å€™æˆ‘è¿˜æ˜¯ä¸ä¼šç›´æ¥æƒ³åˆ°è¿™ä¹ˆå†™ï¼Œå¹¸å¥½æœ‰ChatGPTå¸®æˆ‘è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚æˆ‘æƒ³å†™çš„è¶Šå¤šä¹Ÿå°±è¶Šç†Ÿæ‚‰äº†å§ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-å¤šæ€&#34;&gt;3. å¤šæ€&lt;/h3&gt;

&lt;p&gt;åœ¨Rusté‡Œé¢å†™å¤šæ€æœ‰2ä¸­é€‰æ‹©ï¼Œä¸€ç§ä½¿ç”¨traitï¼Œä¸€ç§æ˜¯ç”¨enumï¼Œæˆ‘ä»¬åˆ†åˆ«æ¥çœ‹ä¸‹ã€‚&lt;/p&gt;

&lt;h4 id=&#34;enum&#34;&gt;enum&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;enum&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;SelectionLB&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Fnv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FVNHash&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ketama&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;KetamaHashing&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TryFrom&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Upstream&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;SelectionType&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;SelectionType&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;SelectionType&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Fnv&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Fnv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FVNHash&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;SelectionType&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Ketama&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Ketama&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LB&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;KetamaHashing&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;try_from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªåŒ…è£…äº†å¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•çš„æšä¸¾ï¼Œåœ¨&lt;code&gt;try_from()&lt;/code&gt;æ–¹æ³•ä¸­æ ¹æ®ä¸åŒçš„ç±»å‹åˆ›å»ºå¯¹åº”çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚åœ¨ä½¿ç”¨æ—¶ï¼Œæˆ‘éœ€è¦æ ¹æ®ä¸åŒenumçš„variantè¿›è¡Œmatchï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ProxyUpstream&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Selects a backend server for a given session.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;select_backend&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Backend&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;request_selector_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hash_on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;proxy lb key: {}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;RoundRobin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstreams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstreams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Fnv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstreams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SelectionLB&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Ketama&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upstreams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_mut&lt;/span&gt;::&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HttpPeer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_timeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;peer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥éšè—ä¸åŒè´Ÿè½½å‡è¡¡ç®—æ³•çš„ç»†èŠ‚ï¼Œå¯¹å¤–æä¾›ç»Ÿä¸€çš„è°ƒç”¨å…¥å£æ¥å®ç°å¤šæ€ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨Pingoraä¸­å¤„ç†http1ä¸http2çš„å·®å¼‚æ—¶ä¹Ÿä½¿ç”¨enumæ¥å®ç°å¤šæ€ã€‚&lt;/p&gt;

&lt;h4 id=&#34;trait&#34;&gt;trait&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;sd&#34;&gt;/// Hybrid service discovery.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;///
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;/// Combines static and DNS-based service discovery.
&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[derive(Default)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;HybridDiscovery&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;discoveries&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ServiceDiscovery&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸ºäº†åŒ…è£…DNSçš„æœåŠ¡å‘ç°ä¸é™æ€æœåŠ¡å‘ç°ï¼Œæˆ‘å®šä¹‰äº†&lt;code&gt;HybridDiscovery&lt;/code&gt;åŒæ—¶å¤„ç†è¿™ä¸¤ç§æœåŠ¡å‘ç°ï¼Œå®ƒæŒæœ‰ä¸€ä¸ª&lt;code&gt;Vec&amp;lt;Box&amp;lt;dyn ServiceDiscovery + Send + Sync&amp;gt;&amp;gt;&lt;/code&gt;çš„æˆå‘˜å˜é‡ã€‚è¿™é‡Œé€šè¿‡BoxåŒ…è£¹çš„trait objectæ¥å®ç°å¤šæ€ã€‚å½“ç„¶ä¸ºäº†æ”¯æŒasync traitï¼Œè¿˜è¦åŠ ä¸Š&lt;code&gt;Send + Sync&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-å±€éƒ¨å¯å˜æ€§&#34;&gt;4. å±€éƒ¨å¯å˜æ€§&lt;/h3&gt;

&lt;p&gt;åœ¨æˆ‘ä½¿ç”¨etcdæ¥å®ç°PingSixçš„èµ„æºå®æ—¶åŠ è½½æ—¶ï¼Œé‡åˆ°äº†è¿™æ ·çš„é—®é¢˜ï¼Œå¯¹etcd clientçš„ä½¿ç”¨å¿…é¡»æ˜¯mutçš„ï¼Œä½†æ˜¯æŒæœ‰etcd clientçš„å¯¹è±¡åˆæ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±å¿…é¡»åŒ…è£…å‡ºå±€éƒ¨å¯å˜çš„etcd clientï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;EtcdClientWrapper&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Etcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Arc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Mutex&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Client&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EtcdClientWrapper&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cfg&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Etcd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;cfg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Arc&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Mutex&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;ensure_connected&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Arc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Mutex&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Client&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_none&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Creating new etcd client...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;create_client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ensure_connected&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ok_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Etcd client is not initialized&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;with_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kvs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kv&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_vec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ensure_connected&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ok_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Etcd client is not initialized&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;put&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;with_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;async&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Box&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dyn&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Send&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ensure_connected&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_arc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client_guard&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ok_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Etcd client is not initialized&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;with_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;await&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;with_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;format&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;{}/{}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å°±å¦‚æˆ‘åœ¨ç¬¬ä¸€èŠ‚çš„ç”Ÿå‘½å‘¨æœŸä¸­æ‰€è¯´çš„ï¼Œä¸ºäº†å±€éƒ¨å¯å˜ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨Arc&lt;Mutex&gt;åŒ…è£¹ï¼Œè¿™æ ·åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥é€šè¿‡lock()æ¥è·å–å¯å˜å¼•ç”¨ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;åœ¨å†™PingSIXä¹‹å‰ï¼Œæˆ‘å†™è¿‡ä¸€äº›Rustçš„å°é¡¹ç›®ï¼Œæ¯”å¦‚ä¸€äº›httpæ¥å£çš„è°ƒç”¨ï¼Œæ¯”å¦‚ä¸€äº›TCPåè®®çš„è§£æã€‚ä½†æ˜¯éƒ½æ²¡æœ‰ç³»ç»Ÿæ€§çš„æ¥ä½¿ç”¨Rustï¼Œæ‰€ä»¥ä¸€ç›´æœ‰è®¡åˆ’ç”¨Rustæ¥å†™ä¸€ä¸ªAPIç½‘å…³ï¼Œç„¶åè¿™ä¸€ä¸ªå¤šæœˆä¸‹æ¥ï¼Œæˆ‘å¯¹Rustå¯ä»¥è¯´æœ‰äº†ä¸€å®šçš„ç†è§£å§ï¼Œè™½ç„¶åƒ&lt;code&gt;Send + Sync&lt;/code&gt;è¿™ç§ä¸œè¥¿è¿˜æ˜¯ä¸å¤ªç†è§£ï¼Œä½†æ˜¯è‡³å°‘çŸ¥é“æ€ä¹ˆç”¨äº†ã€‚åœ¨æ¯”å¦‚åƒ&lt;code&gt;FnOnce&lt;/code&gt;ï¼Œè¿˜æœ‰&lt;code&gt;Pin&lt;/code&gt;è¿™äº›ä¹Ÿéƒ½è¿˜ä¸å¤ªäº†è§£ï¼Œä½†æ˜¯å¯ä»¥è¯´ç°åœ¨ç”¨Rustå†™ç‚¹é¡¹ç›®è¿˜æ˜¯å¯ä»¥çš„ã€‚&lt;/p&gt;

&lt;p&gt;PingSIXè™½ç„¶åªå®ç°äº†APISIXçš„ä¸€ä¸ªå­é›†ï¼Œæœ‰å¾ˆå¤šåŠŸèƒ½çš„ç¼ºå¤±ï¼Œæ¯”å¦‚è¢«åŠ¨çš„å¥åº·æ£€æŸ¥ï¼ŒåŠ¨æ€çš„TLSæ”¯æŒï¼Œè¿˜æœ‰å¾ˆå¤šæ’ä»¶ç­‰ï¼Œä½†æ˜¯å¤§çš„æ¡†æ¶å…¶å®å·²ç»æ­å¥½äº†ï¼Œå‰©ä¸‹çš„å…¶å®éƒ½æ˜¯ä½“åŠ›æ´»äº†ã€‚æ‰€ä»¥æš‚æ—¶å…ˆå‘Šä¸€æ®µè½å§ã€‚&lt;/p&gt;

&lt;p&gt;é€šè¿‡è¿™ä¸ªé¡¹ç›®æˆ‘å¯¹Pingoraçš„å„ä¸ªcrateéƒ½æœ‰äº†æ·±åº¦ä½¿ç”¨ï¼Œå½“ç„¶è¿˜æœ‰ä¸€äº›åŠŸèƒ½ä¹Ÿæ˜¯æ²¡æœ‰è¦†ç›–åˆ°ï¼Œæ¯”å¦‚ä¸‹é¢çš„è¿™äº›ï¼š&lt;/p&gt;

&lt;p&gt;dynamic sslï¼š&lt;a href=&#34;https://github.com/cloudflare/pingora/blob/main/pingora/examples/server.rs#L77&#34;&gt;https://github.com/cloudflare/pingora/blob/main/pingora/examples/server.rs#L77&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;cacheï¼š&lt;a href=&#34;https://github.com/cloudflare/pingora/blob/main/pingora-proxy/tests/utils/server_utils.rs#L393&#34;&gt;https://github.com/cloudflare/pingora/blob/main/pingora-proxy/tests/utils/server_utils.rs#L393&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è¿™äº›éƒ½è¿˜æ²¡æœ‰æ–‡æ¡£ï¼Œæ‰€ä»¥æš‚æ—¶å…ˆä¸æäº†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å¼€å‘è¿™ä¸ªé¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘é¢‘ç¹ä½¿ç”¨ChatGPTï¼Œæ·±åˆ»çš„æ„Ÿå—åˆ°ChatGPTå¯¹äºç¨‹åºå‘˜çš„æ•ˆç‡çš„æå‡ï¼Œé¡¹ç›®ä¸­çš„æ‰€æœ‰ä»£ç éƒ½ç»è¿‡äº†ChatGPTçš„Reviewï¼ŒAIä¸ä¼šæ·˜æ±°ç¨‹åºå‘˜ï¼Œåªä¼šæ·˜æ±°ä¸ä¼šä½¿ç”¨AIçš„ç¨‹åºå‘˜ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ä»Pingoraåˆ°APIç½‘å…³ï¼šRustå®æˆ˜</title>
      <link>https://zhu327.github.io/2024/11/15/%E4%BB%8Epingora%E5%88%B0api%E7%BD%91%E5%85%B3rust%E5%AE%9E%E6%88%98/</link>
      <pubDate>Fri, 15 Nov 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/11/15/%E4%BB%8Epingora%E5%88%B0api%E7%BD%91%E5%85%B3rust%E5%AE%9E%E6%88%98/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;åœ¨å­¦ä¹ Rustçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¸»è¦è¿›è¡Œäº†ä¸€äº›å°å·¥å…·çš„ç»ƒä¹ ï¼Œå¯¹Rustçš„å†…å­˜å®‰å…¨æ€§å’Œæ€§èƒ½ä¼˜åŠ¿æœ‰äº†åˆæ­¥çš„ä½“ä¼šï¼Œä½†å§‹ç»ˆæ²¡æœ‰å®ç°è¿‡ä¸€ä¸ªå®Œæ•´çš„å¤§å‹é¡¹ç›®ã€‚æœ€è¿‘éšç€Ruståœ¨é«˜æ€§èƒ½è®¡ç®—é¢†åŸŸçš„åº”ç”¨ä¸æ–­æ‹“å±•ï¼Œå°¤å…¶æ˜¯Pingoraç­‰é¡¹ç›®çš„å‘å¸ƒï¼Œè®©æˆ‘çœ‹åˆ°äº†Ruståœ¨ç½‘ç»œé€šä¿¡é¢†åŸŸä¸­çš„æ½œåŠ›ï¼Œä¹Ÿæ¿€å‘äº†æˆ‘ç”¨Rustæ¥å®ç°ä¸€ä¸ªAPIç½‘å…³çš„å…´è¶£ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨åŠ å…¥è…¾è®¯ä¹‹å‰ï¼Œæˆ‘æ›¾ä½¿ç”¨OpenRestyå’ŒKongè¿›è¡ŒAPIç½‘å…³çš„å¼€å‘å·¥ä½œï¼Œåæ¥åœ¨è…¾è®¯è¿›ä¸€æ­¥æ·±å…¥å‚ä¸äº†APISixçš„äº‘åŸç”Ÿç½‘å…³é¡¹ç›®ï¼Œé€æ­¥ç§¯ç´¯äº†å…³äºAPIç½‘å…³è®¾è®¡ã€å®ç°ä»¥åŠæ€§èƒ½è°ƒä¼˜æ–¹é¢çš„ç»éªŒã€‚APIç½‘å…³æ˜¯ä¸€ä¸ªå…¼å…·æ¶æ„å¤æ‚åº¦ä¸æ€§èƒ½è¦æ±‚çš„ç³»ç»Ÿï¼Œæ¶‰åŠè¯·æ±‚è·¯ç”±ã€æµé‡æ§åˆ¶ã€èº«ä»½éªŒè¯ç­‰å¤šä¸ªå…³é”®æ¨¡å—ï¼Œæ°å¥½å¯ä»¥å……åˆ†å‘æŒ¥Rustçš„ä¼˜åŠ¿ã€‚å› æ­¤ï¼Œæˆ‘å†³å®šä»¥Rustä¸ºåŸºç¡€å¼€å‘ä¸€ä¸ªAPIç½‘å…³ï¼Œè¿™ä¸ä»…æ˜¯ä¸ºäº†æå‡è‡ªå·±çš„RustæŠ€æœ¯ï¼Œæ›´å¸Œæœ›é€šè¿‡æ­¤é¡¹ç›®è¿›ä¸€æ­¥å·©å›ºå’Œæå‡åœ¨APIç½‘å…³æ–¹é¢çš„çŸ¥è¯†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å…·ä½“å®ç°ä¸­ï¼Œæˆ‘è®¡åˆ’åŸºäºPingoraçš„è®¾è®¡æ€è·¯ï¼Œæ‰“é€ ä¸€ä¸ªAPISixç½‘å…³çš„å­é›†åŠŸèƒ½ã€‚æˆ‘å·²åœ¨GitHubä¸Šå‘å¸ƒäº†è¯¥é¡¹ç›®çš„åˆå§‹ç‰ˆæœ¬ &lt;a href=&#34;https://github.com/zhu327/pingsix&#34;&gt;https://github.com/zhu327/pingsix&lt;/a&gt;ï¼Œç›®å‰å®ç°äº†åŸºç¡€çš„standaloneæ¨¡å¼ï¼ŒåŒ…æ‹¬åŸºæœ¬çš„è·¯ç”±ä¸åå‘ä»£ç†åŠŸèƒ½ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°†æ‰©å±•æ’ä»¶å®šä¹‰ï¼Œé€æ­¥å®ç°ä¸€äº›å…¸å‹çš„åŠŸèƒ½æ’ä»¶ï¼Œæœ€ç»ˆç›®æ ‡æ˜¯æ”¯æŒåŸºäºetcdçš„åŠ¨æ€é…ç½®åŠ è½½ï¼Œä»¥ä¾¿é€‚åº”å¤šåœºæ™¯çš„APIç½‘å…³éœ€æ±‚ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;å®ç°-é…ç½®&#34;&gt;å®ç°ï¼šé…ç½®&lt;/h3&gt;

&lt;p&gt;åœ¨è®¾è®¡ pingsix çš„é…ç½®æ–‡ä»¶æ—¶ï¼Œæˆ‘å‚è€ƒäº† APISix å’Œ Pingora çš„é…ç½®æ–‡ä»¶ç»“æ„ï¼Œç»“åˆè‡ªèº«é¡¹ç›®ç›®æ ‡å’ŒåŠŸèƒ½ï¼Œç®€åŒ–äº†éƒ¨åˆ†å¤æ‚å†…å®¹ï¼ŒåŒæ—¶ä¿æŒäº†æ ¸å¿ƒåŠŸèƒ½çš„çµæ´»æ€§ã€‚é…ç½®æ–‡ä»¶åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªå…³é”®éƒ¨åˆ†ï¼š&lt;strong&gt;åŸºç¡€é…ç½®&lt;/strong&gt;ã€&lt;strong&gt;Listener é…ç½®&lt;/strong&gt; å’Œ &lt;strong&gt;èµ„æºé…ç½®&lt;/strong&gt;ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†è¯´æ˜ä¸å®Œæ•´ YAML ç¤ºä¾‹ã€‚&lt;/p&gt;

&lt;h4 id=&#34;1-åŸºç¡€é…ç½®&#34;&gt;1. åŸºç¡€é…ç½®&lt;/h4&gt;

&lt;p&gt;åŸºç¡€é…ç½®éƒ¨åˆ†ç›´æ¥æ²¿ç”¨äº† Pingora çš„è®¾è®¡ï¼Œç”¨äºå®šä¹‰ç½‘å…³çš„å…¨å±€è¡Œä¸ºå’Œè¿è¡Œå‚æ•°ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´é…ç½®ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;c&#34;&gt;# pingora config example from https://github.com/cloudflare/pingora/blob/main/docs/user_guide/conf.md&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;pingora&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;version&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# é…ç½®æ–‡ä»¶ç‰ˆæœ¬&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;threads&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å·¥ä½œçº¿ç¨‹æ•°é‡&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;pid_file&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/run/pingora.pid&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä¿å­˜è¿›ç¨‹IDçš„æ–‡ä»¶è·¯å¾„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;upgrade_sock&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/tmp/pingora_upgrade.sock&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# çƒ­å‡çº§ç”¨çš„Unix socketæ–‡ä»¶&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;user&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;nobody&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿è¡Œç½‘å…³çš„ç”¨æˆ·&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;group&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;webusers&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿è¡Œç½‘å…³çš„ç”¨æˆ·ç»„&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;è®¾è®¡æ€è·¯&lt;/strong&gt;ï¼šè¿™ä¸€éƒ¨åˆ†é…ç½®æ˜¯ç½‘å…³è¿è¡Œæ—¶çš„åŸºç¡€ï¼Œä¿æŒç®€æ´çš„åŒæ—¶ï¼Œä¸ Pingora é…ç½®å®Œå…¨å…¼å®¹ï¼Œé™ä½äº†é…ç½®çš„å­¦ä¹ æˆæœ¬ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;2-listener-é…ç½®&#34;&gt;2. Listener é…ç½®&lt;/h4&gt;

&lt;p&gt;Listener æ˜¯ API ç½‘å…³çš„å…¥å£ï¼Œç”¨äºå®šä¹‰ç½‘å…³ç›‘å¬çš„åœ°å€ã€ç«¯å£ä»¥åŠåè®®ç±»å‹ï¼ˆHTTP/HTTPSï¼‰ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´é…ç½®ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;listeners&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;-&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;address&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.0&lt;/span&gt;.&lt;span class=&#34;m&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# HTTPç›‘å¬åœ°å€å’Œç«¯å£&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# - address: &amp;#34;[::1]:443&amp;#34;  # ç¤ºä¾‹ï¼šIPv6åœ°å€ç›‘å¬&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   tls:                  # é…ç½®HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#     cert_path: /etc/ssl/server.crt # SSLè¯ä¹¦è·¯å¾„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#     key_path: /etc/ssl/server.key  # SSLç§é’¥è·¯å¾„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   offer_h2: true         # æ˜¯å¦æ”¯æŒHTTP/2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;è®¾è®¡æ€è·¯&lt;/strong&gt;ï¼š
- å½“å‰æ”¯æŒ HTTP å’Œ HTTPS åè®®ï¼Œé€šè¿‡é…ç½® &lt;code&gt;tls&lt;/code&gt; å‚æ•°æ¥å¼€å¯ HTTPSã€‚ æœªæ¥å¯èƒ½åŠ å…¥ç±»ä¼¼ APISix çš„ &lt;code&gt;Stream Proxy&lt;/code&gt; åŠŸèƒ½ï¼Œç”¨äºæ”¯æŒ TCP/UDP æµé‡ä»£ç†ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;3-èµ„æºé…ç½®&#34;&gt;3. èµ„æºé…ç½®&lt;/h4&gt;

&lt;p&gt;èµ„æºé…ç½®æ˜¯ç½‘å…³çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œä¸»è¦å®šä¹‰è·¯ç”±è§„åˆ™ï¼ˆRouterï¼‰å’Œåç«¯æœåŠ¡ï¼ˆUpstreamï¼‰çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚ç›®å‰ pingsix æ”¯æŒçš„åŠŸèƒ½å­é›†ä»¥å®ç°åå‘ä»£ç†ä¸ºä¸»ï¼Œä»¥ä¸‹æ˜¯å®Œæ•´ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;c&#34;&gt;# å‚è€ƒAPISixçš„Standaloneæ¨¡å¼é…ç½®ç¤ºä¾‹ï¼šhttps://apisix.apache.org/zh/docs/apisix/3.1/stand-alone/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å®Œæ•´çš„Routerï¼ŒUpstreamé…ç½®å‚è€ƒAPISixçš„APIæ–‡æ¡£ï¼šhttps://apisix.apache.org/zh/docs/apisix/admin-api/#route&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;routers&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;-&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;id&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                     &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è·¯ç”±å”¯ä¸€æ ‡è¯†&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;uri&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è·¯ç”±åŒ¹é…çš„URI&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;host&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;www.baidu.com&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# åŒ¹é…çš„ä¸»æœº&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¯é€‰é¡¹ï¼š&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# uris: [&amp;#34;/&amp;#34;,&amp;#34;/test&amp;#34;]     # æ”¯æŒå¤šä¸ªURIåŒ¹é…&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# hosts: [&amp;#34;www.baidu.com&amp;#34;,&amp;#34;www.taobao.com&amp;#34;] # æ”¯æŒå¤šä¸ªHoståŒ¹é…&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# methods: [&amp;#34;GET&amp;#34;, &amp;#34;POST&amp;#34;] # é™åˆ¶è¯·æ±‚æ–¹æ³•&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# timeout:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   connect: 2           # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   send: 3              # å‘é€è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#   read: 5              # è¯»å–è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# priority: 10           # è·¯ç”±ä¼˜å…ˆçº§ï¼ˆæ•°å­—è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;upstream&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å®šä¹‰åç«¯æœåŠ¡&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;nodes&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;www.baidu.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# åç«¯æœåŠ¡åœ°å€åŠæƒé‡&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;type&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;roundrobin&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è´Ÿè½½å‡è¡¡ç±»å‹ï¼ˆæ”¯æŒroundrobinã€randomç­‰ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;checks&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æ£€æŸ¥é…ç½®&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;active&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä¸»åŠ¨å¥åº·æ£€æŸ¥&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;type&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;https&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ£€æŸ¥ç±»å‹ï¼ˆhttp/httpsï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;timeout&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æ£€æŸ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;host&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;www.baidu.com&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ£€æŸ¥ç›®æ ‡ä¸»æœº&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;http_path&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æ£€æŸ¥è·¯å¾„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;https_verify_certificate&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ˜¯å¦éªŒè¯HTTPSè¯ä¹¦&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;req_headers&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;User-Agent: curl/7.29.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¯·æ±‚å¤´&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;healthy&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æœåŠ¡çš„æ ‡å‡†&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;interval&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¥åº·æ£€æŸ¥é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;http_statuses&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;201&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# åˆ¤æ–­å¥åº·çš„HTTPçŠ¶æ€ç &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;successes&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿ç»­æˆåŠŸæ¬¡æ•°&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;unhealthy&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä¸å¥åº·æœåŠ¡çš„æ ‡å‡†&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;http_failures&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿ç»­å¤±è´¥çš„HTTPè¯·æ±‚æ¬¡æ•°&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;tcp_failures&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿ç»­å¤±è´¥çš„TCPè¯·æ±‚æ¬¡æ•°&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;pass_host&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;rewrite&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ˜¯å¦é€ä¼ ä¸»æœºä¿¡æ¯&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;upstream_host&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;www.baidu.com&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä¼ é€’ç»™åç«¯çš„Host&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;scheme&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;https&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä½¿ç”¨çš„åè®®ï¼ˆhttp/httpsï¼‰&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;ï¼š
- &lt;strong&gt;Router&lt;/strong&gt; å®šä¹‰äº†è¯·æ±‚çš„è·¯ç”±è§„åˆ™ï¼Œç›®å‰æ”¯æŒ &lt;code&gt;uri&lt;/code&gt; å’Œ &lt;code&gt;host&lt;/code&gt; çš„åŒ¹é…ï¼Œè¿˜å¯ä»¥æ‰©å±•æ”¯æŒ &lt;code&gt;methods&lt;/code&gt;ã€&lt;code&gt;priority&lt;/code&gt; ç­‰å‚æ•°ã€‚
- &lt;strong&gt;Upstream&lt;/strong&gt; é…ç½®æ”¯æŒè´Ÿè½½å‡è¡¡å’Œå¥åº·æ£€æŸ¥ï¼Œæ”¯æŒé…ç½®å„ç§å¤æ‚å‡è¡¡ç®—æ³•ï¼Œè¿˜æ”¯æŒä¸»åŠ¨å¥åº·æ£€æŸ¥ã€‚&lt;/p&gt;

&lt;p&gt;å¯ä»¥åœ¨ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/config.yaml&#34;&gt;GitHub&lt;/a&gt; æŸ¥çœ‹å®Œæ•´çš„é…ç½®æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&#34;4-é…ç½®åŠ è½½&#34;&gt;4. é…ç½®åŠ è½½&lt;/h4&gt;

&lt;p&gt;åœ¨ pingsix ä¸­ï¼Œé…ç½®åŠ è½½çš„å®ç°æ–¹å¼ä¸ Pingora å®Œå…¨å…¼å®¹ï¼Œä¸»è¦é€šè¿‡å¤ç”¨ Pingora çš„å‘½ä»¤è¡Œè§£æå’Œé…ç½®åŠ è½½ä»£ç æ¥å®Œæˆã€‚è¿™äº›ä»£ç å¤§éƒ¨åˆ†æ˜¯ç›´æ¥å€Ÿé‰´äº† Pingora çš„å®ç°ï¼Œå¹¶æ ¹æ® pingsix çš„éœ€æ±‚åšäº†ä¸€äº›ç®€å•çš„è°ƒæ•´å’Œä¼˜åŒ–ã€‚&lt;/p&gt;

&lt;h5 id=&#34;ä¸»è¦æ”¹è¿›&#34;&gt;ä¸»è¦æ”¹è¿›ï¼š&lt;/h5&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨ &lt;code&gt;serde&lt;/code&gt; è¿›è¡Œé…ç½®è§£æ&lt;/strong&gt;ï¼šé…ç½®æ–‡ä»¶ä»ç„¶é‡‡ç”¨ YAML æ ¼å¼ï¼Œä½¿ç”¨ &lt;code&gt;serde_yaml&lt;/code&gt; åº“è¿›è¡Œè§£æã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é…ç½®æ ¡éªŒ&lt;/strong&gt;ï¼šä¸ºäº†ç¡®ä¿é…ç½®çš„æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬å¼•å…¥äº† &lt;code&gt;validator&lt;/code&gt; crateï¼Œå¯¹é…ç½®é¡¹è¿›è¡Œç®€å•çš„æ ¡éªŒï¼Œç¡®ä¿å®ƒä»¬ç¬¦åˆé¢„æœŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤å€¼å’Œæ‹·è´&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;serde&lt;/code&gt; çš„ &lt;code&gt;default&lt;/code&gt; ç‰¹æ€§ç®€åŒ–äº†é»˜è®¤å€¼çš„å¤„ç†ï¼Œä½¿ç”¨ &lt;code&gt;Clone&lt;/code&gt; derive ç‰¹æ€§å®ç°äº†é…ç½®çš„æ‹·è´ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;é…ç½®åŠ è½½å®ç°&#34;&gt;é…ç½®åŠ è½½å®ç°&lt;/h5&gt;

&lt;p&gt;é…ç½®çš„åŠ è½½æµç¨‹å’Œ Pingora åŸºæœ¬ä¸€è‡´ï¼Œä»£ç ç»“æ„ä¹Ÿä¸ Pingora ç›¸ä¼¼ã€‚æˆ‘ä»¬é¦–å…ˆè¯»å– YAML é…ç½®æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ &lt;code&gt;serde_yaml&lt;/code&gt; è¿›è¡Œè§£æï¼Œæœ€åä½¿ç”¨ &lt;code&gt;validator&lt;/code&gt; æ ¡éªŒé…ç½®é¡¹çš„åˆæ³•æ€§ã€‚&lt;/p&gt;

&lt;p&gt;å…·ä½“çš„å®ç°å¯ä»¥å‚è€ƒ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/config/mod.rs&#34;&gt;pingsix çš„é…ç½®åŠ è½½ä»£ç &lt;/a&gt;ï¼Œè¯¥æ–‡ä»¶å±•ç¤ºäº†é…ç½®è§£æã€æ ¡éªŒå’Œé»˜è®¤å€¼å¤„ç†çš„å®ç°æ–¹å¼ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å®ç°-ä¸Šæ¸¸&#34;&gt;å®ç°ï¼šä¸Šæ¸¸&lt;/h3&gt;

&lt;p&gt;ä» APISix çš„ä¸Šæ¸¸é…ç½®åŠŸèƒ½å¯ä»¥çœ‹å‡ºï¼Œç½‘å…³çš„ä¸Šæ¸¸æ¨¡å—éœ€è¦å…·å¤‡ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;DNS è§£æ&lt;/strong&gt;ï¼šæ”¯æŒä¸Šæ¸¸æœåŠ¡çš„åŸŸåè§£æã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡ç®—æ³•&lt;/strong&gt;ï¼šæ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•å’Œè‡ªå®šä¹‰ hash keyã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¥åº·æ£€æŸ¥&lt;/strong&gt;ï¼šå®ç°ä¸»åŠ¨å¥åº·æ£€æŸ¥ï¼Œç¡®ä¿ä¸Šæ¸¸æœåŠ¡çš„å¯ç”¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…æ—¶ä¸é‡è¯•é…ç½®&lt;/strong&gt;ï¼šä¸ºè¿æ¥ã€å‘é€å’Œè¯»å–è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¹¶åœ¨è¯·æ±‚å¤±è´¥æ—¶è¿›è¡Œé‡è¯•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åè®®æ”¯æŒ&lt;/strong&gt;ï¼šæ”¯æŒ HTTP å’Œ HTTPS ä¸Šæ¸¸åè®®ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;ä¸Šæ¸¸æ¨¡å—å®ç°ç»“æ„&#34;&gt;ä¸Šæ¸¸æ¨¡å—å®ç°ç»“æ„&lt;/h4&gt;

&lt;p&gt;æ ¹æ® Pingora çš„æŠ½è±¡è®¾è®¡ï¼Œæˆ‘ä»¬å°†ä¸Šæ¸¸å¤„ç†æ‹†åˆ†ä¸ºä¸¤ä¸ªä¸»è¦æ¨¡å—ï¼Œåˆ†åˆ«è´Ÿè´£æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;æœåŠ¡å‘ç°æ¨¡å—&lt;/strong&gt;&lt;br /&gt;
æœåŠ¡å‘ç°æ¨¡å—ä½äº &lt;code&gt;discovery.rs&lt;/code&gt;ï¼Œæ”¯æŒé™æ€ IP é…ç½®ã€åŸŸå DNS è§£æï¼Œå¹¶å…è®¸ HTTP/HTTPS æ··åˆé…ç½®ã€‚è¯¦æƒ…è§ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/proxy/discovery.rs&#34;&gt;discovery.rs æºç &lt;/a&gt;ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;è´Ÿè½½å‡è¡¡æ¨¡å—&lt;/strong&gt;&lt;br /&gt;
è´Ÿè½½å‡è¡¡æ¨¡å—ä½äº &lt;code&gt;lb.rs&lt;/code&gt;ï¼Œæ”¯æŒ roundrobinã€randomã€fnvhash å’Œ ketama ç­‰ç®—æ³•ï¼Œå¹¶æŒ‰ç…§ APISix å®ç°äº†éƒ¨åˆ†åŸºäº &lt;code&gt;vars&lt;/code&gt;ã€&lt;code&gt;header&lt;/code&gt; å’Œ &lt;code&gt;cookie&lt;/code&gt; çš„ hash è®¡ç®—ã€‚è´Ÿè½½å‡è¡¡æ¨¡å—å¯æ‰©å±•ä¸åŒçš„ hash key ç±»å‹ã€‚æ›´å¤šå®ç°ç»†èŠ‚è§ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/proxy/lb.rs&#34;&gt;lb.rs æºç &lt;/a&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;å®ç°å¿ƒå¾—&#34;&gt;å®ç°å¿ƒå¾—&lt;/h4&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;å¤šæ€è®¾è®¡&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;enum&lt;/code&gt; å®ç°è´Ÿè½½å‡è¡¡ç®—æ³•çš„å¤šæ€æ€§ï¼Œå°†ä¸åŒç®—æ³•çš„å·®å¼‚å°è£…åœ¨æ¨¡å—å†…ï¼Œä¾¿äºè°ƒç”¨å’Œæ‰©å±•ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;é…ç½®è½¬æ¢ç®€åŒ–&lt;/strong&gt;ï¼šä½¿ç”¨ &lt;code&gt;From&lt;/code&gt; trait å°†é…ç½®ç»“æ„è½¬æ¢ä¸ºä¸šåŠ¡å¯¹è±¡ï¼Œç®€åŒ–ä»£ç ï¼Œæé«˜å¯è¯»æ€§ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;å¥åº·æ£€æŸ¥é›†æˆ&lt;/strong&gt;ï¼šPingora çš„å¥åº·æ£€æŸ¥é€»è¾‘ä¸ä¸Šæ¸¸ç»‘å®šåœ¨ä¸€èµ·ï¼Œè€Œå¥åº·æ£€æŸ¥åå°æœåŠ¡éœ€è¦åœ¨ server å¯åŠ¨æ—¶æ³¨å…¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨ä¸Šå±‚ç»“æ„ä¸­å°†ä¸Šæ¸¸å’Œå¥åº·æ£€æŸ¥é€»è¾‘ç»‘å®šï¼Œé€šè¿‡ &lt;code&gt;Option&lt;/code&gt; çµæ´»æ§åˆ¶å…¶ç”Ÿå‘½å‘¨æœŸã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä»¥ä¸Šå®ç°æ–¹æ³•ç¡®ä¿äº†ä»£ç ç»“æ„çš„ç®€æ´æ€§å’Œæ¨¡å—çš„å¯å¤ç”¨æ€§ï¼Œå»ºè®®é˜…è¯»ç›¸å…³æºç è¿›ä¸€æ­¥äº†è§£å®ç°ç»†èŠ‚ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å®ç°-è·¯ç”±&#34;&gt;å®ç°ï¼šè·¯ç”±&lt;/h3&gt;

&lt;p&gt;è·¯ç”±æ¨¡å—å‚è€ƒäº† &lt;a href=&#34;https://github.com/apache/apisix/tree/master/apisix/http/router&#34;&gt;APISix çš„ radixtree_host_uri è·¯ç”±æ–¹å¼&lt;/a&gt;ï¼Œé€šè¿‡ &lt;code&gt;host&lt;/code&gt; å’Œ &lt;code&gt;uri&lt;/code&gt; çš„ç»„åˆå®ç°é«˜æ•ˆçš„è·¯ç”±åŒ¹é…ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ pingsix ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Rust çš„ &lt;code&gt;matchit&lt;/code&gt; crateï¼Œè¿™æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ Radix Tree è·¯ç”±åº“ï¼Œç”¨æ¥å®ç°ä¸ APISix ç›¸åŒçš„åŠŸèƒ½ã€‚&lt;code&gt;matchit&lt;/code&gt; æä¾›äº†çµæ´»çš„è·¯ç”±åŒ¹é…èƒ½åŠ›ï¼Œæ”¯æŒç²¾ç¡®åŒ¹é…å’Œé€šé…ç¬¦è§„åˆ™ã€‚&lt;/p&gt;

&lt;p&gt;æ­¤å¤–ï¼Œè·¯ç”±é€»è¾‘è¿˜ç»“åˆäº†è´Ÿè½½å‡è¡¡ï¼ˆlbï¼‰æ¨¡å—çš„æ–¹æ³•ï¼Œå®ç°è¯·æ±‚çš„ç²¾å‡†è·¯ç”±ï¼Œå¹¶æ”¯æŒé€šè¿‡è·¯ç”±çš„ &lt;code&gt;timeout&lt;/code&gt; é…ç½®è¦†ç›–é»˜è®¤çš„ä¸Šæ¸¸è¶…æ—¶è®¾ç½®ã€‚&lt;/p&gt;

&lt;p&gt;å®Œæ•´å®ç°å¯ä»¥å‚è€ƒ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/proxy/router.rs&#34;&gt;router.rs æºç &lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å®ç°-pingora-service-ä¸-server&#34;&gt;å®ç°ï¼šPingora Service ä¸ Server&lt;/h3&gt;

&lt;h4 id=&#34;service-å®ç°&#34;&gt;Service å®ç°&lt;/h4&gt;

&lt;p&gt;Pingora çš„ &lt;code&gt;Service&lt;/code&gt; æ¦‚å¿µç”¨äºå®šä¹‰ HTTP è¯·æ±‚å¤„ç†çš„å„ä¸ªé˜¶æ®µï¼Œå…¶å¤„ç†æµç¨‹ä¸ Nginx çš„å¤„ç†é˜¶æ®µç±»ä¼¼ï¼ˆå‚è€ƒ &lt;a href=&#34;https://github.com/cloudflare/pingora/blob/main/docs/user_guide/phase.md&#34;&gt;Pingora çš„é˜¶æ®µè®¾è®¡&lt;/a&gt;ï¼‰ã€‚åœ¨ pingsix ä¸­ï¼Œé€šè¿‡å®ç° &lt;code&gt;ProxyService&lt;/code&gt; traitï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªå®Œæ•´çš„åå‘ä»£ç†æœåŠ¡ï¼Œå¹¶åœ¨ä»¥ä¸‹é˜¶æ®µæ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;request&lt;/strong&gt;: è¯·æ±‚æ¥æ”¶åå¯è¿›è¡Œä¿®æ”¹æˆ–æ ¡éªŒã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;upstream_request&lt;/strong&gt;: è½¬å‘åˆ°ä¸Šæ¸¸å‰å¤„ç†è¯·æ±‚ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;upstream_response&lt;/strong&gt;: æ¥æ”¶ä¸Šæ¸¸å“åº”åè¿›è¡Œå¤„ç†ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;response&lt;/strong&gt;: è¿”å›å®¢æˆ·ç«¯å‰å¯¹å“åº”è¿›è¡Œæœ€ç»ˆä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™ç§è®¾è®¡è®©æˆ‘ä»¬å¯ä»¥é€šè¿‡æ’ä»¶çµæ´»æ‰©å±•åŠŸèƒ½ï¼Œä¾‹å¦‚æ·»åŠ è®¤è¯ã€æµé‡æ§åˆ¶ç­‰ã€‚æ ¸å¿ƒä»£ç å®ç°å¯å‚è€ƒ &lt;a href=&#34;https://github.com/cloudflare/pingora/blob/main/src/mod.rs&#34;&gt;pingsix proxy æ¨¡å—&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h4 id=&#34;server-å®ç°&#34;&gt;Server å®ç°&lt;/h4&gt;

&lt;p&gt;Server å±‚è´Ÿè´£åè°ƒé…ç½®ã€è·¯ç”±å’ŒæœåŠ¡å¯åŠ¨ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;åŠ è½½é…ç½®ä¸è·¯ç”±&lt;/strong&gt;&lt;br /&gt;
ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½è·¯ç”±è§„åˆ™å’Œç›‘å¬åœ°å€ï¼Œå¹¶åˆå§‹åŒ–æ‰€éœ€çš„æœåŠ¡æ¨¡å—ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;å¯åŠ¨ç›‘å¬å™¨&lt;/strong&gt;&lt;br /&gt;
æ”¯æŒå¤šåè®®ç›‘å¬ï¼ˆå¦‚ HTTP/HTTPSï¼‰ï¼Œå¹¶åŠ¨æ€ç»‘å®šé…ç½®çš„ç›‘å¬ç«¯å£ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;Service æ‰©å±•&lt;/strong&gt;&lt;br /&gt;
åœ¨ Server ä¸­å¯ä»¥æ³¨å†Œå¤šç§ &lt;code&gt;Service&lt;/code&gt; å®ç°ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ProxyService&lt;/code&gt;: ç”¨äºå¤„ç†åå‘ä»£ç†é€»è¾‘ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BackgroundService&lt;/code&gt;: å¦‚å¥åº·æ£€æŸ¥åå°ä»»åŠ¡ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰æ‰©å±• Serviceï¼Œä¾‹å¦‚è‡ªåŠ¨ç”³è¯·è¯ä¹¦ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é€šè¿‡è¿™ç§è®¾è®¡ï¼ŒServer å¯ä»¥çµæ´»åœ°ç®¡ç†å¤šä¸ªæœåŠ¡å®ä¾‹ï¼Œæ‰©å±•åŠŸèƒ½å˜å¾—ç®€å•ä¸”ç›´è§‚ã€‚å®Œæ•´çš„å®ç°ä»£ç å¯å‚è€ƒ &lt;a href=&#34;https://github.com/zhu327/pingsix/blob/main/src/main.rs&#34;&gt;pingsix çš„ main.rs&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;è§„åˆ’&#34;&gt;è§„åˆ’&lt;/h3&gt;

&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åŸºäºå½“å‰çš„åå‘ä»£ç†åŠŸèƒ½è¿›ä¸€æ­¥å®Œå–„ API ç½‘å…³çš„æ ¸å¿ƒæ‰©å±•èƒ½åŠ›ï¼Œè§„åˆ’åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;æ’ä»¶æ”¯æŒ&lt;/strong&gt;&lt;br /&gt;
å¼•å…¥æ’ä»¶æœºåˆ¶ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½å’Œæ‰§è¡Œï¼Œé€æ­¥å®ç° API ç½‘å…³çš„å…³é”®æ’ä»¶ï¼ˆå¦‚è®¤è¯ã€é™æµã€æ—¥å¿—ç­‰ï¼‰ï¼Œæå‡åŠŸèƒ½çš„çµæ´»æ€§ä¸å¯æ‰©å±•æ€§ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;åŠ¨æ€é…ç½®ç®¡ç†&lt;/strong&gt;&lt;br /&gt;
é›†æˆ etcdï¼Œå®ç°é…ç½®çš„åŠ¨æ€åŠ è½½å’Œæ›´æ–°ï¼Œä»¥ä¾¿åœ¨æ— éœ€é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹åŠ¨æ€è°ƒæ•´è·¯ç”±ã€ä¸Šæ¸¸é…ç½®ç­‰ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;ä¸Šæ¸¸ä¸æœåŠ¡çš„ç‹¬ç«‹é…ç½®&lt;/strong&gt;&lt;br /&gt;
æä¾›ä¸Šæ¸¸ï¼ˆupstreamï¼‰å’ŒæœåŠ¡ï¼ˆserviceï¼‰çš„å•ç‹¬é…ç½®æŠ½è±¡ï¼Œä½¿å¾—å¤æ‚ä¸šåŠ¡éœ€æ±‚ä¸‹çš„é…ç½®æ›´æ¸…æ™°ã€æ¨¡å—åŒ–ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;p&gt;ç»è¿‡ä»¥ä¸Šè®¾è®¡ï¼Œæˆ‘ä»¬å·²ç»æ„å»ºäº†ä¸€ä¸ªå®Œæ•´çš„åŸºç¡€åå‘ä»£ç†åŠŸèƒ½ï¼Œä½†è¦å®ç° API ç½‘å…³çš„æ ¸å¿ƒä»·å€¼ï¼Œæ¥ä¸‹æ¥çš„é‡ç‚¹å°†èšç„¦åœ¨æ’ä»¶ç³»ç»Ÿçš„è®¾è®¡ä¸å®ç°ï¼Œä»¥ä¾¿æ”¯æŒæ›´ä¸°å¯Œçš„åŠŸèƒ½æ‰©å±•ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/apache/apisix&#34;&gt;APISix&lt;/a&gt; - å¼€æºã€é«˜æ€§èƒ½çš„ API ç½‘å…³ï¼Œæä¾›ä¸°å¯Œçš„æ’ä»¶æ”¯æŒå’Œçµæ´»çš„é…ç½®ç®¡ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cloudflare/pingora&#34;&gt;Pingora&lt;/a&gt; - Cloudflare å¼€å‘çš„é«˜æ€§èƒ½åå‘ä»£ç†ï¼Œé‡‡ç”¨ Rust å®ç°ï¼Œè®¾è®¡çµæ„Ÿæ¥æºäº Nginxã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…¶ä»–ç›¸å…³é¡¹ç›®ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/vicanso/pingap&#34;&gt;pingap&lt;/a&gt; - ä¸€ä¸ªä½¿ç”¨ Rust å®ç°çš„è½»é‡çº§ API ç½‘å…³ï¼Œé€‚åˆå‚è€ƒå…¶æ¶æ„å’Œæ’ä»¶è®¾è®¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/memorysafety/river&#34;&gt;river&lt;/a&gt; - Rust å®ç°çš„åˆ†å¸ƒå¼æµé‡ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒåŠ¨æ€è·¯ç”±å’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/caibirdme/penguin&#34;&gt;penguin&lt;/a&gt; - Rust ç¼–å†™çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºå­¦ä¹ å’Œå‚è€ƒå…¶è·¯ç”±ä¸è´Ÿè½½å‡è¡¡å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>k8säº‘åŸç”Ÿç¨‹åºå®ç°CRDçš„æœç´¢æŸ¥è¯¢åˆ†é¡µ</title>
      <link>https://zhu327.github.io/2024/10/22/k8s%E4%BA%91%E5%8E%9F%E7%94%9F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0crd%E7%9A%84%E6%90%9C%E7%B4%A2%E6%9F%A5%E8%AF%A2%E5%88%86%E9%A1%B5/</link>
      <pubDate>Tue, 22 Oct 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/10/22/k8s%E4%BA%91%E5%8E%9F%E7%94%9F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0crd%E7%9A%84%E6%90%9C%E7%B4%A2%E6%9F%A5%E8%AF%A2%E5%88%86%E9%A1%B5/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;æ¥æ–°å…¬å¸è¿˜æ˜¯åœ¨åšäº‘åŸç”Ÿå¹³å°çš„å¼€å‘ï¼ŒåŸºæœ¬çš„ä¸šåŠ¡é€»è¾‘å°±æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„CRDèµ„æºï¼Œèµ°Operatorçš„æ¨¡å¼æ¥å®ç°å¹³å°çš„å„ç§ä¸šåŠ¡éƒ¨ç½²ã€‚ä½†æ˜¯CRDåœ¨apiserverä¸­æ˜¯ä»¥key-valueçš„å½¢å¼å­˜å‚¨åœ¨etcdä¸­ï¼Œè™½ç„¶labelså¯ä»¥å®ç°ç®€å•çš„æŸ¥è¯¢ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æ»¡è¶³å¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ã€‚åœ¨æˆ‘æ¥ä¹‹å‰CRDèµ„æºçš„åˆ—è¡¨æŸ¥è¯¢éƒ½æ˜¯ç›´æ¥å…¨é‡è¿”å›ç”±å‰ç«¯è‡ªè¡Œç­›é€‰ï¼Œéšç€ä¸šåŠ¡é‡çš„å¢åŠ ï¼ŒæŸ¥è¯¢çš„æ•ˆç‡è¶Šæ¥è¶Šä½ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ¥è¿™ä¸ªé¡¹ç›®çš„å‰ä»»å¼€å‘è€…å†³ç­–ä½¿ç”¨MySQLæ¥åŒå†™CRDèµ„æºï¼Œæ¥å®ç°è¾…åŠ©æŸ¥è¯¢ï¼Œä»£ç ä¹Ÿå†™äº†å¾ˆå¤šäº†ï¼ŒåŒå†™å¸¦æ¥äº†ä¸€äº›ä»£ç ç»“æ„ä¸Šçš„è€¦åˆï¼Œä½†æ˜¯å…¶å®ä¹Ÿä¸æ˜¯ä¸ªé—®é¢˜ã€‚æ›´æ¶å¿ƒçš„é—®é¢˜æ˜¯æœ‰ä¸€ä¸ªå®¢æˆ·ç”±äºä¿¡åˆ›æ–¹é¢çš„æ”¿æ²»é—®é¢˜ï¼Œè¦æ±‚æˆ‘ä»¬ä¸èƒ½å¼•å…¥MySQLï¼è™½ç„¶å®¢æˆ·æœ‰å»ºè®®ç”¨ä»–ä»¬è‡ªå·±çš„æ•°æ®åº“ï¼Œä½†æ˜¯ä»æˆ‘ä»¬çš„è§’åº¦æ¥è¯´ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›è‡ªå·±çš„æœåŠ¡ä¾èµ–å¤–éƒ¨å®¢æˆ·ç»„ä»¶ï¼Œæ‰€ä»¥å°±å¿…é¡»è€ƒè™‘ä¸‹å…¶å®ƒçš„æ–¹æ¡ˆäº†ï¼Œæ¯”å¦‚ä¸ç”¨æ•°æ®åº“æœåŠ¡ã€‚&lt;/p&gt;

&lt;p&gt;åŸºäºä»¥å¾€åœ¨SQLiteä¸Šçš„å­¦ä¹ ç»éªŒï¼Œä»¥å½“å‰CRDèµ„æºçš„ä½“é‡å®Œå…¨å¯ä»¥ä½¿ç”¨SQLiteæ¥å®ç°CRDèµ„æºçš„è¾…åŠ©æŸ¥è¯¢ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯è¦å¼•å…¥æŒä¹…å­˜å‚¨å‘¢ï¼Ÿå…¶å®è¿˜æ˜¯ä¸ç”¨ï¼Œå› ä¸ºCRDæœ¬èº«å·²ç»å­˜å‚¨åœ¨etcdä¸­äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç¨‹åºå¯åŠ¨æ—¶é€šè¿‡k8sçš„List-Watchçš„æ–¹å¼å°†CRDèµ„æºåŒæ­¥åˆ°SQLiteä¸­ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°CRDèµ„æºçš„è¾…åŠ©æŸ¥è¯¢äº†ã€‚å…·ä½“åˆ°å®ç°ä¸Šå®Œå…¨å¯ä»¥ä½¿ç”¨k8s clientä¸­çš„informeræ¥å®ç°CRDèµ„æºçš„åŒæ­¥ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨åˆ°informerçš„ç¼“å­˜æœºåˆ¶å‡å°‘apiserverçš„æŸ¥è¯¢å‹åŠ›ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;å®ç°&#34;&gt;å®ç°&lt;/h3&gt;

&lt;h4 id=&#34;synchronizerçš„æ¥å£å®šä¹‰&#34;&gt;synchronizerçš„æ¥å£å®šä¹‰&lt;/h4&gt;

&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å®šä¸€ä¸ªsynchronizeræ¥å£ï¼Œé’ˆå¯¹æ¯ç§éœ€è¦åŒæ­¥çš„CRDèµ„æºï¼Œéœ€è¦å®ç°synchronizeræ¥å£ã€‚è¿™ä¸ªæ¥å£ä¼šå¤„ç†informerçš„addã€updateã€deleteäº‹ä»¶ï¼Œå°†CRDèµ„æºåŒæ­¥åˆ°SQLiteä¸­ã€‚æ¯ä¸€ä¸ªèµ„æºå¯ä»¥åˆ›å»ºä¸€å¼ åœ¨SQLiteä¸­åˆ›å»ºçš„è¡¨ï¼Œå°†CRDèµ„æºåŒæ­¥åˆ°è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/runtime/schema&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;synchronizer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GroupVersionResource&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;oldObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newObj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;// ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®ç°æ¥å£çš„ä¾‹å­
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;manager&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dao&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;TemplateManager&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// SQLiteæ•°æ®åº“æ“ä½œ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GroupVersionResource&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;schema&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GroupVersionResource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Group&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;    &lt;span class=&#34;s&#34;&gt;&amp;#34;apps.titanide.cn&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;s&#34;&gt;&amp;#34;v1alpha1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;Resource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;templates&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;// åˆ†åˆ«å¤„ç†informerçš„addã€updateã€deleteäº‹ä»¶ï¼ŒæŠŠæ•°æ®åŒæ­¥åˆ°SQLiteçš„è¡¨ä¸­
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;oldObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newObj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizerImpl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;obj&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&#34;åŒæ­¥é€»è¾‘å®ç°&#34;&gt;åŒæ­¥é€»è¾‘å®ç°&lt;/h4&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬ä½¿ç”¨k8sçš„dynamicclientçš„informeræ¥å®ç°CRDèµ„æºçš„åŒæ­¥ï¼Œå› ä¸ºè¿™æ®µä»£ç åœ¨é¡¹ç›®ä¸­çš„å±‚çº§æ¯”è¾ƒä½ï¼Œæ²¡èƒ½ç›´æ¥åˆ›å»ºå¸¦schemeçš„clientï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨dynamicclientã€‚å¦‚æœä½ çš„é¡¹ç›®ä»£ç å±‚çº§æ¯”è¾ƒé«˜ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¸¦schemeçš„clientã€‚initSynchronizerå‡½æ•°å¿…é¡»åœ¨æœåŠ¡å¯åŠ¨æ—¶è°ƒç”¨ï¼Œç­‰å¾…åŒæ­¥å®Œæˆåå†å¯åŠ¨æœåŠ¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;os&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;os/signal&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;syscall&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;

	&lt;span class=&#34;s&#34;&gt;&amp;#34;github.com/pkg/errors&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/apis/meta/v1/unstructured&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/runtime&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/runtime/schema&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/client-go/dynamic&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/client-go/dynamic/dynamicinformer&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/client-go/rest&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;k8s.io/client-go/tools/cache&amp;#34;&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;appsv1alpha1&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;project/api/apis/apps/v1alpha1&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;project/pkg/database&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;s&#34;&gt;&amp;#34;project/pkg/database/dao&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;initSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;GetKubeDynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

  &lt;span class=&#34;nx&#34;&gt;sigCh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Signal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;signal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Notify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sigCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SIGINT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SIGTERM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// å¯åŠ¨ä¸€ä¸ªgoroutineï¼Œç­‰å¾…æ¥æ”¶ä¿¡å·
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sigCh&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;

	&lt;span class=&#34;c1&#34;&gt;// å¯åŠ¨åŒæ­¥é€»è¾‘
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;database&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;GetDB&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

  &lt;span class=&#34;c1&#34;&gt;// åˆå§‹åŒ–å…·ä½“çš„åŒæ­¥å¯¹è±¡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;templateSynchronizer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newTemplateSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dao&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewTemplateManager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;projectSynchronizer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newProjectSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dao&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewProjectManager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;pluginSynchronizer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newPluginSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dao&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewPluginManager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;synchronize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;synchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;templateSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;projectSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pluginSynchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;synchronize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dynamicClient&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syncs&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;synchronizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// åˆ›å»º Informer å·¥å‚, 10åˆ†é’Ÿå…¨é‡åŒæ­¥ä¸€æ¬¡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;factory&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dynamicinformer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewDynamicSharedInformerFactory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Minute&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;hasSyncedFuncs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;InformerSynced&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;syncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syncs&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;c1&#34;&gt;// åˆ›å»º informer
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

		&lt;span class=&#34;nx&#34;&gt;informer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;factory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ForResource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gvr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Informer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

		&lt;span class=&#34;c1&#34;&gt;// è®¾ç½®äº‹ä»¶å¤„ç†ç¨‹åº
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;informer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;AddEventHandler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ResourceEventHandlerFuncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;AddFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;UpdateFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;DeleteFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;

		&lt;span class=&#34;c1&#34;&gt;// å¯åŠ¨ informer
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;informer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

		&lt;span class=&#34;nx&#34;&gt;hasSyncedFuncs&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hasSyncedFuncs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;informer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;HasSynced&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;c1&#34;&gt;// ç­‰å¾…ç¼“å­˜åŒæ­¥
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WaitForCacheSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stopCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hasSyncedFuncs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;New&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;failed to wait for cache sync&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;// GetKubeDynamicClient å‡½æ•°ç”¨äºè·å– Kubernetes å®¢æˆ·ç«¯é›†ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘ *kubernetes.Clientset çš„æŒ‡é’ˆå’Œ error å¯¹è±¡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;GetKubeDynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;cfg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;rest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;InClusterConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Wrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;failed to get cluster config&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;dynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;NewForConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cfg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Wrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;failed to create dynamicClient&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dynamicClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;å…¶å®ƒ&#34;&gt;å…¶å®ƒ&lt;/h3&gt;

&lt;p&gt;é€šè¿‡ä»¥ä¸Šæœºåˆ¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°CRDèµ„æºçš„è¾…åŠ©æŸ¥è¯¢äº†ã€‚è¿™ç§åŒæ­¥æœºåˆ¶ä¹Ÿæ‘†è„±äº†éœ€è¦åŒå†™çš„å¤æ‚é€»è¾‘ï¼Œåœ¨ç¨‹åºå¯åŠ¨æ—¶ListåŒæ­¥ï¼Œå¯åŠ¨åWatchåŠ¨æ€æ›´æ–°ï¼Œåœ¨æŸ¥è¯¢æ—¶ç›´æ¥ä»SQLiteä¸­æŸ¥è¯¢ï¼Œå†™å…¥æ—¶ç›´æ¥å†™CRDã€‚ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œè¿™ç§æœºåˆ¶å®ç°äº†è¯»å†™åˆ†ç¦»ï¼Œä¹Ÿè§£å†³äº†åŒå†™å¸¦æ¥çš„è€¦åˆé—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å°è£…dbçš„daoå±‚æ—¶ï¼ŒåŸºäºä»¥å¾€é¡¹ç›®çš„ç»éªŒè¿˜æ˜¯å»ºè®®ç›´æ¥ä½¿ç”¨sqlx+squirrelæ¥å®ç°SQLçš„ç”Ÿæˆå’Œæ‰§è¡Œï¼Œè¿™æ ·åœ¨ä»£ç ç»“æ„ä¸Šä¼šæ›´åŠ æ¸…æ™°ã€‚æ²¡æœ‰å¼•å…¥ORMçš„åŸå› æ˜¯ä»¥å‰è¸©è¿‡å‘ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä½¿ç”¨SQLiteæ—¶å»ºè®®å¼€å¯ä¸€äº›é…ç½®ï¼Œæ¥ä¼˜åŒ–æ€§èƒ½ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA journal_mode = WAL;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA synchronous=NORMAL;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA mmap_size = 134217728;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA journal_size_limit = 27103364;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MustExec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;PRAGMA cache_size=2000;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;åœ¨å®é™…é¡¹ç›®ä¸­æˆ‘ä»¬ä¼šç¢°åˆ°å„ç§é—®é¢˜ï¼Œè§£å†³é—®é¢˜çš„æ€è·¯å’Œæ–¹æ³•å¤šç§å¤šæ ·ã€‚éœ€è¦æ ¹æ®é¡¹ç›®çš„å®é™…æƒ…å†µä¸é¡¹ç›®æœªæ¥çš„å‘å±•æ–¹å‘æ¥å†³ç­–ä½¿ç”¨ä»€ä¹ˆæ–¹æ³•æ¥è§£å†³é—®é¢˜ã€‚ä»¥æˆ‘å½“å‰çš„é¡¹ç›®ä¸ºä¾‹ï¼Œå®¢æˆ·çš„æ”¿æ²»åŸå› å¯¼è‡´ä¸èƒ½å¼•å…¥MySQLï¼Œåªèƒ½è€ƒè™‘å…¶å®ƒçš„æ–¹å¼æ¥è§£å†³é—®é¢˜ã€‚åœ¨å¼•å…¥SQLiteçš„åŒæ—¶è¿˜è§£å†³äº†éœ€è¦åŒå†™å¸¦æ¥çš„è€¦åˆé—®é¢˜ï¼Œè¿™é‡Œçš„ä»£ç ä¸å¤šï¼Œä½†æ˜¯æä¾›ä¸€ç§è§£å†³CRDèµ„æºé€šç”¨æŸ¥è¯¢çš„æ€è·¯ï¼Œæœ‰éœ€è¦å¯ä»¥å‚è€ƒã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ä»¥Vaultwardenä¸ºä¾‹ä½¿ç”¨SQLite Litestreamå®ç°æ— æ•°æ®åº“æœåŠ¡</title>
      <link>https://zhu327.github.io/2024/09/03/%E4%BB%A5vaultwarden%E4%B8%BA%E4%BE%8B%E4%BD%BF%E7%94%A8sqlite-litestream%E5%AE%9E%E7%8E%B0%E6%97%A0%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1/</link>
      <pubDate>Tue, 03 Sep 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/09/03/%E4%BB%A5vaultwarden%E4%B8%BA%E4%BE%8B%E4%BD%BF%E7%94%A8sqlite-litestream%E5%AE%9E%E7%8E%B0%E6%97%A0%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;Vaultwardenæ˜¯ä¸€ä¸ªéå®˜æ–¹å®ç°çš„Bitwarden Serverï¼Œç”¨äºå¯†ç ç®¡ç†ï¼Œæ”¯æŒWebç«¯ã€æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯ã€‚å®ƒæ”¯æŒå¤šç§æ•°æ®æ¥å­˜å‚¨æ•°æ®ï¼ŒåŒ…æ‹¬SQLiteã€PostgreSQLå’ŒMySQLç­‰ã€‚å½“æˆ‘ä»¬æƒ³æŠŠå®ƒéƒ¨ç½²åœ¨ä¸€ä¸ªå®¹å™¨æœåŠ¡å¹³å°æ—¶ï¼Œå¦‚æœå®¹å™¨æœåŠ¡æœ¬èº«æ²¡æœ‰æä¾›æŒä¹…æŒ‚è½½çš„å·ï¼Œé‚£æˆ‘ä»¬å°±åªèƒ½ä½¿ç”¨PostgreSQLæˆ–è€…MySQLå¤–éƒ¨æ•°æ®æ¥å­˜å‚¨æ•°æ®ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸æƒ³é¢å¤–å†ä¹°èµ„æºæ¥è¿è¡Œä¸€ä¸ªæ•°æ®åº“ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨SQLiteæ¥å­˜å‚¨æ•°æ®ï¼Œå¹¶ä¸”ä½¿ç”¨Litestreamæ¥å®ç°å®¹ç¾å¤‡ä»½ã€‚è¿™æ ·è™½ç„¶å®¹å™¨æœåŠ¡æ²¡æœ‰æŒä¹…å­˜å‚¨ï¼Œä½†æ˜¯æ•°æ®è¿˜æ˜¯å®‰å…¨çš„ã€‚ä¸‹é¢ä»¥Vaultwardenä¸ºä¾‹ï¼Œä½¿ç”¨SQLiteå’ŒLitestreamæ¥å®ç°æ— æ•°æ®åº“æœåŠ¡ã€‚å…¶å®ƒå¯ä»¥ä½¿ç”¨SQLiteçš„ç¨‹åºä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å®ç°æ— æ•°æ®åº“æœåŠ¡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-litestream-yml&#34;&gt;1. litestream.yml&lt;/h3&gt;

&lt;p&gt;Litesreamæ˜¯ä¸€ä¸ªå¼€æºçš„SQLiteæ•°æ®åº“å¤‡ä»½å·¥å…·ï¼Œå®ƒä½¿ç”¨Goè¯­è¨€å¼€å‘ã€‚å®ƒå¯ä»¥ç›‘æ§ä¸€ä¸ªSQLiteæ•°æ®åº“æ–‡ä»¶çš„å˜åŒ–ï¼Œå¹¶ä¸”å°†å˜åŒ–è®°å½•åˆ°S3ã€MinIOç­‰å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸Šã€‚å®ƒå·§å¦™çš„ä½¿ç”¨äº†SQLiteçš„WALï¼ˆWrite-Ahead Loggingï¼‰æœºåˆ¶ï¼Œæ¥è®°å½•æ•°æ®åº“çš„å˜åŒ–ï¼Œå¹¶æµå¼åœ°å°†è¿™äº›å˜åŒ–è®°å½•åˆ°å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸Šï¼Œè¾¾åˆ°å®æ—¶å¤‡ä»½çš„ç›®çš„ã€‚åœ¨æœåŠ¡å¯å‰ï¼ŒLitestreamå¯ä»¥ä»å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸Šæ¢å¤æ•°æ®åˆ°SQLiteæ•°æ®åº“æ–‡ä»¶ä¸­ã€‚å®ƒçš„å®ç°åŸç†å¯ä»¥å‚è€ƒ&lt;a href=&#34;https://litestream.io/how-it-works/&#34;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä½¿ç”¨Litestreamæ—¶ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ªS3å…¼å®¹çš„å¯¹è±¡å­˜å‚¨ï¼Œè¿™é‡Œä»¥Cloudflare R2ä¸ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ª&lt;code&gt;litestream.yml&lt;/code&gt;çš„é…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;dbs&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;-&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;path&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/data/db.sqlite3&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;replicas&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;-&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;type&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;s3&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;endpoint&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;${REPLICA_URL}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;bucket&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;sqlite&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;/data/db.sqlite3&lt;/code&gt; æ˜¯Vaultwardençš„SQLiteæ•°æ®åº“æ–‡ä»¶è·¯å¾„ï¼Œ&lt;code&gt;REPLICA_URL&lt;/code&gt;æ˜¯å¯¹è±¡å­˜å‚¨æœåŠ¡çš„åœ°å€ï¼Œæ¯”å¦‚ &lt;code&gt;https://&amp;lt;cloudflare-account-id&amp;gt;.r2.cloudflarestorage.com&lt;/code&gt;ï¼Œæˆ‘ä»¬éœ€è¦åœ¨Cloudflare R2ä¸Šåˆ›å»ºä¸€ä¸ª&lt;code&gt;sqlite&lt;/code&gt;çš„å­˜å‚¨æ¡¶ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-entrypoint-sh&#34;&gt;2. entrypoint.sh&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬è¿˜éœ€è¦å‡†å¤‡ä¸€ä¸ª&lt;code&gt;entrypoint.sh&lt;/code&gt;çš„è„šæœ¬æ–‡ä»¶ï¼Œç”¨äºå¯åŠ¨Liestreamå’ŒVaultwardenæœåŠ¡ã€‚å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; -e

&lt;span class=&#34;c1&#34;&gt;# Set the directory of the database in a variable
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;DB_PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/data/db.sqlite3

&lt;span class=&#34;c1&#34;&gt;# Restore the database if it does not already exist.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; -f &lt;span class=&#34;nv&#34;&gt;$DB_PATH&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Database already exists, skipping restore&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;No database found, restoring from replica if exists&amp;#34;&lt;/span&gt;
	litestream restore -if-replica-exists -config /etc/litestream.yml &lt;span class=&#34;nv&#34;&gt;$DB_PATH&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Litestream replicate database and start vaultwarden
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;exec litestream&amp;#34;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; litestream replicate -exec &lt;span class=&#34;s2&#34;&gt;&amp;#34;/start.sh&amp;#34;&lt;/span&gt; -config /etc/litestream.yml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨å¯åŠ¨VaultwardenæœåŠ¡å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ£€æŸ¥SQLiteæ•°æ®åº“æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä»å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸Šæ¢å¤æ•°æ®ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-dockerfile&#34;&gt;3. Dockerfile&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-dockerfile&#34; data-lang=&#34;dockerfile&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; litestream/litestream:latest AS litestream&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; vaultwarden/server:latest&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;COPY --from&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;litestream /usr/local/bin/litestream /usr/local/bin/litestream&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;COPY --chmod&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;755&lt;/span&gt; entrypoint.sh /usr/bin/entrypoint.sh&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;COPY litestream.yml /etc/litestream.yml&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CMD&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; [&amp;#34;/usr/bin/entrypoint.sh&amp;#34;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·ä¼šæ‰“ä¸€ä¸ªæ–°çš„é•œåƒæŠŠLitestreamå’ŒVaultwardenæœåŠ¡ä¸€èµ·æ‰“åŒ…ï¼Œå¹¶ä¸”ä½¿ç”¨&lt;code&gt;entrypoint.sh&lt;/code&gt;å¯åŠ¨æœåŠ¡ã€‚&lt;/p&gt;

&lt;h3 id=&#34;4-å¯åŠ¨æœåŠ¡&#34;&gt;4. å¯åŠ¨æœåŠ¡&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬è¿˜è¦å‡†å¤‡ä¸€ä¸ª.envæ–‡ä»¶ï¼Œç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;nv&#34;&gt;LITESTREAM_ACCESS_KEY_ID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;cloudflare-r2-access-key-id&amp;gt;
&lt;span class=&#34;nv&#34;&gt;LITESTREAM_SECRET_ACCESS_KEY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;cloudflare-r2-access-key&amp;gt;
&lt;span class=&#34;nv&#34;&gt;PUSH_ENABLED&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;PUSH_INSTALLATION_ID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;push-installation-id&amp;gt;
&lt;span class=&#34;nv&#34;&gt;PUSH_INSTALLATION_KEY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;lt;push-installation-key&amp;gt;
&lt;span class=&#34;nv&#34;&gt;PUSH_RELAY_BASE_URI&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;https://push.bitwarden.com
&lt;span class=&#34;nv&#34;&gt;REPLICA_URL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;https://&amp;lt;cloudflare-account-id&amp;gt;.r2.cloudflarestorage.com
&lt;span class=&#34;nv&#34;&gt;SIGNUPS_ALLOWED&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;true&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;vaulewardençš„PUSHé…ç½®éœ€è¦åˆ°&lt;a href=&#34;https://bitwarden.com/host/&#34;&gt;è¿™é‡Œ&lt;/a&gt;ç”³è¯·ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Dockeræ¥å¯åŠ¨æœåŠ¡äº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;docker run -d &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --name bitwarden &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  -p &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;:80 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --restart unless-stopped &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --env-file .env &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  vaultwarden/server:latest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ²¡æœ‰æŒä¹…å­˜å‚¨çš„å®¹å™¨æœåŠ¡ä¸Šæ— æ•°æ®åº“çš„è¿è¡ŒVaultwardenæœåŠ¡äº†ï¼Œæ¯”å¦‚GCP Code Runï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ä¾‹æ•°é‡scaleåˆ°0ï¼Œåªæœ‰æµé‡è¿›æ¥æ—¶æ‰å¯åŠ¨æœåŠ¡ï¼ŒçœŸæ­£åšåˆ°åªæœ‰ä½¿ç”¨æ—¶æ‰ä»˜è´¹ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨Litestreamå®ç°äº†Vaultwardençš„æ— æ•°æ®åº“æœåŠ¡ï¼Œå¹¶ä¸”ä½¿ç”¨Cloudflare R2ä½œä¸ºå¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚è¿™æ ·å³ä½¿å®¹å™¨æœåŠ¡æ²¡æœ‰æŒä¹…å­˜å‚¨å·ï¼Œæ•°æ®ä¹Ÿæ˜¯å®‰å…¨çš„ã€‚ç±»ä¼¼çš„æ€è·¯è¿˜å¯ä»¥æ¨å¹¿åˆ°å…¶å®ƒä½¿ç”¨SQLiteçš„ç¨‹åºä¸Šã€‚æ¯”å¦‚æˆ‘ä»¬è‡ªå·±å¼€å‘äº†ä¸€ä¸ªDjangoçš„ç¨‹åºï¼Œä¸ä¾èµ–å¤–éƒ¨çš„æ•°æ®åº“æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Litestreamæ¥å®ç°å®¹ç¾å¤‡ä»½ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>è‡ªåŠ¨åŒ–è‡ªå·±çš„ç”Ÿæ´»ï¼šåˆ›é€ è‡ªå·±çš„å°å·¥å…·</title>
      <link>https://zhu327.github.io/2024/08/30/%E8%87%AA%E5%8A%A8%E5%8C%96%E8%87%AA%E5%B7%B1%E7%9A%84%E7%94%9F%E6%B4%BB%E5%88%9B%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%B0%8F%E5%B7%A5%E5%85%B7/</link>
      <pubDate>Fri, 30 Aug 2024 10:55:52 &#43;0800</pubDate>
      
      <guid>https://zhu327.github.io/2024/08/30/%E8%87%AA%E5%8A%A8%E5%8C%96%E8%87%AA%E5%B7%B1%E7%9A%84%E7%94%9F%E6%B4%BB%E5%88%9B%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%B0%8F%E5%B7%A5%E5%85%B7/</guid>
      <description>&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;ä½œä¸ºä¸€ä½ç¨‹åºå‘˜ï¼Œæˆ‘å†™çš„å¤§éƒ¨åˆ†å½“ç„¶éƒ½æ˜¯ç”¨æ¥èµšé’±ç”Ÿæ´»çš„ä»£ç ï¼Œèµšé’±çš„ä»£ç éƒ½æ˜¯éå¸¸è§„èŒƒçš„ï¼Œä¸€èˆ¬éƒ½æ˜¯å¤æ‚ä¸šåŠ¡é€»è¾‘åœ¨ç¨‹åºä¸Šæ˜ å°„ï¼Œå¾ˆå¤šæ—¶å€™éƒ½åªæœ‰åœ¨è§£å†³äº†å¤æ‚çš„ä¸šåŠ¡é—®é¢˜ï¼Œæ‰èƒ½è·å¾—æ‰“æ€ªå‡çº§çš„æˆå°±æ„Ÿã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯æˆ‘ä¹Ÿä¼šåœ¨ä¸šä½™æ—¶é—´å­¦ä¹ ä¸€äº›å·¥ä½œæ— å…³çš„æŠ€æœ¯ï¼Œæ¯”å¦‚æœ€è¿‘åŠå¹´æˆ‘å­¦ä¹ äº†Rustï¼Œæ¯å½“æˆ‘å­¦ä¹ ä¸€é—¨æ–°çš„æŠ€æœ¯ï¼Œæˆ‘æ€»æ˜¯å¸Œæœ›æŠŠä¹‹å‰å®ç°çš„ä¸€äº›ç¨‹åºæ”¹ç”¨æ–°æŠ€æœ¯æ¥å®ç°ï¼Œè¿™æ ·å°±å¯ä»¥æ›´å¿«çš„ä¸Šæ‰‹ã€‚å¹³å¸¸ç”Ÿæ´»ä¸­ä¹Ÿæ²¡ä»€ä¹ˆç”¨åˆ°Rustçš„åœºæ™¯ï¼Œé‚£å°±åªèƒ½å…ˆæŠŠä¹‹å‰ç”¨Bashï¼ŒPythonå†™çš„å°å·¥å…·ç”¨Rusté‡å†™ä¸€éã€‚ç„¶åæœ€è¿‘æˆ‘ä¹Ÿè‡ªå·±å‘æ˜äº†ä¸€äº›ç”Ÿæ´»ä¸Šçš„åœºæ™¯ï¼Œè¿™äº›åœºæ™¯å¾ˆå¤šæ—¶å€™éƒ½æ˜¯é‡å¤çš„ï¼Œæ‰‹åŠ¨çš„ï¼Œå¦‚æœèƒ½æ”¹æˆè‡ªåŠ¨åŒ–èƒ½å¤ŸèŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚æƒ³èµ·äº†ä¸çŸ¥é“å“ªé‡Œçœ‹è¿‡çš„ä¸€ä¸ªè¯´æ³•ï¼šæ‡’æƒ°æ˜¯ç¨‹åºå‘˜çš„ç¬¬ä¸€ç”Ÿäº§åŠ›ï¼Œå› ä¸ºæ‡’ï¼Œæˆ‘ä»¬ä¼šæŠŠå„ç§é‡å¤æ‰‹åŠ¨çš„å·¥ä½œè‡ªåŠ¨åŒ–ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢çš„å†…å®¹å°±æ˜¯æˆ‘åœ¨ä»Šå¹´è‡ªåŠ¨åŒ–ç”Ÿæ´»çš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡è‡ªå·±åˆ›é€ çš„è¿™äº›å°å·¥å…·ï¼Œæˆ‘è§£å†³äº†è‡ªå·±ç”Ÿæ´»ä¸­çš„ä¸€äº›å°ç—›ç‚¹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-è‡ªåŠ¨è¿½ç•ª&#34;&gt;1. è‡ªåŠ¨è¿½ç•ª&lt;/h3&gt;

&lt;p&gt;æ—©å‰æˆ‘åœ¨å®¶é‡Œçš„å¼€å‘æ¿ä¸Šæ­å»ºäº†Jellyfin, Sonarrç”¨æ¥è¿½ç¾å‰§ï¼Œæ•ˆæœè¿˜æ˜¯ä¸é”™çš„ï¼Œè‡ªåŠ¨ä¸‹è½½è‡ªåŠ¨æ•´ç†æ–‡ä»¶ï¼Œè‡ªåŠ¨å‰Šåˆ®æµ·æŠ¥ã€‚Sonarrä¾èµ–çš„IndexeræœåŠ¡æ˜¯ä¸€ä¸ªæ­å»ºåœ¨fly.ioå¹³å°ä¸Šçš„ProwlarræœåŠ¡ï¼ŒæŠŠProwlarræ­å»ºåœ¨å¤–ç½‘ï¼Œå¯ä»¥é¿å…å›½å†…ç½‘ç»œè®¿é—®çš„é™åˆ¶ã€‚&lt;/p&gt;

&lt;p&gt;è¿™å¥—æ–¹æ¡ˆå¯¹äºç¾å‰§æ¥è¯´å·²ç»éå¸¸å®Œç¾äº†ï¼Œä½†æ˜¯æˆ‘é™¤äº†çœ‹ç¾å‰§ï¼Œè¿˜å–œæ¬¢çœ‹æ—¥æœ¬åŠ¨æ¼«ï¼Œç”±äºSonarrå¯¹äºç•ªç»„çš„ä¸­æ–‡æ”¯æŒä¸å¥½ï¼Œæˆ‘åœ¨ç½‘ç»œä¸Šä¹Ÿæ‰¾äº†ä¸€äº›æ–¹æ¡ˆï¼Œéƒ½ä¸æ˜¯ç‰¹åˆ«æ»¡æ„ï¼Œæ‰€ä»¥æˆ‘éƒ½æ˜¯æ‰‹åŠ¨åœ¨èœœæŸ‘è®¡åˆ’ä¸Šæ‰¾ç£åŠ›é“¾ï¼Œç„¶åæ‰‹åŠ¨ä¸‹è½½ã€‚&lt;/p&gt;

&lt;p&gt;å› ä¸ºæˆ‘å¾ˆæ‡’ï¼Œæ‰€ä»¥æˆ‘å°±å­¦ä¹ äº†ä¸€ä¸‹Prowlarrçš„APIï¼Œå†™äº†ä¸€ä¸ªå°å·¥å…·ï¼Œæ¯å°æ—¶è‡ªåŠ¨ä»Prowlarrä¸Šæœç´¢èœœæŸ‘è®¡åˆ’çš„ç´¢å¼•ï¼Œé€šè¿‡æˆ‘åœ¨é…ç½®ä¸­å¡«å†™çš„å…³é”®å­—ï¼Œæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç•ªç»„ï¼Œç„¶åè§¦å‘è‡ªåŠ¨ä¸‹è½½ï¼Œå¦‚æœè§¦å‘äº†ä¸‹è½½è¿˜å¯ä»¥é…ç½®é€šè¿‡ntfy.shå‘é€é€šçŸ¥åˆ°æ‰‹æœºï¼Œè¿™æ ·å°±ä¸ä¼šæ¼æ‰æˆ‘è®¢é˜…çš„ç•ªç»„ã€‚&lt;/p&gt;

&lt;p&gt;ä»£ç åœ°å€ï¼š&lt;a href=&#34;https://github.com/zhu327/ani-sub&#34;&gt;https://github.com/zhu327/ani-sub&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä»£ç å¾ˆé€»è¾‘å¾ˆç®€å•ï¼Œåªæ˜¯ä¸€äº›APIçš„è°ƒç”¨ï¼Œå¦‚æœæ„Ÿå…´è¶£å¯ä»¥è‡ªå·±çœ‹çœ‹ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºäº†æ–¹ä¾¿æ²¡æœ‰è‡ªå·±æœåŠ¡å™¨çš„æœ‹å‹ï¼Œæˆ‘è¿˜å¼€å‘ä¸€ä¸ªå¯ä»¥éƒ¨ç½²åœ¨Cloudflare Workersçš„ç‰ˆæœ¬ï¼š&lt;a href=&#34;https://github.com/zhu327/ani-sub/tree/workers&#34;&gt;https://github.com/zhu327/ani-sub/tree/workers&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªç‰ˆæœ¬ç”±äºæ²¡æœ‰é…ç½®æ–‡ä»¶ï¼Œéœ€è¦ä¾èµ–Cloudflare D1æ•°æ®åº“ï¼Œå¯ä»¥åœ¨Cloudflareç½‘ç«™ä¸Šç¼–è¾‘D1æ•°æ®åº“çš„æ•°æ®æ¥æ·»åŠ ä¿®æ”¹è‡ªå·±è®¢é˜…çš„ç•ªç»„å…³é”®å­—ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-è‡ªåŠ¨ç”Ÿæˆrss-aiæ‘˜è¦&#34;&gt;2. è‡ªåŠ¨ç”ŸæˆRSS AIæ‘˜è¦&lt;/h3&gt;

&lt;p&gt;æˆ‘åœ¨fly.ioå¹³å°ä¸Šæ­å»ºäº†è‡ªå·±çš„RSSè®¢é˜…æœåŠ¡Minifluxï¼Œå¹¶ä¸”è¿˜åœ¨Vercelå¹³å°ä¸Šæ­å»ºäº†è‡ªå·±çš„RSSHubæœåŠ¡ã€‚éšç€è®¢é˜…çš„RSSæºè¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä¸€èˆ¬åœ¨æµè§ˆå™¨ä¸Šä½¿ç”¨ChatGPTæ€»ç»“åŠ©æ‰‹æ¥ç”Ÿæˆæ–‡ç« æ‘˜è¦æ¥å¿«é€Ÿé˜…è¯»ã€‚ä½†æ˜¯è¿™æ ·æ¯æ¬¡æ‰“å¼€æ–‡ç« ï¼Œéƒ½éœ€è¦æˆ‘è‡ªå·±æ‰‹åŠ¨ç‚¹å‡»ä¸€ä¸‹æ¥ç”Ÿæˆæ‘˜è¦ï¼Œéå¸¸éº»çƒ¦ï¼Œæ‰€ä»¥åœ¨ç½‘ç»œä¸Šæ‰¾äº†Minifuxä¸OpenAIç›¸å…³çš„è¯é¢˜ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æ–¹æ¡ˆã€‚ç›´åˆ°æˆ‘åœ¨v2exçœ‹åˆ°ä¸€ä¸ªç½‘å‹åˆ†äº«çš„ä»–ç”¨Pythonå®ç°çš„ä¸€ä¸ªæ—è·¯æœåŠ¡ï¼Œé€šè¿‡Minifluxçš„APIéå†æ–‡ç« ï¼Œç„¶åé€šè¿‡OpenAIçš„APIç”Ÿæˆæ‘˜è¦ï¼Œå†ä¿å­˜åˆ°Minifluxä¸­ã€‚é‚£æˆ‘ä¹Ÿå¯ä»¥ç”¨Rustå®ç°ä¸€ä¸ªç±»ä¼¼çš„æœåŠ¡ï¼Œå¹¶ä¸”å¯ä»¥éƒ¨ç½²åœ¨Cloudflare Workersä¸Šã€‚è¿˜å¯ä»¥åˆ©ç”¨åˆ° Cloudflare Workers AIçš„å…è´¹æ¨¡å‹æ¥ç”Ÿæˆæ‘˜è¦ã€‚&lt;/p&gt;

&lt;p&gt;ä»£ç åœ°å€ï¼š&lt;a href=&#34;https://github.com/zhu327/miniflux-ai&#34;&gt;https://github.com/zhu327/miniflux-ai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç°åœ¨å¯¹äºæ¯”è¾ƒé•¿çš„æ–°é—»ï¼Œæˆ‘ä¸€èˆ¬éƒ½åªçœ‹AIæ‘˜è¦äº†ï¼Œåªæœ‰æœ‰å…´è¶£çš„æ–‡ç« æ‰ä¼šé˜…è¯»å…¨æ–‡ï¼Œå¹¶ä¸”åœ¨æ‰‹æœºä¸Šä¹Ÿå¯ä»¥æ–¹ä¾¿çš„é˜…è¯»åˆ°AIæ‘˜è¦ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-è‡ªåŠ¨ç¿»è¯‘hacknews-rss&#34;&gt;3. è‡ªåŠ¨ç¿»è¯‘HackNews RSS&lt;/h3&gt;

&lt;p&gt;ä½œä¸ºä¸€ä½ç¨‹åºå‘˜ï¼Œæˆ‘å»ºè®®æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥å…³æ³¨HackNewsï¼Œäº†è§£ä¸‹æ¯å¤©çš„ä¸šç•Œæ–°é—»ã€‚ç½‘ç»œä¸Šå·²ç»æœ‰äº†HackNews RSSæº&lt;a href=&#34;https://hnrss.github.io&#34;&gt;https://hnrss.github.io&lt;/a&gt;ï¼Œä½†æ˜¯æ¯å¤©çš„ä¿¡æ¯å¤ªå¤šï¼Œæˆ‘ä¸€èˆ¬åªçœ‹æ ‡é¢˜ï¼Œè‹±æ–‡çš„æ ‡é¢˜ä¼šå½±å“æˆ‘çš„é˜…è¯»ï¼Œæ‰€ä»¥æˆ‘éœ€è¦ä¸€ä¸ªè‡ªåŠ¨ç¿»è¯‘çš„HackNews RSSæºã€‚æ­£å¥½å‰å‡ ä¸ªæœˆCloudflare Workerså¼€å§‹æ”¯æŒPythonï¼Œæ‰€ä»¥æˆ‘å°±ç”¨Pythonå®ç°äº†ä¸€ä¸ªåˆ©ç”¨å¾®è½¯azureç¿»è¯‘APIè‡ªåŠ¨ç¿»è¯‘çš„HackNews RSSæºã€‚å¾®è½¯azureç¿»è¯‘APIæ˜¯æœ‰å…è´¹é¢åº¦ï¼Œæ¯å¤©å¯ä»¥ç¿»è¯‘10ä¸‡å­—ç¬¦ï¼Œå¯¹äºHackNewsæ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚&lt;/p&gt;

&lt;p&gt;ä»£ç åœ°å€ï¼š&lt;a href=&#34;https://github.com/zhu327/workers-hnrss&#34;&gt;https://github.com/zhu327/workers-hnrss&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;4-è‡ªåŠ¨æ£€æµ‹aws-cloudfront-æ–°åŠ å¡-ddns&#34;&gt;4. è‡ªåŠ¨æ£€æµ‹AWS Cloudfront æ–°åŠ å¡ DDNS&lt;/h3&gt;

&lt;p&gt;ç”±äºä¸€äº›ç‰¹æ®Šçš„éœ€æ±‚ï¼Œæˆ‘éœ€è¦ä¿è¯ä¸€ä¸ªåŸŸåä¸€ç›´æŒ‡å‘AWS Cloudfrontçš„æ–°åŠ å¡çš„IPä¸Šï¼Œä½†æ˜¯Cloudfrontçš„IPåœ°å€æ˜¯åŠ¨æ€çš„ï¼Œä¸€æ®µæ—¶é—´å¯èƒ½å¤±æ•ˆï¼Œéœ€è¦æ‰¾æ–°çš„IPåœ°å€ã€‚æ‰€ä»¥æˆ‘å°±å†™äº†ä¸€ä¸ªå°å·¥å…·ï¼Œæ¯å°æ—¶æ£€æµ‹ä¸€æ¬¡Cloudfrontçš„IPåœ°å€æ˜¯å¦æœ‰æ•ˆï¼Œå¦‚æœä¸å¯è¾¾ï¼Œåˆ™è‡ªåŠ¨æ‰¾åˆ°æ–°çš„IPåœ°å€ï¼Œå¹¶ä¸”æ›´æ–°DNSè®°å½•ã€‚&lt;/p&gt;

&lt;p&gt;æ•´ä¸ªé€»è¾‘æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æŸ¥è¯¢DNSPodçš„DNSè®°å½•ï¼Œè·å–è€çš„IPåœ°å€&lt;/li&gt;
&lt;li&gt;http è®¿é—®è¿™ä¸ª IPåœ°å€ï¼Œå¦‚æœä¸å¯è¾¾&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;a href=&#34;https://sg-sin.doh.sb/dns-query&#34;&gt;https://sg-sin.doh.sb/dns-query&lt;/a&gt;è¿™ä¸ªDOHæŸ¥è¯¢ä¸€ä¸ªæ–°çš„æ–°åŠ å¡çš„IPåœ°å€&lt;/li&gt;
&lt;li&gt;é€šè¿‡DNSPodçš„APIæ›´æ–°DNSè®°å½•&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åˆšå¼€å§‹è¿™ä¸ªå°å·¥å…·æ˜¯ç”¨Bashå†™çš„å¹¶é€šè¿‡crontabè¿è¡Œåœ¨æˆ‘çš„æœåŠ¡å™¨ä¸Šï¼Œåæ¥ä¸ºäº†ç»ƒä¹ Rustï¼Œæˆ‘å°±ç”¨Rusté‡å†™äº†è¿™ä¸ªå·¥å…·ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨Cloudflare Workersä¸Šã€‚&lt;/p&gt;

&lt;h3 id=&#34;5-gemini-openai-proxy&#34;&gt;5. Gemini OpenAI Proxy&lt;/h3&gt;

&lt;p&gt;å»å¹´æˆ‘ç”¨Golangå†™äº†ä¸ªä¸€ä¸ªGeminiçš„OpenAIä»£ç†æœåŠ¡&lt;a href=&#34;https://github.com/zhu327/gemini-openai-proxy&#34;&gt;https://github.com/zhu327/gemini-openai-proxy&lt;/a&gt;ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨fly.ioå¹³å°ä¸Šã€‚ä½†æ˜¯å…¶å®ç”¨çš„ä¹ŸæŒºå°‘çš„ï¼Œè¿˜å äº†fly.ioçš„å®ä¾‹èµ„æºã€‚æ‰€ä»¥æˆ‘å°±æƒ³æ‰¾ä¸€ä¸ªservelessçš„ç‰ˆæœ¬æ¥æ›¿ä»£è¿™ä¸ªå·¥å…·ï¼Œç„¶åå°±æ‰¾äº†è¿™ä¸ªæ”¯æŒCloudflare Workersçš„Geminiä»£ç†ï¼š&lt;a href=&#34;https://github.com/PublicAffairs/openai-gemini&#34;&gt;https://github.com/PublicAffairs/openai-gemini&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯å‘¢Cloudflare Workersåœ¨å›½å†…æ˜¯è¢«å±è”½äº†çš„ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠè¿™ä¸ªå°å·¥å…·éƒ¨ç½²åˆ°deno deployä¸Šï¼Œå›½å†…å¯ä»¥æ— ç—›è®¿é—®ã€‚&lt;/p&gt;

&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;é™¤äº†å·¥ä½œï¼Œæˆ‘ä»¬åœ¨ç”Ÿæ´»ä¸­ä¹Ÿä¼šæœ‰ä¸€äº›é‡å¤æ€§çš„å·¥ä½œï¼Œå¦‚æœèƒ½è‡ªåŠ¨åŒ–ï¼Œé‚£ä¹ˆå°±å¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´ã€‚ä½œä¸ºç¨‹åºå‘˜æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç°æœ‰çš„å…è´¹èµ„æºï¼Œæ¥åˆ›é€ è‡ªå·±çš„å°å·¥å…·ï¼Œè®©æˆ‘ä»¬çš„ç”Ÿæ´»æ›´ç¾å¥½ã€‚&lt;/p&gt;

&lt;p&gt;Cloudflare Workers, deno deployï¼Œfly.ioéƒ½æœ‰ä¸€äº›å…è´¹çš„èµ„æºå¯ä»¥åˆ©ç”¨ï¼Œå¯ä»¥è®©æˆ‘ä»¬é›¶æˆæœ¬å®ç°ä¸€äº›å°å·¥å…·ã€‚&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>
